var u3=Object.defineProperty;var fy=e=>{throw TypeError(e)};var f3=(e,t,r)=>t in e?u3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Pa=(e,t,r)=>f3(e,typeof t!="symbol"?t+"":t,r),Tm=(e,t,r)=>t.has(e)||fy("Cannot "+r);var ue=(e,t,r)=>(Tm(e,t,"read from private field"),r?r.call(e):t.get(e)),nt=(e,t,r)=>t.has(e)?fy("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ue=(e,t,r,n)=>(Tm(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Er=(e,t,r)=>(Tm(e,t,"access private method"),r);var wf=(e,t,r,n)=>({set _(a){Ue(e,t,a,r)},get _(){return ue(e,t,n)}});function d3(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function Y2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var X2={exports:{}},xh={},K2={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zu=Symbol.for("react.element"),h3=Symbol.for("react.portal"),m3=Symbol.for("react.fragment"),p3=Symbol.for("react.strict_mode"),g3=Symbol.for("react.profiler"),v3=Symbol.for("react.provider"),y3=Symbol.for("react.context"),x3=Symbol.for("react.forward_ref"),w3=Symbol.for("react.suspense"),_3=Symbol.for("react.memo"),S3=Symbol.for("react.lazy"),dy=Symbol.iterator;function k3(e){return e===null||typeof e!="object"?null:(e=dy&&e[dy]||e["@@iterator"],typeof e=="function"?e:null)}var q2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q2=Object.assign,J2={};function Fl(e,t,r){this.props=e,this.context=t,this.refs=J2,this.updater=r||q2}Fl.prototype.isReactComponent={};Fl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Z2(){}Z2.prototype=Fl.prototype;function yg(e,t,r){this.props=e,this.context=t,this.refs=J2,this.updater=r||q2}var xg=yg.prototype=new Z2;xg.constructor=yg;Q2(xg,Fl.prototype);xg.isPureReactComponent=!0;var hy=Array.isArray,e_=Object.prototype.hasOwnProperty,wg={current:null},t_={key:!0,ref:!0,__self:!0,__source:!0};function r_(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)e_.call(t,n)&&!t_.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:zu,type:e,key:s,ref:i,props:a,_owner:wg.current}}function b3(e,t){return{$$typeof:zu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function _g(e){return typeof e=="object"&&e!==null&&e.$$typeof===zu}function E3(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var my=/\/+/g;function Nm(e,t){return typeof e=="object"&&e!==null&&e.key!=null?E3(""+e.key):t.toString(36)}function id(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case zu:case h3:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Nm(i,0):n,hy(a)?(r="",e!=null&&(r=e.replace(my,"$&/")+"/"),id(a,t,r,"",function(u){return u})):a!=null&&(_g(a)&&(a=b3(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(my,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",hy(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Nm(s,o);i+=id(s,t,r,l,a)}else if(l=k3(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Nm(s,o++),i+=id(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function _f(e,t,r){if(e==null)return e;var n=[],a=0;return id(e,n,"","",function(s){return t.call(r,s,a++)}),n}function T3(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var en={current:null},od={transition:null},N3={ReactCurrentDispatcher:en,ReactCurrentBatchConfig:od,ReactCurrentOwner:wg};function n_(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:_f,forEach:function(e,t,r){_f(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return _f(e,function(){t++}),t},toArray:function(e){return _f(e,function(t){return t})||[]},only:function(e){if(!_g(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=Fl;Xe.Fragment=m3;Xe.Profiler=g3;Xe.PureComponent=yg;Xe.StrictMode=p3;Xe.Suspense=w3;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N3;Xe.act=n_;Xe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Q2({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=wg.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)e_.call(t,l)&&!t_.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:zu,type:e.type,key:a,ref:s,props:n,_owner:i}};Xe.createContext=function(e){return e={$$typeof:y3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:v3,_context:e},e.Consumer=e};Xe.createElement=r_;Xe.createFactory=function(e){var t=r_.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:x3,render:e}};Xe.isValidElement=_g;Xe.lazy=function(e){return{$$typeof:S3,_payload:{_status:-1,_result:e},_init:T3}};Xe.memo=function(e,t){return{$$typeof:_3,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=od.transition;od.transition={};try{e()}finally{od.transition=t}};Xe.unstable_act=n_;Xe.useCallback=function(e,t){return en.current.useCallback(e,t)};Xe.useContext=function(e){return en.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return en.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return en.current.useEffect(e,t)};Xe.useId=function(){return en.current.useId()};Xe.useImperativeHandle=function(e,t,r){return en.current.useImperativeHandle(e,t,r)};Xe.useInsertionEffect=function(e,t){return en.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return en.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return en.current.useMemo(e,t)};Xe.useReducer=function(e,t,r){return en.current.useReducer(e,t,r)};Xe.useRef=function(e){return en.current.useRef(e)};Xe.useState=function(e){return en.current.useState(e)};Xe.useSyncExternalStore=function(e,t,r){return en.current.useSyncExternalStore(e,t,r)};Xe.useTransition=function(){return en.current.useTransition()};Xe.version="18.3.1";K2.exports=Xe;var _=K2.exports;const ge=Y2(_),Sg=d3({__proto__:null,default:ge},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C3=_,A3=Symbol.for("react.element"),P3=Symbol.for("react.fragment"),j3=Object.prototype.hasOwnProperty,D3=C3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R3={key:!0,ref:!0,__self:!0,__source:!0};function a_(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)j3.call(t,n)&&!R3.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:A3,type:e,key:s,ref:i,props:a,_owner:D3.current}}xh.Fragment=P3;xh.jsx=a_;xh.jsxs=a_;X2.exports=xh;var c=X2.exports,s_={exports:{}},Mn={},i_={exports:{}},o_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(H,M){var ne=H.length;H.push(M);e:for(;0<ne;){var ce=ne-1>>>1,j=H[ce];if(0<a(j,M))H[ce]=M,H[ne]=j,ne=ce;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var M=H[0],ne=H.pop();if(ne!==M){H[0]=ne;e:for(var ce=0,j=H.length,z=j>>>1;ce<z;){var L=2*(ce+1)-1,U=H[L],Q=L+1,q=H[Q];if(0>a(U,ne))Q<j&&0>a(q,U)?(H[ce]=q,H[Q]=ne,ce=Q):(H[ce]=U,H[L]=ne,ce=L);else if(Q<j&&0>a(q,ne))H[ce]=q,H[Q]=ne,ce=Q;else break e}}return M}function a(H,M){var ne=H.sortIndex-M.sortIndex;return ne!==0?ne:H.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],u=[],f=1,d=null,m=3,h=!1,v=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(H){for(var M=r(u);M!==null;){if(M.callback===null)n(u);else if(M.startTime<=H)n(u),M.sortIndex=M.expirationTime,t(l,M);else break;M=r(u)}}function S(H){if(p=!1,x(H),!v)if(r(l)!==null)v=!0,K(b);else{var M=r(u);M!==null&&Y(S,M.startTime-H)}}function b(H,M){v=!1,p&&(p=!1,y(T),T=-1),h=!0;var ne=m;try{for(x(M),d=r(l);d!==null&&(!(d.expirationTime>M)||H&&!W());){var ce=d.callback;if(typeof ce=="function"){d.callback=null,m=d.priorityLevel;var j=ce(d.expirationTime<=M);M=e.unstable_now(),typeof j=="function"?d.callback=j:d===r(l)&&n(l),x(M)}else n(l);d=r(l)}if(d!==null)var z=!0;else{var L=r(u);L!==null&&Y(S,L.startTime-M),z=!1}return z}finally{d=null,m=ne,h=!1}}var E=!1,k=null,T=-1,N=5,O=-1;function W(){return!(e.unstable_now()-O<N)}function P(){if(k!==null){var H=e.unstable_now();O=H;var M=!0;try{M=k(!0,H)}finally{M?G():(E=!1,k=null)}}else E=!1}var G;if(typeof w=="function")G=function(){w(P)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,V=X.port2;X.port1.onmessage=P,G=function(){V.postMessage(null)}}else G=function(){g(P,0)};function K(H){k=H,E||(E=!0,G())}function Y(H,M){T=g(function(){H(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,K(b))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(H){switch(m){case 1:case 2:case 3:var M=3;break;default:M=m}var ne=m;m=M;try{return H()}finally{m=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,M){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ne=m;m=H;try{return M()}finally{m=ne}},e.unstable_scheduleCallback=function(H,M,ne){var ce=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ce+ne:ce):ne=ce,H){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ne+j,H={id:f++,callback:M,priorityLevel:H,startTime:ne,expirationTime:j,sortIndex:-1},ne>ce?(H.sortIndex=ne,t(u,H),r(l)===null&&H===r(u)&&(p?(y(T),T=-1):p=!0,Y(S,ne-ce))):(H.sortIndex=j,t(l,H),v||h||(v=!0,K(b))),H},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(H){var M=m;return function(){var ne=m;m=M;try{return H.apply(this,arguments)}finally{m=ne}}}})(o_);i_.exports=o_;var M3=i_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O3=_,Pn=M3;function he(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l_=new Set,Jc={};function vo(e,t){Sl(e,t),Sl(e+"Capture",t)}function Sl(e,t){for(Jc[e]=t,e=0;e<t.length;e++)l_.add(t[e])}var ys=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$p=Object.prototype.hasOwnProperty,I3=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,py={},gy={};function F3(e){return $p.call(gy,e)?!0:$p.call(py,e)?!1:I3.test(e)?gy[e]=!0:(py[e]=!0,!1)}function L3(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function B3(e,t,r,n){if(t===null||typeof t>"u"||L3(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function tn(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var Sr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Sr[e]=new tn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Sr[t]=new tn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Sr[e]=new tn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Sr[e]=new tn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Sr[e]=new tn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Sr[e]=new tn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Sr[e]=new tn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Sr[e]=new tn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Sr[e]=new tn(e,5,!1,e.toLowerCase(),null,!1,!1)});var kg=/[\-:]([a-z])/g;function bg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(kg,bg);Sr[t]=new tn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(kg,bg);Sr[t]=new tn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(kg,bg);Sr[t]=new tn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Sr[e]=new tn(e,1,!1,e.toLowerCase(),null,!1,!1)});Sr.xlinkHref=new tn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Sr[e]=new tn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Eg(e,t,r,n){var a=Sr.hasOwnProperty(t)?Sr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(B3(t,r,a,n)&&(r=null),n||a===null?F3(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ts=O3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sf=Symbol.for("react.element"),Uo=Symbol.for("react.portal"),$o=Symbol.for("react.fragment"),Tg=Symbol.for("react.strict_mode"),Wp=Symbol.for("react.profiler"),c_=Symbol.for("react.provider"),u_=Symbol.for("react.context"),Ng=Symbol.for("react.forward_ref"),Hp=Symbol.for("react.suspense"),zp=Symbol.for("react.suspense_list"),Cg=Symbol.for("react.memo"),$s=Symbol.for("react.lazy"),f_=Symbol.for("react.offscreen"),vy=Symbol.iterator;function oc(e){return e===null||typeof e!="object"?null:(e=vy&&e[vy]||e["@@iterator"],typeof e=="function"?e:null)}var Ft=Object.assign,Cm;function bc(e){if(Cm===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Cm=t&&t[1]||""}return`
`+Cm+e}var Am=!1;function Pm(e,t){if(!e||Am)return"";Am=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Am=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?bc(e):""}function U3(e){switch(e.tag){case 5:return bc(e.type);case 16:return bc("Lazy");case 13:return bc("Suspense");case 19:return bc("SuspenseList");case 0:case 2:case 15:return e=Pm(e.type,!1),e;case 11:return e=Pm(e.type.render,!1),e;case 1:return e=Pm(e.type,!0),e;default:return""}}function Vp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $o:return"Fragment";case Uo:return"Portal";case Wp:return"Profiler";case Tg:return"StrictMode";case Hp:return"Suspense";case zp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case u_:return(e.displayName||"Context")+".Consumer";case c_:return(e._context.displayName||"Context")+".Provider";case Ng:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Cg:return t=e.displayName||null,t!==null?t:Vp(e.type)||"Memo";case $s:t=e._payload,e=e._init;try{return Vp(e(t))}catch{}}return null}function $3(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vp(t);case 8:return t===Tg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ci(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function d_(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function W3(e){var t=d_(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function kf(e){e._valueTracker||(e._valueTracker=W3(e))}function h_(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=d_(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Ed(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Gp(e,t){var r=t.checked;return Ft({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function yy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ci(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function m_(e,t){t=t.checked,t!=null&&Eg(e,"checked",t,!1)}function Yp(e,t){m_(e,t);var r=ci(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Xp(e,t.type,r):t.hasOwnProperty("defaultValue")&&Xp(e,t.type,ci(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function xy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Xp(e,t,r){(t!=="number"||Ed(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ec=Array.isArray;function el(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ci(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Kp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(he(91));return Ft({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function wy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(he(92));if(Ec(r)){if(1<r.length)throw Error(he(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ci(r)}}function p_(e,t){var r=ci(t.value),n=ci(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function _y(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function g_(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?g_(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var bf,v_=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(bf=bf||document.createElement("div"),bf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=bf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Zc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Mc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},H3=["Webkit","ms","Moz","O"];Object.keys(Mc).forEach(function(e){H3.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Mc[t]=Mc[e]})});function y_(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Mc.hasOwnProperty(e)&&Mc[e]?(""+t).trim():t+"px"}function x_(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=y_(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var z3=Ft({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qp(e,t){if(t){if(z3[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(he(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(he(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(he(61))}if(t.style!=null&&typeof t.style!="object")throw Error(he(62))}}function Jp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Zp=null;function Ag(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var e0=null,tl=null,rl=null;function Sy(e){if(e=Yu(e)){if(typeof e0!="function")throw Error(he(280));var t=e.stateNode;t&&(t=bh(t),e0(e.stateNode,e.type,t))}}function w_(e){tl?rl?rl.push(e):rl=[e]:tl=e}function __(){if(tl){var e=tl,t=rl;if(rl=tl=null,Sy(e),t)for(e=0;e<t.length;e++)Sy(t[e])}}function S_(e,t){return e(t)}function k_(){}var jm=!1;function b_(e,t,r){if(jm)return e(t,r);jm=!0;try{return S_(e,t,r)}finally{jm=!1,(tl!==null||rl!==null)&&(k_(),__())}}function eu(e,t){var r=e.stateNode;if(r===null)return null;var n=bh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(he(231,t,typeof r));return r}var t0=!1;if(ys)try{var lc={};Object.defineProperty(lc,"passive",{get:function(){t0=!0}}),window.addEventListener("test",lc,lc),window.removeEventListener("test",lc,lc)}catch{t0=!1}function V3(e,t,r,n,a,s,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var Oc=!1,Td=null,Nd=!1,r0=null,G3={onError:function(e){Oc=!0,Td=e}};function Y3(e,t,r,n,a,s,i,o,l){Oc=!1,Td=null,V3.apply(G3,arguments)}function X3(e,t,r,n,a,s,i,o,l){if(Y3.apply(this,arguments),Oc){if(Oc){var u=Td;Oc=!1,Td=null}else throw Error(he(198));Nd||(Nd=!0,r0=u)}}function yo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function E_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ky(e){if(yo(e)!==e)throw Error(he(188))}function K3(e){var t=e.alternate;if(!t){if(t=yo(e),t===null)throw Error(he(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return ky(a),e;if(s===n)return ky(a),t;s=s.sibling}throw Error(he(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(he(189))}}if(r.alternate!==n)throw Error(he(190))}if(r.tag!==3)throw Error(he(188));return r.stateNode.current===r?e:t}function T_(e){return e=K3(e),e!==null?N_(e):null}function N_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=N_(e);if(t!==null)return t;e=e.sibling}return null}var C_=Pn.unstable_scheduleCallback,by=Pn.unstable_cancelCallback,q3=Pn.unstable_shouldYield,Q3=Pn.unstable_requestPaint,Gt=Pn.unstable_now,J3=Pn.unstable_getCurrentPriorityLevel,Pg=Pn.unstable_ImmediatePriority,A_=Pn.unstable_UserBlockingPriority,Cd=Pn.unstable_NormalPriority,Z3=Pn.unstable_LowPriority,P_=Pn.unstable_IdlePriority,wh=null,za=null;function e5(e){if(za&&typeof za.onCommitFiberRoot=="function")try{za.onCommitFiberRoot(wh,e,void 0,(e.current.flags&128)===128)}catch{}}var va=Math.clz32?Math.clz32:n5,t5=Math.log,r5=Math.LN2;function n5(e){return e>>>=0,e===0?32:31-(t5(e)/r5|0)|0}var Ef=64,Tf=4194304;function Tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ad(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Tc(o):(s&=i,s!==0&&(n=Tc(s)))}else i=r&~a,i!==0?n=Tc(i):s!==0&&(n=Tc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-va(t),a=1<<r,n|=e[r],t&=~a;return n}function a5(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s5(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-va(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=a5(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function n0(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function j_(){var e=Ef;return Ef<<=1,!(Ef&4194240)&&(Ef=64),e}function Dm(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Vu(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-va(t),e[t]=r}function i5(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-va(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function jg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-va(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var ut=0;function D_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var R_,Dg,M_,O_,I_,a0=!1,Nf=[],ti=null,ri=null,ni=null,tu=new Map,ru=new Map,Hs=[],o5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ey(e,t){switch(e){case"focusin":case"focusout":ti=null;break;case"dragenter":case"dragleave":ri=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":tu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ru.delete(t.pointerId)}}function cc(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=Yu(t),t!==null&&Dg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function l5(e,t,r,n,a){switch(t){case"focusin":return ti=cc(ti,e,t,r,n,a),!0;case"dragenter":return ri=cc(ri,e,t,r,n,a),!0;case"mouseover":return ni=cc(ni,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return tu.set(s,cc(tu.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,ru.set(s,cc(ru.get(s)||null,e,t,r,n,a)),!0}return!1}function F_(e){var t=Mi(e.target);if(t!==null){var r=yo(t);if(r!==null){if(t=r.tag,t===13){if(t=E_(r),t!==null){e.blockedOn=t,I_(e.priority,function(){M_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ld(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=s0(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Zp=n,r.target.dispatchEvent(n),Zp=null}else return t=Yu(r),t!==null&&Dg(t),e.blockedOn=r,!1;t.shift()}return!0}function Ty(e,t,r){ld(e)&&r.delete(t)}function c5(){a0=!1,ti!==null&&ld(ti)&&(ti=null),ri!==null&&ld(ri)&&(ri=null),ni!==null&&ld(ni)&&(ni=null),tu.forEach(Ty),ru.forEach(Ty)}function uc(e,t){e.blockedOn===t&&(e.blockedOn=null,a0||(a0=!0,Pn.unstable_scheduleCallback(Pn.unstable_NormalPriority,c5)))}function nu(e){function t(a){return uc(a,e)}if(0<Nf.length){uc(Nf[0],e);for(var r=1;r<Nf.length;r++){var n=Nf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ti!==null&&uc(ti,e),ri!==null&&uc(ri,e),ni!==null&&uc(ni,e),tu.forEach(t),ru.forEach(t),r=0;r<Hs.length;r++)n=Hs[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Hs.length&&(r=Hs[0],r.blockedOn===null);)F_(r),r.blockedOn===null&&Hs.shift()}var nl=Ts.ReactCurrentBatchConfig,Pd=!0;function u5(e,t,r,n){var a=ut,s=nl.transition;nl.transition=null;try{ut=1,Rg(e,t,r,n)}finally{ut=a,nl.transition=s}}function f5(e,t,r,n){var a=ut,s=nl.transition;nl.transition=null;try{ut=4,Rg(e,t,r,n)}finally{ut=a,nl.transition=s}}function Rg(e,t,r,n){if(Pd){var a=s0(e,t,r,n);if(a===null)Wm(e,t,n,jd,r),Ey(e,n);else if(l5(a,e,t,r,n))n.stopPropagation();else if(Ey(e,n),t&4&&-1<o5.indexOf(e)){for(;a!==null;){var s=Yu(a);if(s!==null&&R_(s),s=s0(e,t,r,n),s===null&&Wm(e,t,n,jd,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Wm(e,t,n,null,r)}}var jd=null;function s0(e,t,r,n){if(jd=null,e=Ag(n),e=Mi(e),e!==null)if(t=yo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=E_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return jd=e,null}function L_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(J3()){case Pg:return 1;case A_:return 4;case Cd:case Z3:return 16;case P_:return 536870912;default:return 16}default:return 16}}var qs=null,Mg=null,cd=null;function B_(){if(cd)return cd;var e,t=Mg,r=t.length,n,a="value"in qs?qs.value:qs.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return cd=a.slice(e,1<n?1-n:void 0)}function ud(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Cf(){return!0}function Ny(){return!1}function On(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Cf:Ny,this.isPropagationStopped=Ny,this}return Ft(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Cf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Cf)},persist:function(){},isPersistent:Cf}),t}var Ll={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Og=On(Ll),Gu=Ft({},Ll,{view:0,detail:0}),d5=On(Gu),Rm,Mm,fc,_h=Ft({},Gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ig,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fc&&(fc&&e.type==="mousemove"?(Rm=e.screenX-fc.screenX,Mm=e.screenY-fc.screenY):Mm=Rm=0,fc=e),Rm)},movementY:function(e){return"movementY"in e?e.movementY:Mm}}),Cy=On(_h),h5=Ft({},_h,{dataTransfer:0}),m5=On(h5),p5=Ft({},Gu,{relatedTarget:0}),Om=On(p5),g5=Ft({},Ll,{animationName:0,elapsedTime:0,pseudoElement:0}),v5=On(g5),y5=Ft({},Ll,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),x5=On(y5),w5=Ft({},Ll,{data:0}),Ay=On(w5),_5={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S5={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},k5={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function b5(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=k5[e])?!!t[e]:!1}function Ig(){return b5}var E5=Ft({},Gu,{key:function(e){if(e.key){var t=_5[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ud(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?S5[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ig,charCode:function(e){return e.type==="keypress"?ud(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ud(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),T5=On(E5),N5=Ft({},_h,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Py=On(N5),C5=Ft({},Gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ig}),A5=On(C5),P5=Ft({},Ll,{propertyName:0,elapsedTime:0,pseudoElement:0}),j5=On(P5),D5=Ft({},_h,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),R5=On(D5),M5=[9,13,27,32],Fg=ys&&"CompositionEvent"in window,Ic=null;ys&&"documentMode"in document&&(Ic=document.documentMode);var O5=ys&&"TextEvent"in window&&!Ic,U_=ys&&(!Fg||Ic&&8<Ic&&11>=Ic),jy=" ",Dy=!1;function $_(e,t){switch(e){case"keyup":return M5.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function W_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Wo=!1;function I5(e,t){switch(e){case"compositionend":return W_(t);case"keypress":return t.which!==32?null:(Dy=!0,jy);case"textInput":return e=t.data,e===jy&&Dy?null:e;default:return null}}function F5(e,t){if(Wo)return e==="compositionend"||!Fg&&$_(e,t)?(e=B_(),cd=Mg=qs=null,Wo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return U_&&t.locale!=="ko"?null:t.data;default:return null}}var L5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ry(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!L5[e.type]:t==="textarea"}function H_(e,t,r,n){w_(n),t=Dd(t,"onChange"),0<t.length&&(r=new Og("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Fc=null,au=null;function B5(e){eS(e,0)}function Sh(e){var t=Vo(e);if(h_(t))return e}function U5(e,t){if(e==="change")return t}var z_=!1;if(ys){var Im;if(ys){var Fm="oninput"in document;if(!Fm){var My=document.createElement("div");My.setAttribute("oninput","return;"),Fm=typeof My.oninput=="function"}Im=Fm}else Im=!1;z_=Im&&(!document.documentMode||9<document.documentMode)}function Oy(){Fc&&(Fc.detachEvent("onpropertychange",V_),au=Fc=null)}function V_(e){if(e.propertyName==="value"&&Sh(au)){var t=[];H_(t,au,e,Ag(e)),b_(B5,t)}}function $5(e,t,r){e==="focusin"?(Oy(),Fc=t,au=r,Fc.attachEvent("onpropertychange",V_)):e==="focusout"&&Oy()}function W5(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Sh(au)}function H5(e,t){if(e==="click")return Sh(t)}function z5(e,t){if(e==="input"||e==="change")return Sh(t)}function V5(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _a=typeof Object.is=="function"?Object.is:V5;function su(e,t){if(_a(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!$p.call(t,a)||!_a(e[a],t[a]))return!1}return!0}function Iy(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Fy(e,t){var r=Iy(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Iy(r)}}function G_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?G_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Y_(){for(var e=window,t=Ed();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ed(e.document)}return t}function Lg(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function G5(e){var t=Y_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&G_(r.ownerDocument.documentElement,r)){if(n!==null&&Lg(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Fy(r,s);var i=Fy(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Y5=ys&&"documentMode"in document&&11>=document.documentMode,Ho=null,i0=null,Lc=null,o0=!1;function Ly(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;o0||Ho==null||Ho!==Ed(n)||(n=Ho,"selectionStart"in n&&Lg(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Lc&&su(Lc,n)||(Lc=n,n=Dd(i0,"onSelect"),0<n.length&&(t=new Og("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ho)))}function Af(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var zo={animationend:Af("Animation","AnimationEnd"),animationiteration:Af("Animation","AnimationIteration"),animationstart:Af("Animation","AnimationStart"),transitionend:Af("Transition","TransitionEnd")},Lm={},X_={};ys&&(X_=document.createElement("div").style,"AnimationEvent"in window||(delete zo.animationend.animation,delete zo.animationiteration.animation,delete zo.animationstart.animation),"TransitionEvent"in window||delete zo.transitionend.transition);function kh(e){if(Lm[e])return Lm[e];if(!zo[e])return e;var t=zo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in X_)return Lm[e]=t[r];return e}var K_=kh("animationend"),q_=kh("animationiteration"),Q_=kh("animationstart"),J_=kh("transitionend"),Z_=new Map,By="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yi(e,t){Z_.set(e,t),vo(t,[e])}for(var Bm=0;Bm<By.length;Bm++){var Um=By[Bm],X5=Um.toLowerCase(),K5=Um[0].toUpperCase()+Um.slice(1);yi(X5,"on"+K5)}yi(K_,"onAnimationEnd");yi(q_,"onAnimationIteration");yi(Q_,"onAnimationStart");yi("dblclick","onDoubleClick");yi("focusin","onFocus");yi("focusout","onBlur");yi(J_,"onTransitionEnd");Sl("onMouseEnter",["mouseout","mouseover"]);Sl("onMouseLeave",["mouseout","mouseover"]);Sl("onPointerEnter",["pointerout","pointerover"]);Sl("onPointerLeave",["pointerout","pointerover"]);vo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vo("onBeforeInput",["compositionend","keypress","textInput","paste"]);vo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),q5=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nc));function Uy(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,X3(n,t,void 0,e),e.currentTarget=null}function eS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Uy(a,o,u),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Uy(a,o,u),s=l}}}if(Nd)throw e=r0,Nd=!1,r0=null,e}function St(e,t){var r=t[d0];r===void 0&&(r=t[d0]=new Set);var n=e+"__bubble";r.has(n)||(tS(t,e,2,!1),r.add(n))}function $m(e,t,r){var n=0;t&&(n|=4),tS(r,e,n,t)}var Pf="_reactListening"+Math.random().toString(36).slice(2);function iu(e){if(!e[Pf]){e[Pf]=!0,l_.forEach(function(r){r!=="selectionchange"&&(q5.has(r)||$m(r,!1,e),$m(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Pf]||(t[Pf]=!0,$m("selectionchange",!1,t))}}function tS(e,t,r,n){switch(L_(t)){case 1:var a=u5;break;case 4:a=f5;break;default:a=Rg}r=a.bind(null,t,r,e),a=void 0,!t0||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Wm(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Mi(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}b_(function(){var u=s,f=Ag(r),d=[];e:{var m=Z_.get(e);if(m!==void 0){var h=Og,v=e;switch(e){case"keypress":if(ud(r)===0)break e;case"keydown":case"keyup":h=T5;break;case"focusin":v="focus",h=Om;break;case"focusout":v="blur",h=Om;break;case"beforeblur":case"afterblur":h=Om;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Cy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=m5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=A5;break;case K_:case q_:case Q_:h=v5;break;case J_:h=j5;break;case"scroll":h=d5;break;case"wheel":h=R5;break;case"copy":case"cut":case"paste":h=x5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Py}var p=(t&4)!==0,g=!p&&e==="scroll",y=p?m!==null?m+"Capture":null:m;p=[];for(var w=u,x;w!==null;){x=w;var S=x.stateNode;if(x.tag===5&&S!==null&&(x=S,y!==null&&(S=eu(w,y),S!=null&&p.push(ou(w,S,x)))),g)break;w=w.return}0<p.length&&(m=new h(m,v,null,r,f),d.push({event:m,listeners:p}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",m&&r!==Zp&&(v=r.relatedTarget||r.fromElement)&&(Mi(v)||v[xs]))break e;if((h||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=u,v=v?Mi(v):null,v!==null&&(g=yo(v),v!==g||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=u),h!==v)){if(p=Cy,S="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(p=Py,S="onPointerLeave",y="onPointerEnter",w="pointer"),g=h==null?m:Vo(h),x=v==null?m:Vo(v),m=new p(S,w+"leave",h,r,f),m.target=g,m.relatedTarget=x,S=null,Mi(f)===u&&(p=new p(y,w+"enter",v,r,f),p.target=x,p.relatedTarget=g,S=p),g=S,h&&v)t:{for(p=h,y=v,w=0,x=p;x;x=Po(x))w++;for(x=0,S=y;S;S=Po(S))x++;for(;0<w-x;)p=Po(p),w--;for(;0<x-w;)y=Po(y),x--;for(;w--;){if(p===y||y!==null&&p===y.alternate)break t;p=Po(p),y=Po(y)}p=null}else p=null;h!==null&&$y(d,m,h,p,!1),v!==null&&g!==null&&$y(d,g,v,p,!0)}}e:{if(m=u?Vo(u):window,h=m.nodeName&&m.nodeName.toLowerCase(),h==="select"||h==="input"&&m.type==="file")var b=U5;else if(Ry(m))if(z_)b=z5;else{b=W5;var E=$5}else(h=m.nodeName)&&h.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(b=H5);if(b&&(b=b(e,u))){H_(d,b,r,f);break e}E&&E(e,m,u),e==="focusout"&&(E=m._wrapperState)&&E.controlled&&m.type==="number"&&Xp(m,"number",m.value)}switch(E=u?Vo(u):window,e){case"focusin":(Ry(E)||E.contentEditable==="true")&&(Ho=E,i0=u,Lc=null);break;case"focusout":Lc=i0=Ho=null;break;case"mousedown":o0=!0;break;case"contextmenu":case"mouseup":case"dragend":o0=!1,Ly(d,r,f);break;case"selectionchange":if(Y5)break;case"keydown":case"keyup":Ly(d,r,f)}var k;if(Fg)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Wo?$_(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(U_&&r.locale!=="ko"&&(Wo||T!=="onCompositionStart"?T==="onCompositionEnd"&&Wo&&(k=B_()):(qs=f,Mg="value"in qs?qs.value:qs.textContent,Wo=!0)),E=Dd(u,T),0<E.length&&(T=new Ay(T,e,null,r,f),d.push({event:T,listeners:E}),k?T.data=k:(k=W_(r),k!==null&&(T.data=k)))),(k=O5?I5(e,r):F5(e,r))&&(u=Dd(u,"onBeforeInput"),0<u.length&&(f=new Ay("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=k))}eS(d,t)})}function ou(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Dd(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=eu(e,r),s!=null&&n.unshift(ou(e,s,a)),s=eu(e,t),s!=null&&n.push(ou(e,s,a))),e=e.return}return n}function Po(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $y(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,a?(l=eu(r,s),l!=null&&i.unshift(ou(r,l,o))):a||(l=eu(r,s),l!=null&&i.push(ou(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Q5=/\r\n?/g,J5=/\u0000|\uFFFD/g;function Wy(e){return(typeof e=="string"?e:""+e).replace(Q5,`
`).replace(J5,"")}function jf(e,t,r){if(t=Wy(t),Wy(e)!==t&&r)throw Error(he(425))}function Rd(){}var l0=null,c0=null;function u0(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var f0=typeof setTimeout=="function"?setTimeout:void 0,Z5=typeof clearTimeout=="function"?clearTimeout:void 0,Hy=typeof Promise=="function"?Promise:void 0,e6=typeof queueMicrotask=="function"?queueMicrotask:typeof Hy<"u"?function(e){return Hy.resolve(null).then(e).catch(t6)}:f0;function t6(e){setTimeout(function(){throw e})}function Hm(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),nu(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);nu(t)}function ai(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function zy(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Bl=Math.random().toString(36).slice(2),Ba="__reactFiber$"+Bl,lu="__reactProps$"+Bl,xs="__reactContainer$"+Bl,d0="__reactEvents$"+Bl,r6="__reactListeners$"+Bl,n6="__reactHandles$"+Bl;function Mi(e){var t=e[Ba];if(t)return t;for(var r=e.parentNode;r;){if(t=r[xs]||r[Ba]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=zy(e);e!==null;){if(r=e[Ba])return r;e=zy(e)}return t}e=r,r=e.parentNode}return null}function Yu(e){return e=e[Ba]||e[xs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Vo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(he(33))}function bh(e){return e[lu]||null}var h0=[],Go=-1;function xi(e){return{current:e}}function Et(e){0>Go||(e.current=h0[Go],h0[Go]=null,Go--)}function xt(e,t){Go++,h0[Go]=e.current,e.current=t}var ui={},Br=xi(ui),ln=xi(!1),Ji=ui;function kl(e,t){var r=e.type.contextTypes;if(!r)return ui;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function cn(e){return e=e.childContextTypes,e!=null}function Md(){Et(ln),Et(Br)}function Vy(e,t,r){if(Br.current!==ui)throw Error(he(168));xt(Br,t),xt(ln,r)}function rS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(he(108,$3(e)||"Unknown",a));return Ft({},r,n)}function Od(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ui,Ji=Br.current,xt(Br,e),xt(ln,ln.current),!0}function Gy(e,t,r){var n=e.stateNode;if(!n)throw Error(he(169));r?(e=rS(e,t,Ji),n.__reactInternalMemoizedMergedChildContext=e,Et(ln),Et(Br),xt(Br,e)):Et(ln),xt(ln,r)}var is=null,Eh=!1,zm=!1;function nS(e){is===null?is=[e]:is.push(e)}function a6(e){Eh=!0,nS(e)}function wi(){if(!zm&&is!==null){zm=!0;var e=0,t=ut;try{var r=is;for(ut=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}is=null,Eh=!1}catch(a){throw is!==null&&(is=is.slice(e+1)),C_(Pg,wi),a}finally{ut=t,zm=!1}}return null}var Yo=[],Xo=0,Id=null,Fd=0,Gn=[],Yn=0,Zi=null,ls=1,cs="";function Pi(e,t){Yo[Xo++]=Fd,Yo[Xo++]=Id,Id=e,Fd=t}function aS(e,t,r){Gn[Yn++]=ls,Gn[Yn++]=cs,Gn[Yn++]=Zi,Zi=e;var n=ls;e=cs;var a=32-va(n)-1;n&=~(1<<a),r+=1;var s=32-va(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ls=1<<32-va(t)+a|r<<a|n,cs=s+e}else ls=1<<s|r<<a|n,cs=e}function Bg(e){e.return!==null&&(Pi(e,1),aS(e,1,0))}function Ug(e){for(;e===Id;)Id=Yo[--Xo],Yo[Xo]=null,Fd=Yo[--Xo],Yo[Xo]=null;for(;e===Zi;)Zi=Gn[--Yn],Gn[Yn]=null,cs=Gn[--Yn],Gn[Yn]=null,ls=Gn[--Yn],Gn[Yn]=null}var Cn=null,Nn=null,Ct=!1,ha=null;function sS(e,t){var r=Kn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Yy(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Cn=e,Nn=ai(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Cn=e,Nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Zi!==null?{id:ls,overflow:cs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Kn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Cn=e,Nn=null,!0):!1;default:return!1}}function m0(e){return(e.mode&1)!==0&&(e.flags&128)===0}function p0(e){if(Ct){var t=Nn;if(t){var r=t;if(!Yy(e,t)){if(m0(e))throw Error(he(418));t=ai(r.nextSibling);var n=Cn;t&&Yy(e,t)?sS(n,r):(e.flags=e.flags&-4097|2,Ct=!1,Cn=e)}}else{if(m0(e))throw Error(he(418));e.flags=e.flags&-4097|2,Ct=!1,Cn=e}}}function Xy(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Cn=e}function Df(e){if(e!==Cn)return!1;if(!Ct)return Xy(e),Ct=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!u0(e.type,e.memoizedProps)),t&&(t=Nn)){if(m0(e))throw iS(),Error(he(418));for(;t;)sS(e,t),t=ai(t.nextSibling)}if(Xy(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(he(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Nn=ai(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Nn=null}}else Nn=Cn?ai(e.stateNode.nextSibling):null;return!0}function iS(){for(var e=Nn;e;)e=ai(e.nextSibling)}function bl(){Nn=Cn=null,Ct=!1}function $g(e){ha===null?ha=[e]:ha.push(e)}var s6=Ts.ReactCurrentBatchConfig;function dc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(he(309));var n=r.stateNode}if(!n)throw Error(he(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(he(284));if(!r._owner)throw Error(he(290,e))}return e}function Rf(e,t){throw e=Object.prototype.toString.call(t),Error(he(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ky(e){var t=e._init;return t(e._payload)}function oS(e){function t(y,w){if(e){var x=y.deletions;x===null?(y.deletions=[w],y.flags|=16):x.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function a(y,w){return y=li(y,w),y.index=0,y.sibling=null,y}function s(y,w,x){return y.index=x,e?(x=y.alternate,x!==null?(x=x.index,x<w?(y.flags|=2,w):x):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,x,S){return w===null||w.tag!==6?(w=Qm(x,y.mode,S),w.return=y,w):(w=a(w,x),w.return=y,w)}function l(y,w,x,S){var b=x.type;return b===$o?f(y,w,x.props.children,S,x.key):w!==null&&(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===$s&&Ky(b)===w.type)?(S=a(w,x.props),S.ref=dc(y,w,x),S.return=y,S):(S=vd(x.type,x.key,x.props,null,y.mode,S),S.ref=dc(y,w,x),S.return=y,S)}function u(y,w,x,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=Jm(x,y.mode,S),w.return=y,w):(w=a(w,x.children||[]),w.return=y,w)}function f(y,w,x,S,b){return w===null||w.tag!==7?(w=Vi(x,y.mode,S,b),w.return=y,w):(w=a(w,x),w.return=y,w)}function d(y,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Qm(""+w,y.mode,x),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Sf:return x=vd(w.type,w.key,w.props,null,y.mode,x),x.ref=dc(y,null,w),x.return=y,x;case Uo:return w=Jm(w,y.mode,x),w.return=y,w;case $s:var S=w._init;return d(y,S(w._payload),x)}if(Ec(w)||oc(w))return w=Vi(w,y.mode,x,null),w.return=y,w;Rf(y,w)}return null}function m(y,w,x,S){var b=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:o(y,w,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Sf:return x.key===b?l(y,w,x,S):null;case Uo:return x.key===b?u(y,w,x,S):null;case $s:return b=x._init,m(y,w,b(x._payload),S)}if(Ec(x)||oc(x))return b!==null?null:f(y,w,x,S,null);Rf(y,x)}return null}function h(y,w,x,S,b){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(x)||null,o(w,y,""+S,b);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Sf:return y=y.get(S.key===null?x:S.key)||null,l(w,y,S,b);case Uo:return y=y.get(S.key===null?x:S.key)||null,u(w,y,S,b);case $s:var E=S._init;return h(y,w,x,E(S._payload),b)}if(Ec(S)||oc(S))return y=y.get(x)||null,f(w,y,S,b,null);Rf(w,S)}return null}function v(y,w,x,S){for(var b=null,E=null,k=w,T=w=0,N=null;k!==null&&T<x.length;T++){k.index>T?(N=k,k=null):N=k.sibling;var O=m(y,k,x[T],S);if(O===null){k===null&&(k=N);break}e&&k&&O.alternate===null&&t(y,k),w=s(O,w,T),E===null?b=O:E.sibling=O,E=O,k=N}if(T===x.length)return r(y,k),Ct&&Pi(y,T),b;if(k===null){for(;T<x.length;T++)k=d(y,x[T],S),k!==null&&(w=s(k,w,T),E===null?b=k:E.sibling=k,E=k);return Ct&&Pi(y,T),b}for(k=n(y,k);T<x.length;T++)N=h(k,y,T,x[T],S),N!==null&&(e&&N.alternate!==null&&k.delete(N.key===null?T:N.key),w=s(N,w,T),E===null?b=N:E.sibling=N,E=N);return e&&k.forEach(function(W){return t(y,W)}),Ct&&Pi(y,T),b}function p(y,w,x,S){var b=oc(x);if(typeof b!="function")throw Error(he(150));if(x=b.call(x),x==null)throw Error(he(151));for(var E=b=null,k=w,T=w=0,N=null,O=x.next();k!==null&&!O.done;T++,O=x.next()){k.index>T?(N=k,k=null):N=k.sibling;var W=m(y,k,O.value,S);if(W===null){k===null&&(k=N);break}e&&k&&W.alternate===null&&t(y,k),w=s(W,w,T),E===null?b=W:E.sibling=W,E=W,k=N}if(O.done)return r(y,k),Ct&&Pi(y,T),b;if(k===null){for(;!O.done;T++,O=x.next())O=d(y,O.value,S),O!==null&&(w=s(O,w,T),E===null?b=O:E.sibling=O,E=O);return Ct&&Pi(y,T),b}for(k=n(y,k);!O.done;T++,O=x.next())O=h(k,y,T,O.value,S),O!==null&&(e&&O.alternate!==null&&k.delete(O.key===null?T:O.key),w=s(O,w,T),E===null?b=O:E.sibling=O,E=O);return e&&k.forEach(function(P){return t(y,P)}),Ct&&Pi(y,T),b}function g(y,w,x,S){if(typeof x=="object"&&x!==null&&x.type===$o&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Sf:e:{for(var b=x.key,E=w;E!==null;){if(E.key===b){if(b=x.type,b===$o){if(E.tag===7){r(y,E.sibling),w=a(E,x.props.children),w.return=y,y=w;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===$s&&Ky(b)===E.type){r(y,E.sibling),w=a(E,x.props),w.ref=dc(y,E,x),w.return=y,y=w;break e}r(y,E);break}else t(y,E);E=E.sibling}x.type===$o?(w=Vi(x.props.children,y.mode,S,x.key),w.return=y,y=w):(S=vd(x.type,x.key,x.props,null,y.mode,S),S.ref=dc(y,w,x),S.return=y,y=S)}return i(y);case Uo:e:{for(E=x.key;w!==null;){if(w.key===E)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(y,w.sibling),w=a(w,x.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=Jm(x,y.mode,S),w.return=y,y=w}return i(y);case $s:return E=x._init,g(y,w,E(x._payload),S)}if(Ec(x))return v(y,w,x,S);if(oc(x))return p(y,w,x,S);Rf(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(y,w.sibling),w=a(w,x),w.return=y,y=w):(r(y,w),w=Qm(x,y.mode,S),w.return=y,y=w),i(y)):r(y,w)}return g}var El=oS(!0),lS=oS(!1),Ld=xi(null),Bd=null,Ko=null,Wg=null;function Hg(){Wg=Ko=Bd=null}function zg(e){var t=Ld.current;Et(Ld),e._currentValue=t}function g0(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function al(e,t){Bd=e,Wg=Ko=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(on=!0),e.firstContext=null)}function Jn(e){var t=e._currentValue;if(Wg!==e)if(e={context:e,memoizedValue:t,next:null},Ko===null){if(Bd===null)throw Error(he(308));Ko=e,Bd.dependencies={lanes:0,firstContext:e}}else Ko=Ko.next=e;return t}var Oi=null;function Vg(e){Oi===null?Oi=[e]:Oi.push(e)}function cS(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Vg(t)):(r.next=a.next,a.next=r),t.interleaved=r,ws(e,n)}function ws(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ws=!1;function Gg(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function hs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function si(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ze&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ws(e,r)}return a=n.interleaved,a===null?(t.next=t,Vg(n)):(t.next=a.next,a.next=t),n.interleaved=t,ws(e,r)}function fd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,jg(e,r)}}function qy(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Ud(e,t,r,n){var a=e.updateQueue;Ws=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?s=u:i.next=u,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=u=l=null,o=s;do{var m=o.lane,h=o.eventTime;if((n&m)===m){f!==null&&(f=f.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,p=o;switch(m=t,h=r,p.tag){case 1:if(v=p.payload,typeof v=="function"){d=v.call(h,d,m);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=p.payload,m=typeof v=="function"?v.call(h,d,m):v,m==null)break e;d=Ft({},d,m);break e;case 2:Ws=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,m=a.effects,m===null?a.effects=[o]:m.push(o))}else h={eventTime:h,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=h,l=d):f=f.next=h,i|=m;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;m=o,o=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);to|=i,e.lanes=i,e.memoizedState=d}}function Qy(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(he(191,a));a.call(n)}}}var Xu={},Va=xi(Xu),cu=xi(Xu),uu=xi(Xu);function Ii(e){if(e===Xu)throw Error(he(174));return e}function Yg(e,t){switch(xt(uu,t),xt(cu,e),xt(Va,Xu),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:qp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=qp(t,e)}Et(Va),xt(Va,t)}function Tl(){Et(Va),Et(cu),Et(uu)}function fS(e){Ii(uu.current);var t=Ii(Va.current),r=qp(t,e.type);t!==r&&(xt(cu,e),xt(Va,r))}function Xg(e){cu.current===e&&(Et(Va),Et(cu))}var Rt=xi(0);function $d(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vm=[];function Kg(){for(var e=0;e<Vm.length;e++)Vm[e]._workInProgressVersionPrimary=null;Vm.length=0}var dd=Ts.ReactCurrentDispatcher,Gm=Ts.ReactCurrentBatchConfig,eo=0,It=null,ar=null,fr=null,Wd=!1,Bc=!1,fu=0,i6=0;function Tr(){throw Error(he(321))}function qg(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!_a(e[r],t[r]))return!1;return!0}function Qg(e,t,r,n,a,s){if(eo=s,It=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,dd.current=e===null||e.memoizedState===null?u6:f6,e=r(n,a),Bc){s=0;do{if(Bc=!1,fu=0,25<=s)throw Error(he(301));s+=1,fr=ar=null,t.updateQueue=null,dd.current=d6,e=r(n,a)}while(Bc)}if(dd.current=Hd,t=ar!==null&&ar.next!==null,eo=0,fr=ar=It=null,Wd=!1,t)throw Error(he(300));return e}function Jg(){var e=fu!==0;return fu=0,e}function Oa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fr===null?It.memoizedState=fr=e:fr=fr.next=e,fr}function Zn(){if(ar===null){var e=It.alternate;e=e!==null?e.memoizedState:null}else e=ar.next;var t=fr===null?It.memoizedState:fr.next;if(t!==null)fr=t,ar=e;else{if(e===null)throw Error(he(310));ar=e,e={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},fr===null?It.memoizedState=fr=e:fr=fr.next=e}return fr}function du(e,t){return typeof t=="function"?t(e):t}function Ym(e){var t=Zn(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=ar,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,u=s;do{var f=u.lane;if((eo&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,It.lanes|=f,to|=f}u=u.next}while(u!==null&&u!==s);l===null?i=n:l.next=o,_a(n,t.memoizedState)||(on=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,It.lanes|=s,to|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Xm(e){var t=Zn(),r=t.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);_a(s,t.memoizedState)||(on=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function dS(){}function hS(e,t){var r=It,n=Zn(),a=t(),s=!_a(n.memoizedState,a);if(s&&(n.memoizedState=a,on=!0),n=n.queue,Zg(gS.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||fr!==null&&fr.memoizedState.tag&1){if(r.flags|=2048,hu(9,pS.bind(null,r,n,a,t),void 0,null),mr===null)throw Error(he(349));eo&30||mS(r,t,a)}return a}function mS(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function pS(e,t,r,n){t.value=r,t.getSnapshot=n,vS(t)&&yS(e)}function gS(e,t,r){return r(function(){vS(t)&&yS(e)})}function vS(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_a(e,r)}catch{return!0}}function yS(e){var t=ws(e,1);t!==null&&ya(t,e,1,-1)}function Jy(e){var t=Oa();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:du,lastRenderedState:e},t.queue=e,e=e.dispatch=c6.bind(null,It,e),[t.memoizedState,e]}function hu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=It.updateQueue,t===null?(t={lastEffect:null,stores:null},It.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function xS(){return Zn().memoizedState}function hd(e,t,r,n){var a=Oa();It.flags|=e,a.memoizedState=hu(1|t,r,void 0,n===void 0?null:n)}function Th(e,t,r,n){var a=Zn();n=n===void 0?null:n;var s=void 0;if(ar!==null){var i=ar.memoizedState;if(s=i.destroy,n!==null&&qg(n,i.deps)){a.memoizedState=hu(t,r,s,n);return}}It.flags|=e,a.memoizedState=hu(1|t,r,s,n)}function Zy(e,t){return hd(8390656,8,e,t)}function Zg(e,t){return Th(2048,8,e,t)}function wS(e,t){return Th(4,2,e,t)}function _S(e,t){return Th(4,4,e,t)}function SS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function kS(e,t,r){return r=r!=null?r.concat([e]):null,Th(4,4,SS.bind(null,t,e),r)}function e1(){}function bS(e,t){var r=Zn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&qg(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ES(e,t){var r=Zn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&qg(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function TS(e,t,r){return eo&21?(_a(r,t)||(r=j_(),It.lanes|=r,to|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,on=!0),e.memoizedState=r)}function o6(e,t){var r=ut;ut=r!==0&&4>r?r:4,e(!0);var n=Gm.transition;Gm.transition={};try{e(!1),t()}finally{ut=r,Gm.transition=n}}function NS(){return Zn().memoizedState}function l6(e,t,r){var n=oi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},CS(e))AS(t,r);else if(r=cS(e,t,r,n),r!==null){var a=Jr();ya(r,e,n,a),PS(r,t,n)}}function c6(e,t,r){var n=oi(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(CS(e))AS(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,_a(o,i)){var l=t.interleaved;l===null?(a.next=a,Vg(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=cS(e,t,a,n),r!==null&&(a=Jr(),ya(r,e,n,a),PS(r,t,n))}}function CS(e){var t=e.alternate;return e===It||t!==null&&t===It}function AS(e,t){Bc=Wd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function PS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,jg(e,r)}}var Hd={readContext:Jn,useCallback:Tr,useContext:Tr,useEffect:Tr,useImperativeHandle:Tr,useInsertionEffect:Tr,useLayoutEffect:Tr,useMemo:Tr,useReducer:Tr,useRef:Tr,useState:Tr,useDebugValue:Tr,useDeferredValue:Tr,useTransition:Tr,useMutableSource:Tr,useSyncExternalStore:Tr,useId:Tr,unstable_isNewReconciler:!1},u6={readContext:Jn,useCallback:function(e,t){return Oa().memoizedState=[e,t===void 0?null:t],e},useContext:Jn,useEffect:Zy,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,hd(4194308,4,SS.bind(null,t,e),r)},useLayoutEffect:function(e,t){return hd(4194308,4,e,t)},useInsertionEffect:function(e,t){return hd(4,2,e,t)},useMemo:function(e,t){var r=Oa();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Oa();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=l6.bind(null,It,e),[n.memoizedState,e]},useRef:function(e){var t=Oa();return e={current:e},t.memoizedState=e},useState:Jy,useDebugValue:e1,useDeferredValue:function(e){return Oa().memoizedState=e},useTransition:function(){var e=Jy(!1),t=e[0];return e=o6.bind(null,e[1]),Oa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=It,a=Oa();if(Ct){if(r===void 0)throw Error(he(407));r=r()}else{if(r=t(),mr===null)throw Error(he(349));eo&30||mS(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Zy(gS.bind(null,n,s,e),[e]),n.flags|=2048,hu(9,pS.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Oa(),t=mr.identifierPrefix;if(Ct){var r=cs,n=ls;r=(n&~(1<<32-va(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=fu++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=i6++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},f6={readContext:Jn,useCallback:bS,useContext:Jn,useEffect:Zg,useImperativeHandle:kS,useInsertionEffect:wS,useLayoutEffect:_S,useMemo:ES,useReducer:Ym,useRef:xS,useState:function(){return Ym(du)},useDebugValue:e1,useDeferredValue:function(e){var t=Zn();return TS(t,ar.memoizedState,e)},useTransition:function(){var e=Ym(du)[0],t=Zn().memoizedState;return[e,t]},useMutableSource:dS,useSyncExternalStore:hS,useId:NS,unstable_isNewReconciler:!1},d6={readContext:Jn,useCallback:bS,useContext:Jn,useEffect:Zg,useImperativeHandle:kS,useInsertionEffect:wS,useLayoutEffect:_S,useMemo:ES,useReducer:Xm,useRef:xS,useState:function(){return Xm(du)},useDebugValue:e1,useDeferredValue:function(e){var t=Zn();return ar===null?t.memoizedState=e:TS(t,ar.memoizedState,e)},useTransition:function(){var e=Xm(du)[0],t=Zn().memoizedState;return[e,t]},useMutableSource:dS,useSyncExternalStore:hS,useId:NS,unstable_isNewReconciler:!1};function la(e,t){if(e&&e.defaultProps){t=Ft({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function v0(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ft({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Nh={isMounted:function(e){return(e=e._reactInternals)?yo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Jr(),a=oi(e),s=hs(n,a);s.payload=t,r!=null&&(s.callback=r),t=si(e,s,a),t!==null&&(ya(t,e,a,n),fd(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Jr(),a=oi(e),s=hs(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=si(e,s,a),t!==null&&(ya(t,e,a,n),fd(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Jr(),n=oi(e),a=hs(r,n);a.tag=2,t!=null&&(a.callback=t),t=si(e,a,n),t!==null&&(ya(t,e,n,r),fd(t,e,n))}};function ex(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!su(r,n)||!su(a,s):!0}function jS(e,t,r){var n=!1,a=ui,s=t.contextType;return typeof s=="object"&&s!==null?s=Jn(s):(a=cn(t)?Ji:Br.current,n=t.contextTypes,s=(n=n!=null)?kl(e,a):ui),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Nh,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function tx(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Nh.enqueueReplaceState(t,t.state,null)}function y0(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Gg(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Jn(s):(s=cn(t)?Ji:Br.current,a.context=kl(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(v0(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Nh.enqueueReplaceState(a,a.state,null),Ud(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Nl(e,t){try{var r="",n=t;do r+=U3(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Km(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function x0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var h6=typeof WeakMap=="function"?WeakMap:Map;function DS(e,t,r){r=hs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Vd||(Vd=!0,A0=n),x0(e,t)},r}function RS(e,t,r){r=hs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){x0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){x0(e,t),typeof n!="function"&&(ii===null?ii=new Set([this]):ii.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function rx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new h6;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=N6.bind(null,e,t,r),t.then(e,e))}function nx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ax(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=hs(-1,1),t.tag=2,si(r,t,1))),r.lanes|=1),e)}var m6=Ts.ReactCurrentOwner,on=!1;function Yr(e,t,r,n){t.child=e===null?lS(t,null,r,n):El(t,e.child,r,n)}function sx(e,t,r,n,a){r=r.render;var s=t.ref;return al(t,a),n=Qg(e,t,r,n,s,a),r=Jg(),e!==null&&!on?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_s(e,t,a)):(Ct&&r&&Bg(t),t.flags|=1,Yr(e,t,n,a),t.child)}function ix(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!l1(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,MS(e,t,s,n,a)):(e=vd(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:su,r(i,n)&&e.ref===t.ref)return _s(e,t,a)}return t.flags|=1,e=li(s,n),e.ref=t.ref,e.return=t,t.child=e}function MS(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(su(s,n)&&e.ref===t.ref)if(on=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(on=!0);else return t.lanes=e.lanes,_s(e,t,a)}return w0(e,t,r,n,a)}function OS(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xt(Qo,_n),_n|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xt(Qo,_n),_n|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,xt(Qo,_n),_n|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,xt(Qo,_n),_n|=n;return Yr(e,t,a,r),t.child}function IS(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function w0(e,t,r,n,a){var s=cn(r)?Ji:Br.current;return s=kl(t,s),al(t,a),r=Qg(e,t,r,n,s,a),n=Jg(),e!==null&&!on?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,_s(e,t,a)):(Ct&&n&&Bg(t),t.flags|=1,Yr(e,t,r,a),t.child)}function ox(e,t,r,n,a){if(cn(r)){var s=!0;Od(t)}else s=!1;if(al(t,a),t.stateNode===null)md(e,t),jS(t,r,n),y0(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Jn(u):(u=cn(r)?Ji:Br.current,u=kl(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&tx(t,i,n,u),Ws=!1;var m=t.memoizedState;i.state=m,Ud(t,n,i,a),l=t.memoizedState,o!==n||m!==l||ln.current||Ws?(typeof f=="function"&&(v0(t,r,f,n),l=t.memoizedState),(o=Ws||ex(t,r,o,n,m,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,uS(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:la(t.type,o),i.props=u,d=t.pendingProps,m=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Jn(l):(l=cn(r)?Ji:Br.current,l=kl(t,l));var h=r.getDerivedStateFromProps;(f=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||m!==l)&&tx(t,i,n,l),Ws=!1,m=t.memoizedState,i.state=m,Ud(t,n,i,a);var v=t.memoizedState;o!==d||m!==v||ln.current||Ws?(typeof h=="function"&&(v0(t,r,h,n),v=t.memoizedState),(u=Ws||ex(t,r,u,n,m,v,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),n=!1)}return _0(e,t,r,n,s,a)}function _0(e,t,r,n,a,s){IS(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Gy(t,r,!1),_s(e,t,s);n=t.stateNode,m6.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=El(t,e.child,null,s),t.child=El(t,null,o,s)):Yr(e,t,o,s),t.memoizedState=n.state,a&&Gy(t,r,!0),t.child}function FS(e){var t=e.stateNode;t.pendingContext?Vy(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Vy(e,t.context,!1),Yg(e,t.containerInfo)}function lx(e,t,r,n,a){return bl(),$g(a),t.flags|=256,Yr(e,t,r,n),t.child}var S0={dehydrated:null,treeContext:null,retryLane:0};function k0(e){return{baseLanes:e,cachePool:null,transitions:null}}function LS(e,t,r){var n=t.pendingProps,a=Rt.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),xt(Rt,a&1),e===null)return p0(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Ph(i,n,0,null),e=Vi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=k0(r),t.memoizedState=S0,e):t1(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return p6(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=li(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=li(o,s):(s=Vi(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?k0(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=S0,n}return s=e.child,e=s.sibling,n=li(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function t1(e,t){return t=Ph({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Mf(e,t,r,n){return n!==null&&$g(n),El(t,e.child,null,r),e=t1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function p6(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Km(Error(he(422))),Mf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Ph({mode:"visible",children:n.children},a,0,null),s=Vi(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&El(t,e.child,null,i),t.child.memoizedState=k0(i),t.memoizedState=S0,s);if(!(t.mode&1))return Mf(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(he(419)),n=Km(s,n,void 0),Mf(e,t,i,n)}if(o=(i&e.childLanes)!==0,on||o){if(n=mr,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ws(e,a),ya(n,e,a,-1))}return o1(),n=Km(Error(he(421))),Mf(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=C6.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Nn=ai(a.nextSibling),Cn=t,Ct=!0,ha=null,e!==null&&(Gn[Yn++]=ls,Gn[Yn++]=cs,Gn[Yn++]=Zi,ls=e.id,cs=e.overflow,Zi=t),t=t1(t,n.children),t.flags|=4096,t)}function cx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),g0(e.return,t,r)}function qm(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function BS(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Yr(e,t,n.children,r),n=Rt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&cx(e,r,t);else if(e.tag===19)cx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(xt(Rt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&$d(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),qm(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&$d(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}qm(t,!0,r,null,s);break;case"together":qm(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function md(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function _s(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),to|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(he(153));if(t.child!==null){for(e=t.child,r=li(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=li(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function g6(e,t,r){switch(t.tag){case 3:FS(t),bl();break;case 5:fS(t);break;case 1:cn(t.type)&&Od(t);break;case 4:Yg(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;xt(Ld,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(xt(Rt,Rt.current&1),t.flags|=128,null):r&t.child.childLanes?LS(e,t,r):(xt(Rt,Rt.current&1),e=_s(e,t,r),e!==null?e.sibling:null);xt(Rt,Rt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return BS(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),xt(Rt,Rt.current),n)break;return null;case 22:case 23:return t.lanes=0,OS(e,t,r)}return _s(e,t,r)}var US,b0,$S,WS;US=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};b0=function(){};$S=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ii(Va.current);var s=null;switch(r){case"input":a=Gp(e,a),n=Gp(e,n),s=[];break;case"select":a=Ft({},a,{value:void 0}),n=Ft({},n,{value:void 0}),s=[];break;case"textarea":a=Kp(e,a),n=Kp(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Rd)}Qp(r,n);var i;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jc.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var l=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&St("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};WS=function(e,t,r,n){r!==n&&(t.flags|=4)};function hc(e,t){if(!Ct)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function v6(e,t,r){var n=t.pendingProps;switch(Ug(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(t),null;case 1:return cn(t.type)&&Md(),Nr(t),null;case 3:return n=t.stateNode,Tl(),Et(ln),Et(Br),Kg(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Df(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ha!==null&&(D0(ha),ha=null))),b0(e,t),Nr(t),null;case 5:Xg(t);var a=Ii(uu.current);if(r=t.type,e!==null&&t.stateNode!=null)$S(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(he(166));return Nr(t),null}if(e=Ii(Va.current),Df(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ba]=t,n[lu]=s,e=(t.mode&1)!==0,r){case"dialog":St("cancel",n),St("close",n);break;case"iframe":case"object":case"embed":St("load",n);break;case"video":case"audio":for(a=0;a<Nc.length;a++)St(Nc[a],n);break;case"source":St("error",n);break;case"img":case"image":case"link":St("error",n),St("load",n);break;case"details":St("toggle",n);break;case"input":yy(n,s),St("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},St("invalid",n);break;case"textarea":wy(n,s),St("invalid",n)}Qp(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&jf(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&jf(n.textContent,o,e),a=["children",""+o]):Jc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&St("scroll",n)}switch(r){case"input":kf(n),xy(n,s,!0);break;case"textarea":kf(n),_y(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Rd)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=g_(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Ba]=t,e[lu]=n,US(e,t,!1,!1),t.stateNode=e;e:{switch(i=Jp(r,n),r){case"dialog":St("cancel",e),St("close",e),a=n;break;case"iframe":case"object":case"embed":St("load",e),a=n;break;case"video":case"audio":for(a=0;a<Nc.length;a++)St(Nc[a],e);a=n;break;case"source":St("error",e),a=n;break;case"img":case"image":case"link":St("error",e),St("load",e),a=n;break;case"details":St("toggle",e),a=n;break;case"input":yy(e,n),a=Gp(e,n),St("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ft({},n,{value:void 0}),St("invalid",e);break;case"textarea":wy(e,n),a=Kp(e,n),St("invalid",e);break;default:a=n}Qp(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?x_(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&v_(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Zc(e,l):typeof l=="number"&&Zc(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Jc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&St("scroll",e):l!=null&&Eg(e,s,l,i))}switch(r){case"input":kf(e),xy(e,n,!1);break;case"textarea":kf(e),_y(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ci(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?el(e,!!n.multiple,s,!1):n.defaultValue!=null&&el(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Rd)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nr(t),null;case 6:if(e&&t.stateNode!=null)WS(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(he(166));if(r=Ii(uu.current),Ii(Va.current),Df(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ba]=t,(s=n.nodeValue!==r)&&(e=Cn,e!==null))switch(e.tag){case 3:jf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ba]=t,t.stateNode=n}return Nr(t),null;case 13:if(Et(Rt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ct&&Nn!==null&&t.mode&1&&!(t.flags&128))iS(),bl(),t.flags|=98560,s=!1;else if(s=Df(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(he(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(he(317));s[Ba]=t}else bl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nr(t),s=!1}else ha!==null&&(D0(ha),ha=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Rt.current&1?ir===0&&(ir=3):o1())),t.updateQueue!==null&&(t.flags|=4),Nr(t),null);case 4:return Tl(),b0(e,t),e===null&&iu(t.stateNode.containerInfo),Nr(t),null;case 10:return zg(t.type._context),Nr(t),null;case 17:return cn(t.type)&&Md(),Nr(t),null;case 19:if(Et(Rt),s=t.memoizedState,s===null)return Nr(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)hc(s,!1);else{if(ir!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=$d(e),i!==null){for(t.flags|=128,hc(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return xt(Rt,Rt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Gt()>Cl&&(t.flags|=128,n=!0,hc(s,!1),t.lanes=4194304)}else{if(!n)if(e=$d(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),hc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!Ct)return Nr(t),null}else 2*Gt()-s.renderingStartTime>Cl&&r!==1073741824&&(t.flags|=128,n=!0,hc(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Gt(),t.sibling=null,r=Rt.current,xt(Rt,n?r&1|2:r&1),t):(Nr(t),null);case 22:case 23:return i1(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?_n&1073741824&&(Nr(t),t.subtreeFlags&6&&(t.flags|=8192)):Nr(t),null;case 24:return null;case 25:return null}throw Error(he(156,t.tag))}function y6(e,t){switch(Ug(t),t.tag){case 1:return cn(t.type)&&Md(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Tl(),Et(ln),Et(Br),Kg(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Xg(t),null;case 13:if(Et(Rt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(he(340));bl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Et(Rt),null;case 4:return Tl(),null;case 10:return zg(t.type._context),null;case 22:case 23:return i1(),null;case 24:return null;default:return null}}var Of=!1,Dr=!1,x6=typeof WeakSet=="function"?WeakSet:Set,be=null;function qo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bt(e,t,n)}else r.current=null}function E0(e,t,r){try{r()}catch(n){Bt(e,t,n)}}var ux=!1;function w6(e,t){if(l0=Pd,e=Y_(),Lg(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,f=0,d=e,m=null;t:for(;;){for(var h;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)m=d,d=h;for(;;){if(d===e)break t;if(m===r&&++u===a&&(o=i),m===s&&++f===n&&(l=i),(h=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(c0={focusedElem:e,selectionRange:r},Pd=!1,be=t;be!==null;)if(t=be,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,be=e;else for(;be!==null;){t=be;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var p=v.memoizedProps,g=v.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?p:la(t.type,p),g);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(S){Bt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,be=e;break}be=t.return}return v=ux,ux=!1,v}function Uc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&E0(t,r,s)}a=a.next}while(a!==n)}}function Ch(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function T0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function HS(e){var t=e.alternate;t!==null&&(e.alternate=null,HS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ba],delete t[lu],delete t[d0],delete t[r6],delete t[n6])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function zS(e){return e.tag===5||e.tag===3||e.tag===4}function fx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||zS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function N0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Rd));else if(n!==4&&(e=e.child,e!==null))for(N0(e,t,r),e=e.sibling;e!==null;)N0(e,t,r),e=e.sibling}function C0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(C0(e,t,r),e=e.sibling;e!==null;)C0(e,t,r),e=e.sibling}var yr=null,da=!1;function Rs(e,t,r){for(r=r.child;r!==null;)VS(e,t,r),r=r.sibling}function VS(e,t,r){if(za&&typeof za.onCommitFiberUnmount=="function")try{za.onCommitFiberUnmount(wh,r)}catch{}switch(r.tag){case 5:Dr||qo(r,t);case 6:var n=yr,a=da;yr=null,Rs(e,t,r),yr=n,da=a,yr!==null&&(da?(e=yr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):yr.removeChild(r.stateNode));break;case 18:yr!==null&&(da?(e=yr,r=r.stateNode,e.nodeType===8?Hm(e.parentNode,r):e.nodeType===1&&Hm(e,r),nu(e)):Hm(yr,r.stateNode));break;case 4:n=yr,a=da,yr=r.stateNode.containerInfo,da=!0,Rs(e,t,r),yr=n,da=a;break;case 0:case 11:case 14:case 15:if(!Dr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&E0(r,t,i),a=a.next}while(a!==n)}Rs(e,t,r);break;case 1:if(!Dr&&(qo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Bt(r,t,o)}Rs(e,t,r);break;case 21:Rs(e,t,r);break;case 22:r.mode&1?(Dr=(n=Dr)||r.memoizedState!==null,Rs(e,t,r),Dr=n):Rs(e,t,r);break;default:Rs(e,t,r)}}function dx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new x6),t.forEach(function(n){var a=A6.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function aa(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:yr=o.stateNode,da=!1;break e;case 3:yr=o.stateNode.containerInfo,da=!0;break e;case 4:yr=o.stateNode.containerInfo,da=!0;break e}o=o.return}if(yr===null)throw Error(he(160));VS(s,i,a),yr=null,da=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){Bt(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)GS(t,e),t=t.sibling}function GS(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(aa(t,e),ja(e),n&4){try{Uc(3,e,e.return),Ch(3,e)}catch(p){Bt(e,e.return,p)}try{Uc(5,e,e.return)}catch(p){Bt(e,e.return,p)}}break;case 1:aa(t,e),ja(e),n&512&&r!==null&&qo(r,r.return);break;case 5:if(aa(t,e),ja(e),n&512&&r!==null&&qo(r,r.return),e.flags&32){var a=e.stateNode;try{Zc(a,"")}catch(p){Bt(e,e.return,p)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&m_(a,s),Jp(o,i);var u=Jp(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?x_(a,d):f==="dangerouslySetInnerHTML"?v_(a,d):f==="children"?Zc(a,d):Eg(a,f,d,u)}switch(o){case"input":Yp(a,s);break;case"textarea":p_(a,s);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?el(a,!!s.multiple,h,!1):m!==!!s.multiple&&(s.defaultValue!=null?el(a,!!s.multiple,s.defaultValue,!0):el(a,!!s.multiple,s.multiple?[]:"",!1))}a[lu]=s}catch(p){Bt(e,e.return,p)}}break;case 6:if(aa(t,e),ja(e),n&4){if(e.stateNode===null)throw Error(he(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(p){Bt(e,e.return,p)}}break;case 3:if(aa(t,e),ja(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{nu(t.containerInfo)}catch(p){Bt(e,e.return,p)}break;case 4:aa(t,e),ja(e);break;case 13:aa(t,e),ja(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(a1=Gt())),n&4&&dx(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Dr=(u=Dr)||f,aa(t,e),Dr=u):aa(t,e),ja(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(be=e,f=e.child;f!==null;){for(d=be=f;be!==null;){switch(m=be,h=m.child,m.tag){case 0:case 11:case 14:case 15:Uc(4,m,m.return);break;case 1:qo(m,m.return);var v=m.stateNode;if(typeof v.componentWillUnmount=="function"){n=m,r=m.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(p){Bt(n,r,p)}}break;case 5:qo(m,m.return);break;case 22:if(m.memoizedState!==null){mx(d);continue}}h!==null?(h.return=m,be=h):mx(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=y_("display",i))}catch(p){Bt(e,e.return,p)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(p){Bt(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:aa(t,e),ja(e),n&4&&dx(e);break;case 21:break;default:aa(t,e),ja(e)}}function ja(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(zS(r)){var n=r;break e}r=r.return}throw Error(he(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Zc(a,""),n.flags&=-33);var s=fx(e);C0(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=fx(e);N0(e,o,i);break;default:throw Error(he(161))}}catch(l){Bt(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function _6(e,t,r){be=e,YS(e)}function YS(e,t,r){for(var n=(e.mode&1)!==0;be!==null;){var a=be,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Of;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Dr;o=Of;var u=Dr;if(Of=i,(Dr=l)&&!u)for(be=a;be!==null;)i=be,l=i.child,i.tag===22&&i.memoizedState!==null?px(a):l!==null?(l.return=i,be=l):px(a);for(;s!==null;)be=s,YS(s),s=s.sibling;be=a,Of=o,Dr=u}hx(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,be=s):hx(e)}}function hx(e){for(;be!==null;){var t=be;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Dr||Ch(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Dr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:la(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&Qy(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Qy(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&nu(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}Dr||t.flags&512&&T0(t)}catch(m){Bt(t,t.return,m)}}if(t===e){be=null;break}if(r=t.sibling,r!==null){r.return=t.return,be=r;break}be=t.return}}function mx(e){for(;be!==null;){var t=be;if(t===e){be=null;break}var r=t.sibling;if(r!==null){r.return=t.return,be=r;break}be=t.return}}function px(e){for(;be!==null;){var t=be;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Ch(4,t)}catch(l){Bt(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Bt(t,a,l)}}var s=t.return;try{T0(t)}catch(l){Bt(t,s,l)}break;case 5:var i=t.return;try{T0(t)}catch(l){Bt(t,i,l)}}}catch(l){Bt(t,t.return,l)}if(t===e){be=null;break}var o=t.sibling;if(o!==null){o.return=t.return,be=o;break}be=t.return}}var S6=Math.ceil,zd=Ts.ReactCurrentDispatcher,r1=Ts.ReactCurrentOwner,qn=Ts.ReactCurrentBatchConfig,Ze=0,mr=null,tr=null,_r=0,_n=0,Qo=xi(0),ir=0,mu=null,to=0,Ah=0,n1=0,$c=null,sn=null,a1=0,Cl=1/0,ss=null,Vd=!1,A0=null,ii=null,If=!1,Qs=null,Gd=0,Wc=0,P0=null,pd=-1,gd=0;function Jr(){return Ze&6?Gt():pd!==-1?pd:pd=Gt()}function oi(e){return e.mode&1?Ze&2&&_r!==0?_r&-_r:s6.transition!==null?(gd===0&&(gd=j_()),gd):(e=ut,e!==0||(e=window.event,e=e===void 0?16:L_(e.type)),e):1}function ya(e,t,r,n){if(50<Wc)throw Wc=0,P0=null,Error(he(185));Vu(e,r,n),(!(Ze&2)||e!==mr)&&(e===mr&&(!(Ze&2)&&(Ah|=r),ir===4&&zs(e,_r)),un(e,n),r===1&&Ze===0&&!(t.mode&1)&&(Cl=Gt()+500,Eh&&wi()))}function un(e,t){var r=e.callbackNode;s5(e,t);var n=Ad(e,e===mr?_r:0);if(n===0)r!==null&&by(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&by(r),t===1)e.tag===0?a6(gx.bind(null,e)):nS(gx.bind(null,e)),e6(function(){!(Ze&6)&&wi()}),r=null;else{switch(D_(n)){case 1:r=Pg;break;case 4:r=A_;break;case 16:r=Cd;break;case 536870912:r=P_;break;default:r=Cd}r=tk(r,XS.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function XS(e,t){if(pd=-1,gd=0,Ze&6)throw Error(he(327));var r=e.callbackNode;if(sl()&&e.callbackNode!==r)return null;var n=Ad(e,e===mr?_r:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Yd(e,n);else{t=n;var a=Ze;Ze|=2;var s=qS();(mr!==e||_r!==t)&&(ss=null,Cl=Gt()+500,zi(e,t));do try{E6();break}catch(o){KS(e,o)}while(!0);Hg(),zd.current=s,Ze=a,tr!==null?t=0:(mr=null,_r=0,t=ir)}if(t!==0){if(t===2&&(a=n0(e),a!==0&&(n=a,t=j0(e,a))),t===1)throw r=mu,zi(e,0),zs(e,n),un(e,Gt()),r;if(t===6)zs(e,n);else{if(a=e.current.alternate,!(n&30)&&!k6(a)&&(t=Yd(e,n),t===2&&(s=n0(e),s!==0&&(n=s,t=j0(e,s))),t===1))throw r=mu,zi(e,0),zs(e,n),un(e,Gt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(he(345));case 2:ji(e,sn,ss);break;case 3:if(zs(e,n),(n&130023424)===n&&(t=a1+500-Gt(),10<t)){if(Ad(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Jr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=f0(ji.bind(null,e,sn,ss),t);break}ji(e,sn,ss);break;case 4:if(zs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-va(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=Gt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*S6(n/1960))-n,10<n){e.timeoutHandle=f0(ji.bind(null,e,sn,ss),n);break}ji(e,sn,ss);break;case 5:ji(e,sn,ss);break;default:throw Error(he(329))}}}return un(e,Gt()),e.callbackNode===r?XS.bind(null,e):null}function j0(e,t){var r=$c;return e.current.memoizedState.isDehydrated&&(zi(e,t).flags|=256),e=Yd(e,t),e!==2&&(t=sn,sn=r,t!==null&&D0(t)),e}function D0(e){sn===null?sn=e:sn.push.apply(sn,e)}function k6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!_a(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zs(e,t){for(t&=~n1,t&=~Ah,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-va(t),n=1<<r;e[r]=-1,t&=~n}}function gx(e){if(Ze&6)throw Error(he(327));sl();var t=Ad(e,0);if(!(t&1))return un(e,Gt()),null;var r=Yd(e,t);if(e.tag!==0&&r===2){var n=n0(e);n!==0&&(t=n,r=j0(e,n))}if(r===1)throw r=mu,zi(e,0),zs(e,t),un(e,Gt()),r;if(r===6)throw Error(he(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ji(e,sn,ss),un(e,Gt()),null}function s1(e,t){var r=Ze;Ze|=1;try{return e(t)}finally{Ze=r,Ze===0&&(Cl=Gt()+500,Eh&&wi())}}function ro(e){Qs!==null&&Qs.tag===0&&!(Ze&6)&&sl();var t=Ze;Ze|=1;var r=qn.transition,n=ut;try{if(qn.transition=null,ut=1,e)return e()}finally{ut=n,qn.transition=r,Ze=t,!(Ze&6)&&wi()}}function i1(){_n=Qo.current,Et(Qo)}function zi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Z5(r)),tr!==null)for(r=tr.return;r!==null;){var n=r;switch(Ug(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Md();break;case 3:Tl(),Et(ln),Et(Br),Kg();break;case 5:Xg(n);break;case 4:Tl();break;case 13:Et(Rt);break;case 19:Et(Rt);break;case 10:zg(n.type._context);break;case 22:case 23:i1()}r=r.return}if(mr=e,tr=e=li(e.current,null),_r=_n=t,ir=0,mu=null,n1=Ah=to=0,sn=$c=null,Oi!==null){for(t=0;t<Oi.length;t++)if(r=Oi[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Oi=null}return e}function KS(e,t){do{var r=tr;try{if(Hg(),dd.current=Hd,Wd){for(var n=It.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Wd=!1}if(eo=0,fr=ar=It=null,Bc=!1,fu=0,r1.current=null,r===null||r.return===null){ir=1,mu=t,tr=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=_r,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=nx(i);if(h!==null){h.flags&=-257,ax(h,i,o,s,t),h.mode&1&&rx(s,u,t),t=h,l=u;var v=t.updateQueue;if(v===null){var p=new Set;p.add(l),t.updateQueue=p}else v.add(l);break e}else{if(!(t&1)){rx(s,u,t),o1();break e}l=Error(he(426))}}else if(Ct&&o.mode&1){var g=nx(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),ax(g,i,o,s,t),$g(Nl(l,o));break e}}s=l=Nl(l,o),ir!==4&&(ir=2),$c===null?$c=[s]:$c.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=DS(s,l,t);qy(s,y);break e;case 1:o=l;var w=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ii===null||!ii.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=RS(s,o,t);qy(s,S);break e}}s=s.return}while(s!==null)}JS(r)}catch(b){t=b,tr===r&&r!==null&&(tr=r=r.return);continue}break}while(!0)}function qS(){var e=zd.current;return zd.current=Hd,e===null?Hd:e}function o1(){(ir===0||ir===3||ir===2)&&(ir=4),mr===null||!(to&268435455)&&!(Ah&268435455)||zs(mr,_r)}function Yd(e,t){var r=Ze;Ze|=2;var n=qS();(mr!==e||_r!==t)&&(ss=null,zi(e,t));do try{b6();break}catch(a){KS(e,a)}while(!0);if(Hg(),Ze=r,zd.current=n,tr!==null)throw Error(he(261));return mr=null,_r=0,ir}function b6(){for(;tr!==null;)QS(tr)}function E6(){for(;tr!==null&&!q3();)QS(tr)}function QS(e){var t=ek(e.alternate,e,_n);e.memoizedProps=e.pendingProps,t===null?JS(e):tr=t,r1.current=null}function JS(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=y6(r,t),r!==null){r.flags&=32767,tr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ir=6,tr=null;return}}else if(r=v6(r,t,_n),r!==null){tr=r;return}if(t=t.sibling,t!==null){tr=t;return}tr=t=e}while(t!==null);ir===0&&(ir=5)}function ji(e,t,r){var n=ut,a=qn.transition;try{qn.transition=null,ut=1,T6(e,t,r,n)}finally{qn.transition=a,ut=n}return null}function T6(e,t,r,n){do sl();while(Qs!==null);if(Ze&6)throw Error(he(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(he(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(i5(e,s),e===mr&&(tr=mr=null,_r=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||If||(If=!0,tk(Cd,function(){return sl(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=qn.transition,qn.transition=null;var i=ut;ut=1;var o=Ze;Ze|=4,r1.current=null,w6(e,r),GS(r,e),G5(c0),Pd=!!l0,c0=l0=null,e.current=r,_6(r),Q3(),Ze=o,ut=i,qn.transition=s}else e.current=r;if(If&&(If=!1,Qs=e,Gd=a),s=e.pendingLanes,s===0&&(ii=null),e5(r.stateNode),un(e,Gt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Vd)throw Vd=!1,e=A0,A0=null,e;return Gd&1&&e.tag!==0&&sl(),s=e.pendingLanes,s&1?e===P0?Wc++:(Wc=0,P0=e):Wc=0,wi(),null}function sl(){if(Qs!==null){var e=D_(Gd),t=qn.transition,r=ut;try{if(qn.transition=null,ut=16>e?16:e,Qs===null)var n=!1;else{if(e=Qs,Qs=null,Gd=0,Ze&6)throw Error(he(331));var a=Ze;for(Ze|=4,be=e.current;be!==null;){var s=be,i=s.child;if(be.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(be=u;be!==null;){var f=be;switch(f.tag){case 0:case 11:case 15:Uc(8,f,s)}var d=f.child;if(d!==null)d.return=f,be=d;else for(;be!==null;){f=be;var m=f.sibling,h=f.return;if(HS(f),f===u){be=null;break}if(m!==null){m.return=h,be=m;break}be=h}}}var v=s.alternate;if(v!==null){var p=v.child;if(p!==null){v.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}be=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,be=i;else e:for(;be!==null;){if(s=be,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Uc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,be=y;break e}be=s.return}}var w=e.current;for(be=w;be!==null;){i=be;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,be=x;else e:for(i=w;be!==null;){if(o=be,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ch(9,o)}}catch(b){Bt(o,o.return,b)}if(o===i){be=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,be=S;break e}be=o.return}}if(Ze=a,wi(),za&&typeof za.onPostCommitFiberRoot=="function")try{za.onPostCommitFiberRoot(wh,e)}catch{}n=!0}return n}finally{ut=r,qn.transition=t}}return!1}function vx(e,t,r){t=Nl(r,t),t=DS(e,t,1),e=si(e,t,1),t=Jr(),e!==null&&(Vu(e,1,t),un(e,t))}function Bt(e,t,r){if(e.tag===3)vx(e,e,r);else for(;t!==null;){if(t.tag===3){vx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ii===null||!ii.has(n))){e=Nl(r,e),e=RS(t,e,1),t=si(t,e,1),e=Jr(),t!==null&&(Vu(t,1,e),un(t,e));break}}t=t.return}}function N6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Jr(),e.pingedLanes|=e.suspendedLanes&r,mr===e&&(_r&r)===r&&(ir===4||ir===3&&(_r&130023424)===_r&&500>Gt()-a1?zi(e,0):n1|=r),un(e,t)}function ZS(e,t){t===0&&(e.mode&1?(t=Tf,Tf<<=1,!(Tf&130023424)&&(Tf=4194304)):t=1);var r=Jr();e=ws(e,t),e!==null&&(Vu(e,t,r),un(e,r))}function C6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ZS(e,r)}function A6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(he(314))}n!==null&&n.delete(t),ZS(e,r)}var ek;ek=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ln.current)on=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return on=!1,g6(e,t,r);on=!!(e.flags&131072)}else on=!1,Ct&&t.flags&1048576&&aS(t,Fd,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;md(e,t),e=t.pendingProps;var a=kl(t,Br.current);al(t,r),a=Qg(null,t,n,e,a,r);var s=Jg();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,cn(n)?(s=!0,Od(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Gg(t),a.updater=Nh,t.stateNode=a,a._reactInternals=t,y0(t,n,e,r),t=_0(null,t,n,!0,s,r)):(t.tag=0,Ct&&s&&Bg(t),Yr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(md(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=j6(n),e=la(n,e),a){case 0:t=w0(null,t,n,e,r);break e;case 1:t=ox(null,t,n,e,r);break e;case 11:t=sx(null,t,n,e,r);break e;case 14:t=ix(null,t,n,la(n.type,e),r);break e}throw Error(he(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),w0(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),ox(e,t,n,a,r);case 3:e:{if(FS(t),e===null)throw Error(he(387));n=t.pendingProps,s=t.memoizedState,a=s.element,uS(e,t),Ud(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Nl(Error(he(423)),t),t=lx(e,t,n,r,a);break e}else if(n!==a){a=Nl(Error(he(424)),t),t=lx(e,t,n,r,a);break e}else for(Nn=ai(t.stateNode.containerInfo.firstChild),Cn=t,Ct=!0,ha=null,r=lS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(bl(),n===a){t=_s(e,t,r);break e}Yr(e,t,n,r)}t=t.child}return t;case 5:return fS(t),e===null&&p0(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,u0(n,a)?i=null:s!==null&&u0(n,s)&&(t.flags|=32),IS(e,t),Yr(e,t,i,r),t.child;case 6:return e===null&&p0(t),null;case 13:return LS(e,t,r);case 4:return Yg(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=El(t,null,n,r):Yr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),sx(e,t,n,a,r);case 7:return Yr(e,t,t.pendingProps,r),t.child;case 8:return Yr(e,t,t.pendingProps.children,r),t.child;case 12:return Yr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,xt(Ld,n._currentValue),n._currentValue=i,s!==null)if(_a(s.value,i)){if(s.children===a.children&&!ln.current){t=_s(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=hs(-1,r&-r),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),g0(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(he(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),g0(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Yr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,al(t,r),a=Jn(a),n=n(a),t.flags|=1,Yr(e,t,n,r),t.child;case 14:return n=t.type,a=la(n,t.pendingProps),a=la(n.type,a),ix(e,t,n,a,r);case 15:return MS(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:la(n,a),md(e,t),t.tag=1,cn(n)?(e=!0,Od(t)):e=!1,al(t,r),jS(t,n,a),y0(t,n,a,r),_0(null,t,n,!0,e,r);case 19:return BS(e,t,r);case 22:return OS(e,t,r)}throw Error(he(156,t.tag))};function tk(e,t){return C_(e,t)}function P6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Kn(e,t,r,n){return new P6(e,t,r,n)}function l1(e){return e=e.prototype,!(!e||!e.isReactComponent)}function j6(e){if(typeof e=="function")return l1(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ng)return 11;if(e===Cg)return 14}return 2}function li(e,t){var r=e.alternate;return r===null?(r=Kn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function vd(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")l1(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case $o:return Vi(r.children,a,s,t);case Tg:i=8,a|=8;break;case Wp:return e=Kn(12,r,t,a|2),e.elementType=Wp,e.lanes=s,e;case Hp:return e=Kn(13,r,t,a),e.elementType=Hp,e.lanes=s,e;case zp:return e=Kn(19,r,t,a),e.elementType=zp,e.lanes=s,e;case f_:return Ph(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case c_:i=10;break e;case u_:i=9;break e;case Ng:i=11;break e;case Cg:i=14;break e;case $s:i=16,n=null;break e}throw Error(he(130,e==null?e:typeof e,""))}return t=Kn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Vi(e,t,r,n){return e=Kn(7,e,n,t),e.lanes=r,e}function Ph(e,t,r,n){return e=Kn(22,e,n,t),e.elementType=f_,e.lanes=r,e.stateNode={isHidden:!1},e}function Qm(e,t,r){return e=Kn(6,e,null,t),e.lanes=r,e}function Jm(e,t,r){return t=Kn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function D6(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dm(0),this.expirationTimes=Dm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dm(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function c1(e,t,r,n,a,s,i,o,l){return e=new D6(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Kn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gg(s),e}function R6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Uo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function rk(e){if(!e)return ui;e=e._reactInternals;e:{if(yo(e)!==e||e.tag!==1)throw Error(he(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(cn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(he(171))}if(e.tag===1){var r=e.type;if(cn(r))return rS(e,r,t)}return t}function nk(e,t,r,n,a,s,i,o,l){return e=c1(r,n,!0,e,a,s,i,o,l),e.context=rk(null),r=e.current,n=Jr(),a=oi(r),s=hs(n,a),s.callback=t??null,si(r,s,a),e.current.lanes=a,Vu(e,a,n),un(e,n),e}function jh(e,t,r,n){var a=t.current,s=Jr(),i=oi(a);return r=rk(r),t.context===null?t.context=r:t.pendingContext=r,t=hs(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=si(a,t,i),e!==null&&(ya(e,a,i,s),fd(e,a,i)),i}function Xd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function yx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function u1(e,t){yx(e,t),(e=e.alternate)&&yx(e,t)}function M6(){return null}var ak=typeof reportError=="function"?reportError:function(e){console.error(e)};function f1(e){this._internalRoot=e}Dh.prototype.render=f1.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(he(409));jh(e,t,null,null)};Dh.prototype.unmount=f1.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ro(function(){jh(null,e,null,null)}),t[xs]=null}};function Dh(e){this._internalRoot=e}Dh.prototype.unstable_scheduleHydration=function(e){if(e){var t=O_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Hs.length&&t!==0&&t<Hs[r].priority;r++);Hs.splice(r,0,e),r===0&&F_(e)}};function d1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function xx(){}function O6(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=Xd(i);s.call(u)}}var i=nk(t,n,e,0,null,!1,!1,"",xx);return e._reactRootContainer=i,e[xs]=i.current,iu(e.nodeType===8?e.parentNode:e),ro(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=Xd(l);o.call(u)}}var l=c1(e,0,!1,null,null,!1,!1,"",xx);return e._reactRootContainer=l,e[xs]=l.current,iu(e.nodeType===8?e.parentNode:e),ro(function(){jh(t,l,r,n)}),l}function Mh(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=Xd(i);o.call(l)}}jh(t,i,e,a)}else i=O6(r,t,e,a,n);return Xd(i)}R_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Tc(t.pendingLanes);r!==0&&(jg(t,r|1),un(t,Gt()),!(Ze&6)&&(Cl=Gt()+500,wi()))}break;case 13:ro(function(){var n=ws(e,1);if(n!==null){var a=Jr();ya(n,e,1,a)}}),u1(e,1)}};Dg=function(e){if(e.tag===13){var t=ws(e,134217728);if(t!==null){var r=Jr();ya(t,e,134217728,r)}u1(e,134217728)}};M_=function(e){if(e.tag===13){var t=oi(e),r=ws(e,t);if(r!==null){var n=Jr();ya(r,e,t,n)}u1(e,t)}};O_=function(){return ut};I_=function(e,t){var r=ut;try{return ut=e,t()}finally{ut=r}};e0=function(e,t,r){switch(t){case"input":if(Yp(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=bh(n);if(!a)throw Error(he(90));h_(n),Yp(n,a)}}}break;case"textarea":p_(e,r);break;case"select":t=r.value,t!=null&&el(e,!!r.multiple,t,!1)}};S_=s1;k_=ro;var I6={usingClientEntryPoint:!1,Events:[Yu,Vo,bh,w_,__,s1]},mc={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},F6={bundleType:mc.bundleType,version:mc.version,rendererPackageName:mc.rendererPackageName,rendererConfig:mc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=T_(e),e===null?null:e.stateNode},findFiberByHostInstance:mc.findFiberByHostInstance||M6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ff.isDisabled&&Ff.supportsFiber)try{wh=Ff.inject(F6),za=Ff}catch{}}Mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I6;Mn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d1(t))throw Error(he(200));return R6(e,t,null,r)};Mn.createRoot=function(e,t){if(!d1(e))throw Error(he(299));var r=!1,n="",a=ak;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=c1(e,1,!1,null,null,r,!1,n,a),e[xs]=t.current,iu(e.nodeType===8?e.parentNode:e),new f1(t)};Mn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(he(188)):(e=Object.keys(e).join(","),Error(he(268,e)));return e=T_(t),e=e===null?null:e.stateNode,e};Mn.flushSync=function(e){return ro(e)};Mn.hydrate=function(e,t,r){if(!Rh(t))throw Error(he(200));return Mh(null,e,t,!0,r)};Mn.hydrateRoot=function(e,t,r){if(!d1(e))throw Error(he(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=ak;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=nk(t,null,e,1,r??null,a,!1,s,i),e[xs]=t.current,iu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Dh(t)};Mn.render=function(e,t,r){if(!Rh(t))throw Error(he(200));return Mh(null,e,t,!1,r)};Mn.unmountComponentAtNode=function(e){if(!Rh(e))throw Error(he(40));return e._reactRootContainer?(ro(function(){Mh(null,null,e,!1,function(){e._reactRootContainer=null,e[xs]=null})}),!0):!1};Mn.unstable_batchedUpdates=s1;Mn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Rh(r))throw Error(he(200));if(e==null||e._reactInternals===void 0)throw Error(he(38));return Mh(e,t,r,!1,n)};Mn.version="18.3.1-next-f1338f8080-20240426";function sk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sk)}catch(e){console.error(e)}}sk(),s_.exports=Mn;var xo=s_.exports;const ik=Y2(xo);var ok,wx=xo;ok=wx.createRoot,wx.hydrateRoot;const L6=1,B6=1e6;let Zm=0;function U6(){return Zm=(Zm+1)%Number.MAX_SAFE_INTEGER,Zm.toString()}const ep=new Map,_x=e=>{if(ep.has(e))return;const t=setTimeout(()=>{ep.delete(e),Hc({type:"REMOVE_TOAST",toastId:e})},B6);ep.set(e,t)},$6=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,L6)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?_x(r):e.toasts.forEach(n=>{_x(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},yd=[];let xd={toasts:[]};function Hc(e){xd=$6(xd,e),yd.forEach(t=>{t(xd)})}function W6({...e}){const t=U6(),r=a=>Hc({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>Hc({type:"DISMISS_TOAST",toastId:t});return Hc({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function H6(){const[e,t]=_.useState(xd);return _.useEffect(()=>(yd.push(t),()=>{const r=yd.indexOf(t);r>-1&&yd.splice(r,1)}),[e]),{...e,toast:W6,dismiss:r=>Hc({type:"DISMISS_TOAST",toastId:r})}}function Te(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Sx(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function lk(...e){return t=>{let r=!1;const n=e.map(a=>{const s=Sx(a,t);return!r&&typeof s=="function"&&(r=!0),s});if(r)return()=>{for(let a=0;a<n.length;a++){const s=n[a];typeof s=="function"?s():Sx(e[a],null)}}}}function Qe(...e){return _.useCallback(lk(...e),e)}function z6(e,t){const r=_.createContext(t),n=s=>{const{children:i,...o}=s,l=_.useMemo(()=>o,Object.values(o));return c.jsx(r.Provider,{value:l,children:i})};n.displayName=e+"Provider";function a(s){const i=_.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[n,a]}function In(e,t=[]){let r=[];function n(s,i){const o=_.createContext(i),l=r.length;r=[...r,i];const u=d=>{var y;const{scope:m,children:h,...v}=d,p=((y=m==null?void 0:m[e])==null?void 0:y[l])||o,g=_.useMemo(()=>v,Object.values(v));return c.jsx(p.Provider,{value:g,children:h})};u.displayName=s+"Provider";function f(d,m){var p;const h=((p=m==null?void 0:m[e])==null?void 0:p[l])||o,v=_.useContext(h);if(v)return v;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[u,f]}const a=()=>{const s=r.map(i=>_.createContext(i));return function(o){const l=(o==null?void 0:o[e])||s;return _.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return a.scopeName=e,[n,V6(a,...t)]}function V6(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(s){const i=n.reduce((o,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...o,...d}},{});return _.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}function no(e){const t=Y6(e),r=_.forwardRef((n,a)=>{const{children:s,...i}=n,o=_.Children.toArray(s),l=o.find(K6);if(l){const u=l.props.children,f=o.map(d=>d===l?_.Children.count(u)>1?_.Children.only(null):_.isValidElement(u)?u.props.children:null:d);return c.jsx(t,{...i,ref:a,children:_.isValidElement(u)?_.cloneElement(u,void 0,f):null})}return c.jsx(t,{...i,ref:a,children:s})});return r.displayName=`${e}.Slot`,r}var G6=no("Slot");function Y6(e){const t=_.forwardRef((r,n)=>{const{children:a,...s}=r;if(_.isValidElement(a)){const i=Q6(a),o=q6(s,a.props);return a.type!==_.Fragment&&(o.ref=n?lk(n,i):i),_.cloneElement(a,o)}return _.Children.count(a)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var ck=Symbol("radix.slottable");function X6(e){const t=({children:r})=>c.jsx(c.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=ck,t}function K6(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===ck}function q6(e,t){const r={...t};for(const n in t){const a=e[n],s=t[n];/^on[A-Z]/.test(n)?a&&s?r[n]=(...o)=>{const l=s(...o);return a(...o),l}:a&&(r[n]=a):n==="style"?r[n]={...a,...s}:n==="className"&&(r[n]=[a,s].filter(Boolean).join(" "))}return{...e,...r}}function Q6(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function h1(e){const t=e+"CollectionProvider",[r,n]=In(t),[a,s]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=p=>{const{scope:g,children:y}=p,w=ge.useRef(null),x=ge.useRef(new Map).current;return c.jsx(a,{scope:g,itemMap:x,collectionRef:w,children:y})};i.displayName=t;const o=e+"CollectionSlot",l=no(o),u=ge.forwardRef((p,g)=>{const{scope:y,children:w}=p,x=s(o,y),S=Qe(g,x.collectionRef);return c.jsx(l,{ref:S,children:w})});u.displayName=o;const f=e+"CollectionItemSlot",d="data-radix-collection-item",m=no(f),h=ge.forwardRef((p,g)=>{const{scope:y,children:w,...x}=p,S=ge.useRef(null),b=Qe(g,S),E=s(f,y);return ge.useEffect(()=>(E.itemMap.set(S,{ref:S,...x}),()=>void E.itemMap.delete(S))),c.jsx(m,{[d]:"",ref:b,children:w})});h.displayName=f;function v(p){const g=s(e+"CollectionConsumer",p);return ge.useCallback(()=>{const w=g.collectionRef.current;if(!w)return[];const x=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((E,k)=>x.indexOf(E.ref.current)-x.indexOf(k.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:i,Slot:u,ItemSlot:h},v,n]}var J6=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],je=J6.reduce((e,t)=>{const r=no(`Primitive.${t}`),n=_.forwardRef((a,s)=>{const{asChild:i,...o}=a,l=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function uk(e,t){e&&xo.flushSync(()=>e.dispatchEvent(t))}function ea(e){const t=_.useRef(e);return _.useEffect(()=>{t.current=e}),_.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Z6(e,t=globalThis==null?void 0:globalThis.document){const r=ea(e);_.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var eA="DismissableLayer",R0="dismissableLayer.update",tA="dismissableLayer.pointerDownOutside",rA="dismissableLayer.focusOutside",kx,fk=_.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ul=_.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:s,onInteractOutside:i,onDismiss:o,...l}=e,u=_.useContext(fk),[f,d]=_.useState(null),m=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,h]=_.useState({}),v=Qe(t,k=>d(k)),p=Array.from(u.layers),[g]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=p.indexOf(g),w=f?p.indexOf(f):-1,x=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=y,b=aA(k=>{const T=k.target,N=[...u.branches].some(O=>O.contains(T));!S||N||(a==null||a(k),i==null||i(k),k.defaultPrevented||o==null||o())},m),E=sA(k=>{const T=k.target;[...u.branches].some(O=>O.contains(T))||(s==null||s(k),i==null||i(k),k.defaultPrevented||o==null||o())},m);return Z6(k=>{w===u.layers.size-1&&(n==null||n(k),!k.defaultPrevented&&o&&(k.preventDefault(),o()))},m),_.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(kx=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),bx(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=kx)}},[f,m,r,u]),_.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),bx())},[f,u]),_.useEffect(()=>{const k=()=>h({});return document.addEventListener(R0,k),()=>document.removeEventListener(R0,k)},[]),c.jsx(je.div,{...l,ref:v,style:{pointerEvents:x?S?"auto":"none":void 0,...e.style},onFocusCapture:Te(e.onFocusCapture,E.onFocusCapture),onBlurCapture:Te(e.onBlurCapture,E.onBlurCapture),onPointerDownCapture:Te(e.onPointerDownCapture,b.onPointerDownCapture)})});Ul.displayName=eA;var nA="DismissableLayerBranch",dk=_.forwardRef((e,t)=>{const r=_.useContext(fk),n=_.useRef(null),a=Qe(t,n);return _.useEffect(()=>{const s=n.current;if(s)return r.branches.add(s),()=>{r.branches.delete(s)}},[r.branches]),c.jsx(je.div,{...e,ref:a})});dk.displayName=nA;function aA(e,t=globalThis==null?void 0:globalThis.document){const r=ea(e),n=_.useRef(!1),a=_.useRef(()=>{});return _.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let l=function(){hk(tA,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=l,t.addEventListener("click",a.current,{once:!0})):l()}else t.removeEventListener("click",a.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",s),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function sA(e,t=globalThis==null?void 0:globalThis.document){const r=ea(e),n=_.useRef(!1);return _.useEffect(()=>{const a=s=>{s.target&&!n.current&&hk(rA,r,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function bx(){const e=new CustomEvent(R0);document.dispatchEvent(e)}function hk(e,t,r,{discrete:n}){const a=r.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?uk(a,s):a.dispatchEvent(s)}var iA=Ul,oA=dk,pr=globalThis!=null&&globalThis.document?_.useLayoutEffect:()=>{},lA="Portal",Ku=_.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[a,s]=_.useState(!1);pr(()=>s(!0),[]);const i=r||a&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return i?ik.createPortal(c.jsx(je.div,{...n,ref:t}),i):null});Ku.displayName=lA;function cA(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var Ta=e=>{const{present:t,children:r}=e,n=uA(t),a=typeof r=="function"?r({present:n.isPresent}):_.Children.only(r),s=Qe(n.ref,fA(a));return typeof r=="function"||n.isPresent?_.cloneElement(a,{ref:s}):null};Ta.displayName="Presence";function uA(e){const[t,r]=_.useState(),n=_.useRef(null),a=_.useRef(e),s=_.useRef("none"),i=e?"mounted":"unmounted",[o,l]=cA(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return _.useEffect(()=>{const u=Lf(n.current);s.current=o==="mounted"?u:"none"},[o]),pr(()=>{const u=n.current,f=a.current;if(f!==e){const m=s.current,h=Lf(u);e?l("MOUNT"):h==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(f&&m!==h?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,l]),pr(()=>{if(t){let u;const f=t.ownerDocument.defaultView??window,d=h=>{const p=Lf(n.current).includes(CSS.escape(h.animationName));if(h.target===t&&p&&(l("ANIMATION_END"),!a.current)){const g=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=g)})}},m=h=>{h.target===t&&(s.current=Lf(n.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:_.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function Lf(e){return(e==null?void 0:e.animationName)||"none"}function fA(e){var n,a;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var dA=Sg[" useInsertionEffect ".trim().toString()]||pr;function Xa({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[a,s,i]=hA({defaultProp:t,onChange:r}),o=e!==void 0,l=o?e:a;{const f=_.useRef(e!==void 0);_.useEffect(()=>{const d=f.current;d!==o&&console.warn(`${n} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=o},[o,n])}const u=_.useCallback(f=>{var d;if(o){const m=mA(f)?f(e):f;m!==e&&((d=i.current)==null||d.call(i,m))}else s(f)},[o,e,s,i]);return[l,u]}function hA({defaultProp:e,onChange:t}){const[r,n]=_.useState(e),a=_.useRef(r),s=_.useRef(t);return dA(()=>{s.current=t},[t]),_.useEffect(()=>{var i;a.current!==r&&((i=s.current)==null||i.call(s,r),a.current=r)},[r,a]),[r,n,s]}function mA(e){return typeof e=="function"}var mk=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),pA="VisuallyHidden",Oh=_.forwardRef((e,t)=>c.jsx(je.span,{...e,ref:t,style:{...mk,...e.style}}));Oh.displayName=pA;var gA=Oh,m1="ToastProvider",[p1,vA,yA]=h1("Toast"),[pk,Tq]=In("Toast",[yA]),[xA,Ih]=pk(m1),gk=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:s=50,children:i}=e,[o,l]=_.useState(null),[u,f]=_.useState(0),d=_.useRef(!1),m=_.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${m1}\`. Expected non-empty \`string\`.`),c.jsx(p1.Provider,{scope:t,children:c.jsx(xA,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:s,toastCount:u,viewport:o,onViewportChange:l,onToastAdd:_.useCallback(()=>f(h=>h+1),[]),onToastRemove:_.useCallback(()=>f(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:m,children:i})})};gk.displayName=m1;var vk="ToastViewport",wA=["F8"],M0="toast.viewportPause",O0="toast.viewportResume",yk=_.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=wA,label:a="Notifications ({hotkey})",...s}=e,i=Ih(vk,r),o=vA(r),l=_.useRef(null),u=_.useRef(null),f=_.useRef(null),d=_.useRef(null),m=Qe(t,d,i.onViewportChange),h=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=i.toastCount>0;_.useEffect(()=>{const g=y=>{var x;n.length!==0&&n.every(S=>y[S]||y.code===S)&&((x=d.current)==null||x.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[n]),_.useEffect(()=>{const g=l.current,y=d.current;if(v&&g&&y){const w=()=>{if(!i.isClosePausedRef.current){const E=new CustomEvent(M0);y.dispatchEvent(E),i.isClosePausedRef.current=!0}},x=()=>{if(i.isClosePausedRef.current){const E=new CustomEvent(O0);y.dispatchEvent(E),i.isClosePausedRef.current=!1}},S=E=>{!g.contains(E.relatedTarget)&&x()},b=()=>{g.contains(document.activeElement)||x()};return g.addEventListener("focusin",w),g.addEventListener("focusout",S),g.addEventListener("pointermove",w),g.addEventListener("pointerleave",b),window.addEventListener("blur",w),window.addEventListener("focus",x),()=>{g.removeEventListener("focusin",w),g.removeEventListener("focusout",S),g.removeEventListener("pointermove",w),g.removeEventListener("pointerleave",b),window.removeEventListener("blur",w),window.removeEventListener("focus",x)}}},[v,i.isClosePausedRef]);const p=_.useCallback(({tabbingDirection:g})=>{const w=o().map(x=>{const S=x.ref.current,b=[S,...RA(S)];return g==="forwards"?b:b.reverse()});return(g==="forwards"?w.reverse():w).flat()},[o]);return _.useEffect(()=>{const g=d.current;if(g){const y=w=>{var b,E,k;const x=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!x){const T=document.activeElement,N=w.shiftKey;if(w.target===g&&N){(b=u.current)==null||b.focus();return}const P=p({tabbingDirection:N?"backwards":"forwards"}),G=P.findIndex(X=>X===T);tp(P.slice(G+1))?w.preventDefault():N?(E=u.current)==null||E.focus():(k=f.current)==null||k.focus()}};return g.addEventListener("keydown",y),()=>g.removeEventListener("keydown",y)}},[o,p]),c.jsxs(oA,{ref:l,role:"region","aria-label":a.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&c.jsx(I0,{ref:u,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"forwards"});tp(g)}}),c.jsx(p1.Slot,{scope:r,children:c.jsx(je.ol,{tabIndex:-1,...s,ref:m})}),v&&c.jsx(I0,{ref:f,onFocusFromOutsideViewport:()=>{const g=p({tabbingDirection:"backwards"});tp(g)}})]})});yk.displayName=vk;var xk="ToastFocusProxy",I0=_.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=e,s=Ih(xk,r);return c.jsx(Oh,{tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:i=>{var u;const o=i.relatedTarget;!((u=s.viewport)!=null&&u.contains(o))&&n()}})});I0.displayName=xk;var qu="Toast",_A="toast.swipeStart",SA="toast.swipeMove",kA="toast.swipeCancel",bA="toast.swipeEnd",wk=_.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:s,...i}=e,[o,l]=Xa({prop:n,defaultProp:a??!0,onChange:s,caller:qu});return c.jsx(Ta,{present:r||o,children:c.jsx(NA,{open:o,...i,ref:t,onClose:()=>l(!1),onPause:ea(e.onPause),onResume:ea(e.onResume),onSwipeStart:Te(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Te(e.onSwipeMove,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:Te(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Te(e.onSwipeEnd,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});wk.displayName=qu;var[EA,TA]=pk(qu,{onClose(){}}),NA=_.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:s,onClose:i,onEscapeKeyDown:o,onPause:l,onResume:u,onSwipeStart:f,onSwipeMove:d,onSwipeCancel:m,onSwipeEnd:h,...v}=e,p=Ih(qu,r),[g,y]=_.useState(null),w=Qe(t,X=>y(X)),x=_.useRef(null),S=_.useRef(null),b=a||p.duration,E=_.useRef(0),k=_.useRef(b),T=_.useRef(0),{onToastAdd:N,onToastRemove:O}=p,W=ea(()=>{var V;(g==null?void 0:g.contains(document.activeElement))&&((V=p.viewport)==null||V.focus()),i()}),P=_.useCallback(X=>{!X||X===1/0||(window.clearTimeout(T.current),E.current=new Date().getTime(),T.current=window.setTimeout(W,X))},[W]);_.useEffect(()=>{const X=p.viewport;if(X){const V=()=>{P(k.current),u==null||u()},K=()=>{const Y=new Date().getTime()-E.current;k.current=k.current-Y,window.clearTimeout(T.current),l==null||l()};return X.addEventListener(M0,K),X.addEventListener(O0,V),()=>{X.removeEventListener(M0,K),X.removeEventListener(O0,V)}}},[p.viewport,b,l,u,P]),_.useEffect(()=>{s&&!p.isClosePausedRef.current&&P(b)},[s,b,p.isClosePausedRef,P]),_.useEffect(()=>(N(),()=>O()),[N,O]);const G=_.useMemo(()=>g?Nk(g):null,[g]);return p.viewport?c.jsxs(c.Fragment,{children:[G&&c.jsx(CA,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:G}),c.jsx(EA,{scope:r,onClose:W,children:xo.createPortal(c.jsx(p1.ItemSlot,{scope:r,children:c.jsx(iA,{asChild:!0,onEscapeKeyDown:Te(o,()=>{p.isFocusedToastEscapeKeyDownRef.current||W(),p.isFocusedToastEscapeKeyDownRef.current=!1}),children:c.jsx(je.li,{tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":p.swipeDirection,...v,ref:w,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Te(e.onKeyDown,X=>{X.key==="Escape"&&(o==null||o(X.nativeEvent),X.nativeEvent.defaultPrevented||(p.isFocusedToastEscapeKeyDownRef.current=!0,W()))}),onPointerDown:Te(e.onPointerDown,X=>{X.button===0&&(x.current={x:X.clientX,y:X.clientY})}),onPointerMove:Te(e.onPointerMove,X=>{if(!x.current)return;const V=X.clientX-x.current.x,K=X.clientY-x.current.y,Y=!!S.current,H=["left","right"].includes(p.swipeDirection),M=["left","up"].includes(p.swipeDirection)?Math.min:Math.max,ne=H?M(0,V):0,ce=H?0:M(0,K),j=X.pointerType==="touch"?10:2,z={x:ne,y:ce},L={originalEvent:X,delta:z};Y?(S.current=z,Bf(SA,d,L,{discrete:!1})):Ex(z,p.swipeDirection,j)?(S.current=z,Bf(_A,f,L,{discrete:!1}),X.target.setPointerCapture(X.pointerId)):(Math.abs(V)>j||Math.abs(K)>j)&&(x.current=null)}),onPointerUp:Te(e.onPointerUp,X=>{const V=S.current,K=X.target;if(K.hasPointerCapture(X.pointerId)&&K.releasePointerCapture(X.pointerId),S.current=null,x.current=null,V){const Y=X.currentTarget,H={originalEvent:X,delta:V};Ex(V,p.swipeDirection,p.swipeThreshold)?Bf(bA,h,H,{discrete:!0}):Bf(kA,m,H,{discrete:!0}),Y.addEventListener("click",M=>M.preventDefault(),{once:!0})}})})})}),p.viewport)})]}):null}),CA=e=>{const{__scopeToast:t,children:r,...n}=e,a=Ih(qu,t),[s,i]=_.useState(!1),[o,l]=_.useState(!1);return jA(()=>i(!0)),_.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),o?null:c.jsx(Ku,{asChild:!0,children:c.jsx(Oh,{...n,children:s&&c.jsxs(c.Fragment,{children:[a.label," ",r]})})})},AA="ToastTitle",_k=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return c.jsx(je.div,{...n,ref:t})});_k.displayName=AA;var PA="ToastDescription",Sk=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return c.jsx(je.div,{...n,ref:t})});Sk.displayName=PA;var kk="ToastAction",bk=_.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?c.jsx(Tk,{altText:r,asChild:!0,children:c.jsx(g1,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${kk}\`. Expected non-empty \`string\`.`),null)});bk.displayName=kk;var Ek="ToastClose",g1=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,a=TA(Ek,r);return c.jsx(Tk,{asChild:!0,children:c.jsx(je.button,{type:"button",...n,ref:t,onClick:Te(e.onClick,a.onClose)})})});g1.displayName=Ek;var Tk=_.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...a}=e;return c.jsx(je.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function Nk(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),DA(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",s=n.dataset.radixToastAnnounceExclude==="";if(!a)if(s){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...Nk(n))}}),t}function Bf(e,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,s=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),n?uk(a,s):a.dispatchEvent(s)}var Ex=(e,t,r=0)=>{const n=Math.abs(e.x),a=Math.abs(e.y),s=n>a;return t==="left"||t==="right"?s&&n>r:!s&&a>r};function jA(e=()=>{}){const t=ea(e);pr(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function DA(e){return e.nodeType===e.ELEMENT_NODE}function RA(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function tp(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var MA=gk,Ck=yk,Ak=wk,Pk=_k,jk=Sk,Dk=bk,Rk=g1;function Mk(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Mk(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Ok(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Mk(e))&&(n&&(n+=" "),n+=t);return n}const Tx=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Nx=Ok,Fh=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return Nx(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:s}=t,i=Object.keys(a).map(u=>{const f=r==null?void 0:r[u],d=s==null?void 0:s[u];if(f===null)return null;const m=Tx(f)||Tx(d);return a[u][m]}),o=r&&Object.entries(r).reduce((u,f)=>{let[d,m]=f;return m===void 0||(u[d]=m),u},{}),l=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:d,className:m,...h}=f;return Object.entries(h).every(v=>{let[p,g]=v;return Array.isArray(g)?g.includes({...s,...o}[p]):{...s,...o}[p]===g})?[...u,d,m]:u},[]);return Nx(e,i,l,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OA=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ik=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var IA={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FA=_.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...o},l)=>_.createElement("svg",{ref:l,...IA,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Ik("lucide",a),...o},[...i.map(([u,f])=>_.createElement(u,f)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=(e,t)=>{const r=_.forwardRef(({className:n,...a},s)=>_.createElement(FA,{ref:s,iconNode:t,className:Ik(`lucide-${OA(e)}`,n),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LA=Ve("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F0=Ve("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=Ve("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=Ve("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BA=Ve("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lk=Ve("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=Ve("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v1=Ve("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=Ve("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bh=Ve("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=Ve("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UA=Ve("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $A=Ve("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=Ve("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=Ve("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=Ve("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uk=Ve("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zA=Ve("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=Ve("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=Ve("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GA=Ve("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=Ve("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $k=Ve("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uh=Ve("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=Ve("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YA=Ve("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XA=Ve("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wk=Ve("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hk=Ve("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cx=Ve("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=Ve("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=Ve("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=Ve("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=Ve("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qA=Ve("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w1=Ve("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=Ve("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _1=Ve("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gu=Ve("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=Ve("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),S1="-",QA=e=>{const t=ZA(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const o=i.split(S1);return o[0]===""&&o.length!==1&&o.shift(),zk(o,t)||JA(i)},getConflictingClassGroupIds:(i,o)=>{const l=r[i]||[];return o&&n[i]?[...l,...n[i]]:l}}},zk=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),a=n?zk(e.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const s=e.join(S1);return(i=t.validators.find(({validator:o})=>o(s)))==null?void 0:i.classGroupId},Ax=/^\[(.+)\]$/,JA=e=>{if(Ax.test(e)){const t=Ax.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},ZA=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return tP(Object.entries(e.classGroups),r).forEach(([s,i])=>{U0(i,n,s,t)}),n},U0=(e,t,r,n)=>{e.forEach(a=>{if(typeof a=="string"){const s=a===""?t:Px(t,a);s.classGroupId=r;return}if(typeof a=="function"){if(eP(a)){U0(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([s,i])=>{U0(i,Px(t,s),r,n)})})},Px=(e,t)=>{let r=e;return t.split(S1).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},eP=e=>e.isThemeGetter,tP=(e,t)=>t?e.map(([r,n])=>{const a=n.map(s=>typeof s=="string"?t+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([i,o])=>[t+i,o])):s);return[r,a]}):e,rP=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(s,i)=>{r.set(s,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(s){let i=r.get(s);if(i!==void 0)return i;if((i=n.get(s))!==void 0)return a(s,i),i},set(s,i){r.has(s)?r.set(s,i):a(s,i)}}},Vk="!",nP=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,a=t[0],s=t.length,i=o=>{const l=[];let u=0,f=0,d;for(let g=0;g<o.length;g++){let y=o[g];if(u===0){if(y===a&&(n||o.slice(g,g+s)===t)){l.push(o.slice(f,g)),f=g+s;continue}if(y==="/"){d=g;continue}}y==="["?u++:y==="]"&&u--}const m=l.length===0?o:o.substring(f),h=m.startsWith(Vk),v=h?m.substring(1):m,p=d&&d>f?d-f:void 0;return{modifiers:l,hasImportantModifier:h,baseClassName:v,maybePostfixModifierPosition:p}};return r?o=>r({className:o,parseClassName:i}):i},aP=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},sP=e=>({cache:rP(e.cacheSize),parseClassName:nP(e),...QA(e)}),iP=/\s+/,oP=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,s=[],i=e.trim().split(iP);let o="";for(let l=i.length-1;l>=0;l-=1){const u=i[l],{modifiers:f,hasImportantModifier:d,baseClassName:m,maybePostfixModifierPosition:h}=r(u);let v=!!h,p=n(v?m.substring(0,h):m);if(!p){if(!v){o=u+(o.length>0?" "+o:o);continue}if(p=n(m),!p){o=u+(o.length>0?" "+o:o);continue}v=!1}const g=aP(f).join(":"),y=d?g+Vk:g,w=y+p;if(s.includes(w))continue;s.push(w);const x=a(p,v);for(let S=0;S<x.length;++S){const b=x[S];s.push(y+b)}o=u+(o.length>0?" "+o:o)}return o};function lP(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=Gk(t))&&(n&&(n+=" "),n+=r);return n}const Gk=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=Gk(e[n]))&&(r&&(r+=" "),r+=t);return r};function cP(e,...t){let r,n,a,s=i;function i(l){const u=t.reduce((f,d)=>d(f),e());return r=sP(u),n=r.cache.get,a=r.cache.set,s=o,o(l)}function o(l){const u=n(l);if(u)return u;const f=oP(l,r);return a(l,f),f}return function(){return s(lP.apply(null,arguments))}}const _t=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},Yk=/^\[(?:([a-z-]+):)?(.+)\]$/i,uP=/^\d+\/\d+$/,fP=new Set(["px","full","screen"]),dP=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,hP=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,mP=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,pP=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,gP=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,rs=e=>il(e)||fP.has(e)||uP.test(e),Ms=e=>$l(e,"length",bP),il=e=>!!e&&!Number.isNaN(Number(e)),rp=e=>$l(e,"number",il),pc=e=>!!e&&Number.isInteger(Number(e)),vP=e=>e.endsWith("%")&&il(e.slice(0,-1)),He=e=>Yk.test(e),Os=e=>dP.test(e),yP=new Set(["length","size","percentage"]),xP=e=>$l(e,yP,Xk),wP=e=>$l(e,"position",Xk),_P=new Set(["image","url"]),SP=e=>$l(e,_P,TP),kP=e=>$l(e,"",EP),gc=()=>!0,$l=(e,t,r)=>{const n=Yk.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},bP=e=>hP.test(e)&&!mP.test(e),Xk=()=>!1,EP=e=>pP.test(e),TP=e=>gP.test(e),NP=()=>{const e=_t("colors"),t=_t("spacing"),r=_t("blur"),n=_t("brightness"),a=_t("borderColor"),s=_t("borderRadius"),i=_t("borderSpacing"),o=_t("borderWidth"),l=_t("contrast"),u=_t("grayscale"),f=_t("hueRotate"),d=_t("invert"),m=_t("gap"),h=_t("gradientColorStops"),v=_t("gradientColorStopPositions"),p=_t("inset"),g=_t("margin"),y=_t("opacity"),w=_t("padding"),x=_t("saturate"),S=_t("scale"),b=_t("sepia"),E=_t("skew"),k=_t("space"),T=_t("translate"),N=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],W=()=>["auto",He,t],P=()=>[He,t],G=()=>["",rs,Ms],X=()=>["auto",il,He],V=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],K=()=>["solid","dashed","dotted","double","none"],Y=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],H=()=>["start","end","center","between","around","evenly","stretch"],M=()=>["","0",He],ne=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ce=()=>[il,He];return{cacheSize:500,separator:":",theme:{colors:[gc],spacing:[rs,Ms],blur:["none","",Os,He],brightness:ce(),borderColor:[e],borderRadius:["none","","full",Os,He],borderSpacing:P(),borderWidth:G(),contrast:ce(),grayscale:M(),hueRotate:ce(),invert:M(),gap:P(),gradientColorStops:[e],gradientColorStopPositions:[vP,Ms],inset:W(),margin:W(),opacity:ce(),padding:P(),saturate:ce(),scale:ce(),sepia:M(),skew:ce(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",He]}],container:["container"],columns:[{columns:[Os]}],"break-after":[{"break-after":ne()}],"break-before":[{"break-before":ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...V(),He]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",pc,He]}],basis:[{basis:W()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",He]}],grow:[{grow:M()}],shrink:[{shrink:M()}],order:[{order:["first","last","none",pc,He]}],"grid-cols":[{"grid-cols":[gc]}],"col-start-end":[{col:["auto",{span:["full",pc,He]},He]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[gc]}],"row-start-end":[{row:["auto",{span:[pc,He]},He]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",He]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",He]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...H()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...H(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...H(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",He,t]}],"min-w":[{"min-w":[He,t,"min","max","fit"]}],"max-w":[{"max-w":[He,t,"none","full","min","max","fit","prose",{screen:[Os]},Os]}],h:[{h:[He,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[He,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[He,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[He,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Os,Ms]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",rp]}],"font-family":[{font:[gc]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",He]}],"line-clamp":[{"line-clamp":["none",il,rp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",rs,He]}],"list-image":[{"list-image":["none",He]}],"list-style-type":[{list:["none","disc","decimal",He]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...K(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",rs,Ms]}],"underline-offset":[{"underline-offset":["auto",rs,He]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",He]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",He]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...V(),wP]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",xP]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},SP]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[v]}],"gradient-via-pos":[{via:[v]}],"gradient-to-pos":[{to:[v]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...K(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:K()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...K()]}],"outline-offset":[{"outline-offset":[rs,He]}],"outline-w":[{outline:[rs,Ms]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:G()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[rs,Ms]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Os,kP]}],"shadow-color":[{shadow:[gc]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...Y(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Y()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Os,He]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[x]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",He]}],duration:[{duration:ce()}],ease:[{ease:["linear","in","out","in-out",He]}],delay:[{delay:ce()}],animate:[{animate:["none","spin","ping","pulse","bounce",He]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[pc,He]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",He]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",He]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",He]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[rs,Ms,rp]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},CP=cP(NP);function Ae(...e){return CP(Ok(e))}const AP=MA,Kk=_.forwardRef(({className:e,...t},r)=>c.jsx(Ck,{ref:r,className:Ae("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));Kk.displayName=Ck.displayName;const PP=Fh("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),qk=_.forwardRef(({className:e,variant:t,...r},n)=>c.jsx(Ak,{ref:n,className:Ae(PP({variant:t}),e),...r}));qk.displayName=Ak.displayName;const jP=_.forwardRef(({className:e,...t},r)=>c.jsx(Dk,{ref:r,className:Ae("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));jP.displayName=Dk.displayName;const Qk=_.forwardRef(({className:e,...t},r)=>c.jsx(Rk,{ref:r,className:Ae("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:c.jsx(Ns,{className:"h-4 w-4"})}));Qk.displayName=Rk.displayName;const Jk=_.forwardRef(({className:e,...t},r)=>c.jsx(Pk,{ref:r,className:Ae("text-sm font-semibold",e),...t}));Jk.displayName=Pk.displayName;const Zk=_.forwardRef(({className:e,...t},r)=>c.jsx(jk,{ref:r,className:Ae("text-sm opacity-90",e),...t}));Zk.displayName=jk.displayName;function DP(){const{toasts:e}=H6();return c.jsxs(AP,{children:[e.map(function({id:t,title:r,description:n,action:a,...s}){return c.jsxs(qk,{...s,children:[c.jsxs("div",{className:"grid gap-1",children:[r&&c.jsx(Jk,{children:r}),n&&c.jsx(Zk,{children:n})]}),a,c.jsx(Qk,{})]},t)}),c.jsx(Kk,{})]})}var jx=["light","dark"],RP="(prefers-color-scheme: dark)",MP=_.createContext(void 0),OP={setTheme:e=>{},themes:[]},IP=()=>{var e;return(e=_.useContext(MP))!=null?e:OP};_.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:s,value:i,attrs:o,nonce:l})=>{let u=s==="system",f=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(v=>`'${v}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,d=a?jx.includes(s)&&s?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${s}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",m=(v,p=!1,g=!0)=>{let y=i?i[v]:v,w=p?v+"|| ''":`'${y}'`,x="";return a&&g&&!p&&jx.includes(v)&&(x+=`d.style.colorScheme = '${v}';`),r==="class"?p||y?x+=`c.add(${w})`:x+="null":y&&(x+=`d[s](n,${w})`),x},h=e?`!function(){${f}${m(e)}}()`:n?`!function(){try{${f}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${RP}',m=window.matchMedia(t);if(m.media!==t||m.matches){${m("dark")}}else{${m("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${m(i?"x[e]":"e",!0)}}${u?"":"else{"+m(s,!1,!1)+"}"}${d}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${t}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${m(i?"x[e]":"e",!0)}}else{${m(s,!1,!1)};}${d}}catch(t){}}();`;return _.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:h}})});var FP=e=>{switch(e){case"success":return UP;case"info":return WP;case"warning":return $P;case"error":return HP;default:return null}},LP=Array(12).fill(0),BP=({visible:e,className:t})=>ge.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ge.createElement("div",{className:"sonner-spinner"},LP.map((r,n)=>ge.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),UP=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),$P=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),WP=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),HP=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),zP=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ge.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ge.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),VP=()=>{let[e,t]=ge.useState(document.hidden);return ge.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},$0=1,GP=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...n}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:$0++,s=this.toasts.find(o=>o.id===a),i=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),s?this.toasts=this.toasts.map(o=>o.id===a?(this.publish({...o,...e,id:a,title:r}),{...o,...e,id:a,dismissible:i,title:r}):o):this.addToast({title:r,...n,dismissible:i,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let n=e instanceof Promise?e:e(),a=r!==void 0,s,i=n.then(async l=>{if(s=["resolve",l],ge.isValidElement(l))a=!1,this.create({id:r,type:"default",message:l});else if(XP(l)&&!l.ok){a=!1;let u=typeof t.error=="function"?await t.error(`HTTP error! status: ${l.status}`):t.error,f=typeof t.description=="function"?await t.description(`HTTP error! status: ${l.status}`):t.description;this.create({id:r,type:"error",message:u,description:f})}else if(t.success!==void 0){a=!1;let u=typeof t.success=="function"?await t.success(l):t.success,f=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"success",message:u,description:f})}}).catch(async l=>{if(s=["reject",l],t.error!==void 0){a=!1;let u=typeof t.error=="function"?await t.error(l):t.error,f=typeof t.description=="function"?await t.description(l):t.description;this.create({id:r,type:"error",message:u,description:f})}}).finally(()=>{var l;a&&(this.dismiss(r),r=void 0),(l=t.finally)==null||l.call(t)}),o=()=>new Promise((l,u)=>i.then(()=>s[0]==="reject"?u(s[1]):l(s[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:o}:Object.assign(r,{unwrap:o})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||$0++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},nn=new GP,YP=(e,t)=>{let r=(t==null?void 0:t.id)||$0++;return nn.addToast({title:e,...t,id:r}),r},XP=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",KP=YP,qP=()=>nn.toasts,QP=()=>nn.getActiveToasts(),Se=Object.assign(KP,{success:nn.success,info:nn.info,warning:nn.warning,error:nn.error,custom:nn.custom,message:nn.message,promise:nn.promise,dismiss:nn.dismiss,loading:nn.loading},{getHistory:qP,getToasts:QP});function JP(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}JP(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Uf(e){return e.label!==void 0}var ZP=3,ej="32px",tj="16px",Dx=4e3,rj=356,nj=14,aj=20,sj=200;function sa(...e){return e.filter(Boolean).join(" ")}function ij(e){let[t,r]=e.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var oj=e=>{var t,r,n,a,s,i,o,l,u,f,d;let{invert:m,toast:h,unstyled:v,interacting:p,setHeights:g,visibleToasts:y,heights:w,index:x,toasts:S,expanded:b,removeToast:E,defaultRichColors:k,closeButton:T,style:N,cancelButtonStyle:O,actionButtonStyle:W,className:P="",descriptionClassName:G="",duration:X,position:V,gap:K,loadingIcon:Y,expandByDefault:H,classNames:M,icons:ne,closeButtonAriaLabel:ce="Close toast",pauseWhenPageIsHidden:j}=e,[z,L]=ge.useState(null),[U,Q]=ge.useState(null),[q,ae]=ge.useState(!1),[oe,se]=ge.useState(!1),[J,A]=ge.useState(!1),[pe,Ne]=ge.useState(!1),[$e,Me]=ge.useState(!1),[xe,ht]=ge.useState(0),[nr,vn]=ge.useState(0),Wr=ge.useRef(h.duration||X||Dx),js=ge.useRef(null),kr=ge.useRef(null),Hr=x===0,na=x+1<=y,zt=h.type,Fn=h.dismissible!==!1,gr=h.className||"",Ln=h.descriptionClassName||"",Le=ge.useMemo(()=>w.findIndex(Fe=>Fe.toastId===h.id)||0,[w,h.id]),At=ge.useMemo(()=>{var Fe;return(Fe=h.closeButton)!=null?Fe:T},[h.closeButton,T]),zr=ge.useMemo(()=>h.duration||X||Dx,[h.duration,X]),Pt=ge.useRef(0),rn=ge.useRef(0),ec=ge.useRef(0),Ds=ge.useRef(null),[Sm,xf]=V.split("-"),tc=ge.useMemo(()=>w.reduce((Fe,st,yt)=>yt>=Le?Fe:Fe+st.height,0),[w,Le]),rc=VP(),km=h.invert||m,nc=zt==="loading";rn.current=ge.useMemo(()=>Le*K+tc,[Le,tc]),ge.useEffect(()=>{Wr.current=zr},[zr]),ge.useEffect(()=>{ae(!0)},[]),ge.useEffect(()=>{let Fe=kr.current;if(Fe){let st=Fe.getBoundingClientRect().height;return vn(st),g(yt=>[{toastId:h.id,height:st,position:h.position},...yt]),()=>g(yt=>yt.filter(xn=>xn.toastId!==h.id))}},[g,h.id]),ge.useLayoutEffect(()=>{if(!q)return;let Fe=kr.current,st=Fe.style.height;Fe.style.height="auto";let yt=Fe.getBoundingClientRect().height;Fe.style.height=st,vn(yt),g(xn=>xn.find(wn=>wn.toastId===h.id)?xn.map(wn=>wn.toastId===h.id?{...wn,height:yt}:wn):[{toastId:h.id,height:yt,position:h.position},...xn])},[q,h.title,h.description,g,h.id]);let yn=ge.useCallback(()=>{se(!0),ht(rn.current),g(Fe=>Fe.filter(st=>st.toastId!==h.id)),setTimeout(()=>{E(h)},sj)},[h,E,g,rn]);ge.useEffect(()=>{if(h.promise&&zt==="loading"||h.duration===1/0||h.type==="loading")return;let Fe;return b||p||j&&rc?(()=>{if(ec.current<Pt.current){let st=new Date().getTime()-Pt.current;Wr.current=Wr.current-st}ec.current=new Date().getTime()})():Wr.current!==1/0&&(Pt.current=new Date().getTime(),Fe=setTimeout(()=>{var st;(st=h.onAutoClose)==null||st.call(h,h),yn()},Wr.current)),()=>clearTimeout(Fe)},[b,p,h,zt,j,rc,yn]),ge.useEffect(()=>{h.delete&&yn()},[yn,h.delete]);function bm(){var Fe,st,yt;return ne!=null&&ne.loading?ge.createElement("div",{className:sa(M==null?void 0:M.loader,(Fe=h==null?void 0:h.classNames)==null?void 0:Fe.loader,"sonner-loader"),"data-visible":zt==="loading"},ne.loading):Y?ge.createElement("div",{className:sa(M==null?void 0:M.loader,(st=h==null?void 0:h.classNames)==null?void 0:st.loader,"sonner-loader"),"data-visible":zt==="loading"},Y):ge.createElement(BP,{className:sa(M==null?void 0:M.loader,(yt=h==null?void 0:h.classNames)==null?void 0:yt.loader),visible:zt==="loading"})}return ge.createElement("li",{tabIndex:0,ref:kr,className:sa(P,gr,M==null?void 0:M.toast,(t=h==null?void 0:h.classNames)==null?void 0:t.toast,M==null?void 0:M.default,M==null?void 0:M[zt],(r=h==null?void 0:h.classNames)==null?void 0:r[zt]),"data-sonner-toast":"","data-rich-colors":(n=h.richColors)!=null?n:k,"data-styled":!(h.jsx||h.unstyled||v),"data-mounted":q,"data-promise":!!h.promise,"data-swiped":$e,"data-removed":oe,"data-visible":na,"data-y-position":Sm,"data-x-position":xf,"data-index":x,"data-front":Hr,"data-swiping":J,"data-dismissible":Fn,"data-type":zt,"data-invert":km,"data-swipe-out":pe,"data-swipe-direction":U,"data-expanded":!!(b||H&&q),style:{"--index":x,"--toasts-before":x,"--z-index":S.length-x,"--offset":`${oe?xe:rn.current}px`,"--initial-height":H?"auto":`${nr}px`,...N,...h.style},onDragEnd:()=>{A(!1),L(null),Ds.current=null},onPointerDown:Fe=>{nc||!Fn||(js.current=new Date,ht(rn.current),Fe.target.setPointerCapture(Fe.pointerId),Fe.target.tagName!=="BUTTON"&&(A(!0),Ds.current={x:Fe.clientX,y:Fe.clientY}))},onPointerUp:()=>{var Fe,st,yt,xn;if(pe||!Fn)return;Ds.current=null;let wn=Number(((Fe=kr.current)==null?void 0:Fe.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Ca=Number(((st=kr.current)==null?void 0:st.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),es=new Date().getTime()-((yt=js.current)==null?void 0:yt.getTime()),Vr=z==="x"?wn:Ca,Aa=Math.abs(Vr)/es;if(Math.abs(Vr)>=aj||Aa>.11){ht(rn.current),(xn=h.onDismiss)==null||xn.call(h,h),Q(z==="x"?wn>0?"right":"left":Ca>0?"down":"up"),yn(),Ne(!0),Me(!1);return}A(!1),L(null)},onPointerMove:Fe=>{var st,yt,xn,wn;if(!Ds.current||!Fn||((st=window.getSelection())==null?void 0:st.toString().length)>0)return;let Ca=Fe.clientY-Ds.current.y,es=Fe.clientX-Ds.current.x,Vr=(yt=e.swipeDirections)!=null?yt:ij(V);!z&&(Math.abs(es)>1||Math.abs(Ca)>1)&&L(Math.abs(es)>Math.abs(Ca)?"x":"y");let Aa={x:0,y:0};z==="y"?(Vr.includes("top")||Vr.includes("bottom"))&&(Vr.includes("top")&&Ca<0||Vr.includes("bottom")&&Ca>0)&&(Aa.y=Ca):z==="x"&&(Vr.includes("left")||Vr.includes("right"))&&(Vr.includes("left")&&es<0||Vr.includes("right")&&es>0)&&(Aa.x=es),(Math.abs(Aa.x)>0||Math.abs(Aa.y)>0)&&Me(!0),(xn=kr.current)==null||xn.style.setProperty("--swipe-amount-x",`${Aa.x}px`),(wn=kr.current)==null||wn.style.setProperty("--swipe-amount-y",`${Aa.y}px`)}},At&&!h.jsx?ge.createElement("button",{"aria-label":ce,"data-disabled":nc,"data-close-button":!0,onClick:nc||!Fn?()=>{}:()=>{var Fe;yn(),(Fe=h.onDismiss)==null||Fe.call(h,h)},className:sa(M==null?void 0:M.closeButton,(a=h==null?void 0:h.classNames)==null?void 0:a.closeButton)},(s=ne==null?void 0:ne.close)!=null?s:zP):null,h.jsx||_.isValidElement(h.title)?h.jsx?h.jsx:typeof h.title=="function"?h.title():h.title:ge.createElement(ge.Fragment,null,zt||h.icon||h.promise?ge.createElement("div",{"data-icon":"",className:sa(M==null?void 0:M.icon,(i=h==null?void 0:h.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||bm():null,h.type!=="loading"?h.icon||(ne==null?void 0:ne[zt])||FP(zt):null):null,ge.createElement("div",{"data-content":"",className:sa(M==null?void 0:M.content,(o=h==null?void 0:h.classNames)==null?void 0:o.content)},ge.createElement("div",{"data-title":"",className:sa(M==null?void 0:M.title,(l=h==null?void 0:h.classNames)==null?void 0:l.title)},typeof h.title=="function"?h.title():h.title),h.description?ge.createElement("div",{"data-description":"",className:sa(G,Ln,M==null?void 0:M.description,(u=h==null?void 0:h.classNames)==null?void 0:u.description)},typeof h.description=="function"?h.description():h.description):null),_.isValidElement(h.cancel)?h.cancel:h.cancel&&Uf(h.cancel)?ge.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||O,onClick:Fe=>{var st,yt;Uf(h.cancel)&&Fn&&((yt=(st=h.cancel).onClick)==null||yt.call(st,Fe),yn())},className:sa(M==null?void 0:M.cancelButton,(f=h==null?void 0:h.classNames)==null?void 0:f.cancelButton)},h.cancel.label):null,_.isValidElement(h.action)?h.action:h.action&&Uf(h.action)?ge.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||W,onClick:Fe=>{var st,yt;Uf(h.action)&&((yt=(st=h.action).onClick)==null||yt.call(st,Fe),!Fe.defaultPrevented&&yn())},className:sa(M==null?void 0:M.actionButton,(d=h==null?void 0:h.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function Rx(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function lj(e,t){let r={};return[e,t].forEach((n,a)=>{let s=a===1,i=s?"--mobile-offset":"--offset",o=s?tj:ej;function l(u){["top","right","bottom","left"].forEach(f=>{r[`${i}-${f}`]=typeof u=="number"?`${u}px`:u})}typeof n=="number"||typeof n=="string"?l(n):typeof n=="object"?["top","right","bottom","left"].forEach(u=>{n[u]===void 0?r[`${i}-${u}`]=o:r[`${i}-${u}`]=typeof n[u]=="number"?`${n[u]}px`:n[u]}):l(o)}),r}var cj=_.forwardRef(function(e,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:s,closeButton:i,className:o,offset:l,mobileOffset:u,theme:f="light",richColors:d,duration:m,style:h,visibleToasts:v=ZP,toastOptions:p,dir:g=Rx(),gap:y=nj,loadingIcon:w,icons:x,containerAriaLabel:S="Notifications",pauseWhenPageIsHidden:b}=e,[E,k]=ge.useState([]),T=ge.useMemo(()=>Array.from(new Set([n].concat(E.filter(j=>j.position).map(j=>j.position)))),[E,n]),[N,O]=ge.useState([]),[W,P]=ge.useState(!1),[G,X]=ge.useState(!1),[V,K]=ge.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Y=ge.useRef(null),H=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),M=ge.useRef(null),ne=ge.useRef(!1),ce=ge.useCallback(j=>{k(z=>{var L;return(L=z.find(U=>U.id===j.id))!=null&&L.delete||nn.dismiss(j.id),z.filter(({id:U})=>U!==j.id)})},[]);return ge.useEffect(()=>nn.subscribe(j=>{if(j.dismiss){k(z=>z.map(L=>L.id===j.id?{...L,delete:!0}:L));return}setTimeout(()=>{ik.flushSync(()=>{k(z=>{let L=z.findIndex(U=>U.id===j.id);return L!==-1?[...z.slice(0,L),{...z[L],...j},...z.slice(L+1)]:[j,...z]})})})}),[]),ge.useEffect(()=>{if(f!=="system"){K(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?K("dark"):K("light")),typeof window>"u")return;let j=window.matchMedia("(prefers-color-scheme: dark)");try{j.addEventListener("change",({matches:z})=>{K(z?"dark":"light")})}catch{j.addListener(({matches:L})=>{try{K(L?"dark":"light")}catch(U){console.error(U)}})}},[f]),ge.useEffect(()=>{E.length<=1&&P(!1)},[E]),ge.useEffect(()=>{let j=z=>{var L,U;a.every(Q=>z[Q]||z.code===Q)&&(P(!0),(L=Y.current)==null||L.focus()),z.code==="Escape"&&(document.activeElement===Y.current||(U=Y.current)!=null&&U.contains(document.activeElement))&&P(!1)};return document.addEventListener("keydown",j),()=>document.removeEventListener("keydown",j)},[a]),ge.useEffect(()=>{if(Y.current)return()=>{M.current&&(M.current.focus({preventScroll:!0}),M.current=null,ne.current=!1)}},[Y.current]),ge.createElement("section",{ref:t,"aria-label":`${S} ${H}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((j,z)=>{var L;let[U,Q]=j.split("-");return E.length?ge.createElement("ol",{key:j,dir:g==="auto"?Rx():g,tabIndex:-1,ref:Y,className:o,"data-sonner-toaster":!0,"data-theme":V,"data-y-position":U,"data-lifted":W&&E.length>1&&!s,"data-x-position":Q,style:{"--front-toast-height":`${((L=N[0])==null?void 0:L.height)||0}px`,"--width":`${rj}px`,"--gap":`${y}px`,...h,...lj(l,u)},onBlur:q=>{ne.current&&!q.currentTarget.contains(q.relatedTarget)&&(ne.current=!1,M.current&&(M.current.focus({preventScroll:!0}),M.current=null))},onFocus:q=>{q.target instanceof HTMLElement&&q.target.dataset.dismissible==="false"||ne.current||(ne.current=!0,M.current=q.relatedTarget)},onMouseEnter:()=>P(!0),onMouseMove:()=>P(!0),onMouseLeave:()=>{G||P(!1)},onDragEnd:()=>P(!1),onPointerDown:q=>{q.target instanceof HTMLElement&&q.target.dataset.dismissible==="false"||X(!0)},onPointerUp:()=>X(!1)},E.filter(q=>!q.position&&z===0||q.position===j).map((q,ae)=>{var oe,se;return ge.createElement(oj,{key:q.id,icons:x,index:ae,toast:q,defaultRichColors:d,duration:(oe=p==null?void 0:p.duration)!=null?oe:m,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:r,visibleToasts:v,closeButton:(se=p==null?void 0:p.closeButton)!=null?se:i,interacting:G,position:j,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:ce,toasts:E.filter(J=>J.position==q.position),heights:N.filter(J=>J.position==q.position),setHeights:O,expandByDefault:s,gap:y,loadingIcon:w,expanded:W,pauseWhenPageIsHidden:b,swipeDirections:e.swipeDirections})})):null}))});const uj=({...e})=>{const{theme:t="system"}=IP();return c.jsx(cj,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var fj=Sg[" useId ".trim().toString()]||(()=>{}),dj=0;function Ga(e){const[t,r]=_.useState(fj());return pr(()=>{r(n=>n??String(dj++))},[e]),t?`radix-${t}`:""}const hj=["top","right","bottom","left"],fi=Math.min,Sn=Math.max,Kd=Math.round,$f=Math.floor,Ya=e=>({x:e,y:e}),mj={left:"right",right:"left",bottom:"top",top:"bottom"},pj={start:"end",end:"start"};function W0(e,t,r){return Sn(e,fi(t,r))}function ks(e,t){return typeof e=="function"?e(t):e}function bs(e){return e.split("-")[0]}function Wl(e){return e.split("-")[1]}function k1(e){return e==="x"?"y":"x"}function b1(e){return e==="y"?"height":"width"}const gj=new Set(["top","bottom"]);function $a(e){return gj.has(bs(e))?"y":"x"}function E1(e){return k1($a(e))}function vj(e,t,r){r===void 0&&(r=!1);const n=Wl(e),a=E1(e),s=b1(a);let i=a==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(i=qd(i)),[i,qd(i)]}function yj(e){const t=qd(e);return[H0(e),t,H0(t)]}function H0(e){return e.replace(/start|end/g,t=>pj[t])}const Mx=["left","right"],Ox=["right","left"],xj=["top","bottom"],wj=["bottom","top"];function _j(e,t,r){switch(e){case"top":case"bottom":return r?t?Ox:Mx:t?Mx:Ox;case"left":case"right":return t?xj:wj;default:return[]}}function Sj(e,t,r,n){const a=Wl(e);let s=_j(bs(e),r==="start",n);return a&&(s=s.map(i=>i+"-"+a),t&&(s=s.concat(s.map(H0)))),s}function qd(e){return e.replace(/left|right|bottom|top/g,t=>mj[t])}function kj(e){return{top:0,right:0,bottom:0,left:0,...e}}function eb(e){return typeof e!="number"?kj(e):{top:e,right:e,bottom:e,left:e}}function Qd(e){const{x:t,y:r,width:n,height:a}=e;return{width:n,height:a,top:r,left:t,right:t+n,bottom:r+a,x:t,y:r}}function Ix(e,t,r){let{reference:n,floating:a}=e;const s=$a(t),i=E1(t),o=b1(i),l=bs(t),u=s==="y",f=n.x+n.width/2-a.width/2,d=n.y+n.height/2-a.height/2,m=n[o]/2-a[o]/2;let h;switch(l){case"top":h={x:f,y:n.y-a.height};break;case"bottom":h={x:f,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:d};break;case"left":h={x:n.x-a.width,y:d};break;default:h={x:n.x,y:n.y}}switch(Wl(t)){case"start":h[i]-=m*(r&&u?-1:1);break;case"end":h[i]+=m*(r&&u?-1:1);break}return h}const bj=async(e,t,r)=>{const{placement:n="bottom",strategy:a="absolute",middleware:s=[],platform:i}=r,o=s.filter(Boolean),l=await(i.isRTL==null?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:a}),{x:f,y:d}=Ix(u,n,l),m=n,h={},v=0;for(let p=0;p<o.length;p++){const{name:g,fn:y}=o[p],{x:w,y:x,data:S,reset:b}=await y({x:f,y:d,initialPlacement:n,placement:m,strategy:a,middlewareData:h,rects:u,platform:i,elements:{reference:e,floating:t}});f=w??f,d=x??d,h={...h,[g]:{...h[g],...S}},b&&v<=50&&(v++,typeof b=="object"&&(b.placement&&(m=b.placement),b.rects&&(u=b.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:a}):b.rects),{x:f,y:d}=Ix(u,m,l)),p=-1)}return{x:f,y:d,placement:m,strategy:a,middlewareData:h}};async function vu(e,t){var r;t===void 0&&(t={});const{x:n,y:a,platform:s,rects:i,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:m=!1,padding:h=0}=ks(t,e),v=eb(h),g=o[m?d==="floating"?"reference":"floating":d],y=Qd(await s.getClippingRect({element:(r=await(s.isElement==null?void 0:s.isElement(g)))==null||r?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:f,strategy:l})),w=d==="floating"?{x:n,y:a,width:i.floating.width,height:i.floating.height}:i.reference,x=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),S=await(s.isElement==null?void 0:s.isElement(x))?await(s.getScale==null?void 0:s.getScale(x))||{x:1,y:1}:{x:1,y:1},b=Qd(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:x,strategy:l}):w);return{top:(y.top-b.top+v.top)/S.y,bottom:(b.bottom-y.bottom+v.bottom)/S.y,left:(y.left-b.left+v.left)/S.x,right:(b.right-y.right+v.right)/S.x}}const Ej=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:a,rects:s,platform:i,elements:o,middlewareData:l}=t,{element:u,padding:f=0}=ks(e,t)||{};if(u==null)return{};const d=eb(f),m={x:r,y:n},h=E1(a),v=b1(h),p=await i.getDimensions(u),g=h==="y",y=g?"top":"left",w=g?"bottom":"right",x=g?"clientHeight":"clientWidth",S=s.reference[v]+s.reference[h]-m[h]-s.floating[v],b=m[h]-s.reference[h],E=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u));let k=E?E[x]:0;(!k||!await(i.isElement==null?void 0:i.isElement(E)))&&(k=o.floating[x]||s.floating[v]);const T=S/2-b/2,N=k/2-p[v]/2-1,O=fi(d[y],N),W=fi(d[w],N),P=O,G=k-p[v]-W,X=k/2-p[v]/2+T,V=W0(P,X,G),K=!l.arrow&&Wl(a)!=null&&X!==V&&s.reference[v]/2-(X<P?O:W)-p[v]/2<0,Y=K?X<P?X-P:X-G:0;return{[h]:m[h]+Y,data:{[h]:V,centerOffset:X-V-Y,...K&&{alignmentOffset:Y}},reset:K}}}),Tj=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:a,middlewareData:s,rects:i,initialPlacement:o,platform:l,elements:u}=t,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:m,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:p=!0,...g}=ks(e,t);if((r=s.arrow)!=null&&r.alignmentOffset)return{};const y=bs(a),w=$a(o),x=bs(o)===o,S=await(l.isRTL==null?void 0:l.isRTL(u.floating)),b=m||(x||!p?[qd(o)]:yj(o)),E=v!=="none";!m&&E&&b.push(...Sj(o,p,v,S));const k=[o,...b],T=await vu(t,g),N=[];let O=((n=s.flip)==null?void 0:n.overflows)||[];if(f&&N.push(T[y]),d){const X=vj(a,i,S);N.push(T[X[0]],T[X[1]])}if(O=[...O,{placement:a,overflows:N}],!N.every(X=>X<=0)){var W,P;const X=(((W=s.flip)==null?void 0:W.index)||0)+1,V=k[X];if(V&&(!(d==="alignment"?w!==$a(V):!1)||O.every(H=>$a(H.placement)===w?H.overflows[0]>0:!0)))return{data:{index:X,overflows:O},reset:{placement:V}};let K=(P=O.filter(Y=>Y.overflows[0]<=0).sort((Y,H)=>Y.overflows[1]-H.overflows[1])[0])==null?void 0:P.placement;if(!K)switch(h){case"bestFit":{var G;const Y=(G=O.filter(H=>{if(E){const M=$a(H.placement);return M===w||M==="y"}return!0}).map(H=>[H.placement,H.overflows.filter(M=>M>0).reduce((M,ne)=>M+ne,0)]).sort((H,M)=>H[1]-M[1])[0])==null?void 0:G[0];Y&&(K=Y);break}case"initialPlacement":K=o;break}if(a!==K)return{reset:{placement:K}}}return{}}}};function Fx(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Lx(e){return hj.some(t=>e[t]>=0)}const Nj=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...a}=ks(e,t);switch(n){case"referenceHidden":{const s=await vu(t,{...a,elementContext:"reference"}),i=Fx(s,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:Lx(i)}}}case"escaped":{const s=await vu(t,{...a,altBoundary:!0}),i=Fx(s,r.floating);return{data:{escapedOffsets:i,escaped:Lx(i)}}}default:return{}}}}},tb=new Set(["left","top"]);async function Cj(e,t){const{placement:r,platform:n,elements:a}=e,s=await(n.isRTL==null?void 0:n.isRTL(a.floating)),i=bs(r),o=Wl(r),l=$a(r)==="y",u=tb.has(i)?-1:1,f=s&&l?-1:1,d=ks(t,e);let{mainAxis:m,crossAxis:h,alignmentAxis:v}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof v=="number"&&(h=o==="end"?v*-1:v),l?{x:h*f,y:m*u}:{x:m*u,y:h*f}}const Aj=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:a,y:s,placement:i,middlewareData:o}=t,l=await Cj(t,e);return i===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:a+l.x,y:s+l.y,data:{...l,placement:i}}}}},Pj=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:a}=t,{mainAxis:s=!0,crossAxis:i=!1,limiter:o={fn:g=>{let{x:y,y:w}=g;return{x:y,y:w}}},...l}=ks(e,t),u={x:r,y:n},f=await vu(t,l),d=$a(bs(a)),m=k1(d);let h=u[m],v=u[d];if(s){const g=m==="y"?"top":"left",y=m==="y"?"bottom":"right",w=h+f[g],x=h-f[y];h=W0(w,h,x)}if(i){const g=d==="y"?"top":"left",y=d==="y"?"bottom":"right",w=v+f[g],x=v-f[y];v=W0(w,v,x)}const p=o.fn({...t,[m]:h,[d]:v});return{...p,data:{x:p.x-r,y:p.y-n,enabled:{[m]:s,[d]:i}}}}}},jj=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:a,rects:s,middlewareData:i}=t,{offset:o=0,mainAxis:l=!0,crossAxis:u=!0}=ks(e,t),f={x:r,y:n},d=$a(a),m=k1(d);let h=f[m],v=f[d];const p=ks(o,t),g=typeof p=="number"?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(l){const x=m==="y"?"height":"width",S=s.reference[m]-s.floating[x]+g.mainAxis,b=s.reference[m]+s.reference[x]-g.mainAxis;h<S?h=S:h>b&&(h=b)}if(u){var y,w;const x=m==="y"?"width":"height",S=tb.has(bs(a)),b=s.reference[d]-s.floating[x]+(S&&((y=i.offset)==null?void 0:y[d])||0)+(S?0:g.crossAxis),E=s.reference[d]+s.reference[x]+(S?0:((w=i.offset)==null?void 0:w[d])||0)-(S?g.crossAxis:0);v<b?v=b:v>E&&(v=E)}return{[m]:h,[d]:v}}}},Dj=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:a,rects:s,platform:i,elements:o}=t,{apply:l=()=>{},...u}=ks(e,t),f=await vu(t,u),d=bs(a),m=Wl(a),h=$a(a)==="y",{width:v,height:p}=s.floating;let g,y;d==="top"||d==="bottom"?(g=d,y=m===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(y=d,g=m==="end"?"top":"bottom");const w=p-f.top-f.bottom,x=v-f.left-f.right,S=fi(p-f[g],w),b=fi(v-f[y],x),E=!t.middlewareData.shift;let k=S,T=b;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(T=x),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(k=w),E&&!m){const O=Sn(f.left,0),W=Sn(f.right,0),P=Sn(f.top,0),G=Sn(f.bottom,0);h?T=v-2*(O!==0||W!==0?O+W:Sn(f.left,f.right)):k=p-2*(P!==0||G!==0?P+G:Sn(f.top,f.bottom))}await l({...t,availableWidth:T,availableHeight:k});const N=await i.getDimensions(o.floating);return v!==N.width||p!==N.height?{reset:{rects:!0}}:{}}}};function $h(){return typeof window<"u"}function Hl(e){return rb(e)?(e.nodeName||"").toLowerCase():"#document"}function An(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Qa(e){var t;return(t=(rb(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function rb(e){return $h()?e instanceof Node||e instanceof An(e).Node:!1}function Sa(e){return $h()?e instanceof Element||e instanceof An(e).Element:!1}function Ka(e){return $h()?e instanceof HTMLElement||e instanceof An(e).HTMLElement:!1}function Bx(e){return!$h()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof An(e).ShadowRoot}const Rj=new Set(["inline","contents"]);function Qu(e){const{overflow:t,overflowX:r,overflowY:n,display:a}=ka(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!Rj.has(a)}const Mj=new Set(["table","td","th"]);function Oj(e){return Mj.has(Hl(e))}const Ij=[":popover-open",":modal"];function Wh(e){return Ij.some(t=>{try{return e.matches(t)}catch{return!1}})}const Fj=["transform","translate","scale","rotate","perspective"],Lj=["transform","translate","scale","rotate","perspective","filter"],Bj=["paint","layout","strict","content"];function T1(e){const t=N1(),r=Sa(e)?ka(e):e;return Fj.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||Lj.some(n=>(r.willChange||"").includes(n))||Bj.some(n=>(r.contain||"").includes(n))}function Uj(e){let t=di(e);for(;Ka(t)&&!Al(t);){if(T1(t))return t;if(Wh(t))return null;t=di(t)}return null}function N1(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const $j=new Set(["html","body","#document"]);function Al(e){return $j.has(Hl(e))}function ka(e){return An(e).getComputedStyle(e)}function Hh(e){return Sa(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function di(e){if(Hl(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Bx(e)&&e.host||Qa(e);return Bx(t)?t.host:t}function nb(e){const t=di(e);return Al(t)?e.ownerDocument?e.ownerDocument.body:e.body:Ka(t)&&Qu(t)?t:nb(t)}function yu(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=nb(e),s=a===((n=e.ownerDocument)==null?void 0:n.body),i=An(a);if(s){const o=z0(i);return t.concat(i,i.visualViewport||[],Qu(a)?a:[],o&&r?yu(o):[])}return t.concat(a,yu(a,[],r))}function z0(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function ab(e){const t=ka(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const a=Ka(e),s=a?e.offsetWidth:r,i=a?e.offsetHeight:n,o=Kd(r)!==s||Kd(n)!==i;return o&&(r=s,n=i),{width:r,height:n,$:o}}function C1(e){return Sa(e)?e:e.contextElement}function ol(e){const t=C1(e);if(!Ka(t))return Ya(1);const r=t.getBoundingClientRect(),{width:n,height:a,$:s}=ab(t);let i=(s?Kd(r.width):r.width)/n,o=(s?Kd(r.height):r.height)/a;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const Wj=Ya(0);function sb(e){const t=An(e);return!N1()||!t.visualViewport?Wj:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Hj(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==An(e)?!1:t}function ao(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),s=C1(e);let i=Ya(1);t&&(n?Sa(n)&&(i=ol(n)):i=ol(e));const o=Hj(s,r,n)?sb(s):Ya(0);let l=(a.left+o.x)/i.x,u=(a.top+o.y)/i.y,f=a.width/i.x,d=a.height/i.y;if(s){const m=An(s),h=n&&Sa(n)?An(n):n;let v=m,p=z0(v);for(;p&&n&&h!==v;){const g=ol(p),y=p.getBoundingClientRect(),w=ka(p),x=y.left+(p.clientLeft+parseFloat(w.paddingLeft))*g.x,S=y.top+(p.clientTop+parseFloat(w.paddingTop))*g.y;l*=g.x,u*=g.y,f*=g.x,d*=g.y,l+=x,u+=S,v=An(p),p=z0(v)}}return Qd({width:f,height:d,x:l,y:u})}function A1(e,t){const r=Hh(e).scrollLeft;return t?t.left+r:ao(Qa(e)).left+r}function ib(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),a=n.left+t.scrollLeft-(r?0:A1(e,n)),s=n.top+t.scrollTop;return{x:a,y:s}}function zj(e){let{elements:t,rect:r,offsetParent:n,strategy:a}=e;const s=a==="fixed",i=Qa(n),o=t?Wh(t.floating):!1;if(n===i||o&&s)return r;let l={scrollLeft:0,scrollTop:0},u=Ya(1);const f=Ya(0),d=Ka(n);if((d||!d&&!s)&&((Hl(n)!=="body"||Qu(i))&&(l=Hh(n)),Ka(n))){const h=ao(n);u=ol(n),f.x=h.x+n.clientLeft,f.y=h.y+n.clientTop}const m=i&&!d&&!s?ib(i,l,!0):Ya(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-l.scrollLeft*u.x+f.x+m.x,y:r.y*u.y-l.scrollTop*u.y+f.y+m.y}}function Vj(e){return Array.from(e.getClientRects())}function Gj(e){const t=Qa(e),r=Hh(e),n=e.ownerDocument.body,a=Sn(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=Sn(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+A1(e);const o=-r.scrollTop;return ka(n).direction==="rtl"&&(i+=Sn(t.clientWidth,n.clientWidth)-a),{width:a,height:s,x:i,y:o}}function Yj(e,t){const r=An(e),n=Qa(e),a=r.visualViewport;let s=n.clientWidth,i=n.clientHeight,o=0,l=0;if(a){s=a.width,i=a.height;const u=N1();(!u||u&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:s,height:i,x:o,y:l}}const Xj=new Set(["absolute","fixed"]);function Kj(e,t){const r=ao(e,!0,t==="fixed"),n=r.top+e.clientTop,a=r.left+e.clientLeft,s=Ka(e)?ol(e):Ya(1),i=e.clientWidth*s.x,o=e.clientHeight*s.y,l=a*s.x,u=n*s.y;return{width:i,height:o,x:l,y:u}}function Ux(e,t,r){let n;if(t==="viewport")n=Yj(e,r);else if(t==="document")n=Gj(Qa(e));else if(Sa(t))n=Kj(t,r);else{const a=sb(e);n={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Qd(n)}function ob(e,t){const r=di(e);return r===t||!Sa(r)||Al(r)?!1:ka(r).position==="fixed"||ob(r,t)}function qj(e,t){const r=t.get(e);if(r)return r;let n=yu(e,[],!1).filter(o=>Sa(o)&&Hl(o)!=="body"),a=null;const s=ka(e).position==="fixed";let i=s?di(e):e;for(;Sa(i)&&!Al(i);){const o=ka(i),l=T1(i);!l&&o.position==="fixed"&&(a=null),(s?!l&&!a:!l&&o.position==="static"&&!!a&&Xj.has(a.position)||Qu(i)&&!l&&ob(e,i))?n=n.filter(f=>f!==i):a=o,i=di(i)}return t.set(e,n),n}function Qj(e){let{element:t,boundary:r,rootBoundary:n,strategy:a}=e;const i=[...r==="clippingAncestors"?Wh(t)?[]:qj(t,this._c):[].concat(r),n],o=i[0],l=i.reduce((u,f)=>{const d=Ux(t,f,a);return u.top=Sn(d.top,u.top),u.right=fi(d.right,u.right),u.bottom=fi(d.bottom,u.bottom),u.left=Sn(d.left,u.left),u},Ux(t,o,a));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Jj(e){const{width:t,height:r}=ab(e);return{width:t,height:r}}function Zj(e,t,r){const n=Ka(t),a=Qa(t),s=r==="fixed",i=ao(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=Ya(0);function u(){l.x=A1(a)}if(n||!n&&!s)if((Hl(t)!=="body"||Qu(a))&&(o=Hh(t)),n){const h=ao(t,!0,s,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else a&&u();s&&!n&&a&&u();const f=a&&!n&&!s?ib(a,o):Ya(0),d=i.left+o.scrollLeft-l.x-f.x,m=i.top+o.scrollTop-l.y-f.y;return{x:d,y:m,width:i.width,height:i.height}}function np(e){return ka(e).position==="static"}function $x(e,t){if(!Ka(e)||ka(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Qa(e)===r&&(r=r.ownerDocument.body),r}function lb(e,t){const r=An(e);if(Wh(e))return r;if(!Ka(e)){let a=di(e);for(;a&&!Al(a);){if(Sa(a)&&!np(a))return a;a=di(a)}return r}let n=$x(e,t);for(;n&&Oj(n)&&np(n);)n=$x(n,t);return n&&Al(n)&&np(n)&&!T1(n)?r:n||Uj(e)||r}const eD=async function(e){const t=this.getOffsetParent||lb,r=this.getDimensions,n=await r(e.floating);return{reference:Zj(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function tD(e){return ka(e).direction==="rtl"}const rD={convertOffsetParentRelativeRectToViewportRelativeRect:zj,getDocumentElement:Qa,getClippingRect:Qj,getOffsetParent:lb,getElementRects:eD,getClientRects:Vj,getDimensions:Jj,getScale:ol,isElement:Sa,isRTL:tD};function cb(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function nD(e,t){let r=null,n;const a=Qa(e);function s(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function i(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const u=e.getBoundingClientRect(),{left:f,top:d,width:m,height:h}=u;if(o||t(),!m||!h)return;const v=$f(d),p=$f(a.clientWidth-(f+m)),g=$f(a.clientHeight-(d+h)),y=$f(f),x={rootMargin:-v+"px "+-p+"px "+-g+"px "+-y+"px",threshold:Sn(0,fi(1,l))||1};let S=!0;function b(E){const k=E[0].intersectionRatio;if(k!==l){if(!S)return i();k?i(!1,k):n=setTimeout(()=>{i(!1,1e-7)},1e3)}k===1&&!cb(u,e.getBoundingClientRect())&&i(),S=!1}try{r=new IntersectionObserver(b,{...x,root:a.ownerDocument})}catch{r=new IntersectionObserver(b,x)}r.observe(e)}return i(!0),s}function aD(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:s=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,u=C1(e),f=a||s?[...u?yu(u):[],...yu(t)]:[];f.forEach(y=>{a&&y.addEventListener("scroll",r,{passive:!0}),s&&y.addEventListener("resize",r)});const d=u&&o?nD(u,r):null;let m=-1,h=null;i&&(h=new ResizeObserver(y=>{let[w]=y;w&&w.target===u&&h&&(h.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var x;(x=h)==null||x.observe(t)})),r()}),u&&!l&&h.observe(u),h.observe(t));let v,p=l?ao(e):null;l&&g();function g(){const y=ao(e);p&&!cb(p,y)&&r(),p=y,v=requestAnimationFrame(g)}return r(),()=>{var y;f.forEach(w=>{a&&w.removeEventListener("scroll",r),s&&w.removeEventListener("resize",r)}),d==null||d(),(y=h)==null||y.disconnect(),h=null,l&&cancelAnimationFrame(v)}}const sD=Aj,iD=Pj,oD=Tj,lD=Dj,cD=Nj,Wx=Ej,uD=jj,fD=(e,t,r)=>{const n=new Map,a={platform:rD,...r},s={...a.platform,_c:n};return bj(e,t,{...a,platform:s})};var dD=typeof document<"u",hD=function(){},_d=dD?_.useLayoutEffect:hD;function Jd(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Jd(e[n],t[n]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,a[n]))return!1;for(n=r;n--!==0;){const s=a[n];if(!(s==="_owner"&&e.$$typeof)&&!Jd(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function ub(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Hx(e,t){const r=ub(e);return Math.round(t*r)/r}function ap(e){const t=_.useRef(e);return _d(()=>{t.current=e}),t}function mD(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:a,elements:{reference:s,floating:i}={},transform:o=!0,whileElementsMounted:l,open:u}=e,[f,d]=_.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[m,h]=_.useState(n);Jd(m,n)||h(n);const[v,p]=_.useState(null),[g,y]=_.useState(null),w=_.useCallback(H=>{H!==E.current&&(E.current=H,p(H))},[]),x=_.useCallback(H=>{H!==k.current&&(k.current=H,y(H))},[]),S=s||v,b=i||g,E=_.useRef(null),k=_.useRef(null),T=_.useRef(f),N=l!=null,O=ap(l),W=ap(a),P=ap(u),G=_.useCallback(()=>{if(!E.current||!k.current)return;const H={placement:t,strategy:r,middleware:m};W.current&&(H.platform=W.current),fD(E.current,k.current,H).then(M=>{const ne={...M,isPositioned:P.current!==!1};X.current&&!Jd(T.current,ne)&&(T.current=ne,xo.flushSync(()=>{d(ne)}))})},[m,t,r,W,P]);_d(()=>{u===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(H=>({...H,isPositioned:!1})))},[u]);const X=_.useRef(!1);_d(()=>(X.current=!0,()=>{X.current=!1}),[]),_d(()=>{if(S&&(E.current=S),b&&(k.current=b),S&&b){if(O.current)return O.current(S,b,G);G()}},[S,b,G,O,N]);const V=_.useMemo(()=>({reference:E,floating:k,setReference:w,setFloating:x}),[w,x]),K=_.useMemo(()=>({reference:S,floating:b}),[S,b]),Y=_.useMemo(()=>{const H={position:r,left:0,top:0};if(!K.floating)return H;const M=Hx(K.floating,f.x),ne=Hx(K.floating,f.y);return o?{...H,transform:"translate("+M+"px, "+ne+"px)",...ub(K.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:M,top:ne}},[r,o,K.floating,f.x,f.y]);return _.useMemo(()=>({...f,update:G,refs:V,elements:K,floatingStyles:Y}),[f,G,V,K,Y])}const pD=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:a}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?Wx({element:n.current,padding:a}).fn(r):{}:n?Wx({element:n,padding:a}).fn(r):{}}}},gD=(e,t)=>({...sD(e),options:[e,t]}),vD=(e,t)=>({...iD(e),options:[e,t]}),yD=(e,t)=>({...uD(e),options:[e,t]}),xD=(e,t)=>({...oD(e),options:[e,t]}),wD=(e,t)=>({...lD(e),options:[e,t]}),_D=(e,t)=>({...cD(e),options:[e,t]}),SD=(e,t)=>({...pD(e),options:[e,t]});var kD="Arrow",fb=_.forwardRef((e,t)=>{const{children:r,width:n=10,height:a=5,...s}=e;return c.jsx(je.svg,{...s,ref:t,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:c.jsx("polygon",{points:"0,0 30,0 15,10"})})});fb.displayName=kD;var bD=fb;function P1(e){const[t,r]=_.useState(void 0);return pr(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const s=a[0];let i,o;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;i=u.inlineSize,o=u.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var j1="Popper",[db,zl]=In(j1),[ED,hb]=db(j1),mb=e=>{const{__scopePopper:t,children:r}=e,[n,a]=_.useState(null);return c.jsx(ED,{scope:t,anchor:n,onAnchorChange:a,children:r})};mb.displayName=j1;var pb="PopperAnchor",gb=_.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...a}=e,s=hb(pb,r),i=_.useRef(null),o=Qe(t,i),l=_.useRef(null);return _.useEffect(()=>{const u=l.current;l.current=(n==null?void 0:n.current)||i.current,u!==l.current&&s.onAnchorChange(l.current)}),n?null:c.jsx(je.div,{...a,ref:o})});gb.displayName=pb;var D1="PopperContent",[TD,ND]=db(D1),vb=_.forwardRef((e,t)=>{var q,ae,oe,se,J,A;const{__scopePopper:r,side:n="bottom",sideOffset:a=0,align:s="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:d="partial",hideWhenDetached:m=!1,updatePositionStrategy:h="optimized",onPlaced:v,...p}=e,g=hb(D1,r),[y,w]=_.useState(null),x=Qe(t,pe=>w(pe)),[S,b]=_.useState(null),E=P1(S),k=(E==null?void 0:E.width)??0,T=(E==null?void 0:E.height)??0,N=n+(s!=="center"?"-"+s:""),O=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},W=Array.isArray(u)?u:[u],P=W.length>0,G={padding:O,boundary:W.filter(AD),altBoundary:P},{refs:X,floatingStyles:V,placement:K,isPositioned:Y,middlewareData:H}=mD({strategy:"fixed",placement:N,whileElementsMounted:(...pe)=>aD(...pe,{animationFrame:h==="always"}),elements:{reference:g.anchor},middleware:[gD({mainAxis:a+T,alignmentAxis:i}),l&&vD({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?yD():void 0,...G}),l&&xD({...G}),wD({...G,apply:({elements:pe,rects:Ne,availableWidth:$e,availableHeight:Me})=>{const{width:xe,height:ht}=Ne.reference,nr=pe.floating.style;nr.setProperty("--radix-popper-available-width",`${$e}px`),nr.setProperty("--radix-popper-available-height",`${Me}px`),nr.setProperty("--radix-popper-anchor-width",`${xe}px`),nr.setProperty("--radix-popper-anchor-height",`${ht}px`)}}),S&&SD({element:S,padding:o}),PD({arrowWidth:k,arrowHeight:T}),m&&_D({strategy:"referenceHidden",...G})]}),[M,ne]=wb(K),ce=ea(v);pr(()=>{Y&&(ce==null||ce())},[Y,ce]);const j=(q=H.arrow)==null?void 0:q.x,z=(ae=H.arrow)==null?void 0:ae.y,L=((oe=H.arrow)==null?void 0:oe.centerOffset)!==0,[U,Q]=_.useState();return pr(()=>{y&&Q(window.getComputedStyle(y).zIndex)},[y]),c.jsx("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:Y?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:U,"--radix-popper-transform-origin":[(se=H.transformOrigin)==null?void 0:se.x,(J=H.transformOrigin)==null?void 0:J.y].join(" "),...((A=H.hide)==null?void 0:A.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:c.jsx(TD,{scope:r,placedSide:M,onArrowChange:b,arrowX:j,arrowY:z,shouldHideArrow:L,children:c.jsx(je.div,{"data-side":M,"data-align":ne,...p,ref:x,style:{...p.style,animation:Y?void 0:"none"}})})})});vb.displayName=D1;var yb="PopperArrow",CD={top:"bottom",right:"left",bottom:"top",left:"right"},xb=_.forwardRef(function(t,r){const{__scopePopper:n,...a}=t,s=ND(yb,n),i=CD[s.placedSide];return c.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:c.jsx(bD,{...a,ref:r,style:{...a.style,display:"block"}})})});xb.displayName=yb;function AD(e){return e!==null}var PD=e=>({name:"transformOrigin",options:e,fn(t){var g,y,w;const{placement:r,rects:n,middlewareData:a}=t,i=((g=a.arrow)==null?void 0:g.centerOffset)!==0,o=i?0:e.arrowWidth,l=i?0:e.arrowHeight,[u,f]=wb(r),d={start:"0%",center:"50%",end:"100%"}[f],m=(((y=a.arrow)==null?void 0:y.x)??0)+o/2,h=(((w=a.arrow)==null?void 0:w.y)??0)+l/2;let v="",p="";return u==="bottom"?(v=i?d:`${m}px`,p=`${-l}px`):u==="top"?(v=i?d:`${m}px`,p=`${n.floating.height+l}px`):u==="right"?(v=`${-l}px`,p=i?d:`${h}px`):u==="left"&&(v=`${n.floating.width+l}px`,p=i?d:`${h}px`),{data:{x:v,y:p}}}});function wb(e){const[t,r="center"]=e.split("-");return[t,r]}var _b=mb,zh=gb,R1=vb,M1=xb,[Vh,Nq]=In("Tooltip",[zl]),O1=zl(),Sb="TooltipProvider",jD=700,zx="tooltip.open",[DD,kb]=Vh(Sb),bb=e=>{const{__scopeTooltip:t,delayDuration:r=jD,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:s}=e,i=_.useRef(!0),o=_.useRef(!1),l=_.useRef(0);return _.useEffect(()=>{const u=l.current;return()=>window.clearTimeout(u)},[]),c.jsx(DD,{scope:t,isOpenDelayedRef:i,delayDuration:r,onOpen:_.useCallback(()=>{window.clearTimeout(l.current),i.current=!1},[]),onClose:_.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:_.useCallback(u=>{o.current=u},[]),disableHoverableContent:a,children:s})};bb.displayName=Sb;var Eb="Tooltip",[Cq,Gh]=Vh(Eb),V0="TooltipTrigger",RD=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=Gh(V0,r),s=kb(V0,r),i=O1(r),o=_.useRef(null),l=Qe(t,o,a.onTriggerChange),u=_.useRef(!1),f=_.useRef(!1),d=_.useCallback(()=>u.current=!1,[]);return _.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),c.jsx(zh,{asChild:!0,...i,children:c.jsx(je.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:l,onPointerMove:Te(e.onPointerMove,m=>{m.pointerType!=="touch"&&!f.current&&!s.isPointerInTransitRef.current&&(a.onTriggerEnter(),f.current=!0)}),onPointerLeave:Te(e.onPointerLeave,()=>{a.onTriggerLeave(),f.current=!1}),onPointerDown:Te(e.onPointerDown,()=>{a.open&&a.onClose(),u.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Te(e.onFocus,()=>{u.current||a.onOpen()}),onBlur:Te(e.onBlur,a.onClose),onClick:Te(e.onClick,a.onClose)})})});RD.displayName=V0;var MD="TooltipPortal",[Aq,OD]=Vh(MD,{forceMount:void 0}),Pl="TooltipContent",Tb=_.forwardRef((e,t)=>{const r=OD(Pl,e.__scopeTooltip),{forceMount:n=r.forceMount,side:a="top",...s}=e,i=Gh(Pl,e.__scopeTooltip);return c.jsx(Ta,{present:n||i.open,children:i.disableHoverableContent?c.jsx(Nb,{side:a,...s,ref:t}):c.jsx(ID,{side:a,...s,ref:t})})}),ID=_.forwardRef((e,t)=>{const r=Gh(Pl,e.__scopeTooltip),n=kb(Pl,e.__scopeTooltip),a=_.useRef(null),s=Qe(t,a),[i,o]=_.useState(null),{trigger:l,onClose:u}=r,f=a.current,{onPointerInTransitChange:d}=n,m=_.useCallback(()=>{o(null),d(!1)},[d]),h=_.useCallback((v,p)=>{const g=v.currentTarget,y={x:v.clientX,y:v.clientY},w=$D(y,g.getBoundingClientRect()),x=WD(y,w),S=HD(p.getBoundingClientRect()),b=VD([...x,...S]);o(b),d(!0)},[d]);return _.useEffect(()=>()=>m(),[m]),_.useEffect(()=>{if(l&&f){const v=g=>h(g,f),p=g=>h(g,l);return l.addEventListener("pointerleave",v),f.addEventListener("pointerleave",p),()=>{l.removeEventListener("pointerleave",v),f.removeEventListener("pointerleave",p)}}},[l,f,h,m]),_.useEffect(()=>{if(i){const v=p=>{const g=p.target,y={x:p.clientX,y:p.clientY},w=(l==null?void 0:l.contains(g))||(f==null?void 0:f.contains(g)),x=!zD(y,i);w?m():x&&(m(),u())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,f,i,u,m]),c.jsx(Nb,{...e,ref:s})}),[FD,LD]=Vh(Eb,{isInside:!1}),BD=X6("TooltipContent"),Nb=_.forwardRef((e,t)=>{const{__scopeTooltip:r,children:n,"aria-label":a,onEscapeKeyDown:s,onPointerDownOutside:i,...o}=e,l=Gh(Pl,r),u=O1(r),{onClose:f}=l;return _.useEffect(()=>(document.addEventListener(zx,f),()=>document.removeEventListener(zx,f)),[f]),_.useEffect(()=>{if(l.trigger){const d=m=>{const h=m.target;h!=null&&h.contains(l.trigger)&&f()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,f]),c.jsx(Ul,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:d=>d.preventDefault(),onDismiss:f,children:c.jsxs(R1,{"data-state":l.stateAttribute,...u,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[c.jsx(BD,{children:n}),c.jsx(FD,{scope:r,isInside:!0,children:c.jsx(gA,{id:l.contentId,role:"tooltip",children:a||n})})]})})});Tb.displayName=Pl;var Cb="TooltipArrow",UD=_.forwardRef((e,t)=>{const{__scopeTooltip:r,...n}=e,a=O1(r);return LD(Cb,r).isInside?null:c.jsx(M1,{...a,...n,ref:t})});UD.displayName=Cb;function $D(e,t){const r=Math.abs(t.top-e.y),n=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,n,a,s)){case s:return"left";case a:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function WD(e,t,r=5){const n=[];switch(t){case"top":n.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":n.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":n.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":n.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return n}function HD(e){const{top:t,right:r,bottom:n,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:n},{x:a,y:n}]}function zD(e,t){const{x:r,y:n}=e;let a=!1;for(let s=0,i=t.length-1;s<t.length;i=s++){const o=t[s],l=t[i],u=o.x,f=o.y,d=l.x,m=l.y;f>n!=m>n&&r<(d-u)*(n-f)/(m-f)+u&&(a=!a)}return a}function VD(e){const t=e.slice();return t.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),GD(t)}function GD(e){if(e.length<=1)return e.slice();const t=[];for(let n=0;n<e.length;n++){const a=e[n];for(;t.length>=2;){const s=t[t.length-1],i=t[t.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let n=e.length-1;n>=0;n--){const a=e[n];for(;r.length>=2;){const s=r[r.length-1],i=r[r.length-2];if((s.x-i.x)*(a.y-i.y)>=(s.y-i.y)*(a.x-i.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var YD=bb,Ab=Tb;const XD=YD,KD=_.forwardRef(({className:e,sideOffset:t=4,...r},n)=>c.jsx(Ab,{ref:n,sideOffset:t,className:Ae("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));KD.displayName=Ab.displayName;var Yh=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Xh=typeof window>"u"||"Deno"in globalThis;function ca(){}function qD(e,t){return typeof e=="function"?e(t):e}function QD(e){return typeof e=="number"&&e>=0&&e!==1/0}function JD(e,t){return Math.max(e+(t||0)-Date.now(),0)}function G0(e,t){return typeof e=="function"?e(t):e}function ZD(e,t){return typeof e=="function"?e(t):e}function Vx(e,t){const{type:r="all",exact:n,fetchStatus:a,predicate:s,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==I1(i,t.options))return!1}else if(!wu(t.queryKey,i))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||a&&a!==t.state.fetchStatus||s&&!s(t))}function Gx(e,t){const{exact:r,status:n,predicate:a,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(r){if(xu(t.options.mutationKey)!==xu(s))return!1}else if(!wu(t.options.mutationKey,s))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function I1(e,t){return((t==null?void 0:t.queryKeyHashFn)||xu)(e)}function xu(e){return JSON.stringify(e,(t,r)=>Y0(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function wu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>wu(e[r],t[r])):!1}function Pb(e,t){if(e===t)return e;const r=Yx(e)&&Yx(t);if(r||Y0(e)&&Y0(t)){const n=r?e:Object.keys(e),a=n.length,s=r?t:Object.keys(t),i=s.length,o=r?[]:{},l=new Set(n);let u=0;for(let f=0;f<i;f++){const d=r?f:s[f];(!r&&l.has(d)||r)&&e[d]===void 0&&t[d]===void 0?(o[d]=void 0,u++):(o[d]=Pb(e[d],t[d]),o[d]===e[d]&&e[d]!==void 0&&u++)}return a===i&&u===a?e:o}return t}function Yx(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Y0(e){if(!Xx(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!Xx(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Xx(e){return Object.prototype.toString.call(e)==="[object Object]"}function eR(e){return new Promise(t=>{setTimeout(t,e)})}function tR(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Pb(e,t):t}function rR(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function nR(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var F1=Symbol();function jb(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===F1?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Bi,Vs,hl,B2,aR=(B2=class extends Yh{constructor(){super();nt(this,Bi);nt(this,Vs);nt(this,hl);Ue(this,hl,t=>{if(!Xh&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){ue(this,Vs)||this.setEventListener(ue(this,hl))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,Vs))==null||t.call(this),Ue(this,Vs,void 0))}setEventListener(t){var r;Ue(this,hl,t),(r=ue(this,Vs))==null||r.call(this),Ue(this,Vs,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){ue(this,Bi)!==t&&(Ue(this,Bi,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof ue(this,Bi)=="boolean"?ue(this,Bi):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Bi=new WeakMap,Vs=new WeakMap,hl=new WeakMap,B2),Db=new aR,ml,Gs,pl,U2,sR=(U2=class extends Yh{constructor(){super();nt(this,ml,!0);nt(this,Gs);nt(this,pl);Ue(this,pl,t=>{if(!Xh&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){ue(this,Gs)||this.setEventListener(ue(this,pl))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,Gs))==null||t.call(this),Ue(this,Gs,void 0))}setEventListener(t){var r;Ue(this,pl,t),(r=ue(this,Gs))==null||r.call(this),Ue(this,Gs,t(this.setOnline.bind(this)))}setOnline(t){ue(this,ml)!==t&&(Ue(this,ml,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return ue(this,ml)}},ml=new WeakMap,Gs=new WeakMap,pl=new WeakMap,U2),Zd=new sR;function iR(){let e,t;const r=new Promise((a,s)=>{e=a,t=s});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),e(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}function oR(e){return Math.min(1e3*2**e,3e4)}function Rb(e){return(e??"online")==="online"?Zd.isOnline():!0}var Mb=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Ob(e){let t=!1,r=0,n;const a=iR(),s=()=>a.status!=="pending",i=p=>{var g;s()||(m(new Mb(p)),(g=e.abort)==null||g.call(e))},o=()=>{t=!0},l=()=>{t=!1},u=()=>Db.isFocused()&&(e.networkMode==="always"||Zd.isOnline())&&e.canRun(),f=()=>Rb(e.networkMode)&&e.canRun(),d=p=>{s()||(n==null||n(),a.resolve(p))},m=p=>{s()||(n==null||n(),a.reject(p))},h=()=>new Promise(p=>{var g;n=y=>{(s()||u())&&p(y)},(g=e.onPause)==null||g.call(e)}).then(()=>{var p;n=void 0,s()||(p=e.onContinue)==null||p.call(e)}),v=()=>{if(s())return;let p;const g=r===0?e.initialPromise:void 0;try{p=g??e.fn()}catch(y){p=Promise.reject(y)}Promise.resolve(p).then(d).catch(y=>{var E;if(s())return;const w=e.retry??(Xh?0:3),x=e.retryDelay??oR,S=typeof x=="function"?x(r,y):x,b=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,y);if(t||!b){m(y);return}r++,(E=e.onFail)==null||E.call(e,r,y),eR(S).then(()=>u()?void 0:h()).then(()=>{t?m(y):v()})})};return{promise:a,status:()=>a.status,cancel:i,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:l,canStart:f,start:()=>(f()?v():h().then(v),a)}}var lR=e=>setTimeout(e,0);function cR(){let e=[],t=0,r=o=>{o()},n=o=>{o()},a=lR;const s=o=>{t?e.push(o):a(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&a(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var qr=cR(),Ui,$2,Ib=($2=class{constructor(){nt(this,Ui)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),QD(this.gcTime)&&Ue(this,Ui,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Xh?1/0:5*60*1e3))}clearGcTimeout(){ue(this,Ui)&&(clearTimeout(ue(this,Ui)),Ue(this,Ui,void 0))}},Ui=new WeakMap,$2),gl,vl,zn,$i,cr,Wu,Wi,ua,as,W2,uR=(W2=class extends Ib{constructor(t){super();nt(this,ua);nt(this,gl);nt(this,vl);nt(this,zn);nt(this,$i);nt(this,cr);nt(this,Wu);nt(this,Wi);Ue(this,Wi,!1),Ue(this,Wu,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ue(this,$i,t.client),Ue(this,zn,ue(this,$i).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ue(this,gl,dR(this.options)),this.state=t.state??ue(this,gl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ue(this,cr))==null?void 0:t.promise}setOptions(t){this.options={...ue(this,Wu),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ue(this,zn).remove(this)}setData(t,r){const n=tR(this.state.data,t,this.options);return Er(this,ua,as).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Er(this,ua,as).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=ue(this,cr))==null?void 0:n.promise;return(a=ue(this,cr))==null||a.cancel(t),r?r.then(ca).catch(ca):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ue(this,gl))}isActive(){return this.observers.some(t=>ZD(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===F1||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>G0(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!JD(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=ue(this,cr))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=ue(this,cr))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ue(this,zn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(ue(this,cr)&&(ue(this,Wi)?ue(this,cr).cancel({revert:!0}):ue(this,cr).cancelRetry()),this.scheduleGc()),ue(this,zn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Er(this,ua,as).call(this,{type:"invalidate"})}async fetch(t,r){var l,u,f,d,m,h,v,p,g,y,w,x;if(this.state.fetchStatus!=="idle"&&((l=ue(this,cr))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(ue(this,cr))return ue(this,cr).continueRetry(),ue(this,cr).promise}if(t&&this.setOptions(t),!this.options.queryFn){const S=this.observers.find(b=>b.options.queryFn);S&&this.setOptions(S.options)}const n=new AbortController,a=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(Ue(this,Wi,!0),n.signal)})},s=()=>{const S=jb(this.options,r),E=(()=>{const k={client:ue(this,$i),queryKey:this.queryKey,meta:this.meta};return a(k),k})();return Ue(this,Wi,!1),this.options.persister?this.options.persister(S,E,this):S(E)},o=(()=>{const S={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:ue(this,$i),state:this.state,fetchFn:s};return a(S),S})();(u=this.options.behavior)==null||u.onFetch(o,this),Ue(this,vl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=o.fetchOptions)==null?void 0:f.meta))&&Er(this,ua,as).call(this,{type:"fetch",meta:(d=o.fetchOptions)==null?void 0:d.meta}),Ue(this,cr,Ob({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,abort:n.abort.bind(n),onFail:(S,b)=>{Er(this,ua,as).call(this,{type:"failed",failureCount:S,error:b})},onPause:()=>{Er(this,ua,as).call(this,{type:"pause"})},onContinue:()=>{Er(this,ua,as).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const S=await ue(this,cr).start();if(S===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(S),(h=(m=ue(this,zn).config).onSuccess)==null||h.call(m,S,this),(p=(v=ue(this,zn).config).onSettled)==null||p.call(v,S,this.state.error,this),S}catch(S){if(S instanceof Mb){if(S.silent)return ue(this,cr).promise;if(S.revert){if(this.setState({...ue(this,vl),fetchStatus:"idle"}),this.state.data===void 0)throw S;return this.state.data}}throw Er(this,ua,as).call(this,{type:"error",error:S}),(y=(g=ue(this,zn).config).onError)==null||y.call(g,S,this),(x=(w=ue(this,zn).config).onSettled)==null||x.call(w,this.state.data,S,this),S}finally{this.scheduleGc()}}},gl=new WeakMap,vl=new WeakMap,zn=new WeakMap,$i=new WeakMap,cr=new WeakMap,Wu=new WeakMap,Wi=new WeakMap,ua=new WeakSet,as=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...fR(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Ue(this,vl,t.manual?a:void 0),a;case"error":const s=t.error;return{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),qr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),ue(this,zn).notify({query:this,type:"updated",action:t})})},W2);function fR(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Rb(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function dR(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Ia,H2,hR=(H2=class extends Yh{constructor(t={}){super();nt(this,Ia);this.config=t,Ue(this,Ia,new Map)}build(t,r,n){const a=r.queryKey,s=r.queryHash??I1(a,r);let i=this.get(s);return i||(i=new uR({client:t,queryKey:a,queryHash:s,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(i)),i}add(t){ue(this,Ia).has(t.queryHash)||(ue(this,Ia).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=ue(this,Ia).get(t.queryHash);r&&(t.destroy(),r===t&&ue(this,Ia).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){qr.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ue(this,Ia).get(t)}getAll(){return[...ue(this,Ia).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Vx(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>Vx(t,n)):r}notify(t){qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){qr.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){qr.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ia=new WeakMap,H2),Fa,Gr,Hi,La,Bs,z2,mR=(z2=class extends Ib{constructor(t){super();nt(this,La);nt(this,Fa);nt(this,Gr);nt(this,Hi);this.mutationId=t.mutationId,Ue(this,Gr,t.mutationCache),Ue(this,Fa,[]),this.state=t.state||pR(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ue(this,Fa).includes(t)||(ue(this,Fa).push(t),this.clearGcTimeout(),ue(this,Gr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ue(this,Fa,ue(this,Fa).filter(r=>r!==t)),this.scheduleGc(),ue(this,Gr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ue(this,Fa).length||(this.state.status==="pending"?this.scheduleGc():ue(this,Gr).remove(this))}continue(){var t;return((t=ue(this,Hi))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,i,o,l,u,f,d,m,h,v,p,g,y,w,x,S,b,E,k,T;const r=()=>{Er(this,La,Bs).call(this,{type:"continue"})};Ue(this,Hi,Ob({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(N,O)=>{Er(this,La,Bs).call(this,{type:"failed",failureCount:N,error:O})},onPause:()=>{Er(this,La,Bs).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ue(this,Gr).canRun(this)}));const n=this.state.status==="pending",a=!ue(this,Hi).canStart();try{if(n)r();else{Er(this,La,Bs).call(this,{type:"pending",variables:t,isPaused:a}),await((i=(s=ue(this,Gr).config).onMutate)==null?void 0:i.call(s,t,this));const O=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,t));O!==this.state.context&&Er(this,La,Bs).call(this,{type:"pending",context:O,variables:t,isPaused:a})}const N=await ue(this,Hi).start();return await((f=(u=ue(this,Gr).config).onSuccess)==null?void 0:f.call(u,N,t,this.state.context,this)),await((m=(d=this.options).onSuccess)==null?void 0:m.call(d,N,t,this.state.context)),await((v=(h=ue(this,Gr).config).onSettled)==null?void 0:v.call(h,N,null,this.state.variables,this.state.context,this)),await((g=(p=this.options).onSettled)==null?void 0:g.call(p,N,null,t,this.state.context)),Er(this,La,Bs).call(this,{type:"success",data:N}),N}catch(N){try{throw await((w=(y=ue(this,Gr).config).onError)==null?void 0:w.call(y,N,t,this.state.context,this)),await((S=(x=this.options).onError)==null?void 0:S.call(x,N,t,this.state.context)),await((E=(b=ue(this,Gr).config).onSettled)==null?void 0:E.call(b,void 0,N,this.state.variables,this.state.context,this)),await((T=(k=this.options).onSettled)==null?void 0:T.call(k,void 0,N,t,this.state.context)),N}finally{Er(this,La,Bs).call(this,{type:"error",error:N})}}finally{ue(this,Gr).runNext(this)}}},Fa=new WeakMap,Gr=new WeakMap,Hi=new WeakMap,La=new WeakSet,Bs=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),qr.batch(()=>{ue(this,Fa).forEach(n=>{n.onMutationUpdate(t)}),ue(this,Gr).notify({mutation:this,type:"updated",action:t})})},z2);function pR(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var os,fa,Hu,V2,gR=(V2=class extends Yh{constructor(t={}){super();nt(this,os);nt(this,fa);nt(this,Hu);this.config=t,Ue(this,os,new Set),Ue(this,fa,new Map),Ue(this,Hu,0)}build(t,r,n){const a=new mR({mutationCache:this,mutationId:++wf(this,Hu)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){ue(this,os).add(t);const r=Wf(t);if(typeof r=="string"){const n=ue(this,fa).get(r);n?n.push(t):ue(this,fa).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ue(this,os).delete(t)){const r=Wf(t);if(typeof r=="string"){const n=ue(this,fa).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&ue(this,fa).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Wf(t);if(typeof r=="string"){const n=ue(this,fa).get(r),a=n==null?void 0:n.find(s=>s.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=Wf(t);if(typeof r=="string"){const a=(n=ue(this,fa).get(r))==null?void 0:n.find(s=>s!==t&&s.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){qr.batch(()=>{ue(this,os).forEach(t=>{this.notify({type:"removed",mutation:t})}),ue(this,os).clear(),ue(this,fa).clear()})}getAll(){return Array.from(ue(this,os))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>Gx(r,n))}findAll(t={}){return this.getAll().filter(r=>Gx(t,r))}notify(t){qr.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return qr.batch(()=>Promise.all(t.map(r=>r.continue().catch(ca))))}},os=new WeakMap,fa=new WeakMap,Hu=new WeakMap,V2);function Wf(e){var t;return(t=e.options.scope)==null?void 0:t.id}function Kx(e){return{onFetch:(t,r)=>{var f,d,m,h,v;const n=t.options,a=(m=(d=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:d.fetchMore)==null?void 0:m.direction,s=((h=t.state.data)==null?void 0:h.pages)||[],i=((v=t.state.data)==null?void 0:v.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let p=!1;const g=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},y=jb(t.options,t.fetchOptions),w=async(x,S,b)=>{if(p)return Promise.reject();if(S==null&&x.pages.length)return Promise.resolve(x);const k=(()=>{const W={client:t.client,queryKey:t.queryKey,pageParam:S,direction:b?"backward":"forward",meta:t.options.meta};return g(W),W})(),T=await y(k),{maxPages:N}=t.options,O=b?nR:rR;return{pages:O(x.pages,T,N),pageParams:O(x.pageParams,S,N)}};if(a&&s.length){const x=a==="backward",S=x?vR:qx,b={pages:s,pageParams:i},E=S(n,b);o=await w(b,E,x)}else{const x=e??s.length;do{const S=l===0?i[0]??n.initialPageParam:qx(n,o);if(l>0&&S==null)break;o=await w(o,S),l++}while(l<x)}return o};t.options.persister?t.fetchFn=()=>{var p,g;return(g=(p=t.options).persister)==null?void 0:g.call(p,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function qx(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function vR(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var Lt,Ys,Xs,yl,xl,Ks,wl,_l,G2,yR=(G2=class{constructor(e={}){nt(this,Lt);nt(this,Ys);nt(this,Xs);nt(this,yl);nt(this,xl);nt(this,Ks);nt(this,wl);nt(this,_l);Ue(this,Lt,e.queryCache||new hR),Ue(this,Ys,e.mutationCache||new gR),Ue(this,Xs,e.defaultOptions||{}),Ue(this,yl,new Map),Ue(this,xl,new Map),Ue(this,Ks,0)}mount(){wf(this,Ks)._++,ue(this,Ks)===1&&(Ue(this,wl,Db.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,Lt).onFocus())})),Ue(this,_l,Zd.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,Lt).onOnline())})))}unmount(){var e,t;wf(this,Ks)._--,ue(this,Ks)===0&&((e=ue(this,wl))==null||e.call(this),Ue(this,wl,void 0),(t=ue(this,_l))==null||t.call(this),Ue(this,_l,void 0))}isFetching(e){return ue(this,Lt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ue(this,Ys).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ue(this,Lt).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=ue(this,Lt).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(G0(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return ue(this,Lt).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=ue(this,Lt).get(n.queryHash),s=a==null?void 0:a.state.data,i=qD(t,s);if(i!==void 0)return ue(this,Lt).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return qr.batch(()=>ue(this,Lt).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=ue(this,Lt).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=ue(this,Lt);qr.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=ue(this,Lt);return qr.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=qr.batch(()=>ue(this,Lt).findAll(e).map(a=>a.cancel(r)));return Promise.all(n).then(ca).catch(ca)}invalidateQueries(e,t={}){return qr.batch(()=>(ue(this,Lt).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=qr.batch(()=>ue(this,Lt).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let s=a.fetch(void 0,r);return r.throwOnError||(s=s.catch(ca)),a.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(n).then(ca)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=ue(this,Lt).build(this,t);return r.isStaleByTime(G0(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ca).catch(ca)}fetchInfiniteQuery(e){return e.behavior=Kx(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ca).catch(ca)}ensureInfiniteQueryData(e){return e.behavior=Kx(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Zd.isOnline()?ue(this,Ys).resumePausedMutations():Promise.resolve()}getQueryCache(){return ue(this,Lt)}getMutationCache(){return ue(this,Ys)}getDefaultOptions(){return ue(this,Xs)}setDefaultOptions(e){Ue(this,Xs,e)}setQueryDefaults(e,t){ue(this,yl).set(xu(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ue(this,yl).values()],r={};return t.forEach(n=>{wu(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){ue(this,xl).set(xu(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ue(this,xl).values()],r={};return t.forEach(n=>{wu(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ue(this,Xs).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=I1(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===F1&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ue(this,Xs).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ue(this,Lt).clear(),ue(this,Ys).clear()}},Lt=new WeakMap,Ys=new WeakMap,Xs=new WeakMap,yl=new WeakMap,xl=new WeakMap,Ks=new WeakMap,wl=new WeakMap,_l=new WeakMap,G2),xR=_.createContext(void 0),wR=({client:e,children:t})=>(_.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(xR.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _u(){return _u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_u.apply(this,arguments)}var Js;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Js||(Js={}));const Qx="popstate";function _R(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return X0("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Lb(a)}return kR(t,r,null,e)}function rr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Fb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function SR(){return Math.random().toString(36).substr(2,8)}function Jx(e,t){return{usr:e.state,key:e.key,idx:t}}function X0(e,t,r,n){return r===void 0&&(r=null),_u({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Vl(t):t,{state:r,key:t&&t.key||n||SR()})}function Lb(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Vl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function kR(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o=Js.Pop,l=null,u=f();u==null&&(u=0,i.replaceState(_u({},i.state,{idx:u}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=Js.Pop;let g=f(),y=g==null?null:g-u;u=g,l&&l({action:o,location:p.location,delta:y})}function m(g,y){o=Js.Push;let w=X0(p.location,g,y);u=f()+1;let x=Jx(w,u),S=p.createHref(w);try{i.pushState(x,"",S)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;a.location.assign(S)}s&&l&&l({action:o,location:p.location,delta:1})}function h(g,y){o=Js.Replace;let w=X0(p.location,g,y);u=f();let x=Jx(w,u),S=p.createHref(w);i.replaceState(x,"",S),s&&l&&l({action:o,location:p.location,delta:0})}function v(g){let y=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof g=="string"?g:Lb(g);return w=w.replace(/ $/,"%20"),rr(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let p={get action(){return o},get location(){return e(a,i)},listen(g){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Qx,d),l=g,()=>{a.removeEventListener(Qx,d),l=null}},createHref(g){return t(a,g)},createURL:v,encodeLocation(g){let y=v(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:m,replace:h,go(g){return i.go(g)}};return p}var Zx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Zx||(Zx={}));function bR(e,t,r){return r===void 0&&(r="/"),ER(e,t,r)}function ER(e,t,r,n){let a=typeof t=="string"?Vl(t):t,s=$b(a.pathname||"/",r);if(s==null)return null;let i=Bb(e);TR(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=LR(s);o=OR(i[l],u)}return o}function Bb(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(rr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=Gi([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(rr(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Bb(s.children,t,f,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:RR(u,s.index),routesMeta:f})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of Ub(s.path))a(s,i,l)}),t}function Ub(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=Ub(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function TR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:MR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const NR=/^:[\w-]+$/,CR=3,AR=2,PR=1,jR=10,DR=-2,ew=e=>e==="*";function RR(e,t){let r=e.split("/"),n=r.length;return r.some(ew)&&(n+=DR),t&&(n+=AR),r.filter(a=>!ew(a)).reduce((a,s)=>a+(NR.test(s)?CR:s===""?PR:jR),n)}function MR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function OR(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=IR({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),m=l.route;if(!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Gi([s,d.pathname]),pathnameBase:WR(Gi([s,d.pathnameBase])),route:m}),d.pathnameBase!=="/"&&(s=Gi([s,d.pathnameBase]))}return i}function IR(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=FR(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((u,f,d)=>{let{paramName:m,isOptional:h}=f;if(m==="*"){let p=o[d]||"";i=s.slice(0,s.length-p.length).replace(/(.)\/+$/,"$1")}const v=o[d];return h&&!v?u[m]=void 0:u[m]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:i,pattern:e}}function FR(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Fb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function LR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Fb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function $b(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function BR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Vl(e):e;return{pathname:r?r.startsWith("/")?r:UR(r,t):t,search:HR(n),hash:zR(a)}}function UR(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function sp(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $R(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Wb(e,t){let r=$R(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Hb(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Vl(e):(a=_u({},e),rr(!a.pathname||!a.pathname.includes("?"),sp("?","pathname","search",a)),rr(!a.pathname||!a.pathname.includes("#"),sp("#","pathname","hash",a)),rr(!a.search||!a.search.includes("#"),sp("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),d-=1;a.pathname=m.join("/")}o=d>=0?t[d]:"/"}let l=BR(a,o),u=i&&i!=="/"&&i.endsWith("/"),f=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}const Gi=e=>e.join("/").replace(/\/\/+/g,"/"),WR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,zR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function VR(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const zb=["post","put","patch","delete"];new Set(zb);const GR=["get",...zb];new Set(GR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Su(){return Su=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Su.apply(this,arguments)}const L1=_.createContext(null),YR=_.createContext(null),Ju=_.createContext(null),Kh=_.createContext(null),_o=_.createContext({outlet:null,matches:[],isDataRoute:!1}),Vb=_.createContext(null);function Zu(){return _.useContext(Kh)!=null}function qh(){return Zu()||rr(!1),_.useContext(Kh).location}function Gb(e){_.useContext(Ju).static||_.useLayoutEffect(e)}function ef(){let{isDataRoute:e}=_.useContext(_o);return e?i8():XR()}function XR(){Zu()||rr(!1);let e=_.useContext(L1),{basename:t,future:r,navigator:n}=_.useContext(Ju),{matches:a}=_.useContext(_o),{pathname:s}=qh(),i=JSON.stringify(Wb(a,r.v7_relativeSplatPath)),o=_.useRef(!1);return Gb(()=>{o.current=!0}),_.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=Hb(u,JSON.parse(i),s,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Gi([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,s,e])}function KR(e,t){return qR(e,t)}function qR(e,t,r,n){Zu()||rr(!1);let{navigator:a}=_.useContext(Ju),{matches:s}=_.useContext(_o),i=s[s.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=qh(),f;if(t){var d;let g=typeof t=="string"?Vl(t):t;l==="/"||(d=g.pathname)!=null&&d.startsWith(l)||rr(!1),f=g}else f=u;let m=f.pathname||"/",h=m;if(l!=="/"){let g=l.replace(/^\//,"").split("/");h="/"+m.replace(/^\//,"").split("/").slice(g.length).join("/")}let v=bR(e,{pathname:h}),p=t8(v&&v.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:Gi([l,a.encodeLocation?a.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?l:Gi([l,a.encodeLocation?a.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),s,r,n);return t&&p?_.createElement(Kh.Provider,{value:{location:Su({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Js.Pop}},p):p}function QR(){let e=s8(),t=VR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),r?_.createElement("pre",{style:a},r):null,null)}const JR=_.createElement(QR,null);class ZR extends _.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?_.createElement(_o.Provider,{value:this.props.routeContext},_.createElement(Vb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function e8(e){let{routeContext:t,match:r,children:n}=e,a=_.useContext(L1);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),_.createElement(_o.Provider,{value:t},n)}function t8(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||rr(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=f),d.route.id){let{loaderData:m,errors:h}=r,v=d.route.loader&&m[d.route.id]===void 0&&(!h||h[d.route.id]===void 0);if(d.route.lazy||v){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((f,d,m)=>{let h,v=!1,p=null,g=null;r&&(h=o&&d.route.id?o[d.route.id]:void 0,p=d.route.errorElement||JR,l&&(u<0&&m===0?(o8("route-fallback"),v=!0,g=null):u===m&&(v=!0,g=d.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,m+1)),w=()=>{let x;return h?x=p:v?x=g:d.route.Component?x=_.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=f,_.createElement(e8,{match:d,routeContext:{outlet:f,matches:y,isDataRoute:r!=null},children:x})};return r&&(d.route.ErrorBoundary||d.route.errorElement||m===0)?_.createElement(ZR,{location:r.location,revalidation:r.revalidation,component:p,error:h,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var Yb=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Yb||{}),Xb=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Xb||{});function r8(e){let t=_.useContext(L1);return t||rr(!1),t}function n8(e){let t=_.useContext(YR);return t||rr(!1),t}function a8(e){let t=_.useContext(_o);return t||rr(!1),t}function Kb(e){let t=a8(),r=t.matches[t.matches.length-1];return r.route.id||rr(!1),r.route.id}function s8(){var e;let t=_.useContext(Vb),r=n8(),n=Kb();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function i8(){let{router:e}=r8(Yb.UseNavigateStable),t=Kb(Xb.UseNavigateStable),r=_.useRef(!1);return Gb(()=>{r.current=!0}),_.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Su({fromRouteId:t},s)))},[e,t])}const tw={};function o8(e,t,r){tw[e]||(tw[e]=!0)}function l8(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function c8(e){let{to:t,replace:r,state:n,relative:a}=e;Zu()||rr(!1);let{future:s,static:i}=_.useContext(Ju),{matches:o}=_.useContext(_o),{pathname:l}=qh(),u=ef(),f=Hb(t,Wb(o,s.v7_relativeSplatPath),l,a==="path"),d=JSON.stringify(f);return _.useEffect(()=>u(JSON.parse(d),{replace:r,state:n,relative:a}),[u,d,a,r,n]),null}function Cc(e){rr(!1)}function u8(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Js.Pop,navigator:s,static:i=!1,future:o}=e;Zu()&&rr(!1);let l=t.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:l,navigator:s,static:i,future:Su({v7_relativeSplatPath:!1},o)}),[l,o,s,i]);typeof n=="string"&&(n=Vl(n));let{pathname:f="/",search:d="",hash:m="",state:h=null,key:v="default"}=n,p=_.useMemo(()=>{let g=$b(f,l);return g==null?null:{location:{pathname:g,search:d,hash:m,state:h,key:v},navigationType:a}},[l,f,d,m,h,v,a]);return p==null?null:_.createElement(Ju.Provider,{value:u},_.createElement(Kh.Provider,{children:r,value:p}))}function f8(e){let{children:t,location:r}=e;return KR(K0(t),r)}new Promise(()=>{});function K0(e,t){t===void 0&&(t=[]);let r=[];return _.Children.forEach(e,(n,a)=>{if(!_.isValidElement(n))return;let s=[...t,a];if(n.type===_.Fragment){r.push.apply(r,K0(n.props.children,s));return}n.type!==Cc&&rr(!1),!n.props.index||!n.props.children||rr(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=K0(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const d8="6";try{window.__reactRouterVersion=d8}catch{}const h8="startTransition",rw=Sg[h8];function m8(e){let{basename:t,children:r,future:n,window:a}=e,s=_.useRef();s.current==null&&(s.current=_R({window:a,v5Compat:!0}));let i=s.current,[o,l]=_.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},f=_.useCallback(d=>{u&&rw?rw(()=>l(d)):l(d)},[l,u]);return _.useLayoutEffect(()=>i.listen(f),[i,f]),_.useEffect(()=>l8(n),[n]),_.createElement(u8,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var nw;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(nw||(nw={}));var aw;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(aw||(aw={}));const qb=_.createContext(void 0),Lo={id:"user1",email:"admin@example.com",full_name:"Admin User",created_at:new Date().toISOString(),updated_at:new Date().toISOString()},vc={user:Lo},p8=({children:e})=>{const[t,r]=_.useState(Lo),[n,a]=_.useState(vc),[s,i]=_.useState(!1),o=async(u,f)=>(r(Lo),a(vc),{data:{user:Lo,session:vc},error:null}),l=async()=>{r(Lo),a(vc)};return _.useEffect(()=>{r(Lo),a(vc)},[]),c.jsx(qb.Provider,{value:{user:t,session:n,loading:s,signIn:o,signOut:l},children:e})},Ht=()=>{const e=_.useContext(qb);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},B1=()=>{const{user:e}=Ht(),[t,r]=_.useState([]),[n,a]=_.useState(!1),[s,i]=_.useState(!0),o=async f=>!!f,l=async()=>{e&&r([{id:"role-1",user_id:e.id,role:"admin",created_at:new Date().toISOString(),updated_at:new Date().toISOString()}])},u=async(f,d)=>{r(m=>{const h=new Date().toISOString();return[...m.filter(p=>p.user_id!==f),{id:`role-${f}`,user_id:f,role:d,created_at:h,updated_at:h}]})};return _.useEffect(()=>{(async()=>{i(!0),e&&(a(!0),await l()),i(!1)})()},[e]),{userRoles:t,isAdmin:n,loading:s,checkIsAdmin:o,assignRole:u,fetchUserRoles:l}},g8="modulepreload",v8=function(e){return"/"+e},sw={},y8=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=v8(l),l in sw)return;sw[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":g8,u||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((m,h)=>{d.addEventListener("load",m),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},Mr="http://localhost:8000/api/v1";function Qb(e){var t,r,n,a;return{id:e.application_id,applicant_id:e.application_id,loan_id:e.loan_id,payment_id:e.payment_id,demand_num:e.demand_num,applicant_name:e.applicant_name,branch_name:e.branch,team_lead:e.tl_name,rm_name:e.rm_name,dealer_name:e.dealer,lender_name:e.lender,lms_status:e.status||"Unknown",field_status:e.status,status:e.status,emi_amount:e.emi_amount,principle_due:0,interest_due:0,demand_date:e.emi_month,emi_month:e.emi_month,user_id:"1",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),ptp_date:e.ptp_date,latest_calling_status:e.calling_status,calling_status:e.calling_status,recent_comments:e.comments.map(s=>({content:s,user_name:"Unknown"})),comments:e.comments,applicant_mobile:"",applicant_address:"",co_applicant_name:"",co_applicant_mobile:"",co_applicant_address:"",guarantor_name:"",guarantor_mobile:"",guarantor_address:"",reference_name:"",reference_mobile:"",reference_address:"",fi_location:"",repayment:"",last_month_bounce:0,collection_rm:"",paid_date:"",applicant_calling_status:((t=e.calling_statuses)==null?void 0:t.applicant)||"Not Called",co_applicant_calling_status:((r=e.calling_statuses)==null?void 0:r.co_applicant)||"Not Called",guarantor_calling_status:((n=e.calling_statuses)==null?void 0:n.guarantor)||"Not Called",reference_calling_status:((a=e.calling_statuses)==null?void 0:a.reference)||"Not Called",disbursement_date:e.disbursement_date||"",loan_amount:e.loan_amount||0,vehicle_status:"",amount_collected:e.amount_collected||0,payment_mode:e.payment_mode||"",calling_statuses:e.calling_statuses||{},house_ownership:e.house_ownership||"",demand_calling_status:e.demand_calling_status||""}}async function ip(e,t="Aug-25"){const r=new URLSearchParams({emi_month:t,search:e,offset:"0",limit:"1"}),n=await fetch(`${Mr}/applications/?${r.toString()}`);if(!n.ok)throw new Error("Failed to fetch application details");const a=await n.json();if(a.results&&a.results.length>0)return Qb(a.results[0]);throw new Error("Application not found")}async function x8(e,t){const{SummaryService:r}=await y8(async()=>{const{SummaryService:n}=await import("./summaryService-Bg4GbFS5.js");return{SummaryService:n}},[]);return r.getSummaryStatus(e,t)}async function w8(){const e=await fetch(`${Mr}/filters/options`);if(!e.ok)throw new Error("Failed to fetch filter options");return e.json()}async function _8(e,t=0,r=20,n={}){const a=new URLSearchParams;a.append("emi_month",e),a.append("offset",t.toString()),a.append("limit",r.toString()),n.search&&a.append("search",n.search),n.branch&&n.branch.length>0&&a.append("branch",n.branch.join(",")),n.teamLead&&n.teamLead.length>0&&a.append("team_lead",n.teamLead.join(",")),n.rm&&n.rm.length>0&&a.append("rm",n.rm.join(",")),n.dealer&&n.dealer.length>0&&a.append("dealer",n.dealer.join(",")),n.lender&&n.lender.length>0&&a.append("lender",n.lender.join(",")),n.status&&n.status.length>0&&a.append("status",n.status.join(",")),n.ptpDate&&n.ptpDate.length>0&&a.append("ptp_date",n.ptpDate.join(",")),n.vehicleStatus&&n.vehicleStatus.length>0&&a.append("vehicle_status",n.vehicleStatus.join(","));const s=await fetch(`${Mr}/applications/?${a.toString()}`);if(!s.ok)throw new Error("Failed to fetch applications");return console.log("API Request URL:",`${Mr}/applications/?${a.toString()}`),console.log("API Response status:",s.status),await s.json()}async function S8(){const e=await fetch(`${Mr}/paidpending-approval/`);if(!e.ok)throw new Error("Failed to fetch pending approvals");return await e.json()}class k8{constructor(){Pa(this,"_single",!1);Pa(this,"_maybeSingle",!1);Pa(this,"_selectFields",[]);Pa(this,"_whereConditions",[]);Pa(this,"_orderBy",null);Pa(this,"_limitValue",null);Pa(this,"_table","");Pa(this,"_operation","select");Pa(this,"_data",null)}from(t){return this._table=t,this}select(...t){return this._selectFields=t.length>0?t:["*"],this._operation="select",this}insert(t){return this._data=t,this._operation="insert",this}update(t){return this._data=t,this._operation="update",this}upsert(t){return this._data=t,this._operation="upsert",this}delete(){return this._operation="delete",this}eq(t,r){return this._whereConditions.push({field:t,operator:"eq",value:r}),this}in(t,r){return this._whereConditions.push({field:t,operator:"in",value:r}),this}gte(t,r){return this._whereConditions.push({field:t,operator:"gte",value:r}),this}lte(t,r){return this._whereConditions.push({field:t,operator:"lte",value:r}),this}order(t,r){return this._orderBy={field:t,ascending:r.ascending},this}limit(t){return this._limitValue=t,this}single(){return this._single=!0,this}maybeSingle(){return this._maybeSingle=!0,this}then(t,r){let n;this._operation==="select"?this._table==="field_status"?this._single||this._maybeSingle?n={data:{status:"1",calling_status:"1"},error:null,count:1}:n={data:[{status:"1",calling_status:"1"}],error:null,count:1}:this._table==="payment_details"?this._single||this._maybeSingle?n={data:{amount_collected:"1000"},error:null,count:1}:n={data:[{amount_collected:"1000"}],error:null,count:1}:this._single||this._maybeSingle?n={data:{},error:null,count:0}:n={data:[],error:null,count:0}:n={data:this._single||this._maybeSingle?null:[],error:null,count:0};const s=(t??(i=>i))(n);return{then:i=>{const o=i?i(s):s;return{then:l=>l?l(o):o}}}}}const Pe={from(e){return new k8},auth:{signOut:async()=>({error:null}),signUp:async e=>({data:{user:{id:"user1",email:e==null?void 0:e.email}},error:null}),admin:{createUser:async e=>({data:{user:{id:"user1",email:e==null?void 0:e.email}},error:null})}},functions:{invoke:async(e,t)=>({data:{successful:1,failed:0,errors:[]},error:null})},channel:e=>({on:()=>({subscribe:()=>({})}),subscribe:()=>({}),unsubscribe:()=>({})}),removeChannel:e=>{}},iw=e=>{if(!e||!e.includes("@"))return e||"Unknown User";const t=e.split("@")[0];return t.includes(".")?t.split(".").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):t.includes("_")?t.split("_").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):t.includes("-")?t.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" "):t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},Gl=()=>{const{user:e}=Ht(),[t,r]=_.useState(new Map),[n,a]=_.useState(!1),s=_.useRef(new Set),i=_.useCallback(async u=>{if(!e||u.length===0)return console.log("No user or empty userIds, returning empty array"),[];const f=u.filter(d=>!t.has(d)&&!s.current.has(d));if(f.length===0){const d=u.map(m=>t.get(m)).filter(Boolean);return console.log("All profiles already cached, returning:",d.length),d}f.forEach(d=>s.current.add(d)),a(!0);try{console.log("=== FETCHING USER PROFILES ==="),console.log("Fetching profiles for user IDs:",f);const{data:d,error:m}=await Pe.from("profiles").select("id, full_name, email").in("id",f);if(m)return console.error("Error fetching user profiles:",m),[];console.log("Fetched profiles from DB:",d),d&&d.length>0&&r(v=>{const p=new Map(v);return d.forEach(g=>{p.set(g.id,g),console.log(`✓ Cached profile: ${g.id} -> name: "${g.full_name}", email: "${g.email}"`)}),p});const h=u.map(v=>{const p=d==null?void 0:d.find(g=>g.id===v);return p||t.get(v)}).filter(Boolean);return console.log("Returning total profiles:",h.length),h}catch(d){return console.error("Exception in fetchProfiles:",d),[]}finally{f.forEach(d=>s.current.delete(d)),a(!1)}},[e,t]),o=_.useCallback((u,f)=>{const d=t.get(u);return console.log("=== GET USER NAME ==="),console.log(`User ID: ${u}`),console.log("Profile from cache:",d),console.log(`Fallback email: ${f}`),d!=null&&d.full_name&&d.full_name.trim()!==""&&d.full_name!=="null"&&d.full_name.toLowerCase()!=="unknown user"?d.full_name.trim():d!=null&&d.email&&d.email.trim()!==""&&d.email!=="null"?iw(d.email.trim()):f&&f.trim()!==""?iw(f.trim()):(console.log(`✗ Returning Unknown User for ${u}`),"Unknown User")},[t]),l=_.useCallback(()=>{console.log("Clearing user profiles cache"),r(new Map),s.current.clear()},[]);return{fetchProfiles:i,getUserName:o,profilesCache:t,loading:n,clearCache:l}},q0=Fh("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ee=_.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...a},s)=>{const i=n?G6:"button";return c.jsx(i,{className:Ae(q0({variant:t,size:r,className:e})),ref:s,...a})});Ee.displayName="Button";var op="focusScope.autoFocusOnMount",lp="focusScope.autoFocusOnUnmount",ow={bubbles:!1,cancelable:!0},b8="FocusScope",Qh=_.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:s,...i}=e,[o,l]=_.useState(null),u=ea(a),f=ea(s),d=_.useRef(null),m=Qe(t,p=>l(p)),h=_.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;_.useEffect(()=>{if(n){let p=function(x){if(h.paused||!o)return;const S=x.target;o.contains(S)?d.current=S:Us(d.current,{select:!0})},g=function(x){if(h.paused||!o)return;const S=x.relatedTarget;S!==null&&(o.contains(S)||Us(d.current,{select:!0}))},y=function(x){if(document.activeElement===document.body)for(const b of x)b.removedNodes.length>0&&Us(o)};document.addEventListener("focusin",p),document.addEventListener("focusout",g);const w=new MutationObserver(y);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",p),document.removeEventListener("focusout",g),w.disconnect()}}},[n,o,h.paused]),_.useEffect(()=>{if(o){cw.add(h);const p=document.activeElement;if(!o.contains(p)){const y=new CustomEvent(op,ow);o.addEventListener(op,u),o.dispatchEvent(y),y.defaultPrevented||(E8(P8(Jb(o)),{select:!0}),document.activeElement===p&&Us(o))}return()=>{o.removeEventListener(op,u),setTimeout(()=>{const y=new CustomEvent(lp,ow);o.addEventListener(lp,f),o.dispatchEvent(y),y.defaultPrevented||Us(p??document.body,{select:!0}),o.removeEventListener(lp,f),cw.remove(h)},0)}}},[o,u,f,h]);const v=_.useCallback(p=>{if(!r&&!n||h.paused)return;const g=p.key==="Tab"&&!p.altKey&&!p.ctrlKey&&!p.metaKey,y=document.activeElement;if(g&&y){const w=p.currentTarget,[x,S]=T8(w);x&&S?!p.shiftKey&&y===S?(p.preventDefault(),r&&Us(x,{select:!0})):p.shiftKey&&y===x&&(p.preventDefault(),r&&Us(S,{select:!0})):y===w&&p.preventDefault()}},[r,n,h.paused]);return c.jsx(je.div,{tabIndex:-1,...i,ref:m,onKeyDown:v})});Qh.displayName=b8;function E8(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(Us(n,{select:t}),document.activeElement!==r)return}function T8(e){const t=Jb(e),r=lw(t,e),n=lw(t.reverse(),e);return[r,n]}function Jb(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function lw(e,t){for(const r of e)if(!N8(r,{upTo:t}))return r}function N8(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function C8(e){return e instanceof HTMLInputElement&&"select"in e}function Us(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&C8(e)&&t&&e.select()}}var cw=A8();function A8(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=uw(e,t),e.unshift(t)},remove(t){var r;e=uw(e,t),(r=e[0])==null||r.resume()}}}function uw(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function P8(e){return e.filter(t=>t.tagName!=="A")}var cp=0;function U1(){_.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??fw()),document.body.insertAdjacentElement("beforeend",e[1]??fw()),cp++,()=>{cp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),cp--}},[])}function fw(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Ua=function(){return Ua=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ua.apply(this,arguments)};function Zb(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function j8(e,t,r){if(r||arguments.length===2)for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}var Sd="right-scroll-bar-position",kd="width-before-scroll-bar",D8="with-scroll-bars-hidden",R8="--removed-body-scroll-bar-size";function up(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function M8(e,t){var r=_.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var a=r.value;a!==n&&(r.value=n,r.callback(n,a))}}}})[0];return r.callback=t,r.facade}var O8=typeof window<"u"?_.useLayoutEffect:_.useEffect,dw=new WeakMap;function I8(e,t){var r=M8(null,function(n){return e.forEach(function(a){return up(a,n)})});return O8(function(){var n=dw.get(r);if(n){var a=new Set(n),s=new Set(e),i=r.current;a.forEach(function(o){s.has(o)||up(o,null)}),s.forEach(function(o){a.has(o)||up(o,i)})}dw.set(r,e)},[e]),r}function F8(e){return e}function L8(e,t){t===void 0&&(t=F8);var r=[],n=!1,a={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(s){var i=t(s,n);return r.push(i),function(){r=r.filter(function(o){return o!==i})}},assignSyncMedium:function(s){for(n=!0;r.length;){var i=r;r=[],i.forEach(s)}r={push:function(o){return s(o)},filter:function(){return r}}},assignMedium:function(s){n=!0;var i=[];if(r.length){var o=r;r=[],o.forEach(s),i=r}var l=function(){var f=i;i=[],f.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),r={push:function(f){i.push(f),u()},filter:function(f){return i=i.filter(f),r}}}};return a}function B8(e){e===void 0&&(e={});var t=L8(null);return t.options=Ua({async:!0,ssr:!1},e),t}var e4=function(e){var t=e.sideCar,r=Zb(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return _.createElement(n,Ua({},r))};e4.isSideCarExport=!0;function U8(e,t){return e.useMedium(t),e4}var t4=B8(),fp=function(){},Jh=_.forwardRef(function(e,t){var r=_.useRef(null),n=_.useState({onScrollCapture:fp,onWheelCapture:fp,onTouchMoveCapture:fp}),a=n[0],s=n[1],i=e.forwardProps,o=e.children,l=e.className,u=e.removeScrollBar,f=e.enabled,d=e.shards,m=e.sideCar,h=e.noRelative,v=e.noIsolation,p=e.inert,g=e.allowPinchZoom,y=e.as,w=y===void 0?"div":y,x=e.gapMode,S=Zb(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),b=m,E=I8([r,t]),k=Ua(Ua({},S),a);return _.createElement(_.Fragment,null,f&&_.createElement(b,{sideCar:t4,removeScrollBar:u,shards:d,noRelative:h,noIsolation:v,inert:p,setCallbacks:s,allowPinchZoom:!!g,lockRef:r,gapMode:x}),i?_.cloneElement(_.Children.only(o),Ua(Ua({},k),{ref:E})):_.createElement(w,Ua({},k,{className:l,ref:E}),o))});Jh.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Jh.classNames={fullWidth:kd,zeroRight:Sd};var $8=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function W8(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=$8();return t&&e.setAttribute("nonce",t),e}function H8(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function z8(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var V8=function(){var e=0,t=null;return{add:function(r){e==0&&(t=W8())&&(H8(t,r),z8(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},G8=function(){var e=V8();return function(t,r){_.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},r4=function(){var e=G8(),t=function(r){var n=r.styles,a=r.dynamic;return e(n,a),null};return t},Y8={left:0,top:0,right:0,gap:0},dp=function(e){return parseInt(e||"",10)||0},X8=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[dp(r),dp(n),dp(a)]},K8=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Y8;var t=X8(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},q8=r4(),ll="data-scroll-locked",Q8=function(e,t,r,n){var a=e.left,s=e.top,i=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(D8,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(ll,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Sd,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(kd,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Sd," .").concat(Sd,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(kd," .").concat(kd,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(ll,`] {
    `).concat(R8,": ").concat(o,`px;
  }
`)},hw=function(){var e=parseInt(document.body.getAttribute(ll)||"0",10);return isFinite(e)?e:0},J8=function(){_.useEffect(function(){return document.body.setAttribute(ll,(hw()+1).toString()),function(){var e=hw()-1;e<=0?document.body.removeAttribute(ll):document.body.setAttribute(ll,e.toString())}},[])},Z8=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,a=n===void 0?"margin":n;J8();var s=_.useMemo(function(){return K8(a)},[a]);return _.createElement(q8,{styles:Q8(s,!t,a,r?"":"!important")})},Q0=!1;if(typeof window<"u")try{var Hf=Object.defineProperty({},"passive",{get:function(){return Q0=!0,!0}});window.addEventListener("test",Hf,Hf),window.removeEventListener("test",Hf,Hf)}catch{Q0=!1}var jo=Q0?{passive:!1}:!1,eM=function(e){return e.tagName==="TEXTAREA"},n4=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!eM(e)&&r[t]==="visible")},tM=function(e){return n4(e,"overflowY")},rM=function(e){return n4(e,"overflowX")},mw=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var a=a4(e,n);if(a){var s=s4(e,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},nM=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},aM=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},a4=function(e,t){return e==="v"?tM(t):rM(t)},s4=function(e,t){return e==="v"?nM(t):aM(t)},sM=function(e,t){return e==="h"&&t==="rtl"?-1:1},iM=function(e,t,r,n,a){var s=sM(e,window.getComputedStyle(t).direction),i=s*n,o=r.target,l=t.contains(o),u=!1,f=i>0,d=0,m=0;do{if(!o)break;var h=s4(e,o),v=h[0],p=h[1],g=h[2],y=p-g-s*v;(v||y)&&a4(e,o)&&(d+=y,m+=v);var w=o.parentNode;o=w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE?w.host:w}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(f&&Math.abs(d)<1||!f&&Math.abs(m)<1)&&(u=!0),u},zf=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},pw=function(e){return[e.deltaX,e.deltaY]},gw=function(e){return e&&"current"in e?e.current:e},oM=function(e,t){return e[0]===t[0]&&e[1]===t[1]},lM=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},cM=0,Do=[];function uM(e){var t=_.useRef([]),r=_.useRef([0,0]),n=_.useRef(),a=_.useState(cM++)[0],s=_.useState(r4)[0],i=_.useRef(e);_.useEffect(function(){i.current=e},[e]),_.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var p=j8([e.lockRef.current],(e.shards||[]).map(gw),!0).filter(Boolean);return p.forEach(function(g){return g.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),p.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var o=_.useCallback(function(p,g){if("touches"in p&&p.touches.length===2||p.type==="wheel"&&p.ctrlKey)return!i.current.allowPinchZoom;var y=zf(p),w=r.current,x="deltaX"in p?p.deltaX:w[0]-y[0],S="deltaY"in p?p.deltaY:w[1]-y[1],b,E=p.target,k=Math.abs(x)>Math.abs(S)?"h":"v";if("touches"in p&&k==="h"&&E.type==="range")return!1;var T=mw(k,E);if(!T)return!0;if(T?b=k:(b=k==="v"?"h":"v",T=mw(k,E)),!T)return!1;if(!n.current&&"changedTouches"in p&&(x||S)&&(n.current=b),!b)return!0;var N=n.current||b;return iM(N,g,p,N==="h"?x:S)},[]),l=_.useCallback(function(p){var g=p;if(!(!Do.length||Do[Do.length-1]!==s)){var y="deltaY"in g?pw(g):zf(g),w=t.current.filter(function(b){return b.name===g.type&&(b.target===g.target||g.target===b.shadowParent)&&oM(b.delta,y)})[0];if(w&&w.should){g.cancelable&&g.preventDefault();return}if(!w){var x=(i.current.shards||[]).map(gw).filter(Boolean).filter(function(b){return b.contains(g.target)}),S=x.length>0?o(g,x[0]):!i.current.noIsolation;S&&g.cancelable&&g.preventDefault()}}},[]),u=_.useCallback(function(p,g,y,w){var x={name:p,delta:g,target:y,should:w,shadowParent:fM(y)};t.current.push(x),setTimeout(function(){t.current=t.current.filter(function(S){return S!==x})},1)},[]),f=_.useCallback(function(p){r.current=zf(p),n.current=void 0},[]),d=_.useCallback(function(p){u(p.type,pw(p),p.target,o(p,e.lockRef.current))},[]),m=_.useCallback(function(p){u(p.type,zf(p),p.target,o(p,e.lockRef.current))},[]);_.useEffect(function(){return Do.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:m}),document.addEventListener("wheel",l,jo),document.addEventListener("touchmove",l,jo),document.addEventListener("touchstart",f,jo),function(){Do=Do.filter(function(p){return p!==s}),document.removeEventListener("wheel",l,jo),document.removeEventListener("touchmove",l,jo),document.removeEventListener("touchstart",f,jo)}},[]);var h=e.removeScrollBar,v=e.inert;return _.createElement(_.Fragment,null,v?_.createElement(s,{styles:lM(a)}):null,h?_.createElement(Z8,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function fM(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const dM=U8(t4,uM);var Zh=_.forwardRef(function(e,t){return _.createElement(Jh,Ua({},e,{ref:t,sideCar:dM}))});Zh.classNames=Jh.classNames;var hM=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Ro=new WeakMap,Vf=new WeakMap,Gf={},hp=0,i4=function(e){return e&&(e.host||i4(e.parentNode))},mM=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=i4(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},pM=function(e,t,r,n){var a=mM(t,Array.isArray(e)?e:[e]);Gf[r]||(Gf[r]=new WeakMap);var s=Gf[r],i=[],o=new Set,l=new Set(a),u=function(d){!d||o.has(d)||(o.add(d),u(d.parentNode))};a.forEach(u);var f=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(m){if(o.has(m))f(m);else try{var h=m.getAttribute(n),v=h!==null&&h!=="false",p=(Ro.get(m)||0)+1,g=(s.get(m)||0)+1;Ro.set(m,p),s.set(m,g),i.push(m),p===1&&v&&Vf.set(m,!0),g===1&&m.setAttribute(r,"true"),v||m.setAttribute(n,"true")}catch(y){console.error("aria-hidden: cannot operate on ",m,y)}})};return f(t),o.clear(),hp++,function(){i.forEach(function(d){var m=Ro.get(d)-1,h=s.get(d)-1;Ro.set(d,m),s.set(d,h),m||(Vf.has(d)||d.removeAttribute(n),Vf.delete(d)),h||d.removeAttribute(r)}),hp--,hp||(Ro=new WeakMap,Ro=new WeakMap,Vf=new WeakMap,Gf={})}},$1=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),a=hM(e);return a?(n.push.apply(n,Array.from(a.querySelectorAll("[aria-live], script"))),pM(n,a,r,"aria-hidden")):function(){return null}},em="Dialog",[o4,Pq]=In(em),[gM,Na]=o4(em),l4=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:s,modal:i=!0}=e,o=_.useRef(null),l=_.useRef(null),[u,f]=Xa({prop:n,defaultProp:a??!1,onChange:s,caller:em});return c.jsx(gM,{scope:t,triggerRef:o,contentRef:l,contentId:Ga(),titleId:Ga(),descriptionId:Ga(),open:u,onOpenChange:f,onOpenToggle:_.useCallback(()=>f(d=>!d),[f]),modal:i,children:r})};l4.displayName=em;var c4="DialogTrigger",u4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Na(c4,r),s=Qe(t,a.triggerRef);return c.jsx(je.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":z1(a.open),...n,ref:s,onClick:Te(e.onClick,a.onOpenToggle)})});u4.displayName=c4;var W1="DialogPortal",[vM,f4]=o4(W1,{forceMount:void 0}),d4=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=e,s=Na(W1,t);return c.jsx(vM,{scope:t,forceMount:r,children:_.Children.map(n,i=>c.jsx(Ta,{present:r||s.open,children:c.jsx(Ku,{asChild:!0,container:a,children:i})}))})};d4.displayName=W1;var eh="DialogOverlay",h4=_.forwardRef((e,t)=>{const r=f4(eh,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=Na(eh,e.__scopeDialog);return s.modal?c.jsx(Ta,{present:n||s.open,children:c.jsx(xM,{...a,ref:t})}):null});h4.displayName=eh;var yM=no("DialogOverlay.RemoveScroll"),xM=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Na(eh,r);return c.jsx(Zh,{as:yM,allowPinchZoom:!0,shards:[a.contentRef],children:c.jsx(je.div,{"data-state":z1(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),so="DialogContent",m4=_.forwardRef((e,t)=>{const r=f4(so,e.__scopeDialog),{forceMount:n=r.forceMount,...a}=e,s=Na(so,e.__scopeDialog);return c.jsx(Ta,{present:n||s.open,children:s.modal?c.jsx(wM,{...a,ref:t}):c.jsx(_M,{...a,ref:t})})});m4.displayName=so;var wM=_.forwardRef((e,t)=>{const r=Na(so,e.__scopeDialog),n=_.useRef(null),a=Qe(t,r.contentRef,n);return _.useEffect(()=>{const s=n.current;if(s)return $1(s)},[]),c.jsx(p4,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Te(e.onCloseAutoFocus,s=>{var i;s.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:Te(e.onPointerDownOutside,s=>{const i=s.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&s.preventDefault()}),onFocusOutside:Te(e.onFocusOutside,s=>s.preventDefault())})}),_M=_.forwardRef((e,t)=>{const r=Na(so,e.__scopeDialog),n=_.useRef(!1),a=_.useRef(!1);return c.jsx(p4,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:s=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((u=r.triggerRef.current)==null?void 0:u.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),p4=_.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:s,...i}=e,o=Na(so,r),l=_.useRef(null),u=Qe(t,l);return U1(),c.jsxs(c.Fragment,{children:[c.jsx(Qh,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:s,children:c.jsx(Ul,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":z1(o.open),...i,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),c.jsxs(c.Fragment,{children:[c.jsx(SM,{titleId:o.titleId}),c.jsx(bM,{contentRef:l,descriptionId:o.descriptionId})]})]})}),H1="DialogTitle",g4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Na(H1,r);return c.jsx(je.h2,{id:a.titleId,...n,ref:t})});g4.displayName=H1;var v4="DialogDescription",y4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Na(v4,r);return c.jsx(je.p,{id:a.descriptionId,...n,ref:t})});y4.displayName=v4;var x4="DialogClose",w4=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,a=Na(x4,r);return c.jsx(je.button,{type:"button",...n,ref:t,onClick:Te(e.onClick,()=>a.onOpenChange(!1))})});w4.displayName=x4;function z1(e){return e?"open":"closed"}var _4="DialogTitleWarning",[jq,S4]=z6(_4,{contentName:so,titleName:H1,docsSlug:"dialog"}),SM=({titleId:e})=>{const t=S4(_4),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return _.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},kM="DialogDescriptionWarning",bM=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${S4(kM).contentName}}.`;return _.useEffect(()=>{var s;const a=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},EM=l4,TM=u4,NM=d4,k4=h4,b4=m4,E4=g4,T4=y4,CM=w4;const So=EM,tf=TM,AM=NM,N4=_.forwardRef(({className:e,...t},r)=>c.jsx(k4,{ref:r,className:Ae("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));N4.displayName=k4.displayName;const _i=_.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(AM,{children:[c.jsx(N4,{}),c.jsxs(b4,{ref:n,className:Ae("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,c.jsxs(CM,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[c.jsx(Ns,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));_i.displayName=b4.displayName;const Si=({className:e,...t})=>c.jsx("div",{className:Ae("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});Si.displayName="DialogHeader";const ko=_.forwardRef(({className:e,...t},r)=>c.jsx(E4,{ref:r,className:Ae("text-lg font-semibold leading-none tracking-tight",e),...t}));ko.displayName=E4.displayName;const rf=_.forwardRef(({className:e,...t},r)=>c.jsx(T4,{ref:r,className:Ae("text-sm text-muted-foreground",e),...t}));rf.displayName=T4.displayName;var PM=_.createContext(void 0);function tm(e){const t=_.useContext(PM);return e||t||"ltr"}var mp="rovingFocusGroup.onEntryFocus",jM={bubbles:!1,cancelable:!0},nf="RovingFocusGroup",[J0,C4,DM]=h1(nf),[RM,rm]=In(nf,[DM]),[MM,OM]=RM(nf),A4=_.forwardRef((e,t)=>c.jsx(J0.Provider,{scope:e.__scopeRovingFocusGroup,children:c.jsx(J0.Slot,{scope:e.__scopeRovingFocusGroup,children:c.jsx(IM,{...e,ref:t})})}));A4.displayName=nf;var IM=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:a=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...d}=e,m=_.useRef(null),h=Qe(t,m),v=tm(s),[p,g]=Xa({prop:i,defaultProp:o??null,onChange:l,caller:nf}),[y,w]=_.useState(!1),x=ea(u),S=C4(r),b=_.useRef(!1),[E,k]=_.useState(0);return _.useEffect(()=>{const T=m.current;if(T)return T.addEventListener(mp,x),()=>T.removeEventListener(mp,x)},[x]),c.jsx(MM,{scope:r,orientation:n,dir:v,loop:a,currentTabStopId:p,onItemFocus:_.useCallback(T=>g(T),[g]),onItemShiftTab:_.useCallback(()=>w(!0),[]),onFocusableItemAdd:_.useCallback(()=>k(T=>T+1),[]),onFocusableItemRemove:_.useCallback(()=>k(T=>T-1),[]),children:c.jsx(je.div,{tabIndex:y||E===0?-1:0,"data-orientation":n,...d,ref:h,style:{outline:"none",...e.style},onMouseDown:Te(e.onMouseDown,()=>{b.current=!0}),onFocus:Te(e.onFocus,T=>{const N=!b.current;if(T.target===T.currentTarget&&N&&!y){const O=new CustomEvent(mp,jM);if(T.currentTarget.dispatchEvent(O),!O.defaultPrevented){const W=S().filter(K=>K.focusable),P=W.find(K=>K.active),G=W.find(K=>K.id===p),V=[P,G,...W].filter(Boolean).map(K=>K.ref.current);D4(V,f)}}b.current=!1}),onBlur:Te(e.onBlur,()=>w(!1))})})}),P4="RovingFocusGroupItem",j4=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:a=!1,tabStopId:s,children:i,...o}=e,l=Ga(),u=s||l,f=OM(P4,r),d=f.currentTabStopId===u,m=C4(r),{onFocusableItemAdd:h,onFocusableItemRemove:v,currentTabStopId:p}=f;return _.useEffect(()=>{if(n)return h(),()=>v()},[n,h,v]),c.jsx(J0.ItemSlot,{scope:r,id:u,focusable:n,active:a,children:c.jsx(je.span,{tabIndex:d?0:-1,"data-orientation":f.orientation,...o,ref:t,onMouseDown:Te(e.onMouseDown,g=>{n?f.onItemFocus(u):g.preventDefault()}),onFocus:Te(e.onFocus,()=>f.onItemFocus(u)),onKeyDown:Te(e.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){f.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const y=BM(g,f.orientation,f.dir);if(y!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let x=m().filter(S=>S.focusable).map(S=>S.ref.current);if(y==="last")x.reverse();else if(y==="prev"||y==="next"){y==="prev"&&x.reverse();const S=x.indexOf(g.currentTarget);x=f.loop?UM(x,S+1):x.slice(S+1)}setTimeout(()=>D4(x))}}),children:typeof i=="function"?i({isCurrentTabStop:d,hasTabStop:p!=null}):i})})});j4.displayName=P4;var FM={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function LM(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function BM(e,t,r){const n=LM(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return FM[n]}function D4(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function UM(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var R4=A4,M4=j4;function V1(e){const t=_.useRef({value:e,previous:e});return _.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var G1="Radio",[$M,O4]=In(G1),[WM,HM]=$M(G1),I4=_.forwardRef((e,t)=>{const{__scopeRadio:r,name:n,checked:a=!1,required:s,disabled:i,value:o="on",onCheck:l,form:u,...f}=e,[d,m]=_.useState(null),h=Qe(t,g=>m(g)),v=_.useRef(!1),p=d?u||!!d.closest("form"):!0;return c.jsxs(WM,{scope:r,checked:a,disabled:i,children:[c.jsx(je.button,{type:"button",role:"radio","aria-checked":a,"data-state":U4(a),"data-disabled":i?"":void 0,disabled:i,value:o,...f,ref:h,onClick:Te(e.onClick,g=>{a||l==null||l(),p&&(v.current=g.isPropagationStopped(),v.current||g.stopPropagation())})}),p&&c.jsx(B4,{control:d,bubbles:!v.current,name:n,value:o,checked:a,required:s,disabled:i,form:u,style:{transform:"translateX(-100%)"}})]})});I4.displayName=G1;var F4="RadioIndicator",L4=_.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:n,...a}=e,s=HM(F4,r);return c.jsx(Ta,{present:n||s.checked,children:c.jsx(je.span,{"data-state":U4(s.checked),"data-disabled":s.disabled?"":void 0,...a,ref:t})})});L4.displayName=F4;var zM="RadioBubbleInput",B4=_.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:n=!0,...a},s)=>{const i=_.useRef(null),o=Qe(i,s),l=V1(r),u=P1(t);return _.useEffect(()=>{const f=i.current;if(!f)return;const d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==r&&h){const v=new Event("click",{bubbles:n});h.call(f,r),f.dispatchEvent(v)}},[l,r,n]),c.jsx(je.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});B4.displayName=zM;function U4(e){return e?"checked":"unchecked"}var VM=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],nm="RadioGroup",[GM,Dq]=In(nm,[rm,O4]),$4=rm(),W4=O4(),[YM,XM]=GM(nm),H4=_.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:n,defaultValue:a,value:s,required:i=!1,disabled:o=!1,orientation:l,dir:u,loop:f=!0,onValueChange:d,...m}=e,h=$4(r),v=tm(u),[p,g]=Xa({prop:s,defaultProp:a??null,onChange:d,caller:nm});return c.jsx(YM,{scope:r,name:n,required:i,disabled:o,value:p,onValueChange:g,children:c.jsx(R4,{asChild:!0,...h,orientation:l,dir:v,loop:f,children:c.jsx(je.div,{role:"radiogroup","aria-required":i,"aria-orientation":l,"data-disabled":o?"":void 0,dir:v,...m,ref:t})})})});H4.displayName=nm;var z4="RadioGroupItem",V4=_.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:n,...a}=e,s=XM(z4,r),i=s.disabled||n,o=$4(r),l=W4(r),u=_.useRef(null),f=Qe(t,u),d=s.value===a.value,m=_.useRef(!1);return _.useEffect(()=>{const h=p=>{VM.includes(p.key)&&(m.current=!0)},v=()=>m.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",v),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",v)}},[]),c.jsx(M4,{asChild:!0,...o,focusable:!i,active:d,children:c.jsx(I4,{disabled:i,required:s.required,checked:d,...l,...a,name:s.name,ref:f,onCheck:()=>s.onValueChange(a.value),onKeyDown:Te(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:Te(a.onFocus,()=>{var h;m.current&&((h=u.current)==null||h.click())})})})});V4.displayName=z4;var KM="RadioGroupIndicator",G4=_.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...n}=e,a=W4(r);return c.jsx(L4,{...a,...n,ref:t})});G4.displayName=KM;var Y4=H4,X4=V4,qM=G4;const am=_.forwardRef(({className:e,...t},r)=>c.jsx(Y4,{className:Ae("grid gap-2",e),...t,ref:r}));am.displayName=Y4.displayName;const ms=_.forwardRef(({className:e,...t},r)=>c.jsx(X4,{ref:r,className:Ae("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:c.jsx(qM,{className:"flex items-center justify-center",children:c.jsx(HA,{className:"h-2.5 w-2.5 fill-current text-current"})})}));ms.displayName=X4.displayName;var QM="Label",K4=_.forwardRef((e,t)=>c.jsx(je.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));K4.displayName=QM;var q4=K4;const JM=Fh("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ke=_.forwardRef(({className:e,...t},r)=>c.jsx(q4,{ref:r,className:Ae(JM(),e),...t}));Ke.displayName=q4.displayName;const qe=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ae("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));qe.displayName="Card";const pt=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ae("flex flex-col space-y-1.5 p-6",e),...t}));pt.displayName="CardHeader";const gt=_.forwardRef(({className:e,...t},r)=>c.jsx("h3",{ref:r,className:Ae("text-2xl font-semibold leading-none tracking-tight",e),...t}));gt.displayName="CardTitle";const Yi=_.forwardRef(({className:e,...t},r)=>c.jsx("p",{ref:r,className:Ae("text-sm text-muted-foreground",e),...t}));Yi.displayName="CardDescription";const Je=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ae("p-6 pt-0",e),...t}));Je.displayName="CardContent";const ZM=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{ref:r,className:Ae("flex items-center p-6 pt-0",e),...t}));ZM.displayName="CardFooter";function tt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function hn(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ar(e,t){const r=tt(e);return isNaN(t)?hn(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function ba(e,t){const r=tt(e);if(isNaN(t))return hn(e,NaN);if(!t)return r;const n=r.getDate(),a=hn(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const s=a.getDate();return n>=s?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const Y1=6048e5,eO=864e5;let tO={};function af(){return tO}function qa(e,t){var o,l,u,f;const r=af(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,a=tt(e),s=a.getDay(),i=(s<n?7:0)+s-n;return a.setDate(a.getDate()-i),a.setHours(0,0,0,0),a}function io(e){return qa(e,{weekStartsOn:1})}function Q4(e){const t=tt(e),r=t.getFullYear(),n=hn(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=io(n),s=hn(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const i=io(s);return t.getTime()>=a.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function oo(e){const t=tt(e);return t.setHours(0,0,0,0),t}function th(e){const t=tt(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Wa(e,t){const r=oo(e),n=oo(t),a=+r-th(r),s=+n-th(n);return Math.round((a-s)/eO)}function rO(e){const t=Q4(e),r=hn(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),io(r)}function Z0(e,t){const r=t*7;return Ar(e,r)}function nO(e,t){return ba(e,t*12)}function aO(e){let t;return e.forEach(function(r){const n=tt(r);(t===void 0||t<n||isNaN(Number(n)))&&(t=n)}),t||new Date(NaN)}function sO(e){let t;return e.forEach(r=>{const n=tt(r);(!t||t>n||isNaN(+n))&&(t=n)}),t||new Date(NaN)}function J4(e){return hn(e,Date.now())}function Ir(e,t){const r=oo(e),n=oo(t);return+r==+n}function X1(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function iO(e){if(!X1(e)&&typeof e!="number")return!1;const t=tt(e);return!isNaN(Number(t))}function ku(e,t){const r=tt(e),n=tt(t),a=r.getFullYear()-n.getFullYear(),s=r.getMonth()-n.getMonth();return a*12+s}function oO(e,t,r){const n=qa(e,r),a=qa(t,r),s=+n-th(n),i=+a-th(a);return Math.round((s-i)/Y1)}function K1(e){const t=tt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function fn(e){const t=tt(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Z4(e){const t=tt(e),r=hn(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function q1(e,t){var o,l,u,f;const r=af(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,a=tt(e),s=a.getDay(),i=(s<n?-7:0)+6-(s-n);return a.setDate(a.getDate()+i),a.setHours(23,59,59,999),a}function eE(e){return q1(e,{weekStartsOn:1})}const lO={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cO=(e,t,r)=>{let n;const a=lO[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function pp(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const uO={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fO={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dO={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hO={date:pp({formats:uO,defaultWidth:"full"}),time:pp({formats:fO,defaultWidth:"full"}),dateTime:pp({formats:dO,defaultWidth:"full"})},mO={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},pO=(e,t,r,n)=>mO[e];function yc(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;a=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[i]}const s=e.argumentCallback?e.argumentCallback(t):t;return a[s]}}const gO={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},vO={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},yO={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},xO={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wO={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},_O={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},SO=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},kO={ordinalNumber:SO,era:yc({values:gO,defaultWidth:"wide"}),quarter:yc({values:vO,defaultWidth:"wide",argumentCallback:e=>e-1}),month:yc({values:yO,defaultWidth:"wide"}),day:yc({values:xO,defaultWidth:"wide"}),dayPeriod:yc({values:wO,defaultWidth:"wide",formattingValues:_O,defaultFormattingWidth:"wide"})};function xc(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const i=s[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?EO(o,d=>d.test(i)):bO(o,d=>d.test(i));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const f=t.slice(i.length);return{value:u,rest:f}}}function bO(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function EO(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function TO(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],s=t.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(a.length);return{value:i,rest:o}}}const NO=/^(\d+)(th|st|nd|rd)?/i,CO=/\d+/i,AO={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},PO={any:[/^b/i,/^(a|c)/i]},jO={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},DO={any:[/1/i,/2/i,/3/i,/4/i]},RO={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},MO={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},OO={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},IO={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},FO={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},LO={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},BO={ordinalNumber:TO({matchPattern:NO,parsePattern:CO,valueCallback:e=>parseInt(e,10)}),era:xc({matchPatterns:AO,defaultMatchWidth:"wide",parsePatterns:PO,defaultParseWidth:"any"}),quarter:xc({matchPatterns:jO,defaultMatchWidth:"wide",parsePatterns:DO,defaultParseWidth:"any",valueCallback:e=>e+1}),month:xc({matchPatterns:RO,defaultMatchWidth:"wide",parsePatterns:MO,defaultParseWidth:"any"}),day:xc({matchPatterns:OO,defaultMatchWidth:"wide",parsePatterns:IO,defaultParseWidth:"any"}),dayPeriod:xc({matchPatterns:FO,defaultMatchWidth:"any",parsePatterns:LO,defaultParseWidth:"any"})},tE={code:"en-US",formatDistance:cO,formatLong:hO,formatRelative:pO,localize:kO,match:BO,options:{weekStartsOn:0,firstWeekContainsDate:1}};function UO(e){const t=tt(e);return Wa(t,Z4(t))+1}function rE(e){const t=tt(e),r=+io(t)-+rO(t);return Math.round(r/Y1)+1}function nE(e,t){var f,d,m,h;const r=tt(e),n=r.getFullYear(),a=af(),s=(t==null?void 0:t.firstWeekContainsDate)??((d=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??a.firstWeekContainsDate??((h=(m=a.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,i=hn(e,0);i.setFullYear(n+1,0,s),i.setHours(0,0,0,0);const o=qa(i,t),l=hn(e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const u=qa(l,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function $O(e,t){var o,l,u,f;const r=af(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,a=nE(e,t),s=hn(e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),qa(s,t)}function aE(e,t){const r=tt(e),n=+qa(r,t)-+$O(r,t);return Math.round(n/Y1)+1}function ot(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Is={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return ot(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):ot(r+1,2)},d(e,t){return ot(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return ot(e.getHours()%12||12,t.length)},H(e,t){return ot(e.getHours(),t.length)},m(e,t){return ot(e.getMinutes(),t.length)},s(e,t){return ot(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return ot(a,t.length)}},Mo={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},vw={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Is.y(e,t)},Y:function(e,t,r,n){const a=nE(e,n),s=a>0?a:1-a;if(t==="YY"){const i=s%100;return ot(i,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):ot(s,t.length)},R:function(e,t){const r=Q4(e);return ot(r,t.length)},u:function(e,t){const r=e.getFullYear();return ot(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return ot(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return ot(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Is.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return ot(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=aE(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):ot(a,t.length)},I:function(e,t,r){const n=rE(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):ot(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Is.d(e,t)},D:function(e,t,r){const n=UO(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ot(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return ot(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return ot(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return ot(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Mo.noon:n===0?a=Mo.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Mo.evening:n>=12?a=Mo.afternoon:n>=4?a=Mo.morning:a=Mo.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Is.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Is.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ot(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):ot(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Is.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Is.s(e,t)},S:function(e,t){return Is.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return xw(n);case"XXXX":case"XX":return Di(n);case"XXXXX":case"XXX":default:return Di(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return xw(n);case"xxxx":case"xx":return Di(n);case"xxxxx":case"xxx":default:return Di(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+yw(n,":");case"OOOO":default:return"GMT"+Di(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+yw(n,":");case"zzzz":default:return"GMT"+Di(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return ot(n,t.length)},T:function(e,t,r){const n=e.getTime();return ot(n,t.length)}};function yw(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+t+ot(s,2)}function xw(e,t){return e%60===0?(e>0?"-":"+")+ot(Math.abs(e)/60,2):Di(e,t)}function Di(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=ot(Math.trunc(n/60),2),s=ot(n%60,2);return r+a+t+s}const ww=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},sE=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},WO=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return ww(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",ww(n,t)).replace("{{time}}",sE(a,t))},HO={p:sE,P:WO},zO=/^D+$/,VO=/^Y+$/,GO=["D","DD","YY","YYYY"];function YO(e){return zO.test(e)}function XO(e){return VO.test(e)}function KO(e,t,r){const n=qO(e,t,r);if(console.warn(n),GO.includes(e))throw new RangeError(n)}function qO(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const QO=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,JO=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ZO=/^'([^]*?)'?$/,eI=/''/g,tI=/[a-zA-Z]/;function vt(e,t,r){var f,d,m,h,v,p,g,y;const n=af(),a=(r==null?void 0:r.locale)??n.locale??tE,s=(r==null?void 0:r.firstWeekContainsDate)??((d=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(m=n.locale)==null?void 0:m.options)==null?void 0:h.firstWeekContainsDate)??1,i=(r==null?void 0:r.weekStartsOn)??((p=(v=r==null?void 0:r.locale)==null?void 0:v.options)==null?void 0:p.weekStartsOn)??n.weekStartsOn??((y=(g=n.locale)==null?void 0:g.options)==null?void 0:y.weekStartsOn)??0,o=tt(e);if(!iO(o))throw new RangeError("Invalid time value");let l=t.match(JO).map(w=>{const x=w[0];if(x==="p"||x==="P"){const S=HO[x];return S(w,a.formatLong)}return w}).join("").match(QO).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const x=w[0];if(x==="'")return{isToken:!1,value:rI(w)};if(vw[x])return{isToken:!0,value:w};if(x.match(tI))throw new RangeError("Format string contains an unescaped latin alphabet character `"+x+"`");return{isToken:!1,value:w}});a.localize.preprocessor&&(l=a.localize.preprocessor(o,l));const u={firstWeekContainsDate:s,weekStartsOn:i,locale:a};return l.map(w=>{if(!w.isToken)return w.value;const x=w.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&XO(x)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&YO(x))&&KO(x,t,String(e));const S=vw[x[0]];return S(o,x,a.localize,u)}).join("")}function rI(e){const t=e.match(ZO);return t?t[1].replace(eI,"'"):e}function nI(e){const t=tt(e),r=t.getFullYear(),n=t.getMonth(),a=hn(e,0);return a.setFullYear(r,n+1,0),a.setHours(0,0,0,0),a.getDate()}function aI(e){return Math.trunc(+tt(e)/1e3)}function sI(e){const t=tt(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function iI(e,t){return oO(sI(e),fn(e),t)+1}function rh(e,t){const r=tt(e),n=tt(t);return r.getTime()>n.getTime()}function Q1(e,t){const r=tt(e),n=tt(t);return+r<+n}function J1(e,t){const r=tt(e),n=tt(t);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function oI(e,t){const r=tt(e),n=tt(t);return r.getFullYear()===n.getFullYear()}function lI(e){return Ir(e,J4(e))}function _w(e){return Ir(e,Ar(J4(e),1))}function gp(e,t){return Ar(e,-t)}function vp(e,t){const r=tt(e),n=r.getFullYear(),a=r.getDate(),s=hn(e,0);s.setFullYear(n,t,15),s.setHours(0,0,0,0);const i=nI(s);return r.setMonth(t,Math.min(a,i)),r}function Sw(e,t){const r=tt(e);return isNaN(+r)?hn(e,NaN):(r.setFullYear(t),r)}var Oe=function(){return Oe=Object.assign||function(t){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Oe.apply(this,arguments)};function cI(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function iE(e,t,r){for(var n=0,a=t.length,s;n<a;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))}function sf(e){return e.mode==="multiple"}function of(e){return e.mode==="range"}function sm(e){return e.mode==="single"}var uI={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function fI(e,t){return vt(e,"LLLL y",t)}function dI(e,t){return vt(e,"d",t)}function hI(e,t){return vt(e,"LLLL",t)}function mI(e){return"".concat(e)}function pI(e,t){return vt(e,"cccccc",t)}function gI(e,t){return vt(e,"yyyy",t)}var vI=Object.freeze({__proto__:null,formatCaption:fI,formatDay:dI,formatMonthCaption:hI,formatWeekNumber:mI,formatWeekdayName:pI,formatYearCaption:gI}),yI=function(e,t,r){return vt(e,"do MMMM (EEEE)",r)},xI=function(){return"Month: "},wI=function(){return"Go to next month"},_I=function(){return"Go to previous month"},SI=function(e,t){return vt(e,"cccc",t)},kI=function(e){return"Week n. ".concat(e)},bI=function(){return"Year: "},EI=Object.freeze({__proto__:null,labelDay:yI,labelMonthDropdown:xI,labelNext:wI,labelPrevious:_I,labelWeekNumber:kI,labelWeekday:SI,labelYearDropdown:bI});function TI(){var e="buttons",t=uI,r=tE,n={},a={},s=1,i={},o=new Date;return{captionLayout:e,classNames:t,formatters:vI,labels:EI,locale:r,modifiersClassNames:n,modifiers:a,numberOfMonths:s,styles:i,today:o,mode:"default"}}function NI(e){var t=e.fromYear,r=e.toYear,n=e.fromMonth,a=e.toMonth,s=e.fromDate,i=e.toDate;return n?s=fn(n):t&&(s=new Date(t,0,1)),a?i=K1(a):r&&(i=new Date(r,11,31)),{fromDate:s?oo(s):void 0,toDate:i?oo(i):void 0}}var oE=_.createContext(void 0);function CI(e){var t,r=e.initialProps,n=TI(),a=NI(r),s=a.fromDate,i=a.toDate,o=(t=r.captionLayout)!==null&&t!==void 0?t:n.captionLayout;o!=="buttons"&&(!s||!i)&&(o="buttons");var l;(sm(r)||sf(r)||of(r))&&(l=r.onSelect);var u=Oe(Oe(Oe({},n),r),{captionLayout:o,classNames:Oe(Oe({},n.classNames),r.classNames),components:Oe({},r.components),formatters:Oe(Oe({},n.formatters),r.formatters),fromDate:s,labels:Oe(Oe({},n.labels),r.labels),mode:r.mode||n.mode,modifiers:Oe(Oe({},n.modifiers),r.modifiers),modifiersClassNames:Oe(Oe({},n.modifiersClassNames),r.modifiersClassNames),onSelect:l,styles:Oe(Oe({},n.styles),r.styles),toDate:i});return c.jsx(oE.Provider,{value:u,children:e.children})}function wt(){var e=_.useContext(oE);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function lE(e){var t=wt(),r=t.locale,n=t.classNames,a=t.styles,s=t.formatters.formatCaption;return c.jsx("div",{className:n.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:s(e.displayMonth,{locale:r})})}function AI(e){return c.jsx("svg",Oe({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:c.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function cE(e){var t,r,n=e.onChange,a=e.value,s=e.children,i=e.caption,o=e.className,l=e.style,u=wt(),f=(r=(t=u.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:AI;return c.jsxs("div",{className:o,style:l,children:[c.jsx("span",{className:u.classNames.vhidden,children:e["aria-label"]}),c.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:a,onChange:n,children:s}),c.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[i,c.jsx(f,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function PI(e){var t,r=wt(),n=r.fromDate,a=r.toDate,s=r.styles,i=r.locale,o=r.formatters.formatMonthCaption,l=r.classNames,u=r.components,f=r.labels.labelMonthDropdown;if(!n)return c.jsx(c.Fragment,{});if(!a)return c.jsx(c.Fragment,{});var d=[];if(oI(n,a))for(var m=fn(n),h=n.getMonth();h<=a.getMonth();h++)d.push(vp(m,h));else for(var m=fn(new Date),h=0;h<=11;h++)d.push(vp(m,h));var v=function(g){var y=Number(g.target.value),w=vp(fn(e.displayMonth),y);e.onChange(w)},p=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:cE;return c.jsx(p,{name:"months","aria-label":f(),className:l.dropdown_month,style:s.dropdown_month,onChange:v,value:e.displayMonth.getMonth(),caption:o(e.displayMonth,{locale:i}),children:d.map(function(g){return c.jsx("option",{value:g.getMonth(),children:o(g,{locale:i})},g.getMonth())})})}function jI(e){var t,r=e.displayMonth,n=wt(),a=n.fromDate,s=n.toDate,i=n.locale,o=n.styles,l=n.classNames,u=n.components,f=n.formatters.formatYearCaption,d=n.labels.labelYearDropdown,m=[];if(!a)return c.jsx(c.Fragment,{});if(!s)return c.jsx(c.Fragment,{});for(var h=a.getFullYear(),v=s.getFullYear(),p=h;p<=v;p++)m.push(Sw(Z4(new Date),p));var g=function(w){var x=Sw(fn(r),Number(w.target.value));e.onChange(x)},y=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:cE;return c.jsx(y,{name:"years","aria-label":d(),className:l.dropdown_year,style:o.dropdown_year,onChange:g,value:r.getFullYear(),caption:f(r,{locale:i}),children:m.map(function(w){return c.jsx("option",{value:w.getFullYear(),children:f(w,{locale:i})},w.getFullYear())})})}function DI(e,t){var r=_.useState(e),n=r[0],a=r[1],s=t===void 0?n:t;return[s,a]}function RI(e){var t=e.month,r=e.defaultMonth,n=e.today,a=t||r||n||new Date,s=e.toDate,i=e.fromDate,o=e.numberOfMonths,l=o===void 0?1:o;if(s&&ku(s,a)<0){var u=-1*(l-1);a=ba(s,u)}return i&&ku(a,i)<0&&(a=i),fn(a)}function MI(){var e=wt(),t=RI(e),r=DI(t,e.month),n=r[0],a=r[1],s=function(i){var o;if(!e.disableNavigation){var l=fn(i);a(l),(o=e.onMonthChange)===null||o===void 0||o.call(e,l)}};return[n,s]}function OI(e,t){for(var r=t.reverseMonths,n=t.numberOfMonths,a=fn(e),s=fn(ba(a,n)),i=ku(s,a),o=[],l=0;l<i;l++){var u=ba(a,l);o.push(u)}return r&&(o=o.reverse()),o}function II(e,t){if(!t.disableNavigation){var r=t.toDate,n=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=n?s:1,o=fn(e);if(!r)return ba(o,i);var l=ku(r,e);if(!(l<s))return ba(o,i)}}function FI(e,t){if(!t.disableNavigation){var r=t.fromDate,n=t.pagedNavigation,a=t.numberOfMonths,s=a===void 0?1:a,i=n?s:1,o=fn(e);if(!r)return ba(o,-i);var l=ku(o,r);if(!(l<=0))return ba(o,-i)}}var uE=_.createContext(void 0);function LI(e){var t=wt(),r=MI(),n=r[0],a=r[1],s=OI(n,t),i=II(n,t),o=FI(n,t),l=function(d){return s.some(function(m){return J1(d,m)})},u=function(d,m){l(d)||(m&&Q1(d,m)?a(ba(d,1+t.numberOfMonths*-1)):a(d))},f={currentMonth:n,displayMonths:s,goToMonth:a,goToDate:u,previousMonth:o,nextMonth:i,isDateDisplayed:l};return c.jsx(uE.Provider,{value:f,children:e.children})}function lf(){var e=_.useContext(uE);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function kw(e){var t,r=wt(),n=r.classNames,a=r.styles,s=r.components,i=lf().goToMonth,o=function(f){i(ba(f,e.displayIndex?-e.displayIndex:0))},l=(t=s==null?void 0:s.CaptionLabel)!==null&&t!==void 0?t:lE,u=c.jsx(l,{id:e.id,displayMonth:e.displayMonth});return c.jsxs("div",{className:n.caption_dropdowns,style:a.caption_dropdowns,children:[c.jsx("div",{className:n.vhidden,children:u}),c.jsx(PI,{onChange:o,displayMonth:e.displayMonth}),c.jsx(jI,{onChange:o,displayMonth:e.displayMonth})]})}function BI(e){return c.jsx("svg",Oe({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:c.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function UI(e){return c.jsx("svg",Oe({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:c.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var nh=_.forwardRef(function(e,t){var r=wt(),n=r.classNames,a=r.styles,s=[n.button_reset,n.button];e.className&&s.push(e.className);var i=s.join(" "),o=Oe(Oe({},a.button_reset),a.button);return e.style&&Object.assign(o,e.style),c.jsx("button",Oe({},e,{ref:t,type:"button",className:i,style:o}))});function $I(e){var t,r,n=wt(),a=n.dir,s=n.locale,i=n.classNames,o=n.styles,l=n.labels,u=l.labelPrevious,f=l.labelNext,d=n.components;if(!e.nextMonth&&!e.previousMonth)return c.jsx(c.Fragment,{});var m=u(e.previousMonth,{locale:s}),h=[i.nav_button,i.nav_button_previous].join(" "),v=f(e.nextMonth,{locale:s}),p=[i.nav_button,i.nav_button_next].join(" "),g=(t=d==null?void 0:d.IconRight)!==null&&t!==void 0?t:UI,y=(r=d==null?void 0:d.IconLeft)!==null&&r!==void 0?r:BI;return c.jsxs("div",{className:i.nav,style:o.nav,children:[!e.hidePrevious&&c.jsx(nh,{name:"previous-month","aria-label":m,className:h,style:o.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?c.jsx(g,{className:i.nav_icon,style:o.nav_icon}):c.jsx(y,{className:i.nav_icon,style:o.nav_icon})}),!e.hideNext&&c.jsx(nh,{name:"next-month","aria-label":v,className:p,style:o.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?c.jsx(y,{className:i.nav_icon,style:o.nav_icon}):c.jsx(g,{className:i.nav_icon,style:o.nav_icon})})]})}function bw(e){var t=wt().numberOfMonths,r=lf(),n=r.previousMonth,a=r.nextMonth,s=r.goToMonth,i=r.displayMonths,o=i.findIndex(function(v){return J1(e.displayMonth,v)}),l=o===0,u=o===i.length-1,f=t>1&&(l||!u),d=t>1&&(u||!l),m=function(){n&&s(n)},h=function(){a&&s(a)};return c.jsx($I,{displayMonth:e.displayMonth,hideNext:f,hidePrevious:d,nextMonth:a,previousMonth:n,onPreviousClick:m,onNextClick:h})}function WI(e){var t,r=wt(),n=r.classNames,a=r.disableNavigation,s=r.styles,i=r.captionLayout,o=r.components,l=(t=o==null?void 0:o.CaptionLabel)!==null&&t!==void 0?t:lE,u;return a?u=c.jsx(l,{id:e.id,displayMonth:e.displayMonth}):i==="dropdown"?u=c.jsx(kw,{displayMonth:e.displayMonth,id:e.id}):i==="dropdown-buttons"?u=c.jsxs(c.Fragment,{children:[c.jsx(kw,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),c.jsx(bw,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):u=c.jsxs(c.Fragment,{children:[c.jsx(l,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),c.jsx(bw,{displayMonth:e.displayMonth,id:e.id})]}),c.jsx("div",{className:n.caption,style:s.caption,children:u})}function HI(e){var t=wt(),r=t.footer,n=t.styles,a=t.classNames.tfoot;return r?c.jsx("tfoot",{className:a,style:n.tfoot,children:c.jsx("tr",{children:c.jsx("td",{colSpan:8,children:r})})}):c.jsx(c.Fragment,{})}function zI(e,t,r){for(var n=r?io(new Date):qa(new Date,{locale:e,weekStartsOn:t}),a=[],s=0;s<7;s++){var i=Ar(n,s);a.push(i)}return a}function VI(){var e=wt(),t=e.classNames,r=e.styles,n=e.showWeekNumber,a=e.locale,s=e.weekStartsOn,i=e.ISOWeek,o=e.formatters.formatWeekdayName,l=e.labels.labelWeekday,u=zI(a,s,i);return c.jsxs("tr",{style:r.head_row,className:t.head_row,children:[n&&c.jsx("td",{style:r.head_cell,className:t.head_cell}),u.map(function(f,d){return c.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":l(f,{locale:a}),children:o(f,{locale:a})},d)})]})}function GI(){var e,t=wt(),r=t.classNames,n=t.styles,a=t.components,s=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:VI;return c.jsx("thead",{style:n.head,className:r.head,children:c.jsx(s,{})})}function YI(e){var t=wt(),r=t.locale,n=t.formatters.formatDay;return c.jsx(c.Fragment,{children:n(e.date,{locale:r})})}var Z1=_.createContext(void 0);function XI(e){if(!sf(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return c.jsx(Z1.Provider,{value:t,children:e.children})}return c.jsx(KI,{initialProps:e.initialProps,children:e.children})}function KI(e){var t=e.initialProps,r=e.children,n=t.selected,a=t.min,s=t.max,i=function(u,f,d){var m,h;(m=t.onDayClick)===null||m===void 0||m.call(t,u,f,d);var v=!!(f.selected&&a&&(n==null?void 0:n.length)===a);if(!v){var p=!!(!f.selected&&s&&(n==null?void 0:n.length)===s);if(!p){var g=n?iE([],n):[];if(f.selected){var y=g.findIndex(function(w){return Ir(u,w)});g.splice(y,1)}else g.push(u);(h=t.onSelect)===null||h===void 0||h.call(t,g,u,f,d)}}},o={disabled:[]};n&&o.disabled.push(function(u){var f=s&&n.length>s-1,d=n.some(function(m){return Ir(m,u)});return!!(f&&!d)});var l={selected:n,onDayClick:i,modifiers:o};return c.jsx(Z1.Provider,{value:l,children:r})}function ev(){var e=_.useContext(Z1);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function qI(e,t){var r=t||{},n=r.from,a=r.to;return n&&a?Ir(a,e)&&Ir(n,e)?void 0:Ir(a,e)?{from:a,to:void 0}:Ir(n,e)?void 0:rh(n,e)?{from:e,to:a}:{from:n,to:e}:a?rh(e,a)?{from:a,to:e}:{from:e,to:a}:n?Q1(e,n)?{from:e,to:n}:{from:n,to:e}:{from:e,to:void 0}}var tv=_.createContext(void 0);function QI(e){if(!of(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return c.jsx(tv.Provider,{value:t,children:e.children})}return c.jsx(JI,{initialProps:e.initialProps,children:e.children})}function JI(e){var t=e.initialProps,r=e.children,n=t.selected,a=n||{},s=a.from,i=a.to,o=t.min,l=t.max,u=function(h,v,p){var g,y;(g=t.onDayClick)===null||g===void 0||g.call(t,h,v,p);var w=qI(h,n);(y=t.onSelect)===null||y===void 0||y.call(t,w,h,v,p)},f={range_start:[],range_end:[],range_middle:[],disabled:[]};if(s?(f.range_start=[s],i?(f.range_end=[i],Ir(s,i)||(f.range_middle=[{after:s,before:i}])):f.range_end=[s]):i&&(f.range_start=[i],f.range_end=[i]),o&&(s&&!i&&f.disabled.push({after:gp(s,o-1),before:Ar(s,o-1)}),s&&i&&f.disabled.push({after:s,before:Ar(s,o-1)}),!s&&i&&f.disabled.push({after:gp(i,o-1),before:Ar(i,o-1)})),l){if(s&&!i&&(f.disabled.push({before:Ar(s,-l+1)}),f.disabled.push({after:Ar(s,l-1)})),s&&i){var d=Wa(i,s)+1,m=l-d;f.disabled.push({before:gp(s,m)}),f.disabled.push({after:Ar(i,m)})}!s&&i&&(f.disabled.push({before:Ar(i,-l+1)}),f.disabled.push({after:Ar(i,l-1)}))}return c.jsx(tv.Provider,{value:{selected:n,onDayClick:u,modifiers:f},children:r})}function rv(){var e=_.useContext(tv);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function bd(e){return Array.isArray(e)?iE([],e):e!==void 0?[e]:[]}function ZI(e){var t={};return Object.entries(e).forEach(function(r){var n=r[0],a=r[1];t[n]=bd(a)}),t}var Ea;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Ea||(Ea={}));var eF=Ea.Selected,ns=Ea.Disabled,tF=Ea.Hidden,rF=Ea.Today,yp=Ea.RangeEnd,xp=Ea.RangeMiddle,wp=Ea.RangeStart,nF=Ea.Outside;function aF(e,t,r){var n,a=(n={},n[eF]=bd(e.selected),n[ns]=bd(e.disabled),n[tF]=bd(e.hidden),n[rF]=[e.today],n[yp]=[],n[xp]=[],n[wp]=[],n[nF]=[],n);return e.fromDate&&a[ns].push({before:e.fromDate}),e.toDate&&a[ns].push({after:e.toDate}),sf(e)?a[ns]=a[ns].concat(t.modifiers[ns]):of(e)&&(a[ns]=a[ns].concat(r.modifiers[ns]),a[wp]=r.modifiers[wp],a[xp]=r.modifiers[xp],a[yp]=r.modifiers[yp]),a}var fE=_.createContext(void 0);function sF(e){var t=wt(),r=ev(),n=rv(),a=aF(t,r,n),s=ZI(t.modifiers),i=Oe(Oe({},a),s);return c.jsx(fE.Provider,{value:i,children:e.children})}function dE(){var e=_.useContext(fE);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function iF(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function oF(e){return!!(e&&typeof e=="object"&&"from"in e)}function lF(e){return!!(e&&typeof e=="object"&&"after"in e)}function cF(e){return!!(e&&typeof e=="object"&&"before"in e)}function uF(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function fF(e,t){var r,n=t.from,a=t.to;if(n&&a){var s=Wa(a,n)<0;s&&(r=[a,n],n=r[0],a=r[1]);var i=Wa(e,n)>=0&&Wa(a,e)>=0;return i}return a?Ir(a,e):n?Ir(n,e):!1}function dF(e){return X1(e)}function hF(e){return Array.isArray(e)&&e.every(X1)}function mF(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(dF(r))return Ir(e,r);if(hF(r))return r.includes(e);if(oF(r))return fF(e,r);if(uF(r))return r.dayOfWeek.includes(e.getDay());if(iF(r)){var n=Wa(r.before,e),a=Wa(r.after,e),s=n>0,i=a<0,o=rh(r.before,r.after);return o?i&&s:s||i}return lF(r)?Wa(e,r.after)>0:cF(r)?Wa(r.before,e)>0:typeof r=="function"?r(e):!1})}function nv(e,t,r){var n=Object.keys(t).reduce(function(s,i){var o=t[i];return mF(e,o)&&s.push(i),s},[]),a={};return n.forEach(function(s){return a[s]=!0}),r&&!J1(e,r)&&(a.outside=!0),a}function pF(e,t){for(var r=fn(e[0]),n=K1(e[e.length-1]),a,s,i=r;i<=n;){var o=nv(i,t),l=!o.disabled&&!o.hidden;if(!l){i=Ar(i,1);continue}if(o.selected)return i;o.today&&!s&&(s=i),a||(a=i),i=Ar(i,1)}return s||a}var gF=365;function hE(e,t){var r=t.moveBy,n=t.direction,a=t.context,s=t.modifiers,i=t.retry,o=i===void 0?{count:0,lastFocused:e}:i,l=a.weekStartsOn,u=a.fromDate,f=a.toDate,d=a.locale,m={day:Ar,week:Z0,month:ba,year:nO,startOfWeek:function(g){return a.ISOWeek?io(g):qa(g,{locale:d,weekStartsOn:l})},endOfWeek:function(g){return a.ISOWeek?eE(g):q1(g,{locale:d,weekStartsOn:l})}},h=m[r](e,n==="after"?1:-1);n==="before"&&u?h=aO([u,h]):n==="after"&&f&&(h=sO([f,h]));var v=!0;if(s){var p=nv(h,s);v=!p.disabled&&!p.hidden}return v?h:o.count>gF?o.lastFocused:hE(h,{moveBy:r,direction:n,context:a,modifiers:s,retry:Oe(Oe({},o),{count:o.count+1})})}var mE=_.createContext(void 0);function vF(e){var t=lf(),r=dE(),n=_.useState(),a=n[0],s=n[1],i=_.useState(),o=i[0],l=i[1],u=pF(t.displayMonths,r),f=a??(o&&t.isDateDisplayed(o))?o:u,d=function(){l(a),s(void 0)},m=function(g){s(g)},h=wt(),v=function(g,y){if(a){var w=hE(a,{moveBy:g,direction:y,context:h,modifiers:r});Ir(a,w)||(t.goToDate(w,a),m(w))}},p={focusedDay:a,focusTarget:f,blur:d,focus:m,focusDayAfter:function(){return v("day","after")},focusDayBefore:function(){return v("day","before")},focusWeekAfter:function(){return v("week","after")},focusWeekBefore:function(){return v("week","before")},focusMonthBefore:function(){return v("month","before")},focusMonthAfter:function(){return v("month","after")},focusYearBefore:function(){return v("year","before")},focusYearAfter:function(){return v("year","after")},focusStartOfWeek:function(){return v("startOfWeek","before")},focusEndOfWeek:function(){return v("endOfWeek","after")}};return c.jsx(mE.Provider,{value:p,children:e.children})}function av(){var e=_.useContext(mE);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function yF(e,t){var r=dE(),n=nv(e,r,t);return n}var sv=_.createContext(void 0);function xF(e){if(!sm(e.initialProps)){var t={selected:void 0};return c.jsx(sv.Provider,{value:t,children:e.children})}return c.jsx(wF,{initialProps:e.initialProps,children:e.children})}function wF(e){var t=e.initialProps,r=e.children,n=function(s,i,o){var l,u,f;if((l=t.onDayClick)===null||l===void 0||l.call(t,s,i,o),i.selected&&!t.required){(u=t.onSelect)===null||u===void 0||u.call(t,void 0,s,i,o);return}(f=t.onSelect)===null||f===void 0||f.call(t,s,s,i,o)},a={selected:t.selected,onDayClick:n};return c.jsx(sv.Provider,{value:a,children:r})}function pE(){var e=_.useContext(sv);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function _F(e,t){var r=wt(),n=pE(),a=ev(),s=rv(),i=av(),o=i.focusDayAfter,l=i.focusDayBefore,u=i.focusWeekAfter,f=i.focusWeekBefore,d=i.blur,m=i.focus,h=i.focusMonthBefore,v=i.focusMonthAfter,p=i.focusYearBefore,g=i.focusYearAfter,y=i.focusStartOfWeek,w=i.focusEndOfWeek,x=function(Y){var H,M,ne,ce;sm(r)?(H=n.onDayClick)===null||H===void 0||H.call(n,e,t,Y):sf(r)?(M=a.onDayClick)===null||M===void 0||M.call(a,e,t,Y):of(r)?(ne=s.onDayClick)===null||ne===void 0||ne.call(s,e,t,Y):(ce=r.onDayClick)===null||ce===void 0||ce.call(r,e,t,Y)},S=function(Y){var H;m(e),(H=r.onDayFocus)===null||H===void 0||H.call(r,e,t,Y)},b=function(Y){var H;d(),(H=r.onDayBlur)===null||H===void 0||H.call(r,e,t,Y)},E=function(Y){var H;(H=r.onDayMouseEnter)===null||H===void 0||H.call(r,e,t,Y)},k=function(Y){var H;(H=r.onDayMouseLeave)===null||H===void 0||H.call(r,e,t,Y)},T=function(Y){var H;(H=r.onDayPointerEnter)===null||H===void 0||H.call(r,e,t,Y)},N=function(Y){var H;(H=r.onDayPointerLeave)===null||H===void 0||H.call(r,e,t,Y)},O=function(Y){var H;(H=r.onDayTouchCancel)===null||H===void 0||H.call(r,e,t,Y)},W=function(Y){var H;(H=r.onDayTouchEnd)===null||H===void 0||H.call(r,e,t,Y)},P=function(Y){var H;(H=r.onDayTouchMove)===null||H===void 0||H.call(r,e,t,Y)},G=function(Y){var H;(H=r.onDayTouchStart)===null||H===void 0||H.call(r,e,t,Y)},X=function(Y){var H;(H=r.onDayKeyUp)===null||H===void 0||H.call(r,e,t,Y)},V=function(Y){var H;switch(Y.key){case"ArrowLeft":Y.preventDefault(),Y.stopPropagation(),r.dir==="rtl"?o():l();break;case"ArrowRight":Y.preventDefault(),Y.stopPropagation(),r.dir==="rtl"?l():o();break;case"ArrowDown":Y.preventDefault(),Y.stopPropagation(),u();break;case"ArrowUp":Y.preventDefault(),Y.stopPropagation(),f();break;case"PageUp":Y.preventDefault(),Y.stopPropagation(),Y.shiftKey?p():h();break;case"PageDown":Y.preventDefault(),Y.stopPropagation(),Y.shiftKey?g():v();break;case"Home":Y.preventDefault(),Y.stopPropagation(),y();break;case"End":Y.preventDefault(),Y.stopPropagation(),w();break}(H=r.onDayKeyDown)===null||H===void 0||H.call(r,e,t,Y)},K={onClick:x,onFocus:S,onBlur:b,onKeyDown:V,onKeyUp:X,onMouseEnter:E,onMouseLeave:k,onPointerEnter:T,onPointerLeave:N,onTouchCancel:O,onTouchEnd:W,onTouchMove:P,onTouchStart:G};return K}function SF(){var e=wt(),t=pE(),r=ev(),n=rv(),a=sm(e)?t.selected:sf(e)?r.selected:of(e)?n.selected:void 0;return a}function kF(e){return Object.values(Ea).includes(e)}function bF(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(n){var a=e.modifiersClassNames[n];if(a)r.push(a);else if(kF(n)){var s=e.classNames["day_".concat(n)];s&&r.push(s)}}),r}function EF(e,t){var r=Oe({},e.styles.day);return Object.keys(t).forEach(function(n){var a;r=Oe(Oe({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[n])}),r}function TF(e,t,r){var n,a,s,i=wt(),o=av(),l=yF(e,t),u=_F(e,l),f=SF(),d=!!(i.onDayClick||i.mode!=="default");_.useEffect(function(){var E;l.outside||o.focusedDay&&d&&Ir(o.focusedDay,e)&&((E=r.current)===null||E===void 0||E.focus())},[o.focusedDay,e,r,d,l.outside]);var m=bF(i,l).join(" "),h=EF(i,l),v=!!(l.outside&&!i.showOutsideDays||l.hidden),p=(s=(a=i.components)===null||a===void 0?void 0:a.DayContent)!==null&&s!==void 0?s:YI,g=c.jsx(p,{date:e,displayMonth:t,activeModifiers:l}),y={style:h,className:m,children:g,role:"gridcell"},w=o.focusTarget&&Ir(o.focusTarget,e)&&!l.outside,x=o.focusedDay&&Ir(o.focusedDay,e),S=Oe(Oe(Oe({},y),(n={disabled:l.disabled,role:"gridcell"},n["aria-selected"]=l.selected,n.tabIndex=x||w?0:-1,n)),u),b={isButton:d,isHidden:v,activeModifiers:l,selectedDays:f,buttonProps:S,divProps:y};return b}function NF(e){var t=_.useRef(null),r=TF(e.date,e.displayMonth,t);return r.isHidden?c.jsx("div",{role:"gridcell"}):r.isButton?c.jsx(nh,Oe({name:"day",ref:t},r.buttonProps)):c.jsx("div",Oe({},r.divProps))}function CF(e){var t=e.number,r=e.dates,n=wt(),a=n.onWeekNumberClick,s=n.styles,i=n.classNames,o=n.locale,l=n.labels.labelWeekNumber,u=n.formatters.formatWeekNumber,f=u(Number(t),{locale:o});if(!a)return c.jsx("span",{className:i.weeknumber,style:s.weeknumber,children:f});var d=l(Number(t),{locale:o}),m=function(h){a(t,r,h)};return c.jsx(nh,{name:"week-number","aria-label":d,className:i.weeknumber,style:s.weeknumber,onClick:m,children:f})}function AF(e){var t,r,n=wt(),a=n.styles,s=n.classNames,i=n.showWeekNumber,o=n.components,l=(t=o==null?void 0:o.Day)!==null&&t!==void 0?t:NF,u=(r=o==null?void 0:o.WeekNumber)!==null&&r!==void 0?r:CF,f;return i&&(f=c.jsx("td",{className:s.cell,style:a.cell,children:c.jsx(u,{number:e.weekNumber,dates:e.dates})})),c.jsxs("tr",{className:s.row,style:a.row,children:[f,e.dates.map(function(d){return c.jsx("td",{className:s.cell,style:a.cell,role:"presentation",children:c.jsx(l,{displayMonth:e.displayMonth,date:d})},aI(d))})]})}function Ew(e,t,r){for(var n=r!=null&&r.ISOWeek?eE(t):q1(t,r),a=r!=null&&r.ISOWeek?io(e):qa(e,r),s=Wa(n,a),i=[],o=0;o<=s;o++)i.push(Ar(a,o));var l=i.reduce(function(u,f){var d=r!=null&&r.ISOWeek?rE(f):aE(f,r),m=u.find(function(h){return h.weekNumber===d});return m?(m.dates.push(f),u):(u.push({weekNumber:d,dates:[f]}),u)},[]);return l}function PF(e,t){var r=Ew(fn(e),K1(e),t);if(t!=null&&t.useFixedWeeks){var n=iI(e,t);if(n<6){var a=r[r.length-1],s=a.dates[a.dates.length-1],i=Z0(s,6-n),o=Ew(Z0(s,1),i,t);r.push.apply(r,o)}}return r}function jF(e){var t,r,n,a=wt(),s=a.locale,i=a.classNames,o=a.styles,l=a.hideHead,u=a.fixedWeeks,f=a.components,d=a.weekStartsOn,m=a.firstWeekContainsDate,h=a.ISOWeek,v=PF(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:h,locale:s,weekStartsOn:d,firstWeekContainsDate:m}),p=(t=f==null?void 0:f.Head)!==null&&t!==void 0?t:GI,g=(r=f==null?void 0:f.Row)!==null&&r!==void 0?r:AF,y=(n=f==null?void 0:f.Footer)!==null&&n!==void 0?n:HI;return c.jsxs("table",{id:e.id,className:i.table,style:o.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!l&&c.jsx(p,{}),c.jsx("tbody",{className:i.tbody,style:o.tbody,children:v.map(function(w){return c.jsx(g,{displayMonth:e.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),c.jsx(y,{displayMonth:e.displayMonth})]})}function DF(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var RF=DF()?_.useLayoutEffect:_.useEffect,_p=!1,MF=0;function Tw(){return"react-day-picker-".concat(++MF)}function OF(e){var t,r=e??(_p?Tw():null),n=_.useState(r),a=n[0],s=n[1];return RF(function(){a===null&&s(Tw())},[]),_.useEffect(function(){_p===!1&&(_p=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function IF(e){var t,r,n=wt(),a=n.dir,s=n.classNames,i=n.styles,o=n.components,l=lf().displayMonths,u=OF(n.id?"".concat(n.id,"-").concat(e.displayIndex):void 0),f=n.id?"".concat(n.id,"-grid-").concat(e.displayIndex):void 0,d=[s.month],m=i.month,h=e.displayIndex===0,v=e.displayIndex===l.length-1,p=!h&&!v;a==="rtl"&&(t=[h,v],v=t[0],h=t[1]),h&&(d.push(s.caption_start),m=Oe(Oe({},m),i.caption_start)),v&&(d.push(s.caption_end),m=Oe(Oe({},m),i.caption_end)),p&&(d.push(s.caption_between),m=Oe(Oe({},m),i.caption_between));var g=(r=o==null?void 0:o.Caption)!==null&&r!==void 0?r:WI;return c.jsxs("div",{className:d.join(" "),style:m,children:[c.jsx(g,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),c.jsx(jF,{id:f,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function FF(e){var t=wt(),r=t.classNames,n=t.styles;return c.jsx("div",{className:r.months,style:n.months,children:e.children})}function LF(e){var t,r,n=e.initialProps,a=wt(),s=av(),i=lf(),o=_.useState(!1),l=o[0],u=o[1];_.useEffect(function(){a.initialFocus&&s.focusTarget&&(l||(s.focus(s.focusTarget),u(!0)))},[a.initialFocus,l,s.focus,s.focusTarget,s]);var f=[a.classNames.root,a.className];a.numberOfMonths>1&&f.push(a.classNames.multiple_months),a.showWeekNumber&&f.push(a.classNames.with_weeknumber);var d=Oe(Oe({},a.styles.root),a.style),m=Object.keys(n).filter(function(v){return v.startsWith("data-")}).reduce(function(v,p){var g;return Oe(Oe({},v),(g={},g[p]=n[p],g))},{}),h=(r=(t=n.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:FF;return c.jsx("div",Oe({className:f.join(" "),style:d,dir:a.dir,id:a.id,nonce:n.nonce,title:n.title,lang:n.lang},m,{children:c.jsx(h,{children:i.displayMonths.map(function(v,p){return c.jsx(IF,{displayIndex:p,displayMonth:v},p)})})}))}function BF(e){var t=e.children,r=cI(e,["children"]);return c.jsx(CI,{initialProps:r,children:c.jsx(LI,{children:c.jsx(xF,{initialProps:r,children:c.jsx(XI,{initialProps:r,children:c.jsx(QI,{initialProps:r,children:c.jsx(sF,{children:c.jsx(vF,{children:t})})})})})})})}function UF(e){return c.jsx(BF,Oe({},e,{children:c.jsx(LF,{initialProps:e})}))}function gE({className:e,classNames:t,showOutsideDays:r=!0,...n}){return c.jsx(UF,{showOutsideDays:r,className:Ae("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ae(q0({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ae(q0({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>c.jsx(v1,{className:"h-4 w-4"}),IconRight:({...a})=>c.jsx(Lh,{className:"h-4 w-4"})},...n})}gE.displayName="Calendar";var im="Popover",[vE,Rq]=In(im,[zl]),cf=zl(),[$F,ki]=vE(im),yE=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:s,modal:i=!1}=e,o=cf(t),l=_.useRef(null),[u,f]=_.useState(!1),[d,m]=Xa({prop:n,defaultProp:a??!1,onChange:s,caller:im});return c.jsx(_b,{...o,children:c.jsx($F,{scope:t,contentId:Ga(),triggerRef:l,open:d,onOpenChange:m,onOpenToggle:_.useCallback(()=>m(h=>!h),[m]),hasCustomAnchor:u,onCustomAnchorAdd:_.useCallback(()=>f(!0),[]),onCustomAnchorRemove:_.useCallback(()=>f(!1),[]),modal:i,children:r})})};yE.displayName=im;var xE="PopoverAnchor",WF=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=ki(xE,r),s=cf(r),{onCustomAnchorAdd:i,onCustomAnchorRemove:o}=a;return _.useEffect(()=>(i(),()=>o()),[i,o]),c.jsx(zh,{...s,...n,ref:t})});WF.displayName=xE;var wE="PopoverTrigger",_E=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=ki(wE,r),s=cf(r),i=Qe(t,a.triggerRef),o=c.jsx(je.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":TE(a.open),...n,ref:i,onClick:Te(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:c.jsx(zh,{asChild:!0,...s,children:o})});_E.displayName=wE;var iv="PopoverPortal",[HF,zF]=vE(iv,{forceMount:void 0}),SE=e=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=e,s=ki(iv,t);return c.jsx(HF,{scope:t,forceMount:r,children:c.jsx(Ta,{present:r||s.open,children:c.jsx(Ku,{asChild:!0,container:a,children:n})})})};SE.displayName=iv;var jl="PopoverContent",kE=_.forwardRef((e,t)=>{const r=zF(jl,e.__scopePopover),{forceMount:n=r.forceMount,...a}=e,s=ki(jl,e.__scopePopover);return c.jsx(Ta,{present:n||s.open,children:s.modal?c.jsx(GF,{...a,ref:t}):c.jsx(YF,{...a,ref:t})})});kE.displayName=jl;var VF=no("PopoverContent.RemoveScroll"),GF=_.forwardRef((e,t)=>{const r=ki(jl,e.__scopePopover),n=_.useRef(null),a=Qe(t,n),s=_.useRef(!1);return _.useEffect(()=>{const i=n.current;if(i)return $1(i)},[]),c.jsx(Zh,{as:VF,allowPinchZoom:!0,children:c.jsx(bE,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Te(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),s.current||(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Te(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,u=o.button===2||l;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Te(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1})})})}),YF=_.forwardRef((e,t)=>{const r=ki(jl,e.__scopePopover),n=_.useRef(!1),a=_.useRef(!1);return c.jsx(bE,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,s),s.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),s.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:s=>{var l,u;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(n.current=!0,s.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const i=s.target;((u=r.triggerRef.current)==null?void 0:u.contains(i))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&a.current&&s.preventDefault()}})}),bE=_.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:s,disableOutsidePointerEvents:i,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:f,...d}=e,m=ki(jl,r),h=cf(r);return U1(),c.jsx(Qh,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:s,children:c.jsx(Ul,{asChild:!0,disableOutsidePointerEvents:i,onInteractOutside:f,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>m.onOpenChange(!1),children:c.jsx(R1,{"data-state":TE(m.open),role:"dialog",id:m.contentId,...h,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),EE="PopoverClose",XF=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=ki(EE,r);return c.jsx(je.button,{type:"button",...n,ref:t,onClick:Te(e.onClick,()=>a.onOpenChange(!1))})});XF.displayName=EE;var KF="PopoverArrow",qF=_.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,a=cf(r);return c.jsx(M1,{...a,...n,ref:t})});qF.displayName=KF;function TE(e){return e?"open":"closed"}var QF=yE,JF=_E,ZF=SE,NE=kE;const CE=QF,AE=JF,ov=_.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},a)=>c.jsx(ZF,{children:c.jsx(NE,{ref:a,align:t,sideOffset:r,className:Ae("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));ov.displayName=NE.displayName;const eL=({selectedDateTime:e,onDateTimeChange:t})=>{const[r,n]=_.useState(!1),[a,s]=_.useState(e||void 0),[i,o]=_.useState(e?vt(e,"HH:mm"):"10:30"),l=f=>{if(s(f),f){const[d,m]=i.split(":").map(Number),h=new Date(f);h.setHours(d,m,0,0),t(h)}else t(null)},u=f=>{if(o(f),a){const[d,m]=f.split(":").map(Number),h=new Date(a);h.setHours(d,m,0,0),t(h)}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-sm text-gray-600",children:[c.jsx("p",{className:"font-medium mb-2",children:"Plan vs Achievement Report"}),c.jsx("p",{children:"Select the planned date and time to compare against current data. This will show applications that had PTP dates set for the selected date as of the planned time, and compare their status and PTP changes until now."})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Planned Date"}),c.jsxs(CE,{open:r,onOpenChange:n,children:[c.jsx(AE,{asChild:!0,children:c.jsxs(Ee,{variant:"outline",className:Ae("w-full justify-start text-left font-normal",!a&&"text-muted-foreground"),children:[c.jsx(Fi,{className:"mr-2 h-4 w-4"}),a?vt(a,"PPP"):"Pick a date"]})}),c.jsx(ov,{className:"w-auto p-0",align:"start",children:c.jsx(gE,{mode:"single",selected:a,onSelect:l,initialFocus:!0})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Planned Time"}),c.jsxs("div",{className:"relative",children:[c.jsx(wd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"time",value:i,onChange:f=>u(f.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e&&c.jsxs("div",{className:"p-3 bg-blue-50 rounded-md",children:[c.jsxs("p",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Selected:"})," ",vt(e,"PPP 'at' HH:mm")]}),c.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"This will compare data as of this time vs current state"})]})]})]})},tL=({onExportFull:e,onExportPtpComments:t,onExportPlanVsAchievement:r})=>{const[n,a]=_.useState("ptp-comments"),[s,i]=_.useState(!1),[o,l]=_.useState(null),u=()=>{n==="full"?(e(),i(!1)):n==="ptp-comments"?(t(),i(!1)):n==="plan-vs-achievement"&&o&&(r(o),i(!1))},f=n!=="plan-vs-achievement"||o!==null;return c.jsxs(So,{open:s,onOpenChange:i,children:[c.jsx(tf,{asChild:!0,children:c.jsxs(Ee,{variant:"outline",size:"sm",className:"h-8 text-xs",children:[c.jsx(Ss,{className:"h-3 w-3 mr-1"}),"Export"]})}),c.jsxs(_i,{className:"sm:max-w-[500px] max-h-[80vh] overflow-y-auto",children:[c.jsx(Si,{children:c.jsx(ko,{children:"Export Report"})}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs(am,{value:n,onValueChange:d=>a(d),children:[c.jsxs(qe,{className:`cursor-pointer transition-colors ${n==="ptp-comments"?"ring-2 ring-blue-500":""}`,children:[c.jsx(pt,{className:"pb-3",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"ptp-comments",id:"ptp-comments"}),c.jsx(Ke,{htmlFor:"ptp-comments",className:"cursor-pointer",children:c.jsx(gt,{className:"text-sm",children:"PTP + Comments Report"})})]})}),c.jsx(Je,{className:"pt-0",children:c.jsx(Yi,{className:"text-xs",children:"Simplified report with: Applicant ID, Branch Name, RM Name, Dealer Name, Applicant Name, PTP Date, and Comment Trail"})})]}),c.jsxs(qe,{className:`cursor-pointer transition-colors ${n==="plan-vs-achievement"?"ring-2 ring-blue-500":""}`,children:[c.jsx(pt,{className:"pb-3",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"plan-vs-achievement",id:"plan-vs-achievement"}),c.jsx(Ke,{htmlFor:"plan-vs-achievement",className:"cursor-pointer",children:c.jsx(gt,{className:"text-sm",children:"Plan vs Achievement Report"})})]})}),c.jsx(Je,{className:"pt-0",children:c.jsx(Yi,{className:"text-xs",children:"Compare planned follow-ups (PTP dates set for a specific date/time) vs actual achievements including status and comment changes"})})]}),c.jsxs(qe,{className:`cursor-pointer transition-colors ${n==="full"?"ring-2 ring-blue-500":""}`,children:[c.jsx(pt,{className:"pb-3",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"full",id:"full"}),c.jsx(Ke,{htmlFor:"full",className:"cursor-pointer",children:c.jsx(gt,{className:"text-sm",children:"Full Report"})})]})}),c.jsx(Je,{className:"pt-0",children:c.jsx(Yi,{className:"text-xs",children:"Complete report with all available fields including contact details, financial information, and status"})})]})]}),n==="plan-vs-achievement"&&c.jsx(eL,{selectedDateTime:o,onDateTimeChange:l}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[c.jsx(Ee,{variant:"outline",onClick:()=>i(!1),size:"sm",children:"Cancel"}),c.jsxs(Ee,{onClick:u,size:"sm",disabled:!f,children:[c.jsx(Ss,{className:"h-3 w-3 mr-1"}),"Export"]})]})]})]})]})},rL=({onExportFull:e,onExportPtpComments:t,onExportPlanVsAchievement:r})=>{const n=ef(),{user:a}=Ht(),{getUserName:s,fetchProfiles:i}=Gl(),{isAdmin:o}=B1();_.useEffect(()=>{a!=null&&a.id&&i([a.id])},[a==null?void 0:a.id,i]);const l=_.useMemo(()=>a?s(a.id,a.email||""):"",[a,s]),u=async()=>{await Promise.resolve(),Se.message("Dev mode",{description:"Sign out is disabled; using default admin user."})};return c.jsx(c.Fragment,{children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("img",{src:"/uploads/logo.png",alt:"Prosparity Logo",className:"h-7 w-auto"}),c.jsx("div",{children:c.jsx("h1",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Collection Dashboard"})})]}),c.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>n("/analytics"),className:"h-8 text-xs",children:[c.jsx(BA,{className:"h-3 w-3 mr-1"}),"Analytics"]}),c.jsx(tL,{onExportFull:e,onExportPtpComments:t,onExportPlanVsAchievement:r}),o&&c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>n("/admin-settings"),className:"h-8 text-xs",children:[c.jsx(pu,{className:"h-3 w-3 mr-1"}),"Admin Settings"]})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsx("span",{className:"font-medium truncate max-w-[120px]",children:l}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:u,className:"text-gray-600 hover:text-gray-900 h-8 text-xs",children:[c.jsx(YA,{className:"h-3 w-3 mr-1"}),"Sign Out"]})]})]}),c.jsxs("div",{className:"sm:hidden flex items-center justify-between",children:[c.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:c.jsx("span",{className:"font-medium truncate max-w-[150px]",children:l})}),c.jsxs("div",{className:"flex items-center gap-2",children:[o&&c.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>n("/admin-settings"),className:"h-8",children:c.jsx(pu,{className:"h-4 w-4"})}),c.jsx(Ee,{variant:"outline",size:"sm",onClick:u,className:"text-gray-600 hover:text-gray-900 h-8",children:"Log Out"})]})]})]})})},Sp=768;function PE(){const[e,t]=_.useState(void 0);return _.useEffect(()=>{const r=window.matchMedia(`(max-width: ${Sp-1}px)`),n=()=>{t(window.innerWidth<Sp)};return r.addEventListener("change",n),t(window.innerWidth<Sp),()=>r.removeEventListener("change",n)},[]),!!e}var om="Collapsible",[nL,Mq]=In(om),[aL,lv]=nL(om),jE=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:n,defaultOpen:a,disabled:s,onOpenChange:i,...o}=e,[l,u]=Xa({prop:n,defaultProp:a??!1,onChange:i,caller:om});return c.jsx(aL,{scope:r,disabled:s,contentId:Ga(),open:l,onOpenToggle:_.useCallback(()=>u(f=>!f),[u]),children:c.jsx(je.div,{"data-state":uv(l),"data-disabled":s?"":void 0,...o,ref:t})})});jE.displayName=om;var DE="CollapsibleTrigger",RE=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,...n}=e,a=lv(DE,r);return c.jsx(je.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":uv(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:t,onClick:Te(e.onClick,a.onOpenToggle)})});RE.displayName=DE;var cv="CollapsibleContent",ME=_.forwardRef((e,t)=>{const{forceMount:r,...n}=e,a=lv(cv,e.__scopeCollapsible);return c.jsx(Ta,{present:r||a.open,children:({present:s})=>c.jsx(sL,{...n,ref:t,present:s})})});ME.displayName=cv;var sL=_.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:n,children:a,...s}=e,i=lv(cv,r),[o,l]=_.useState(n),u=_.useRef(null),f=Qe(t,u),d=_.useRef(0),m=d.current,h=_.useRef(0),v=h.current,p=i.open||o,g=_.useRef(p),y=_.useRef(void 0);return _.useEffect(()=>{const w=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(w)},[]),pr(()=>{const w=u.current;if(w){y.current=y.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const x=w.getBoundingClientRect();d.current=x.height,h.current=x.width,g.current||(w.style.transitionDuration=y.current.transitionDuration,w.style.animationName=y.current.animationName),l(n)}},[i.open,n]),c.jsx(je.div,{"data-state":uv(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!p,...s,ref:f,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":v?`${v}px`:void 0,...e.style},children:p&&a})});function uv(e){return e?"open":"closed"}var iL=jE;const fv=iL,dv=RE,hv=ME,Xn=e=>{if(!e)return"";if(/^[A-Za-z]{3}-\d{2}$/.test(e))return e;try{const t=new Date(e);if(isNaN(t.getTime()))return e;const r=t.toLocaleString("en-US",{month:"short"}),n=t.getFullYear().toString().slice(-2);return`${r}-${n}`}catch{return e}},oL=e=>e?`tel:${e.replace(/[^\d+]/g,"")}`:null,mv=e=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),eg=e=>{if(!e)return"Not Set";if(/^\d{2}-[A-Za-z]{3}-\d{2}$/.test(e))return e;try{if(/^\d{2}-\d{2}-\d{2}$/.test(e)){const[r,n,a]=e.split("-"),s=new Date(`20${r}-${n}-${a}`);if(!isNaN(s.getTime()))return s.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"}).replace(/ /g,"-")}const t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"}).replace(/ /g,"-")}catch{return e}},tg=()=>{const e=new Date,t=e.toLocaleString("en-US",{month:"short"}),r=e.getFullYear().toString().slice(-2);return`${t}-${r}`},lL=()=>{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=tg(),[r,n]=t.split("-"),a=parseInt(n),s=[];let i=25,o=0;for(;;){const u=`${e[o]}-${i.toString().padStart(2,"0")}`;if(s.push(u),u===t||(o++,o>=12&&(o=0,i++),i>a+1))break}return s},cL=Fh("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Fr({className:e,variant:t,...r}){return c.jsx("div",{className:Ae(cL({variant:t}),e),...r})}const uL=({count:e})=>e===0?null:c.jsx(Fr,{variant:"secondary",className:"ml-1",children:e}),fL=({isOpen:e,activeFilterCount:t,selectedEmiMonth:r,onEmiMonthChange:n,emiMonthOptions:a=[],onClearAllFilters:s})=>c.jsx("div",{className:"p-4 border-b",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(dv,{asChild:!0,children:c.jsxs(Ee,{variant:"ghost",size:"sm",className:"gap-2",children:[e?c.jsx(Bh,{className:"h-4 w-4"}):c.jsx(wo,{className:"h-4 w-4"}),c.jsx("span",{className:"font-medium",children:"Filters"}),c.jsx(uL,{count:t})]})}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"EMI Month:"}),c.jsxs("div",{className:"relative",children:[c.jsx("select",{value:r||"",onChange:i=>n==null?void 0:n(i.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:a.map(i=>c.jsx("option",{value:i,children:Xn(i)},i))}),r===tg()&&c.jsx("div",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full",title:"Current month"})]}),c.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>n==null?void 0:n(tg()),className:"px-2 py-1 h-8 text-xs",title:"Switch to current month",children:"Current"})]})]}),t>0&&c.jsxs(Ee,{variant:"outline",size:"sm",onClick:s,className:"gap-2",children:[c.jsx(KA,{className:"h-4 w-4"}),"Clear All"]})]})}),er=({label:e,options:t=[],selected:r=[],onSelectionChange:n,placeholder:a="Select options...",formatDisplay:s})=>{const[i,o]=_.useState(!1),[l,u]=_.useState(""),f=_.useRef(null);_.useEffect(()=>{console.log(`🔍 CustomMultiSelectFilter [${e}]: Received options:`,t),console.log(`🔍 CustomMultiSelectFilter [${e}]: Options length:`,t==null?void 0:t.length),console.log(`🔍 CustomMultiSelectFilter [${e}]: Selected values:`,r)},[t,r,e]);const d=t.filter(w=>w&&typeof w=="string"&&w.trim().length>0),m=r.filter(w=>w&&typeof w=="string"&&w.trim().length>0),h=d.filter(w=>(s?s(w):w).toLowerCase().includes(l.toLowerCase())),v=w=>{if(!w)return;console.log("=== TOGGLE OPTION ==="),console.log("Option:",w),console.log("Current selected:",m);const x=m.includes(w)?m.filter(S=>S!==w):[...m,w];console.log("New selected:",x),n(x)},p=()=>{console.log("=== CLEAR ALL FILTERS ==="),console.log("Label:",e),n([])},g=()=>{console.log("=== SELECT ALL FILTERS ==="),console.log("Label:",e),console.log("All options:",h),n(h)},y=(w,x)=>{x.stopPropagation(),console.log("=== REMOVE ITEM ==="),console.log("Item:",w),console.log("Label:",e),n(m.filter(S=>S!==w))};return _.useEffect(()=>{i&&f.current&&f.current.focus()},[i]),_.useEffect(()=>{i||u("")},[i]),c.jsx("div",{className:"w-full",children:c.jsxs(CE,{open:i,onOpenChange:o,children:[c.jsx(AE,{asChild:!0,children:c.jsxs(Ee,{variant:"outline",className:"w-full justify-between h-auto min-h-[40px] text-left font-normal p-3 relative hover:bg-blue-50 transition-colors",children:[c.jsx("div",{className:"flex flex-wrap gap-1 items-center min-h-[20px] flex-1",children:m.length===0?c.jsx("span",{className:"text-muted-foreground",children:e}):c.jsxs(c.Fragment,{children:[m.slice(0,2).map(w=>c.jsxs(Fr,{variant:"secondary",className:"text-xs h-6 px-2 bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:[s?s(w):w,c.jsx(Ns,{className:"ml-1 h-3 w-3 cursor-pointer hover:text-red-500 transition-colors",onClick:x=>y(w,x)})]},w)),m.length>2&&c.jsxs(Fr,{variant:"secondary",className:"text-xs h-6 px-2 bg-blue-100 text-blue-800",children:["+",m.length-2," more"]})]})}),c.jsx(wo,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),c.jsxs(ov,{className:"w-full min-w-[280px] p-0",align:"start",children:[c.jsx("div",{className:"p-3 border-b",children:c.jsx("input",{ref:f,type:"text",placeholder:`Search ${e.toLowerCase()}...`,value:l,onChange:w=>u(w.target.value),className:"w-full px-3 py-2 text-sm border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})}),c.jsxs("div",{className:"max-h-60 overflow-y-auto",children:[c.jsxs("div",{className:"p-2 border-b space-y-1 bg-gray-50",children:[h.length>1&&c.jsxs(Ee,{variant:"ghost",size:"sm",onClick:g,className:"w-full text-blue-600 hover:text-blue-700 hover:bg-blue-50 justify-start",children:["Select All (",h.length,")"]}),m.length>0&&c.jsxs(Ee,{variant:"ghost",size:"sm",onClick:p,className:"w-full text-red-600 hover:text-red-700 hover:bg-red-50 justify-start",children:["Clear All (",m.length,")"]})]}),h.length>0?c.jsx("div",{className:"p-1",children:h.map(w=>{const x=s?s(w):w;return c.jsxs("div",{onClick:()=>v(w),className:"flex items-center space-x-2 px-3 py-2 cursor-pointer hover:bg-blue-50 rounded-md transition-colors",children:[c.jsx("div",{className:`w-4 h-4 border rounded flex items-center justify-center transition-colors ${m.includes(w)?"bg-blue-600 border-blue-600":"border-gray-300 hover:border-blue-400"}`,children:m.includes(w)&&c.jsx(Lk,{className:"w-3 h-3 text-white"})}),c.jsx("span",{className:"flex-1 text-sm",children:x}),m.includes(w)&&c.jsx(Fr,{variant:"secondary",className:"text-xs bg-blue-100 text-blue-800",children:"Selected"})]},w)})}):c.jsx("div",{className:"p-4 text-center text-sm text-gray-500",children:l?"No matching options":"No options available"})]}),m.length>0&&c.jsx("div",{className:"p-2 border-t bg-blue-50",children:c.jsxs("div",{className:"text-xs text-blue-700 text-center font-medium",children:[m.length," item",m.length!==1?"s":""," selected"]})})]})]})})},dL=({selectedValues:e,onValueChange:t,availableOptions:r})=>{_.useEffect(()=>{console.log("🔍 PtpDateFilter: Received availableOptions:",r),console.log("🔍 PtpDateFilter: Options length:",r==null?void 0:r.length),console.log("🔍 PtpDateFilter: Selected values:",e)},[r,e]);const n=r||[],a=s=>{t(s)};return c.jsx(er,{label:"PTP Date",options:n,selected:e,onSelectionChange:a,placeholder:"Select PTP dates"})},hL=({filters:e,availableOptions:t,onFilterChange:r,onClose:n,onCancel:a})=>(_.useEffect(()=>{var s,i,o;console.log("🔍 FilterContent received availableOptions:",t),console.log("🔍 Repayments options:",t.repayments),console.log("🔍 PTP Date options:",t.ptpDateOptions),console.log("🔍 Last Month Bounce options:",t.lastMonthBounce),console.log("🔍 Repayments options length:",(s=t.repayments)==null?void 0:s.length),console.log("🔍 PTP Date options length:",(i=t.ptpDateOptions)==null?void 0:i.length),console.log("🔍 Last Month Bounce options length:",(o=t.lastMonthBounce)==null?void 0:o.length),console.log("🔍 All available options keys:",Object.keys(t||{})),console.log("🔍 Full availableOptions object:",t)},[t]),c.jsxs("div",{className:"p-4 bg-gray-50 border-b",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[c.jsx(er,{label:"Branch",options:t.branches||[],selected:e.branch||[],onSelectionChange:s=>r("branch",s),placeholder:"Select branches"}),c.jsx(er,{label:"Team Lead",options:t.team_leads||[],selected:e.teamLead||[],onSelectionChange:s=>r("teamLead",s),placeholder:"Select team leads"}),c.jsx(er,{label:"RM",options:t.rms||[],selected:e.rm||[],onSelectionChange:s=>r("rm",s),placeholder:"Select RMs"}),c.jsx(er,{label:"Dealer",options:t.dealers||[],selected:e.dealer||[],onSelectionChange:s=>r("dealer",s),placeholder:"Select dealers"}),c.jsx(er,{label:"Lender",options:t.lenders||[],selected:e.lender||[],onSelectionChange:s=>r("lender",s),placeholder:"Select lenders"}),c.jsx(er,{label:"Status",options:t.statuses||[],selected:e.status||[],onSelectionChange:s=>r("status",s),placeholder:"Select status"}),c.jsx(er,{label:"Repayment",options:t.repayments||[],selected:e.repayment||[],onSelectionChange:s=>r("repayment",s),placeholder:"Select repayment"}),c.jsx(er,{label:"Last Month Bounce",options:t.lastMonthBounce||[],selected:e.lastMonthBounce||[],onSelectionChange:s=>r("lastMonthBounce",s),placeholder:"Select bounce status"}),c.jsx(dL,{selectedValues:e.ptpDate||[],onValueChange:s=>r("ptpDate",s),availableOptions:t.ptpDateOptions||[]}),c.jsx(er,{label:"Vehicle Status",options:t.vehicle_statuses||[],selected:e.vehicleStatus||[],onSelectionChange:s=>r("vehicleStatus",s),placeholder:"Select vehicle status"})]}),(n||a)&&c.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[a&&c.jsx(Ee,{variant:"outline",className:"px-6 py-2",onClick:a,children:"Cancel"}),n&&c.jsx(Ee,{variant:"default",className:"px-8 py-2 text-base font-semibold",onClick:n,children:"Done"})]})]})),mL=e=>Object.values(e).reduce((t,r)=>Array.isArray(r)?t+r.length:t,0),pL=({filters:e,availableOptions:t={},onFilterChange:r,selectedEmiMonth:n,onEmiMonthChange:a,emiMonthOptions:s=[]})=>{var p,g,y,w,x;const[i,o]=_.useState(!1),[l,u]=_.useState(e);_.useEffect(()=>{u(e)},[e]);const f=mL(e),d=(S,b)=>{u(E=>({...E,[S]:b}))},m=()=>{Object.keys(l).forEach(S=>{r(S,l[S]||[])}),o(!1)},h=()=>{const S=Object.keys(e).reduce((b,E)=>(b[E]=[],b),{});u(S),Object.keys(S).forEach(b=>{r(b,[])})},v=()=>{u(e),o(!1)};return console.log("FilterBar render - available options:",{statuses:((p=t==null?void 0:t.statuses)==null?void 0:p.length)||0,ptpDateOptions:((g=t==null?void 0:t.ptpDateOptions)==null?void 0:g.length)||0,branches:((y=t==null?void 0:t.branches)==null?void 0:y.length)||0,repayments:((w=t==null?void 0:t.repayments)==null?void 0:w.length)||0,lastMonthBounce:((x=t==null?void 0:t.lastMonthBounce)==null?void 0:x.length)||0}),c.jsxs(fv,{open:i,onOpenChange:o,className:"w-full",children:[c.jsx(fL,{isOpen:i,activeFilterCount:f,selectedEmiMonth:n,onEmiMonthChange:a,emiMonthOptions:s,onClearAllFilters:h}),c.jsx(hv,{children:c.jsx(hL,{filters:l,availableOptions:t||{},onFilterChange:d,onClose:m,onCancel:v})})]})},gL=({filters:e,onFilterChange:t,availableOptions:r,emiMonthOptions:n})=>{const[a,s]=_.useState(!1),[i,o]=_.useState(e);_.useEffect(()=>{o(e)},[e]);const l={branches:(r==null?void 0:r.branches)||[],teamLeads:(r==null?void 0:r.team_leads)||[],rms:(r==null?void 0:r.rms)||[],dealers:(r==null?void 0:r.dealers)||[],lenders:(r==null?void 0:r.lenders)||[],statuses:(r==null?void 0:r.statuses)||[],repayments:(r==null?void 0:r.repayments)||[],lastMonthBounce:(r==null?void 0:r.lastMonthBounce)||[],ptpDateOptions:(r==null?void 0:r.ptpDateOptions)||[]};_.useEffect(()=>{console.log("🔍 MobileFilterBar: Received availableOptions:",r),console.log("🔍 MobileFilterBar: Safe filter options:",l),console.log("🔍 MobileFilterBar: Repayments options:",l.repayments),console.log("🔍 MobileFilterBar: PTP Date options:",l.ptpDateOptions),console.log("🔍 MobileFilterBar: Last Month Bounce options:",l.lastMonthBounce)},[r,l]);const u=n||(r==null?void 0:r.emiMonths)||[],f={branch:(i==null?void 0:i.branch)||[],teamLead:(i==null?void 0:i.teamLead)||[],rm:(i==null?void 0:i.rm)||[],dealer:(i==null?void 0:i.dealer)||[],lender:(i==null?void 0:i.lender)||[],status:(i==null?void 0:i.status)||[],emiMonth:(i==null?void 0:i.emiMonth)||[],repayment:(i==null?void 0:i.repayment)||[],lastMonthBounce:(i==null?void 0:i.lastMonthBounce)||[],ptpDate:(i==null?void 0:i.ptpDate)||[]},d=Object.values(e).reduce((p,g)=>p+((g==null?void 0:g.length)||0),0),m=(p,g)=>{o(y=>({...y,[p]:g}))},h=()=>{Object.keys(i).forEach(p=>{t(p,i[p]||[])}),s(!1)},v=()=>{o(e),s(!1)};return c.jsx("div",{className:"bg-white rounded-lg shadow-sm border",children:c.jsxs(fv,{open:a,onOpenChange:s,children:[c.jsx(dv,{asChild:!0,children:c.jsxs(Ee,{variant:"outline",className:"w-full flex items-center justify-between p-4 hover:bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx($k,{className:"h-4 w-4"}),c.jsx("span",{children:"Filters"}),d>0&&c.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:d})]}),a?c.jsx(Bh,{className:"h-4 w-4"}):c.jsx(wo,{className:"h-4 w-4"})]})}),c.jsx(hv,{children:c.jsxs("div",{className:"p-4 space-y-6 border-t",children:[c.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:"Filter Applications"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"PTP Date"}),c.jsx(er,{label:"PTP Date",options:l.ptpDateOptions,selected:f.ptpDate,onSelectionChange:p=>m("ptpDate",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"EMI Months"}),c.jsx(er,{label:"EMI Months",options:u,selected:f.emiMonth,onSelectionChange:p=>m("emiMonth",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Branches"}),c.jsx(er,{label:"Branches",options:l.branches,selected:f.branch,onSelectionChange:p=>m("branch",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Team Leads"}),c.jsx(er,{label:"Team Leads",options:l.teamLeads,selected:f.teamLead,onSelectionChange:p=>m("teamLead",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"RMs"}),c.jsx(er,{label:"RMs",options:l.rms,selected:f.rm,onSelectionChange:p=>m("rm",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Dealers"}),c.jsx(er,{label:"Dealers",options:l.dealers,selected:f.dealer,onSelectionChange:p=>m("dealer",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Lenders"}),c.jsx(er,{label:"Lenders",options:l.lenders,selected:f.lender,onSelectionChange:p=>m("lender",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Status"}),c.jsx(er,{label:"Status",options:l.statuses,selected:f.status,onSelectionChange:p=>m("status",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Repayment"}),c.jsx(er,{label:"Repayment",options:l.repayments,selected:f.repayment,onSelectionChange:p=>m("repayment",p)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Last Month Status"}),c.jsx(er,{label:"Last Month Status",options:l.lastMonthBounce,selected:f.lastMonthBounce,onSelectionChange:p=>m("lastMonthBounce",p)})]})]}),c.jsxs("div",{className:"mt-6 flex gap-3",children:[c.jsx(Ee,{variant:"outline",className:"flex-1 px-6 py-2",onClick:v,children:"Cancel"}),c.jsx("div",{className:"border border-blue-500 rounded-lg p-2 bg-blue-50 flex-1",children:c.jsx(Ee,{variant:"default",className:"w-full px-8 py-2 text-base font-semibold",onClick:h,children:"Done"})})]})]})})]})})},Qr=_.forwardRef(({className:e,type:t,...r},n)=>c.jsx("input",{type:t,className:Ae("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));Qr.displayName="Input";const vL=({value:e,onChange:t,placeholder:r="Search by application name or ID...",loading:n=!1,resultCount:a})=>{const[s,i]=_.useState(e);_.useEffect(()=>{i(e)},[e]);const o=()=>{t(s)},l=()=>{i(""),t("")},u=f=>{f.key==="Enter"&&o()};return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex w-full items-center space-x-2",children:[c.jsxs("div",{className:"relative flex-1",children:[c.jsx(x1,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),c.jsx(Qr,{type:"text",placeholder:r,value:s,onChange:f=>i(f.target.value),onKeyDown:u,className:"pl-10 pr-10 h-10 text-sm w-full",disabled:n}),s&&!n&&c.jsx(Ee,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0 text-gray-500 hover:text-gray-900",onClick:l,children:c.jsx(Ns,{className:"h-4 w-4"})}),n&&c.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:c.jsx(Jo,{className:"h-4 w-4 animate-spin text-gray-400"})})]}),c.jsxs(Ee,{onClick:o,className:"h-10",disabled:n,children:[n?c.jsx(Jo,{className:"h-4 w-4 animate-spin mr-2"}):null,"Search"]})]}),e&&a!==void 0&&!n&&c.jsx("div",{className:"text-xs text-gray-500 px-1",children:a===0?`No results found for "${e}"`:a===1?`1 result found for "${e}"`:`${a.toLocaleString()} results found for "${e}"`})]})},yL=({filters:e,availableOptions:t,onFilterChange:r,searchTerm:n,onSearchChange:a,selectedEmiMonth:s,onEmiMonthChange:i,emiMonthOptions:o=[],loading:l=!1,searchLoading:u=!1,totalCount:f})=>{const d=PE();return _.useEffect(()=>{console.log("🔍 FiltersSection: Received availableOptions:",t),console.log("🔍 FiltersSection: Repayments options:",t==null?void 0:t.repayments),console.log("🔍 FiltersSection: PTP Date options:",t==null?void 0:t.ptpDateOptions),console.log("🔍 FiltersSection: Last Month Bounce options:",t==null?void 0:t.lastMonthBounce)},[t]),c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:d?c.jsx(gL,{filters:e,availableOptions:t,onFilterChange:r,emiMonthOptions:o}):c.jsx(pL,{filters:e,availableOptions:t,onFilterChange:r,selectedEmiMonth:s,onEmiMonthChange:i,emiMonthOptions:o})}),c.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:c.jsx(vL,{value:n,onChange:a,placeholder:"Search by application name or ID...",loading:u,resultCount:n?f:void 0})})]})},Yl=_.forwardRef(({className:e,...t},r)=>c.jsx("div",{className:"relative w-full overflow-auto",children:c.jsx("table",{ref:r,className:Ae("w-full caption-bottom text-sm",e),...t})}));Yl.displayName="Table";const uf=_.forwardRef(({className:e,...t},r)=>c.jsx("thead",{ref:r,className:Ae("[&_tr]:border-b",e),...t}));uf.displayName="TableHeader";const Xl=_.forwardRef(({className:e,...t},r)=>c.jsx("tbody",{ref:r,className:Ae("[&_tr:last-child]:border-0",e),...t}));Xl.displayName="TableBody";const xL=_.forwardRef(({className:e,...t},r)=>c.jsx("tfoot",{ref:r,className:Ae("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));xL.displayName="TableFooter";const ma=_.forwardRef(({className:e,...t},r)=>c.jsx("tr",{ref:r,className:Ae("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));ma.displayName="TableRow";const ft=_.forwardRef(({className:e,...t},r)=>c.jsx("th",{ref:r,className:Ae("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));ft.displayName="TableHead";const mt=_.forwardRef(({className:e,...t},r)=>c.jsx("td",{ref:r,className:Ae("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));mt.displayName="TableCell";const wL=_.forwardRef(({className:e,...t},r)=>c.jsx("caption",{ref:r,className:Ae("mt-4 text-sm text-muted-foreground",e),...t}));wL.displayName="TableCaption";const _L=()=>c.jsx(uf,{children:c.jsxs(ma,{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-slate-200",children:[c.jsx(ft,{className:"font-bold text-slate-800 py-4 px-6",children:"Application Details"}),c.jsx(ft,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"EMI Amount"}),c.jsx(ft,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"Status"}),c.jsx(ft,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"PTP Date"}),c.jsx(ft,{className:"font-bold text-slate-800 text-center py-4 px-4 whitespace-nowrap",children:"Calling Status"}),c.jsx(ft,{className:"font-bold text-slate-800 py-4 px-4 whitespace-nowrap",children:"Recent Comments"})]})}),OE=()=>c.jsx(_L,{}),IE=_.memo(({status:e})=>{const t={Unpaid:"bg-red-100 text-red-800 border-red-200","Partially Paid":"bg-yellow-100 text-yellow-800 border-yellow-200","Cash Collected from Customer":"bg-orange-100 text-orange-800 border-orange-200","Customer Deposited to Bank":"bg-indigo-100 text-indigo-800 border-indigo-200","Paid (Pending Approval)":"bg-blue-100 text-blue-800 border-blue-200",Paid:"bg-green-100 text-green-800 border-green-200"};return c.jsx(Fr,{className:`${t[e]||"bg-gray-100 text-gray-800 border-gray-200"} border`,children:e})});IE.displayName="StatusBadge";const pv=_.memo(({comments:e,hasComments:t,loading:r})=>r?c.jsx("div",{className:"bg-gray-50 p-3 rounded",children:c.jsx("div",{className:"text-xs text-gray-400 italic",children:"Loading comments..."})}):e&&e.length>0?c.jsx("div",{className:"bg-gray-50 p-3 rounded",children:c.jsxs("div",{className:"space-y-2",children:[e.slice(0,3).map((n,a)=>c.jsxs("div",{className:"relative pl-4",children:[c.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-0.5 bg-blue-200"}),c.jsx("div",{className:"font-medium text-blue-600 text-sm mb-1",children:n.user_name==="Manoj Sen1"?"User 1":n.user_name}),c.jsx("div",{className:"text-xs text-gray-700 break-words",children:n.content})]},a)),e.length>3&&c.jsxs("div",{className:"text-xs text-blue-600 italic mt-2",children:["+",e.length-3," more comments"]})]})}):c.jsx("div",{className:"text-xs text-gray-400 italic",children:t?"Has comments - click to view":"Click to add comments"}));pv.displayName="CommentsDisplay";const SL=({callingStatuses:e})=>{const t=n=>{const a=n.toLowerCase();return a==="not called"||a==="not called"?c.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300 flex-shrink-0"}):a==="not answered"||a==="no response"?c.jsx(Ns,{className:"w-3 h-3 text-red-500 flex-shrink-0"}):a==="called"||a==="answered"||a==="customer funded the account"||a==="customer will fund the account on a future date"||a==="cash collected"||a==="cash will be collected on a future date"||a==="spoken – no commitment"||a==="refused / unable to fund"?c.jsx(Fk,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):c.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300 flex-shrink-0"})},r=[{key:"applicant",label:"Applicant",status:e.applicant},{key:"co_applicant",label:"Co-Applicant",status:e.co_applicant},{key:"guarantor",label:"Guarantor",status:e.guarantor},{key:"reference",label:"Reference",status:e.reference}];return c.jsx("div",{className:"space-y-2",children:r.map(n=>c.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[t(n.status),c.jsx("span",{className:"text-gray-700 font-medium",children:n.label})]},n.key))})},bu={APPLICATION_DETAILS:1,PAID_PENDING:2};class Eu{static async createComment(t){const r=await fetch(`${Mr}/comments/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!r.ok)throw new Error(`Failed to create comment: ${r.status}`);return await r.json()}static async getCommentsByRepayment(t,r=0,n=100){const a=new URLSearchParams({skip:r.toString(),limit:n.toString()}),s=await fetch(`${Mr}/comments/repayment/${t}?${a.toString()}`);if(!s.ok)throw new Error(`Failed to fetch comments: ${s.status}`);return await s.json()}static async getCommentsByRepaymentAndType(t,r,n=0,a=100){const s=new URLSearchParams({skip:n.toString(),limit:a.toString()}),i=await fetch(`${Mr}/comments/repayment/${t}/type/${r}?${s.toString()}`);if(!i.ok)throw new Error(`Failed to fetch comments by type: ${i.status}`);return await i.json()}static async getRepaymentCommentsCount(t){const r=await fetch(`${Mr}/comments/repayment/${t}/count`);if(!r.ok)throw new Error(`Failed to fetch comment count: ${r.status}`);return await r.json()}static async getRepaymentCommentsCountByType(t,r){const n=await fetch(`${Mr}/comments/repayment/${t}/type/${r}/count`);if(!n.ok)throw new Error(`Failed to fetch comment count by type: ${n.status}`);return await n.json()}}const gv=_.memo(({application:e,selectedApplicationId:t,onRowClick:r,selectedEmiMonth:n,batchedStatus:a,batchedPtpDate:s,batchedContactStatus:i,batchedComments:o,isLoading:l})=>{const[u,f]=_.useState([]),[d,m]=_.useState(!1);_.useEffect(()=>{(async()=>{if(!e.payment_id){console.log("⚠️ No payment_id for application:",e.applicant_id);return}console.log("🔍 Fetching comments for application:",e.applicant_id,"payment_id:",e.payment_id),m(!0);try{const p=await Eu.getCommentsByRepaymentAndType(e.payment_id.toString(),bu.APPLICATION_DETAILS,0,3);if(console.log("📝 Comments response for",e.applicant_id,":",p),p.results&&p.results.length>0){const g=p.results.map(y=>({id:y.id.toString(),content:y.comment,created_at:y.commented_at,user_id:y.user_id.toString(),user_name:y.user_id===1?"User 1":`User ${y.user_id}`,application_id:e.applicant_id}));console.log("✅ Mapped comments for",e.applicant_id,":",g),f(g)}else console.log("ℹ️ No comments found for application:",e.applicant_id),f([])}catch(p){console.error("❌ Error fetching comments for application:",e.applicant_id,p),f([])}finally{m(!1)}})()},[e.payment_id,e.applicant_id]);const h=v=>{r(e)};return c.jsxs(ma,{className:`cursor-pointer transition-colors align-top ${t===e.id?"bg-blue-50 border-l-4 border-l-blue-500 hover:bg-blue-100":"hover:bg-gray-50"}`,onClick:h,children:[c.jsx(mt,{className:"py-4 align-top w-[24%]",children:c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("span",{className:"font-bold text-blue-800",children:e.applicant_name}),c.jsxs("span",{className:"text-xs text-gray-700",children:["ID: ",e.applicant_id]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["EMI Month: ",Xn(n||e.emi_month)]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Branch: ",e.branch_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["TL: ",e.team_lead]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["RM: ",e.rm_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Dealer: ",e.dealer_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Lender: ",e.lender_name]})]})}),c.jsx(mt,{className:"py-4 align-top text-blue-600 font-semibold text-base w-[10%]",children:mv(e.emi_amount)}),c.jsx(mt,{className:"py-4 align-top w-[10%]",children:c.jsx(IE,{status:e.status})}),c.jsx(mt,{className:"py-4 align-top w-[10%]",children:s?eg(s):e.ptp_date?eg(e.ptp_date):"Not Set"}),c.jsx(mt,{className:"py-4 align-top w-[10%]",children:c.jsx(SL,{callingStatuses:i?{applicant:i.applicant||"Not Called",co_applicant:i.co_applicant||"Not Called",guarantor:i.guarantor||"Not Called",reference:i.reference||"Not Called"}:{applicant:e.applicant_calling_status||"Not Called",co_applicant:e.co_applicant_calling_status||"Not Called",guarantor:e.guarantor_calling_status||"Not Called",reference:e.reference_calling_status||"Not Called"}})}),c.jsx(mt,{className:"py-4 align-top w-[20%]",children:c.jsx(pv,{comments:u,hasComments:u.length>0,loading:d})})]})});gv.displayName="ApplicationRow";const kL=(e,t)=>{const r=[];for(let n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r},bL=10*1e3,Nw=25,wc={},Yf=new Map,Fs=new Map,vv=()=>{const{user:e}=Ht(),[t,r]=_.useState(!1);_.useRef(null);const n=_.useCallback(l=>{const u=[...l.applicationIds].sort(),f=u.length<=5?u.join(","):`${u.length}-${u[0]}-${u[u.length-1]}`;return`fs-${l.selectedMonth||"all"}-${f}`},[]),a=_.useCallback(l=>typeof l=="string"&&l.trim().length>0,[]),s=_.useCallback(async(l,u,f=0)=>{if(l.length===0)return{};const d=2;try{console.log(`📤 Fetching field status chunk: ${l.length} applications (attempt ${f+1})`);let m=Pe.from("field_status").select("application_id, status, created_at, demand_date").in("application_id",l);if(u.selectedMonth&&!u.includeAllMonths){let x;if(console.log(`🔍 Processing month: "${u.selectedMonth}"`),u.selectedMonth.includes("-")){const W=u.selectedMonth.split("-");if(W.length>=2&&W[0].length===4&&!isNaN(Number(W[0]))&&!isNaN(Number(W[1])))x=`${W[0]}-${W[1].padStart(2,"0")}`,console.log(`✅ Already in YYYY-MM format: ${x}`);else{const[P,G]=W,V={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"}[P],K=G.length===2?`20${G}`:G;if(!V||!K)throw console.error(`❌ Invalid month-year format: ${u.selectedMonth}. MonthAbbr: ${P}, Year: ${G}, MonthNum: ${V}, FullYear: ${K}`),new Error(`Invalid month-year format: ${u.selectedMonth}`);x=`${K}-${V}`,console.log(`🔄 Month-Year conversion: ${u.selectedMonth} → ${x}`)}}else x=u.selectedMonth;const[S,b]=x.split("-");if(!S||!b||isNaN(Number(S))||isNaN(Number(b)))throw console.error(`❌ Invalid database format month: ${x}`),new Error(`Invalid database format month: ${x}`);const E=Number(S),k=Number(b),T=new Date(E,k,0).getDate(),N=`${x}-01`,O=`${x}-${String(T).padStart(2,"0")}`;console.log(`📅 Field status month filter: ${N} to ${O}`),m=m.gte("demand_date",N).lte("demand_date",O)}m=m.order("created_at",{ascending:!1});const{data:h,error:v}=await m;if(v)throw new Error(`Field status query failed: ${v.message}`);const p={},g=new Set;h&&h.forEach(x=>{if(x&&x.application_id&&x.status){const S=x.application_id;g.has(S)||(p[S]=x.status||"Unpaid",g.add(S))}});const y=Object.keys(p).length,w=l.length;return y<w*.8&&f<d?(console.warn(`⚠️ Low data completeness: ${y}/${w}. Retrying...`),await new Promise(x=>setTimeout(x,1e3*(f+1))),s(l,u,f+1)):(console.log(`✅ Chunk processed: ${y}/${w} statuses loaded`),p)}catch(m){return f<d?(console.warn(`⚠️ Chunk fetch failed, retrying (${f+1}/${d}):`,m),await new Promise(h=>setTimeout(h,1e3*(f+1))),s(l,u,f+1)):(console.error("❌ Chunk fetch error after retries:",m),{})}},[]),i=_.useCallback(async(l,u,f=!1)=>{if(!e||l.length===0)return console.log("❌ No user or empty application IDs"),{};const d=l.filter(a);if(d.length===0)return console.warn("❌ No valid application IDs provided"),{};console.log("=== FIELD STATUS MANAGER FETCH ==="),console.log("Valid Application IDs:",d.length),console.log("Selected Month:",u);const m={applicationIds:d,selectedMonth:u,includeAllMonths:f},h=n(m),v=wc[h];if(v&&Date.now()<v.expiresAt){const g=Object.keys(v.data).length,y=d.length;if(g>=y*.8)return console.log(`✅ Using cached field status data (${g}/${y})`),v.data;console.warn(`⚠️ Cache data incomplete (${g}/${y}), refreshing`),delete wc[h]}if(Yf.has(h))return console.log("⏳ Waiting for pending field status request"),new Promise((g,y)=>{Fs.has(h)||Fs.set(h,[]),Fs.get(h).push({resolve:g,reject:y})});const p=(async()=>{try{r(!0),console.log(`🚀 Starting fresh field status fetch for ${d.length} applications`);const g=kL(d,Nw);console.log(`📦 Splitting into ${g.length} chunks of max ${Nw} IDs each`);const y={};let w=0;for(let b=0;b<g.length;b++)try{const E=await s(g[b],m);Object.assign(y,E),w++,b<g.length-1&&await new Promise(k=>setTimeout(k,100))}catch(E){console.error(`❌ Chunk ${b+1} failed:`,E)}d.forEach(b=>{y[b]||(y[b]="Unpaid")});const x=Object.keys(y).length;return console.log(`✅ Field status loaded: ${x} applications (${w}/${g.length} chunks successful)`),x>=d.length*.8?(wc[h]={data:y,timestamp:Date.now(),expiresAt:Date.now()+bL},console.log(`💾 Cached field status data (${x} applications)`)):console.warn(`⚠️ Not caching incomplete data (${x}/${d.length})`),(Fs.get(h)||[]).forEach(({resolve:b})=>b(y)),Fs.delete(h),y}catch(g){return console.error("❌ Error in fetchFieldStatus:",g),(Fs.get(h)||[]).forEach(({reject:w})=>w(g)),Fs.delete(h),{}}finally{r(!1)}})();Yf.set(h,p);try{return await p}finally{Yf.delete(h)}},[e,a,n,s]),o=_.useCallback(()=>{Object.keys(wc).forEach(l=>delete wc[l]),Yf.clear(),Fs.clear(),console.log("🧹 Field status cache, pending requests, and queue cleared")},[]);return{fetchFieldStatus:i,loading:t,clearCache:o}},EL=e=>{const{user:t}=Ht();Gl();const[r,n]=_.useState({}),[a,s]=_.useState(!1),i=_.useCallback(async o=>{if(!t||!o.length)return{};s(!0);try{return console.log("=== BATCH FETCHING COMMENTS ==="),console.log("Application IDs:",o.slice(0,5),"... and",Math.max(0,o.length-5),"more"),console.log("Selected Month:",e),console.log("⚠️ Comments fetching temporarily disabled - needs applications data for payment_id mapping"),n({}),{}}catch(l){return console.error("Exception in batch fetchComments:",l),{}}finally{s(!1)}},[t,e]);return _.useEffect(()=>{n({})},[e]),{comments:r,loading:a,fetchBatchComments:i}},Tu=e=>{if(!e)return console.warn("Empty emiMonth provided to convertEmiMonthToDatabase"),"";if(e.match(/^\d{4}-\d{2}$/))return e;if(e.match(/^[A-Za-z]{3}-\d{2}$/)){const[t,r]=e.split("-");if(!t||!r)return console.warn("Invalid emiMonth format:",e),e;const n=parseInt(r);if(isNaN(n))return console.warn("Invalid year in emiMonth:",r),e;const a=n<50?`20${r}`:`19${r}`,i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].findIndex(u=>u.toLowerCase()===t.toLowerCase());if(i===-1)return console.warn("Invalid month name:",t),e;const o=(i+1).toString().padStart(2,"0"),l=`${a}-${o}`;return console.log("Converted EMI month:",e,"->",l),l}return console.warn("Unrecognized emiMonth format:",e),e},Dl=e=>!e||!e.match(/^\d{4}-\d{2}$/)?e:`${e}-05`,hi=e=>{if(!e||!e.match(/^\d{4}-\d{2}$/))return console.warn("Invalid yearMonth format for getMonthDateRange:",e),{start:e,end:e};try{const[t,r]=e.split("-").map(Number),n=new Date(t,r-1,1),a=new Date(t,r,0),s=n.toISOString().split("T")[0],i=a.toISOString().split("T")[0];return console.log("Month date range for",e,":",{start:s,end:i}),{start:s,end:i}}catch(t){return console.error("Error calculating month date range for:",e,t),{start:e,end:e}}},TL=()=>{const{user:e}=Ht(),[t,r]=_.useState(!1),n=_.useCallback(async(s,i)=>{if(!e||s.length===0)return console.log("❌ No user or empty application IDs for batch PTP dates"),{};r(!0);try{console.log("=== BATCH PTP DATES FETCH ==="),console.log("Application IDs:",s.length),console.log("Selected Month:",i);let o=Pe.from("ptp_dates").select("application_id, ptp_date, created_at").in("application_id",s);if(i){const d=Tu(i),{start:m,end:h}=hi(d);console.log("Date range for PTP dates:",{start:m,end:h}),o=o.gte("demand_date",m).lte("demand_date",h)}o=o.order("created_at",{ascending:!1});const{data:l,error:u}=await o;if(u)return console.error("❌ Error fetching batch PTP dates:",u),{};const f={};return l&&l.forEach(d=>{f.hasOwnProperty(d.application_id)||(f[d.application_id]=d.ptp_date)}),console.log("✅ Batch PTP dates loaded:",Object.keys(f).length,"applications"),f}catch(o){return console.error("❌ Error in fetchBatchPtpDates:",o),{}}finally{r(!1)}},[e]),a=_.useCallback(async(s,i)=>{if(!e||s.length===0)return console.log("❌ No user or empty application IDs for batch PTP dates (audit log)"),{};r(!0);try{console.log("=== BATCH PTP DATES FROM AUDIT LOG FETCH ==="),console.log("Application IDs:",s.length),console.log("Selected Month:",i);let o=Pe.from("audit_logs").select("application_id, field, new_value, created_at, demand_date").in("application_id",s).eq("field","PTP Date");if(i){const d=Tu(i),{start:m,end:h}=hi(d);o=o.gte("demand_date",m).lte("demand_date",h)}o=o.order("created_at",{ascending:!1});const{data:l,error:u}=await o;if(u)return console.error("❌ Error fetching batch PTP dates from audit log:",u),{};const f={};return l&&l.forEach(d=>{f.hasOwnProperty(d.application_id)||(f[d.application_id]=d.new_value)}),console.log("✅ Batch PTP dates from audit log loaded:",Object.keys(f).length,"applications"),f}catch(o){return console.error("❌ Error in fetchBatchPtpDatesFromAuditLog:",o),{}}finally{r(!1)}},[e]);return{fetchBatchPtpDates:n,fetchBatchPtpDatesFromAuditLog:a,loading:t}},NL=()=>{const{user:e}=Ht(),[t,r]=_.useState(!1);return{fetchBatchContactStatus:_.useCallback(async(a,s)=>{if(!e||a.length===0)return{};r(!0);try{console.log("=== BATCH CONTACT STATUS FETCH ==="),console.log("Application IDs:",a.length),console.log("Selected Month:",s);let i=Pe.from("contact_calling_status").select("application_id, contact_type, status, created_at").in("application_id",a);if(s){const{start:f,end:d}=hi(s);console.log("Date range for contact status:",{start:f,end:d}),i=i.gte("demand_date",f).lte("demand_date",d)}i=i.order("created_at",{ascending:!1});const{data:o,error:l}=await i;if(l)return console.error("Error fetching batch contact status:",l),{};const u={};return o&&(o.forEach(f=>{u[f.application_id]||(u[f.application_id]={});const d=f.contact_type.toLowerCase();u[f.application_id][d]||(u[f.application_id][d]=f.status)}),Object.keys(u).forEach(f=>{const d=Object.values(u[f]);if(d.length>0){const m=d.filter(h=>h!=="Not Called");u[f].latest=m.length>0?m[0]:"No Calls"}else u[f].latest="No Calls"})),console.log("✅ Batch contact status loaded:",Object.keys(u).length,"applications"),u}catch(i){return console.error("Error in fetchBatchContactStatus:",i),{}}finally{r(!1)}},[e]),loading:t}},yv=e=>{const{fetchFieldStatus:t,loading:r}=vv(),{fetchBatchComments:n,loading:a}=EL(e),{fetchBatchPtpDates:s,fetchBatchPtpDatesFromAuditLog:i,loading:o}=TL(),{fetchBatchContactStatus:l,loading:u}=NL(),[f,d]=_.useState({statuses:{},comments:{},ptpDates:{},contactStatuses:{}}),[m,h]=_.useState(!1),[v,p]=_.useState(null),g=_.useRef(null),y=_.useRef(""),w=_.useCallback(async(E,k={})=>{var N,O,W,P;if(E.length===0){const G={statuses:{},comments:{},ptpDates:{},contactStatuses:{}};return d(G),G}g.current&&g.current.abort(),g.current=new AbortController;const T=`${E.join(",")}-${k.selectedEmiMonth||"none"}`;if(y.current===T)return console.log("⏭️ Skipping duplicate centralized data request"),f;y.current=T,h(!0),p(null);try{console.log("=== CENTRALIZED DATA MANAGER ==="),console.log("Application IDs:",E.length),console.log("Selected EMI Month:",k.selectedEmiMonth),console.log("Priority:",k.priority||"medium");const G=E.length<500&&k.priority!=="low";let X;if(G){console.log("📊 Fetching all data in parallel...");const[V,K,Y,H]=await Promise.all([t(E,k.selectedEmiMonth),i(E,k.selectedEmiMonth),l(E,k.selectedEmiMonth),n(E)]);X={statuses:V,ptpDates:K,contactStatuses:Y,comments:H}}else{console.log("📊 Fetching data sequentially...");const V=await t(E,k.selectedEmiMonth);if((N=g.current)!=null&&N.signal.aborted)return f;const K=await i(E,k.selectedEmiMonth);if((O=g.current)!=null&&O.signal.aborted)return f;const Y=await l(E,k.selectedEmiMonth);if((W=g.current)!=null&&W.signal.aborted)return f;const H=await n(E);X={statuses:V,ptpDates:K,contactStatuses:Y,comments:H}}return(P=g.current)!=null&&P.signal.aborted?f:(console.log("✅ Centralized data fetch complete:",{statuses:Object.keys(X.statuses).length,ptpDates:Object.keys(X.ptpDates).length,contactStatuses:Object.keys(X.contactStatuses).length,comments:Object.keys(X.comments).length}),d(X),X)}catch(G){return G instanceof Error&&G.name==="AbortError"?(console.log("🛑 Centralized data fetch was cancelled"),f):(console.error("❌ Error in centralized data fetch:",G),p(G instanceof Error?G:new Error("Unknown error")),f)}finally{h(!1)}},[t,n,s,i,l]),x=_.useCallback(()=>{d({statuses:{},comments:{},ptpDates:{},contactStatuses:{}}),p(null)},[]),S=_.useCallback(()=>{g.current&&g.current.abort(),h(!1)},[]);return _.useEffect(()=>()=>{g.current&&g.current.abort()},[]),{data:f,loading:m||r||a||o||u,error:v,fetchAllData:w,clearData:x,cancelRequests:S}},FE=_.memo(({applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:n})=>{const{data:a,loading:s,fetchAllData:i,clearData:o}=yv(n),l=e.map(u=>u.applicant_id);return _.useEffect(()=>{o(),l.length>0&&i(l,{selectedEmiMonth:n})},[l.join(","),n]),c.jsxs("div",{className:"rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(Yl,{children:[c.jsx(OE,{}),c.jsx(Xl,{children:e.map(u=>c.jsx(gv,{application:u,selectedApplicationId:r,onRowClick:t,batchedStatus:a.statuses[u.applicant_id]||"Unpaid",batchedPtpDate:a.ptpDates[u.applicant_id]||null,batchedContactStatus:a.contactStatuses[u.applicant_id],batchedComments:a.comments[u.applicant_id]||[],isLoading:s},u.id))})]})}),e.length===0&&c.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[c.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No applications found"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Try adjusting your filters"})]})]})});FE.displayName="SimpleApplicationsTable";const LE=_.memo(({currentPage:e,totalPages:t,onPageChange:r,totalCount:n,pageSize:a})=>{const{startRecord:s,endRecord:i,pageNumbers:o}=_.useMemo(()=>{const l=(e-1)*a+1,u=Math.min(e*a,n),f=[];if(t<=5)for(let d=1;d<=t;d++)f.push(d);else if(e<=3)for(let d=1;d<=5;d++)f.push(d);else if(e>=t-2)for(let d=t-4;d<=t;d++)f.push(d);else for(let d=e-2;d<=e+2;d++)f.push(d);return{startRecord:l,endRecord:u,pageNumbers:f}},[e,t,a,n]);return c.jsxs("div",{className:"flex items-center justify-between px-4 py-3 bg-white border-t",children:[c.jsx("div",{className:"flex items-center text-sm text-gray-700",children:c.jsxs("span",{children:["Showing ",s," to ",i," of ",n," applications"]})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>r(e-1),disabled:e===1,children:[c.jsx(v1,{className:"h-4 w-4 mr-1"}),"Previous"]}),c.jsx("div",{className:"flex items-center space-x-1",children:o.map(l=>c.jsx(Ee,{variant:e===l?"default":"outline",size:"sm",onClick:()=>r(l),className:"w-8 h-8 p-0",children:l},l))}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>r(e+1),disabled:e===t,children:["Next",c.jsx(Lh,{className:"h-4 w-4 ml-1"})]})]})]})});LE.displayName="PaginationControls";const BE=({name:e,phone:t,variant:r="ghost",size:n="sm",className:a=""})=>{if(!t)return null;const s=oL(t);return s?c.jsx(Ee,{variant:r,size:n,className:`gap-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 ${a}`,asChild:!0,children:c.jsxs("a",{href:s,children:[c.jsx(Hk,{className:"h-3 w-3"}),c.jsx("span",{className:"text-xs",children:e})]})}):null},CL=e=>`${{Unpaid:"bg-red-100 text-red-800 border-red-200","Partially Paid":"bg-yellow-100 text-yellow-800 border-yellow-200","Cash Collected from Customer":"bg-orange-100 text-orange-800 border-orange-200","Customer Deposited to Bank":"bg-indigo-100 text-indigo-800 border-indigo-200","Paid (Pending Approval)":"bg-blue-100 text-blue-800 border-blue-200",Paid:"bg-green-100 text-green-800 border-green-200"}[e]||"bg-gray-100 text-gray-800 border-gray-200"} border`,Xf=e=>{const t=e.toLowerCase();return t==="not called"||t==="not called"?c.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300 flex-shrink-0"}):t==="not answered"||t==="no response"?c.jsx(Ns,{className:"w-3 h-3 text-red-500 flex-shrink-0"}):t==="called"||t==="answered"||t==="customer funded the account"||t==="customer will fund the account on a future date"||t==="cash collected"||t==="cash will be collected on a future date"||t==="spoken – no commitment"||t==="refused / unable to fund"?c.jsx(Fk,{className:"w-3 h-3 text-green-500 flex-shrink-0"}):c.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300 flex-shrink-0"})},UE=_.memo(({application:e,onRowClick:t,selectedApplicationId:r,selectedMonth:n})=>{const a=e.status,s=e.ptp_date,i={applicant:e.applicant_calling_status||"Not Called",co_applicant:e.co_applicant_calling_status||"Not Called",guarantor:e.guarantor_calling_status||"Not Called",reference:e.reference_calling_status||"Not Called"},o=e.comments||[];return c.jsx(qe,{className:`cursor-pointer transition-all duration-200 hover:shadow-md active:scale-[0.98] ${r===e.id?"ring-2 ring-blue-500 shadow-md":"hover:shadow-lg"}`,onClick:()=>t(e),children:c.jsxs(Je,{className:"p-4",children:[c.jsx("div",{className:"mb-3",children:c.jsxs("div",{className:"flex flex-col gap-1",children:[c.jsx("span",{className:"font-bold text-blue-800",children:e.applicant_name}),c.jsxs("span",{className:"text-xs text-gray-700",children:["ID: ",e.applicant_id]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["EMI Month: ",Xn(n||e.emi_month)]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Branch: ",e.branch_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["TL: ",e.team_lead]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["RM: ",e.rm_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Dealer: ",e.dealer_name]}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Lender: ",e.lender_name]})]})}),c.jsx("div",{className:"mb-3",children:c.jsx("div",{className:"text-blue-600 font-semibold text-base",children:mv(e.emi_amount)})}),c.jsx("div",{className:"mb-3",children:c.jsx(Fr,{className:CL(a),children:a})}),c.jsx("div",{className:"mb-3",children:c.jsx("div",{className:"text-xs text-gray-700",children:s?eg(s):"Not Set"})}),c.jsxs("div",{className:"mb-3",children:[c.jsx("div",{className:"text-xs text-gray-700 mb-2",children:"Calling Status:"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Xf(i.applicant),c.jsx("span",{className:"text-gray-700 font-medium",children:"Applicant"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Xf(i.co_applicant),c.jsx("span",{className:"text-gray-700 font-medium",children:"Co-Applicant"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Xf(i.guarantor),c.jsx("span",{className:"text-gray-700 font-medium",children:"Guarantor"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Xf(i.reference),c.jsx("span",{className:"text-gray-700 font-medium",children:"Reference"})]})]})]}),c.jsx("div",{className:"border-t pt-3",children:c.jsx(pv,{comments:(o==null?void 0:o.map(l=>({content:l,user_name:"User 1"})))||[],hasComments:!!(o!=null&&o.length)})}),e.applicant_mobile&&c.jsx("div",{className:"mt-3 pt-3 border-t",children:c.jsx(BE,{name:"Call Applicant",phone:e.applicant_mobile,variant:"default",size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 w-full"})})]})})});UE.displayName="MobileApplicationCard";const $E=_.memo(({applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:n})=>c.jsx("div",{className:"space-y-3",children:e.map(a=>c.jsx(UE,{application:a,onRowClick:t,selectedApplicationId:r,selectedMonth:n||""},a.id))}));$E.displayName="OptimizedMobileTable";const AL=({applications:e,onRowClick:t,selectedApplicationId:r,currentPage:n,totalPages:a,onPageChange:s,totalCount:i,pageSize:o,selectedEmiMonth:l})=>{const u=PE();return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[c.jsxs("span",{children:["Showing ",(n-1)*o+1," to ",Math.min(n*o,i)," of ",i," applications"]}),i>=1e3&&c.jsx("span",{className:"text-amber-600 font-medium",children:"Showing first 1,000 results"})]}),u?c.jsx($E,{applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:l}):c.jsx(FE,{applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:l}),a>1&&c.jsx(LE,{currentPage:n,totalPages:a,onPageChange:s,totalCount:i,pageSize:o})]})},PL=()=>{const[e,t]=_.useState(null),[r,n]=_.useState(!1),[a,s]=_.useState(!1);_.useEffect(()=>{const l=window.navigator.userAgent.toLowerCase(),u=/iphone|ipad|ipod/.test(l);if(s(u),window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0)return;const d=m=>{m.preventDefault(),t(m),setTimeout(()=>{localStorage.getItem("pwa-install-dismissed")||n(!0)},5e3)};return window.addEventListener("beforeinstallprompt",d),()=>{window.removeEventListener("beforeinstallprompt",d)}},[]);const i=async()=>{if(e){e.prompt();const{outcome:l}=await e.userChoice;l==="accepted"&&console.log("User accepted the install prompt"),t(null),n(!1)}},o=()=>{n(!1),localStorage.setItem("pwa-install-dismissed","true")};return r?c.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 sm:left-auto sm:right-4 sm:w-80",children:c.jsx(qe,{className:"shadow-lg border border-blue-200 bg-blue-50",children:c.jsxs(Je,{className:"p-4",children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ss,{className:"h-5 w-5 text-blue-600"}),c.jsx("h3",{className:"font-semibold text-gray-900",children:"Install App"})]}),c.jsx(Ee,{variant:"ghost",size:"sm",onClick:o,className:"h-6 w-6 p-0",children:c.jsx(Ns,{className:"h-4 w-4"})})]}),a?c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Install this app for a better experience"}),c.jsx("p",{className:"text-xs text-gray-500",children:'Tap the share button and select "Add to Home Screen"'})]}):c.jsxs("div",{className:"space-y-3",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Install ProsParity for quick access and offline support"}),c.jsxs(Ee,{onClick:i,className:"w-full bg-blue-600 hover:bg-blue-700",size:"sm",children:[c.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Install Now"]})]})]})})}):null},jL=({statusCounts:e})=>{if(!e)return c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-1 sm:gap-2 md:gap-3",children:Array.from({length:7}).map((n,a)=>c.jsxs(qe,{className:"bg-gray-50 border-gray-200 border shadow-sm",children:[c.jsx(pt,{className:"pb-1 pt-1 px-1 sm:pb-2 sm:pt-2 sm:px-2",children:c.jsx(gt,{className:"text-xs sm:text-sm font-medium text-gray-400 text-center leading-tight",children:"Loading..."})}),c.jsx(Je,{className:"pt-0 pb-1 px-1 sm:pb-2 sm:px-2",children:c.jsx("div",{className:"text-sm sm:text-lg md:text-xl font-semibold text-gray-300 text-center",children:"-"})})]},a))});const t=(n,a)=>a===0?"0%":`${Math.round(n/a*100)}%`,r=[{title:"Total",value:e.total,percentage:null,className:"bg-blue-50 border-blue-200"},{title:"Unpaid",value:e.unpaid||0,percentage:t(e.unpaid||0,e.total),className:"bg-red-50 border-red-200"},{title:"Partially Paid",value:e.partially_paid||0,percentage:t(e.partially_paid||0,e.total),className:"bg-yellow-50 border-yellow-200"},{title:"Cash Collected",value:e.cash_collected||0,percentage:t(e.cash_collected||0,e.total),className:"bg-orange-50 border-orange-200"},{title:"Customer Deposited",value:e.customer_deposited||0,percentage:t(e.customer_deposited||0,e.total),className:"bg-indigo-50 border-indigo-200"},{title:"Paid",value:e.paid||0,percentage:t(e.paid||0,e.total),className:"bg-green-50 border-green-200"},{title:"Paid (Pending Approval)",value:e.paid_pending_approval||0,percentage:t(e.paid_pending_approval||0,e.total),className:"bg-purple-50 border-purple-200"}];return c.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-1 sm:gap-2 md:gap-3",children:r.map((n,a)=>c.jsxs(qe,{className:`${n.className} border shadow-sm`,children:[c.jsx(pt,{className:"pb-1 pt-1 px-1 sm:pb-2 sm:pt-2 sm:px-2",children:c.jsx(gt,{className:"text-xs sm:text-sm font-medium text-gray-600 text-center leading-tight",children:n.title})}),c.jsxs(Je,{className:"pt-0 pb-1 px-1 sm:pb-2 sm:px-2",children:[c.jsx("div",{className:"text-sm sm:text-lg md:text-xl font-semibold text-gray-800 text-center",children:n.value}),n.percentage&&c.jsx("div",{className:"text-xs text-gray-500 text-center mt-1",children:n.percentage})]})]},a))})};function Cw({className:e,...t}){return c.jsx("div",{className:Ae("animate-pulse rounded-md bg-muted",e),...t})}const DL=()=>c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:Array.from({length:5}).map((e,t)=>c.jsx(qe,{children:c.jsx(Je,{className:"p-6",children:c.jsxs("div",{className:"space-y-2",children:[c.jsx(Cw,{className:"h-4 w-[100px]"}),c.jsx(Cw,{className:"h-8 w-[60px]"})]})})},t))}),RL=`
  @media (max-width: 480px) {
    .xs\\:hidden { display: none !important; }
    .xs\\:inline { display: inline !important; }
    .xs\\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)) !important; }
  }
`,ML=({onUpdate:e})=>{const{user:t}=Ht(),[r,n]=_.useState([]),[a,s]=_.useState(!1),[i,o]=_.useState(new Set),[l,u]=_.useState(()=>{const v=localStorage.getItem("pendingApprovalsOpen");return v!==null?JSON.parse(v):!0});_.useEffect(()=>{localStorage.setItem("pendingApprovalsOpen",JSON.stringify(l))},[l]);const f=async()=>{if(t){s(!0);try{const v=await S8();console.log("Fetched pending applications:",v),n(v.applications||[])}catch(v){console.error("Error fetching pending applications:",v),Se.error("Failed to fetch pending applications")}finally{s(!1)}}};_.useEffect(()=>{f()},[t]);const d=async v=>{if(!t)return;const p=`${v.applicant_id}-approve`;o(g=>new Set(g).add(p));try{const g={loan_id:v.loan_id.toString(),repayment_id:v.repayment_id,action:"accept",user_id:1,comments:""};console.log("Sending approve payload:",g);const y=await fetch("http://localhost:8000/api/v1/paidpending-approval/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!y.ok)throw new Error(`Failed to approve application: ${y.status}`);Se.success(`Application ${v.applicant_id} approved successfully`),await f(),e()}catch(g){console.error("Error approving application:",g),Se.error("Failed to approve application")}finally{o(g=>{const y=new Set(g);return y.delete(p),y})}},m=async v=>{if(!t)return;const p=`${v.applicant_id}-reject`;o(g=>new Set(g).add(p));try{const g={loan_id:v.loan_id.toString(),repayment_id:v.repayment_id,action:"reject",user_id:1,comments:""};console.log("Sending reject payload:",g);const y=await fetch("http://localhost:8000/api/v1/paidpending-approval/approve",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)});if(!y.ok)throw new Error(`Failed to reject application: ${y.status}`);Se.success(`Application ${v.applicant_id} rejected successfully`),await f(),e()}catch(g){console.error("Error rejecting application:",g),Se.error("Failed to reject application")}finally{o(g=>{const y=new Set(g);return y.delete(p),y})}},h=v=>{try{return new Date(v).toLocaleDateString("en-GB")}catch{return v}};return a?c.jsxs(qe,{children:[c.jsx(pt,{className:"p-3 sm:p-6",children:c.jsxs(gt,{className:"flex items-center gap-2",children:[c.jsx(wd,{className:"h-5 w-5 flex-shrink-0"}),c.jsx("span",{className:"text-base sm:text-lg font-semibold",children:"Pending Status Approvals"})]})}),c.jsx(Je,{className:"p-3 sm:p-6",children:c.jsx("div",{className:"text-center py-4 text-sm sm:text-base",children:"Loading pending applications..."})})]}):c.jsxs(c.Fragment,{children:[c.jsx("style",{children:RL}),c.jsx(qe,{className:"overflow-hidden",children:c.jsxs(fv,{open:l,onOpenChange:u,children:[c.jsx(dv,{asChild:!0,children:c.jsx(pt,{className:"cursor-pointer hover:bg-gray-50 transition-colors p-3 sm:p-6",children:c.jsxs(gt,{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c.jsx(wd,{className:"h-5 w-5 flex-shrink-0"}),c.jsx("span",{className:"text-base sm:text-lg font-semibold",children:"Pending Status Approvals"}),r.length>0&&c.jsx(Fr,{variant:"secondary",className:"ml-2 flex-shrink-0",children:r.length})]}),c.jsx("div",{className:"flex-shrink-0",children:l?c.jsx(Bh,{className:"h-5 w-5"}):c.jsx(wo,{className:"h-5 w-5"})})]})})}),c.jsx(hv,{children:c.jsx(Je,{children:r.length===0?c.jsxs("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:[c.jsx(wd,{className:"h-8 w-8 sm:h-12 sm:w-12 mx-auto mb-3 sm:mb-4 text-gray-300"}),c.jsx("p",{className:"text-base sm:text-lg font-medium",children:"No pending requests"}),c.jsx("p",{className:"text-xs sm:text-sm",children:"All applications have been reviewed"})]}):c.jsx("div",{className:"space-y-3 sm:space-y-4",children:r.map(v=>c.jsx("div",{className:"border rounded-lg p-3 sm:p-4 bg-gray-50",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[c.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[c.jsx(_1,{className:"h-4 w-4 text-gray-600 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-base sm:text-lg truncate",children:v.applicant_name}),c.jsx(Fr,{variant:"outline",className:"text-xs flex-shrink-0",children:v.applicant_id})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[c.jsx(Ee,{size:"sm",onClick:()=>d(v),disabled:i.has(`${v.applicant_id}-approve`)||i.has(`${v.applicant_id}-reject`),className:"flex items-center justify-center gap-1 bg-green-600 hover:bg-green-700 w-full sm:w-auto min-h-[32px] sm:min-h-[36px]",children:i.has(`${v.applicant_id}-approve`)?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),c.jsx("span",{className:"hidden xs:inline",children:"Processing..."}),c.jsx("span",{className:"xs:hidden",children:"..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(UA,{className:"h-4 w-4 sm:h-5 sm:w-5"}),c.jsx("span",{className:"hidden xs:inline",children:"Approve"}),c.jsx("span",{className:"xs:hidden",children:"Approve"})]})}),c.jsx(Ee,{size:"sm",variant:"destructive",onClick:()=>m(v),disabled:i.has(`${v.applicant_id}-approve`)||i.has(`${v.applicant_id}-reject`),className:"flex items-center justify-center gap-1 w-full sm:w-auto min-h-[32px] sm:min-h-[36px]",children:i.has(`${v.applicant_id}-reject`)?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),c.jsx("span",{className:"hidden xs:inline",children:"Processing..."}),c.jsx("span",{className:"xs:hidden",children:"..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(WA,{className:"h-4 w-4 sm:h-5 sm:w-5"}),c.jsx("span",{className:"hidden xs:inline",children:"Reject"}),c.jsx("span",{className:"xs:hidden",children:"Reject"})]})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-3 text-xs sm:text-sm",children:[c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(zA,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Amount:"}),c.jsxs("span",{className:"text-green-600 font-semibold text-xs sm:text-sm truncate",children:["₹",v.amount_collected.toLocaleString()]})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Fi,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"PTP:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:v.ptp_date||"Not set"})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(y1,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Demand:"}),c.jsxs("span",{className:"text-xs sm:text-sm truncate",children:["₹",v.demand_amount.toLocaleString()]})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Fi,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Demand Date:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:h(v.demand_date)})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Fi,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Payment:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:h(v.payment_date)})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 min-w-0",children:[c.jsx(Fi,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-500 flex-shrink-0"}),c.jsx("span",{className:"font-medium text-xs sm:text-sm whitespace-nowrap",children:"Updated:"}),c.jsx("span",{className:"text-xs sm:text-sm truncate",children:h(v.updated_at)})]})]})]})},v.applicant_id))})})})]})})]})};var lm="Tabs",[OL,Oq]=In(lm,[rm]),WE=rm(),[IL,xv]=OL(lm),HE=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:s,orientation:i="horizontal",dir:o,activationMode:l="automatic",...u}=e,f=tm(o),[d,m]=Xa({prop:n,onChange:a,defaultProp:s??"",caller:lm});return c.jsx(IL,{scope:r,baseId:Ga(),value:d,onValueChange:m,orientation:i,dir:f,activationMode:l,children:c.jsx(je.div,{dir:f,"data-orientation":i,...u,ref:t})})});HE.displayName=lm;var zE="TabsList",VE=_.forwardRef((e,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=e,s=xv(zE,r),i=WE(r);return c.jsx(R4,{asChild:!0,...i,orientation:s.orientation,dir:s.dir,loop:n,children:c.jsx(je.div,{role:"tablist","aria-orientation":s.orientation,...a,ref:t})})});VE.displayName=zE;var GE="TabsTrigger",YE=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...s}=e,i=xv(GE,r),o=WE(r),l=qE(i.baseId,n),u=QE(i.baseId,n),f=n===i.value;return c.jsx(M4,{asChild:!0,...o,focusable:!a,active:f,children:c.jsx(je.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":u,"data-state":f?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...s,ref:t,onMouseDown:Te(e.onMouseDown,d=>{!a&&d.button===0&&d.ctrlKey===!1?i.onValueChange(n):d.preventDefault()}),onKeyDown:Te(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&i.onValueChange(n)}),onFocus:Te(e.onFocus,()=>{const d=i.activationMode!=="manual";!f&&!a&&d&&i.onValueChange(n)})})})});YE.displayName=GE;var XE="TabsContent",KE=_.forwardRef((e,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:s,...i}=e,o=xv(XE,r),l=qE(o.baseId,n),u=QE(o.baseId,n),f=n===o.value,d=_.useRef(f);return _.useEffect(()=>{const m=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(m)},[]),c.jsx(Ta,{present:a||f,children:({present:m})=>c.jsx(je.div,{"data-state":f?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!m,id:u,tabIndex:0,...i,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:m&&s})})});KE.displayName=XE;function qE(e,t){return`${e}-trigger-${t}`}function QE(e,t){return`${e}-content-${t}`}var FL=HE,JE=VE,ZE=YE,eT=KE;const tT=FL,wv=_.forwardRef(({className:e,...t},r)=>c.jsx(JE,{ref:r,className:Ae("inline-flex h-12 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));wv.displayName=JE.displayName;const us=_.forwardRef(({className:e,...t},r)=>c.jsx(ZE,{ref:r,className:Ae("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-4 py-2 text-base font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));us.displayName=ZE.displayName;const fs=_.forwardRef(({className:e,...t},r)=>c.jsx(eT,{ref:r,className:Ae("mt-4 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));fs.displayName=eT.displayName;const rT=e=>{const{user:t}=Ht(),{getUserName:r,fetchProfiles:n}=Gl(),[a,s]=_.useState([]),[i,o]=_.useState(!1),[l,u]=_.useState(null),[f,d]=_.useState(null),m=_.useRef(!1);_.useEffect(()=>{e!==f&&(console.log("Comments: Clearing due to month change",{from:f,to:e}),s([]),u(null),d(null))},[e,f]);const h=_.useCallback(async y=>{if(!t||!y)return[];if(m.current)return console.log("Comments: Fetch already in progress, skipping"),a;m.current=!0,o(!0);try{console.log("=== FETCHING COMMENTS ==="),console.log("Application ID:",y),console.log("Selected Month:",e);const w=await Eu.getCommentsByRepaymentAndType(y,bu.APPLICATION_DETAILS,0,100);if(!w.results||w.results.length===0)return console.log("No comments found for application:",y,"month:",e),s([]),u(y),d(e),[];console.log("Raw comments data from API:",w.results);const x=[...new Set(w.results.map(b=>b.user_id.toString()))];console.log("Fetching profiles for user IDs:",x),await n(x);const S=w.results.map(b=>{const E=r(b.user_id.toString(),null);return console.log(`✓ Comment ${b.id}: user_id=${b.user_id} -> resolved_name="${E}"`),{...b,user_name:E,content:b.comment,application_id:y}});return console.log("Final mapped comments with resolved names:",S),s(S),u(y),d(e),S}catch(w){return console.error("Exception in fetchComments:",w),[]}finally{o(!1),m.current=!1}},[t,n,r,e]),v=_.useCallback(async(y,w,x)=>(console.warn("fetchCommentsByApplications is deprecated. Use individual fetchComments instead."),{}),[]),p=_.useCallback(async(y,w,x,S,b)=>{if(!(!t||!y||!w.trim()))try{console.log("=== ADDING COMMENT ==="),console.log("Application ID:",y),console.log("Content:",w),console.log("User ID (frontend):",t.id),console.log("User ID (sending to API): 1"),console.log("User email:",t.email),console.log("Demand Date:",x),console.log("Loan ID:",S),console.log("EMI Month:",b);let E=y;if(S&&b)try{console.log("🔍 Fetching repayment_id for loan_id:",S,"emi_month:",b);const N={Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},[O,W]=b.split("-"),P=N[O],G=parseInt(`20${W}`);if(!P||!G)throw new Error(`Invalid emi_month format: ${b}. Expected format: "Aug-25"`);console.log("🔍 Parsed month/year:",{month:P,year:G}),console.log("🔍 Querying payment_details table for loan_id:",S,"month:",P,"year:",G);const{data:X,error:V}=await Pe.from("payment_details").select("id, loan_application_id, demand_month, demand_year").eq("loan_application_id",S).eq("demand_month",P).eq("demand_year",G).maybeSingle();if(V){console.error("❌ Database query error:",V),console.log("🔍 Checking available tables...");try{const{data:K,error:Y}=await Pe.from("information_schema.tables").select("table_name").eq("table_schema","public");Y?console.log("⚠️ Could not check tables:",Y):console.log("📋 Available tables:",K==null?void 0:K.map(H=>H.table_name))}catch(K){console.log("⚠️ Table check failed:",K)}throw V}if(X)E=X.id.toString(),console.log("✅ Found repayment_id:",E,"for loan_id:",S,"emi_month:",b),console.log("✅ Payment details:",X);else{console.log("⚠️ No payment details found in database for loan_id:",S,"month:",P,"year:",G),console.log("⚠️ Using applicationId as repayment_id:",y);const{data:K,error:Y}=await Pe.from("payment_details").select("id, loan_application_id, demand_month, demand_year").eq("loan_application_id",S);Y?console.error("❌ Error listing payment details:",Y):console.log("🔍 All payment details for loan_id:",S,":",K)}}catch(N){console.error("❌ Error fetching payment details, using fallback:",N),console.log("⚠️ Using applicationId as repayment_id:",y)}else console.log("⚠️ No loan_id or emi_month provided, using applicationId as repayment_id:",y);console.log("🔍 Final repayment_id being used:",E),console.log("🔍 Is repayment_id different from applicationId?",E!==y);const k={repayment_id:E,comment:w.trim(),user_id:1,comment_type:bu.APPLICATION_DETAILS};console.log("🚀 Creating comment with data:",k),E===y?console.warn("⚠️ WARNING: repayment_id is the same as applicationId. Payment details lookup may have failed."):console.log("✅ SUCCESS: repayment_id is different from applicationId - payment details lookup worked!");const T=await Eu.createComment(k);console.log("✓ Comment added successfully via API:",T),u(null),d(null)}catch(E){throw console.error("Exception in addComment:",E),E}},[t]),g=_.useCallback(()=>{console.log("Comments: Clearing all cached data"),s([]),u(null),d(null)},[]);return{comments:a,loading:i,fetchComments:h,fetchCommentsByApplications:v,addComment:p,clearComments:g}},LL=(e,t)=>{const{user:r}=Ht(),{getUserName:n,fetchProfiles:a}=Gl(),[s,i]=_.useState([]),[o,l]=_.useState(!1),u=_.useCallback(async()=>{if(!(!r||!e)){l(!0);try{console.log("=== FETCHING AUDIT LOGS ==="),console.log("Application ID:",e),console.log("Selected Month:",t);let m=Pe.from("audit_logs").select("*").eq("application_id",e);if(t){const y=Dl(t);console.log("Filtering audit logs by demand_date:",y),m=m.eq("demand_date",y)}m=m.order("created_at",{ascending:!1});const{data:h,error:v}=await m;if(v){console.error("Error fetching audit logs:",v);return}if(!h||h.length===0){console.log("No audit logs found for application:",e,"month:",t),i([]);return}console.log("Raw audit logs data:",h);const p=[...new Set(h.map(y=>y.user_id))];console.log("Fetching profiles for user IDs:",p),await a(p),await new Promise(y=>setTimeout(y,100));const g=h.map(y=>{const w=n(y.user_id,y.user_email);return console.log(`✓ Audit log ${y.id}: user_id=${y.user_id} -> resolved_name="${w}"`),{...y,user_name:w}});console.log("Final mapped audit logs with resolved names:",g),i(g)}catch(m){console.error("Exception in fetchAuditLogs:",m)}finally{l(!1)}}},[r,e,t,a,n]),f=_.useCallback(async(m,h,v,p,g)=>{if(r)try{console.log("=== ADDING AUDIT LOG ==="),console.log("Application ID:",m),console.log("Field:",h),console.log("Previous Value:",v),console.log("New Value:",p),console.log("User ID:",r.id),console.log("User email:",r.email),console.log("Demand Date:",g);const y={application_id:m,field:h,previous_value:v,new_value:p,user_id:r.id,user_email:r.email};g&&(y.demand_date=g);const{error:w}=await Pe.from("audit_logs").insert(y);if(w)throw console.error("Error adding audit log:",w),w;console.log("✓ Audit log added successfully"),await u()}catch(y){throw console.error("Exception in addAuditLog:",y),y}},[r,u]);_.useEffect(()=>{u()},[u]);const d=_.useCallback(async()=>{await u()},[u]);return{auditLogs:s,loading:o,addAuditLog:f,refetch:d}},BL=(e,t)=>{const{user:r}=Ht(),{getUserName:n,fetchProfiles:a}=Gl(),[s,i]=_.useState([]),[o,l]=_.useState(!1),u=_.useCallback(async()=>{if(!(!r||!e)){l(!0);try{console.log("=== FETCHING CALLING LOGS ==="),console.log("Application ID:",e),console.log("Selected Month:",t);let m=Pe.from("calling_logs").select("*").eq("application_id",e);if(t){const y=Dl(t);console.log("Filtering calling logs by demand_date:",y),m=m.eq("demand_date",y)}m=m.order("created_at",{ascending:!1});const{data:h,error:v}=await m;if(v){console.error("Error fetching calling logs:",v);return}if(!h||h.length===0){console.log("No calling logs found for application:",e,"month:",t),i([]);return}console.log("Raw calling logs data:",h);const p=[...new Set(h.map(y=>y.user_id))];console.log("Fetching profiles for user IDs:",p),await a(p),await new Promise(y=>setTimeout(y,100));const g=h.map(y=>{const w=n(y.user_id,y.user_email);return console.log(`✓ Calling log ${y.id}: user_id=${y.user_id} -> resolved_name="${w}"`),{...y,user_name:w}});console.log("Final mapped calling logs with resolved names:",g),i(g)}catch(m){console.error("Exception in fetchCallingLogs:",m)}finally{l(!1)}}},[r,e,t,a,n]),f=_.useCallback(async(m,h,v)=>{if(!(!r||!e))try{console.log("=== ADDING CALLING LOG ==="),console.log("Application ID:",e),console.log("Contact Type:",m),console.log("Previous Status:",h),console.log("New Status:",v),console.log("User ID:",r.id),console.log("User email:",r.email),console.log("Selected Month:",t);const p={application_id:e,contact_type:m,previous_status:h,new_status:v,user_id:r.id,user_email:r.email,user_name:n(r.id,r.email)};t&&(p.demand_date=Dl(t));const{error:g}=await Pe.from("calling_logs").insert(p);if(g)throw console.error("Error adding calling log:",g),g;console.log("✓ Calling log added successfully"),await u()}catch(p){throw console.error("Exception in addCallingLog:",p),p}},[r,e,t,n,u]);_.useEffect(()=>{u()},[u]);const d=_.useCallback(async()=>{await u()},[u]);return{callingLogs:s,loading:o,addCallingLog:f,refetch:d}},UL={Risky:"bg-yellow-500 text-white",Repossessed:"bg-red-600 text-white","Might Need to Repossess":"bg-orange-500 text-white"},$L=({application:e})=>{const t=e.vehicle_status?UL[e.vehicle_status]||"bg-gray-400 text-white":"";return c.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[c.jsx("div",{className:"p-2 sm:p-3 bg-blue-100 rounded-full",children:c.jsx($A,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-600"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 truncate",children:e.applicant_name}),e.vehicle_status&&c.jsx(Fr,{className:t,children:e.vehicle_status})]}),c.jsxs("div",{className:"space-y-1 text-xs sm:text-sm text-gray-600",children:[e.demand_date&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"EMI Month:"})," ",Xn(e.demand_date)]}),e.emi_amount!=null&&c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"EMI Due:"})," ",mv(e.emi_amount)]})]})]})]})};function Aw(e,[t,r]){return Math.min(r,Math.max(t,e))}var WL=[" ","Enter","ArrowUp","ArrowDown"],HL=[" ","Enter"],lo="Select",[cm,um,zL]=h1(lo),[Kl,Iq]=In(lo,[zL,zl]),fm=zl(),[VL,bi]=Kl(lo),[GL,YL]=Kl(lo),nT=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:s,value:i,defaultValue:o,onValueChange:l,dir:u,name:f,autoComplete:d,disabled:m,required:h,form:v}=e,p=fm(t),[g,y]=_.useState(null),[w,x]=_.useState(null),[S,b]=_.useState(!1),E=tm(u),[k,T]=Xa({prop:n,defaultProp:a??!1,onChange:s,caller:lo}),[N,O]=Xa({prop:i,defaultProp:o,onChange:l,caller:lo}),W=_.useRef(null),P=g?v||!!g.closest("form"):!0,[G,X]=_.useState(new Set),V=Array.from(G).map(K=>K.props.value).join(";");return c.jsx(_b,{...p,children:c.jsxs(VL,{required:h,scope:t,trigger:g,onTriggerChange:y,valueNode:w,onValueNodeChange:x,valueNodeHasChildren:S,onValueNodeHasChildrenChange:b,contentId:Ga(),value:N,onValueChange:O,open:k,onOpenChange:T,dir:E,triggerPointerDownPosRef:W,disabled:m,children:[c.jsx(cm.Provider,{scope:t,children:c.jsx(GL,{scope:e.__scopeSelect,onNativeOptionAdd:_.useCallback(K=>{X(Y=>new Set(Y).add(K))},[]),onNativeOptionRemove:_.useCallback(K=>{X(Y=>{const H=new Set(Y);return H.delete(K),H})},[]),children:r})}),P?c.jsxs(NT,{"aria-hidden":!0,required:h,tabIndex:-1,name:f,autoComplete:d,value:N,onChange:K=>O(K.target.value),disabled:m,form:v,children:[N===void 0?c.jsx("option",{value:""}):null,Array.from(G)]},V):null]})})};nT.displayName=lo;var aT="SelectTrigger",sT=_.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=e,s=fm(r),i=bi(aT,r),o=i.disabled||n,l=Qe(t,i.onTriggerChange),u=um(r),f=_.useRef("touch"),[d,m,h]=AT(p=>{const g=u().filter(x=>!x.disabled),y=g.find(x=>x.value===i.value),w=PT(g,p,y);w!==void 0&&i.onValueChange(w.value)}),v=p=>{o||(i.onOpenChange(!0),h()),p&&(i.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)})};return c.jsx(zh,{asChild:!0,...s,children:c.jsx(je.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":CT(i.value)?"":void 0,...a,ref:l,onClick:Te(a.onClick,p=>{p.currentTarget.focus(),f.current!=="mouse"&&v(p)}),onPointerDown:Te(a.onPointerDown,p=>{f.current=p.pointerType;const g=p.target;g.hasPointerCapture(p.pointerId)&&g.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&p.pointerType==="mouse"&&(v(p),p.preventDefault())}),onKeyDown:Te(a.onKeyDown,p=>{const g=d.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&m(p.key),!(g&&p.key===" ")&&WL.includes(p.key)&&(v(),p.preventDefault())})})})});sT.displayName=aT;var iT="SelectValue",oT=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,children:s,placeholder:i="",...o}=e,l=bi(iT,r),{onValueNodeHasChildrenChange:u}=l,f=s!==void 0,d=Qe(t,l.onValueNodeChange);return pr(()=>{u(f)},[u,f]),c.jsx(je.span,{...o,ref:d,style:{pointerEvents:"none"},children:CT(l.value)?c.jsx(c.Fragment,{children:i}):s})});oT.displayName=iT;var XL="SelectIcon",lT=_.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...a}=e;return c.jsx(je.span,{"aria-hidden":!0,...a,ref:t,children:n||"▼"})});lT.displayName=XL;var KL="SelectPortal",cT=e=>c.jsx(Ku,{asChild:!0,...e});cT.displayName=KL;var co="SelectContent",uT=_.forwardRef((e,t)=>{const r=bi(co,e.__scopeSelect),[n,a]=_.useState();if(pr(()=>{a(new DocumentFragment)},[]),!r.open){const s=n;return s?xo.createPortal(c.jsx(fT,{scope:e.__scopeSelect,children:c.jsx(cm.Slot,{scope:e.__scopeSelect,children:c.jsx("div",{children:e.children})})}),s):null}return c.jsx(dT,{...e,ref:t})});uT.displayName=co;var oa=10,[fT,Ei]=Kl(co),qL="SelectContentImpl",QL=no("SelectContent.RemoveScroll"),dT=_.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:s,onPointerDownOutside:i,side:o,sideOffset:l,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:m,collisionPadding:h,sticky:v,hideWhenDetached:p,avoidCollisions:g,...y}=e,w=bi(co,r),[x,S]=_.useState(null),[b,E]=_.useState(null),k=Qe(t,q=>S(q)),[T,N]=_.useState(null),[O,W]=_.useState(null),P=um(r),[G,X]=_.useState(!1),V=_.useRef(!1);_.useEffect(()=>{if(x)return $1(x)},[x]),U1();const K=_.useCallback(q=>{const[ae,...oe]=P().map(A=>A.ref.current),[se]=oe.slice(-1),J=document.activeElement;for(const A of q)if(A===J||(A==null||A.scrollIntoView({block:"nearest"}),A===ae&&b&&(b.scrollTop=0),A===se&&b&&(b.scrollTop=b.scrollHeight),A==null||A.focus(),document.activeElement!==J))return},[P,b]),Y=_.useCallback(()=>K([T,x]),[K,T,x]);_.useEffect(()=>{G&&Y()},[G,Y]);const{onOpenChange:H,triggerPointerDownPosRef:M}=w;_.useEffect(()=>{if(x){let q={x:0,y:0};const ae=se=>{var J,A;q={x:Math.abs(Math.round(se.pageX)-(((J=M.current)==null?void 0:J.x)??0)),y:Math.abs(Math.round(se.pageY)-(((A=M.current)==null?void 0:A.y)??0))}},oe=se=>{q.x<=10&&q.y<=10?se.preventDefault():x.contains(se.target)||H(!1),document.removeEventListener("pointermove",ae),M.current=null};return M.current!==null&&(document.addEventListener("pointermove",ae),document.addEventListener("pointerup",oe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ae),document.removeEventListener("pointerup",oe,{capture:!0})}}},[x,H,M]),_.useEffect(()=>{const q=()=>H(!1);return window.addEventListener("blur",q),window.addEventListener("resize",q),()=>{window.removeEventListener("blur",q),window.removeEventListener("resize",q)}},[H]);const[ne,ce]=AT(q=>{const ae=P().filter(J=>!J.disabled),oe=ae.find(J=>J.ref.current===document.activeElement),se=PT(ae,q,oe);se&&setTimeout(()=>se.ref.current.focus())}),j=_.useCallback((q,ae,oe)=>{const se=!V.current&&!oe;(w.value!==void 0&&w.value===ae||se)&&(N(q),se&&(V.current=!0))},[w.value]),z=_.useCallback(()=>x==null?void 0:x.focus(),[x]),L=_.useCallback((q,ae,oe)=>{const se=!V.current&&!oe;(w.value!==void 0&&w.value===ae||se)&&W(q)},[w.value]),U=n==="popper"?rg:hT,Q=U===rg?{side:o,sideOffset:l,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:m,collisionPadding:h,sticky:v,hideWhenDetached:p,avoidCollisions:g}:{};return c.jsx(fT,{scope:r,content:x,viewport:b,onViewportChange:E,itemRefCallback:j,selectedItem:T,onItemLeave:z,itemTextRefCallback:L,focusSelectedItem:Y,selectedItemText:O,position:n,isPositioned:G,searchRef:ne,children:c.jsx(Zh,{as:QL,allowPinchZoom:!0,children:c.jsx(Qh,{asChild:!0,trapped:w.open,onMountAutoFocus:q=>{q.preventDefault()},onUnmountAutoFocus:Te(a,q=>{var ae;(ae=w.trigger)==null||ae.focus({preventScroll:!0}),q.preventDefault()}),children:c.jsx(Ul,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:q=>q.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:c.jsx(U,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:q=>q.preventDefault(),...y,...Q,onPlaced:()=>X(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:Te(y.onKeyDown,q=>{const ae=q.ctrlKey||q.altKey||q.metaKey;if(q.key==="Tab"&&q.preventDefault(),!ae&&q.key.length===1&&ce(q.key),["ArrowUp","ArrowDown","Home","End"].includes(q.key)){let se=P().filter(J=>!J.disabled).map(J=>J.ref.current);if(["ArrowUp","End"].includes(q.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(q.key)){const J=q.target,A=se.indexOf(J);se=se.slice(A+1)}setTimeout(()=>K(se)),q.preventDefault()}})})})})})})});dT.displayName=qL;var JL="SelectItemAlignedPosition",hT=_.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=e,s=bi(co,r),i=Ei(co,r),[o,l]=_.useState(null),[u,f]=_.useState(null),d=Qe(t,k=>f(k)),m=um(r),h=_.useRef(!1),v=_.useRef(!0),{viewport:p,selectedItem:g,selectedItemText:y,focusSelectedItem:w}=i,x=_.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&u&&p&&g&&y){const k=s.trigger.getBoundingClientRect(),T=u.getBoundingClientRect(),N=s.valueNode.getBoundingClientRect(),O=y.getBoundingClientRect();if(s.dir!=="rtl"){const J=O.left-T.left,A=N.left-J,pe=k.left-A,Ne=k.width+pe,$e=Math.max(Ne,T.width),Me=window.innerWidth-oa,xe=Aw(A,[oa,Math.max(oa,Me-$e)]);o.style.minWidth=Ne+"px",o.style.left=xe+"px"}else{const J=T.right-O.right,A=window.innerWidth-N.right-J,pe=window.innerWidth-k.right-A,Ne=k.width+pe,$e=Math.max(Ne,T.width),Me=window.innerWidth-oa,xe=Aw(A,[oa,Math.max(oa,Me-$e)]);o.style.minWidth=Ne+"px",o.style.right=xe+"px"}const W=m(),P=window.innerHeight-oa*2,G=p.scrollHeight,X=window.getComputedStyle(u),V=parseInt(X.borderTopWidth,10),K=parseInt(X.paddingTop,10),Y=parseInt(X.borderBottomWidth,10),H=parseInt(X.paddingBottom,10),M=V+K+G+H+Y,ne=Math.min(g.offsetHeight*5,M),ce=window.getComputedStyle(p),j=parseInt(ce.paddingTop,10),z=parseInt(ce.paddingBottom,10),L=k.top+k.height/2-oa,U=P-L,Q=g.offsetHeight/2,q=g.offsetTop+Q,ae=V+K+q,oe=M-ae;if(ae<=L){const J=W.length>0&&g===W[W.length-1].ref.current;o.style.bottom="0px";const A=u.clientHeight-p.offsetTop-p.offsetHeight,pe=Math.max(U,Q+(J?z:0)+A+Y),Ne=ae+pe;o.style.height=Ne+"px"}else{const J=W.length>0&&g===W[0].ref.current;o.style.top="0px";const pe=Math.max(L,V+p.offsetTop+(J?j:0)+Q)+oe;o.style.height=pe+"px",p.scrollTop=ae-L+p.offsetTop}o.style.margin=`${oa}px 0`,o.style.minHeight=ne+"px",o.style.maxHeight=P+"px",n==null||n(),requestAnimationFrame(()=>h.current=!0)}},[m,s.trigger,s.valueNode,o,u,p,g,y,s.dir,n]);pr(()=>x(),[x]);const[S,b]=_.useState();pr(()=>{u&&b(window.getComputedStyle(u).zIndex)},[u]);const E=_.useCallback(k=>{k&&v.current===!0&&(x(),w==null||w(),v.current=!1)},[x,w]);return c.jsx(e7,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:h,onScrollButtonChange:E,children:c.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:c.jsx(je.div,{...a,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});hT.displayName=JL;var ZL="SelectPopperPosition",rg=_.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=oa,...s}=e,i=fm(r);return c.jsx(R1,{...i,...s,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});rg.displayName=ZL;var[e7,_v]=Kl(co,{}),ng="SelectViewport",mT=_.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...a}=e,s=Ei(ng,r),i=_v(ng,r),o=Qe(t,s.onViewportChange),l=_.useRef(0);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),c.jsx(cm.Slot,{scope:r,children:c.jsx(je.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Te(a.onScroll,u=>{const f=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:m}=i;if(m!=null&&m.current&&d){const h=Math.abs(l.current-f.scrollTop);if(h>0){const v=window.innerHeight-oa*2,p=parseFloat(d.style.minHeight),g=parseFloat(d.style.height),y=Math.max(p,g);if(y<v){const w=y+h,x=Math.min(v,w),S=w-x;d.style.height=x+"px",d.style.bottom==="0px"&&(f.scrollTop=S>0?S:0,d.style.justifyContent="flex-end")}}}l.current=f.scrollTop})})})]})});mT.displayName=ng;var pT="SelectGroup",[t7,r7]=Kl(pT),n7=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=Ga();return c.jsx(t7,{scope:r,id:a,children:c.jsx(je.div,{role:"group","aria-labelledby":a,...n,ref:t})})});n7.displayName=pT;var gT="SelectLabel",vT=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=r7(gT,r);return c.jsx(je.div,{id:a.id,...n,ref:t})});vT.displayName=gT;var ah="SelectItem",[a7,yT]=Kl(ah),xT=_.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:s,...i}=e,o=bi(ah,r),l=Ei(ah,r),u=o.value===n,[f,d]=_.useState(s??""),[m,h]=_.useState(!1),v=Qe(t,w=>{var x;return(x=l.itemRefCallback)==null?void 0:x.call(l,w,n,a)}),p=Ga(),g=_.useRef("touch"),y=()=>{a||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return c.jsx(a7,{scope:r,value:n,disabled:a,textId:p,isSelected:u,onItemTextChange:_.useCallback(w=>{d(x=>x||((w==null?void 0:w.textContent)??"").trim())},[]),children:c.jsx(cm.ItemSlot,{scope:r,value:n,disabled:a,textValue:f,children:c.jsx(je.div,{role:"option","aria-labelledby":p,"data-highlighted":m?"":void 0,"aria-selected":u&&m,"data-state":u?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...i,ref:v,onFocus:Te(i.onFocus,()=>h(!0)),onBlur:Te(i.onBlur,()=>h(!1)),onClick:Te(i.onClick,()=>{g.current!=="mouse"&&y()}),onPointerUp:Te(i.onPointerUp,()=>{g.current==="mouse"&&y()}),onPointerDown:Te(i.onPointerDown,w=>{g.current=w.pointerType}),onPointerMove:Te(i.onPointerMove,w=>{var x;g.current=w.pointerType,a?(x=l.onItemLeave)==null||x.call(l):g.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Te(i.onPointerLeave,w=>{var x;w.currentTarget===document.activeElement&&((x=l.onItemLeave)==null||x.call(l))}),onKeyDown:Te(i.onKeyDown,w=>{var S;((S=l.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(HL.includes(w.key)&&y(),w.key===" "&&w.preventDefault())})})})})});xT.displayName=ah;var Ac="SelectItemText",wT=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:a,...s}=e,i=bi(Ac,r),o=Ei(Ac,r),l=yT(Ac,r),u=YL(Ac,r),[f,d]=_.useState(null),m=Qe(t,y=>d(y),l.onItemTextChange,y=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,y,l.value,l.disabled)}),h=f==null?void 0:f.textContent,v=_.useMemo(()=>c.jsx("option",{value:l.value,disabled:l.disabled,children:h},l.value),[l.disabled,l.value,h]),{onNativeOptionAdd:p,onNativeOptionRemove:g}=u;return pr(()=>(p(v),()=>g(v)),[p,g,v]),c.jsxs(c.Fragment,{children:[c.jsx(je.span,{id:l.textId,...s,ref:m}),l.isSelected&&i.valueNode&&!i.valueNodeHasChildren?xo.createPortal(s.children,i.valueNode):null]})});wT.displayName=Ac;var _T="SelectItemIndicator",ST=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return yT(_T,r).isSelected?c.jsx(je.span,{"aria-hidden":!0,...n,ref:t}):null});ST.displayName=_T;var ag="SelectScrollUpButton",kT=_.forwardRef((e,t)=>{const r=Ei(ag,e.__scopeSelect),n=_v(ag,e.__scopeSelect),[a,s]=_.useState(!1),i=Qe(t,n.onScrollButtonChange);return pr(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=l.scrollTop>0;s(u)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?c.jsx(ET,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});kT.displayName=ag;var sg="SelectScrollDownButton",bT=_.forwardRef((e,t)=>{const r=Ei(sg,e.__scopeSelect),n=_v(sg,e.__scopeSelect),[a,s]=_.useState(!1),i=Qe(t,n.onScrollButtonChange);return pr(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=l.scrollHeight-l.clientHeight,f=Math.ceil(l.scrollTop)<u;s(f)};const l=r.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),a?c.jsx(ET,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=r;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});bT.displayName=sg;var ET=_.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=e,s=Ei("SelectScrollButton",r),i=_.useRef(null),o=um(r),l=_.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return _.useEffect(()=>()=>l(),[l]),pr(()=>{var f;const u=o().find(d=>d.ref.current===document.activeElement);(f=u==null?void 0:u.ref.current)==null||f.scrollIntoView({block:"nearest"})},[o]),c.jsx(je.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Te(a.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:Te(a.onPointerMove,()=>{var u;(u=s.onItemLeave)==null||u.call(s),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:Te(a.onPointerLeave,()=>{l()})})}),s7="SelectSeparator",TT=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return c.jsx(je.div,{"aria-hidden":!0,...n,ref:t})});TT.displayName=s7;var ig="SelectArrow",i7=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,a=fm(r),s=bi(ig,r),i=Ei(ig,r);return s.open&&i.position==="popper"?c.jsx(M1,{...a,...n,ref:t}):null});i7.displayName=ig;var o7="SelectBubbleInput",NT=_.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const a=_.useRef(null),s=Qe(n,a),i=V1(t);return _.useEffect(()=>{const o=a.current;if(!o)return;const l=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(l,"value").set;if(i!==t&&f){const d=new Event("change",{bubbles:!0});f.call(o,t),o.dispatchEvent(d)}},[i,t]),c.jsx(je.select,{...r,style:{...mk,...r.style},ref:s,defaultValue:t})});NT.displayName=o7;function CT(e){return e===""||e===void 0}function AT(e){const t=ea(e),r=_.useRef(""),n=_.useRef(0),a=_.useCallback(i=>{const o=r.current+i;t(o),function l(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=_.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return _.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,s]}function PT(e,t,r){const a=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,s=r?e.indexOf(r):-1;let i=l7(e,Math.max(s,0));a.length===1&&(i=i.filter(u=>u!==r));const l=i.find(u=>u.textValue.toLowerCase().startsWith(a.toLowerCase()));return l!==r?l:void 0}function l7(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var c7=nT,jT=sT,u7=oT,f7=lT,d7=cT,DT=uT,h7=mT,RT=vT,MT=xT,m7=wT,p7=ST,OT=kT,IT=bT,FT=TT;const jn=c7,Dn=u7,mn=_.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(jT,{ref:n,className:Ae("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,c.jsx(f7,{asChild:!0,children:c.jsx(wo,{className:"h-4 w-4 opacity-50"})})]}));mn.displayName=jT.displayName;const LT=_.forwardRef(({className:e,...t},r)=>c.jsx(OT,{ref:r,className:Ae("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(Bh,{className:"h-4 w-4"})}));LT.displayName=OT.displayName;const BT=_.forwardRef(({className:e,...t},r)=>c.jsx(IT,{ref:r,className:Ae("flex cursor-default items-center justify-center py-1",e),...t,children:c.jsx(wo,{className:"h-4 w-4"})}));BT.displayName=IT.displayName;const pn=_.forwardRef(({className:e,children:t,position:r="popper",...n},a)=>c.jsx(d7,{children:c.jsxs(DT,{ref:a,className:Ae("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[c.jsx(LT,{}),c.jsx(h7,{className:Ae("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),c.jsx(BT,{})]})}));pn.displayName=DT.displayName;const g7=_.forwardRef(({className:e,...t},r)=>c.jsx(RT,{ref:r,className:Ae("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));g7.displayName=RT.displayName;const bt=_.forwardRef(({className:e,children:t,...r},n)=>c.jsxs(MT,{ref:n,className:Ae("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(p7,{children:c.jsx(Lk,{className:"h-4 w-4"})})}),c.jsx(m7,{children:t})]}));bt.displayName=MT.displayName;const v7=_.forwardRef(({className:e,...t},r)=>c.jsx(FT,{ref:r,className:Ae("-mx-1 my-1 h-px bg-muted",e),...t}));v7.displayName=FT.displayName;const kp=[{value:"3",display:"Not Called",color:"text-gray-600"},{value:"2",display:"Not Answered",color:"text-red-600"},{value:"1",display:"Answered",color:"text-green-600"}],y7=({currentStatus:e,onStatusChange:t,disabled:r})=>{console.log("🔄 CallStatusSelector: Rendering with currentStatus:",e);const n=i=>{if(!i)return"3";if(["1","2","3"].includes(i))return i;const l={answered:"1","not answered":"2","not called":"3"}[i.toLowerCase()]||"3";return console.log("🔄 CallStatusSelector: Converting status:",i,"to display value:",l),l},a=kp.find(i=>i.value===n(e))||kp[0],s=i=>{console.log("🔄 CallStatusSelector: Status changed from",e,"to",i),console.log("🔄 CallStatusSelector: Calling onStatusChange with value:",i),t(i)};return c.jsxs(jn,{value:n(e),onValueChange:s,disabled:r,children:[c.jsx(mn,{className:`w-40 h-8 text-xs ${a.color}`,children:c.jsx(Dn,{})}),c.jsx(pn,{children:kp.map(i=>c.jsx(bt,{value:i.value,className:`text-xs ${i.color}`,children:i.display},i.value))})]})},x7=({title:e,name:t,mobile:r,email:n,currentStatus:a,onStatusChange:s,showCallingStatus:i=!0})=>(console.log(`🔄 ContactCard (${e}): Rendering with currentStatus:`,a),c.jsxs("div",{className:"border rounded-lg p-4 bg-white shadow-sm hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 mb-3",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(_1,{className:"h-4 w-4 text-blue-600"}),c.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:e})]}),c.jsx("p",{className:"text-sm font-medium text-gray-800 break-words mb-2",children:t}),c.jsxs("div",{className:"space-y-1",children:[r&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[c.jsx(Hk,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"break-all",children:r})]}),n&&c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[c.jsx(XA,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"break-all",children:n})]})]})]}),r&&c.jsx(BE,{name:"Call",phone:r,variant:"outline",size:"sm",className:"flex-shrink-0"})]}),i&&c.jsxs("div",{className:"flex items-center gap-2 flex-wrap pt-2 border-t border-gray-100",children:[c.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Calling Status:"}),c.jsx(y7,{currentStatus:a,onStatusChange:s})]})]})),w7=e=>({"No response":0,"Customer funded the account":1,"Customer will fund the account on a future date":2,"Cash collected":3,"Cash will be collected on a future date":4,"Spoken – no commitment":5,"Refused / unable to fund":6})[e]??0,UT=e=>isNaN(Number(e))?{answered:1,"not answered":2,"not called":3}[e.toLowerCase()]??3:parseInt(e,10),$T=e=>isNaN(Number(e))?{applicant:1,co_applicant:2,guarantor:3,reference:4}[e.toLowerCase()]??1:parseInt(e,10),_7=e=>({Unpaid:0,"Partially Paid":1,"Cash Collected from Customer":2,"Customer Deposited to Bank":3,Paid:4,"Paid (Pending Approval)":5})[e]??0,S7=()=>{console.log("🧪 Testing Contact Calling Payload Structure:"),[{contactType:"applicant",status:"answered",expectedContactType:1,expectedStatus:1},{contactType:"co_applicant",status:"not answered",expectedContactType:2,expectedStatus:2},{contactType:"guarantor",status:"not called",expectedContactType:3,expectedStatus:3},{contactType:"reference",status:"answered",expectedContactType:4,expectedStatus:1}].forEach(t=>{const r=$T(t.contactType),n=UT(t.status);console.log(`  ${t.contactType} (${t.status}):`,{contact_type:r,contact_calling_status:n,calling_type:1,expected:{contact_type:t.expectedContactType,contact_calling_status:t.expectedStatus,calling_type:1}})})};class Sv{static async updateApplicationStatus(t,r){const n={loan_id:t,...r};console.log("🚀 Final API Request Body:",n),console.log("🌐 API Endpoint:",`${Mr}/status-management/${t}`);const a=await fetch(`${Mr}/status-management/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok){const i=await a.json().catch(()=>({}));throw console.error("❌ Status update failed:",a.status,i),new Error(`Failed to update status: ${a.status} - ${JSON.stringify(i)}`)}const s=await a.json();return console.log("📥 Backend response:",s),typeof s=="string"?{success:!0,message:s,loan_id:parseInt(t,10),updated_fields:[],new_status:{}}:s&&typeof s=="object"&&"success"in s?s:a.ok?{success:!0,message:(s==null?void 0:s.message)||"Status updated successfully",loan_id:parseInt(t,10),updated_fields:(s==null?void 0:s.updated_fields)||[],new_status:(s==null?void 0:s.new_status)||{}}:{success:!0,message:"Status updated successfully",loan_id:parseInt(t,10),updated_fields:[],new_status:{}}}static async getApplicationStatus(t,r){const n=new URLSearchParams({demand_date:r}),a=await fetch(`${Mr}/status-management/${t}?${n.toString()}`);if(!a.ok)throw new Error(`Failed to get application status: ${a.status}`);return await a.json()}static async updateDemandCallingStatus(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,demand_calling_status:w7(r),contact_calling_status:0,contact_type:1})}static async updateContactCallingStatus(t,r,n,a,s){const i={calling_type:1,contact_calling_status:UT(n),contact_type:$T(r)};return s&&(i.repayment_id=s),a&&(i.demand_date=a),console.log("📤 Contact Calling Status Update Payload:",{loan_id:t,...i}),await this.updateApplicationStatus(t,i)}static async updateRepaymentStatus(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,repayment_status:_7(r),contact_calling_status:0,contact_type:1})}static async updatePTPDate(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,ptp_date:r,contact_calling_status:0,contact_type:1})}static async updateAmountCollected(t,r,n=""){return await this.updateApplicationStatus(t,{repayment_id:n,calling_type:2,amount_collected:r,contact_calling_status:0,contact_type:1})}static async updateMultipleStatusFields(t,r,n=""){const a={repayment_id:n,calling_type:2,contact_calling_status:0,contact_type:1,...r};return await this.updateApplicationStatus(t,a)}}const k7=e=>{const t=(e==null?void 0:e.toString())||"3";return["answered","not answered","not called"].includes(t.toLowerCase())?t:{1:"1",2:"2",3:"3"}[t]||"3"},b7=e=>{const t=e.toLowerCase();return["1","2","3"].includes(e)?e:{answered:"1","not answered":"2","not called":"3"}[t]||"3"},E7=()=>{const{user:e}=Ht(),[t,r]=_.useState(!1),n=_.useCallback(async(s,i)=>{if(!e||!s)return{};r(!0);try{console.log("=== CONTACT STATUS FETCH ==="),console.log("Application ID:",s),console.log("Selected Month:",i);let o=Pe.from("contact_calling_status").select("contact_type, status, created_at").eq("application_id",s);if(i){const d=Dl(i);console.log("Filtering by demand_date:",d),o=o.eq("demand_date",d)}o=o.order("created_at",{ascending:!1});const{data:l,error:u}=await o;if(u)return console.error("Error fetching contact status:",u),{};const f={};return l&&l.forEach(d=>{const m=d.contact_type.toLowerCase();f[m]||(f[m]=k7(d.status))}),console.log("✅ Contact status loaded:",f),f}catch(o){return console.error("Error in fetchContactStatus:",o),{}}finally{r(!1)}},[e]),a=_.useCallback(async(s,i,o,l,u)=>{if(e)try{console.log("=== UPDATING CONTACT STATUS ==="),console.log("Application ID:",s),console.log("Contact Type:",i),console.log("New Status:",o),console.log("Selected Month:",l),console.log("Repayment ID:",u);const f=l?Dl(l):void 0,d=b7(o);console.log("Converted status for API:",{display:o,id:d});const m=await Sv.updateContactCallingStatus(s,i,d,f,u);if(console.log("📥 API Response Result:",m),m.success)console.log("✅ Contact status updated successfully via API:",m);else throw console.error("❌ API returned success: false:",m),new Error(m.message||"Failed to update contact status")}catch(f){throw console.error("Error in updateContactStatus:",f),f}},[e]);return{fetchContactStatus:n,updateContactStatus:a,loading:t}};class T7{static async getApplicationContacts(t){const r=await fetch(`${Mr}/contacts/${t}`);if(!r.ok)throw new Error(`Failed to fetch contacts: ${r.status}`);return await r.json()}static async getApplicantContact(t){return(await this.getApplicationContacts(t)).applicant}static async getCoApplicants(t){return(await this.getApplicationContacts(t)).co_applicants}static async getGuarantors(t){return(await this.getApplicationContacts(t)).guarantors}static async getReferences(t){return(await this.getApplicationContacts(t)).references}static async getContactsByType(t,r){const n=await this.getApplicationContacts(t);switch(r.toLowerCase()){case"applicant":return[n.applicant];case"co_applicant":case"co-applicant":return n.co_applicants;case"guarantor":return n.guarantors;case"reference":return n.references;default:throw new Error(`Invalid contact type: ${r}`)}}}const N7=e=>{const[t,r]=_.useState(null),[n,a]=_.useState(!1),[s,i]=_.useState(null),o=_.useCallback(async()=>{if(e){a(!0),i(null);try{console.log("🔄 Fetching contacts for application:",e);const u=await T7.getApplicationContacts(e);console.log("✅ Contacts loaded:",u),r(u)}catch(u){console.error("❌ Error fetching contacts:",u),i(u instanceof Error?u.message:"Failed to fetch contacts")}finally{a(!1)}}},[e]);_.useEffect(()=>{o()},[o]);const l=_.useCallback(()=>{o()},[o]);return{contacts:t,loading:n,error:s,refreshContacts:l}},kv=({open:e,onClose:t,logs:r,title:n,type:a})=>{const s=o=>{try{const l=new Date(o);return`${vt(l,"dd-MMM-yy")} at ${vt(l,"HH:mm")}`}catch{return o}},i=o=>!o||o.trim()===""||o==="Unknown User"?"Unknown User":(o.includes("@"),o);return c.jsx(So,{open:e,onOpenChange:t,children:c.jsxs(_i,{className:"max-w-2xl max-h-[80vh] overflow-hidden flex flex-col",children:[c.jsx(Si,{className:"flex-shrink-0",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(ko,{children:n}),c.jsx(Ee,{variant:"ghost",size:"sm",onClick:t,children:c.jsx(Ns,{className:"h-4 w-4"})})]})}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:r.length===0?c.jsxs("div",{className:"text-sm text-gray-500 text-center py-8",children:["No ",a==="audit"?"status changes":"call activity"," recorded yet"]}):c.jsx("div",{className:"space-y-3",children:r.map(o=>{var l;return c.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsx("span",{className:"font-semibold text-blue-700 capitalize",children:a==="audit"?o.field:(l=o.contact_type)==null?void 0:l.replace("_"," ")}),c.jsx("span",{className:"text-xs text-gray-500",children:s(o.created_at)})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"From:"}),c.jsx("span",{className:"text-red-600 font-medium",children:a==="audit"?o.previous_value||"Not Set":o.previous_status||"Not Called"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"To:"}),c.jsx("span",{className:"text-green-600 font-medium",children:a==="audit"?o.new_value||"Not Set":o.new_status})]}),c.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Changed by: ",i(o.user_name)]})]})]},o.id)})})})]})})},C7=({fiLocation:e})=>{const r=(s=>{if(!s||s.trim()==="")return null;const o=s.replace(/^FI_PENDING_/i,"").match(/(-?\d+\.?\d*)[,\s]+(-?\d+\.?\d*)/);if(o){const l=parseFloat(o[1]),u=parseFloat(o[2]);if(!isNaN(l)&&!isNaN(u)&&l>=-90&&l<=90&&u>=-180&&u<=180)return{lat:l,lng:u}}return null})(e);if(!r)return null;const n=(s,i)=>`${s.toFixed(6)}, ${i.toFixed(6)}`,a=()=>{const s=`https://www.google.com/maps?q=${r.lat},${r.lng}`;window.open(s,"_blank")};return c.jsxs(qe,{className:"mb-4",children:[c.jsx(pt,{className:"pb-3",children:c.jsxs(gt,{className:"text-sm flex items-center gap-2",children:[c.jsx(Wk,{className:"h-4 w-4 text-blue-600"}),"Field Investigation Location"]})}),c.jsx(Je,{className:"pt-0",children:c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Coordinates"}),c.jsx("p",{className:"text-xs text-gray-600 font-mono",children:n(r.lat,r.lng)})]}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:a,className:"flex items-center gap-1",children:[c.jsx(VA,{className:"h-3 w-3"}),"View on Map"]})]})})})]})},A7=({application:e,callingLogs:t,onCallingStatusChange:r,selectedMonth:n,onReloadApplication:a})=>{const[s,i]=_.useState(!1),o=e.loan_id?e.loan_id.toString():e.applicant_id,{contacts:l,loading:u,error:f,refreshContacts:d}=N7(o),{updateContactStatus:m}=E7(),h=_.useRef({}),[v,p]=_.useState(()=>{const E=k=>k?["1","2","3"].includes(k.toString())?k.toString():{answered:"1","not answered":"2","not called":"3"}[k.toString().toLowerCase()]||"3":"3";return e.calling_statuses?{applicant:E(e.calling_statuses.applicant),co_applicant:E(e.calling_statuses.co_applicant),guarantor:E(e.calling_statuses.guarantor),reference:E(e.calling_statuses.reference)}:{applicant:"3",co_applicant:"3",guarantor:"3",reference:"3"}});_.useEffect(()=>{if(e.calling_statuses){const E=`${n}-${e.payment_id}`,k=Object.values(v).some(N=>N!=="3"&&N!=="1"&&N!=="2"),T=Object.values(e.calling_statuses).some(N=>N&&N!=="3");if(k&&!T){console.log("🔄 ContactsTab: Preserving local status changes during month change");return}if(T)console.log("🔄 ContactsTab: Updating local statuses from application data:",e.calling_statuses),p(e.calling_statuses),h.current[E]={...e.calling_statuses};else{const N=h.current[E];N&&k&&(console.log("🔄 ContactsTab: Restoring last known state for month:",E,N),p(N))}}},[e.calling_statuses,v,n,e.payment_id]),_.useEffect(()=>{console.log("🔄 ContactsTab: Using contact ID:",o,"for application:",e.applicant_id),console.log("🔄 ContactsTab: Application has loan_id:",e.loan_id),console.log("🔄 ContactsTab: Application calling statuses:",e.calling_statuses),console.log("🔄 ContactsTab: Local calling statuses:",v),console.log("🔄 ContactsTab: Selected month:",n),console.log("🔄 ContactsTab: Application payment_id:",e.payment_id),S7()},[o,e.applicant_id,e.loan_id,e.calling_statuses,v,n,e.payment_id]);const g=E=>{try{const k=new Date(E);return`${vt(k,"dd-MMM-yy")} at ${vt(k,"HH:mm")}`}catch{return E}},y=t.slice(0,2),w=()=>{var k,T,N,O,W,P;return l?[{type:"applicant",displayType:"Applicant",name:((k=l.applicant)==null?void 0:k.name)||e.applicant_name,mobile:((T=l.applicant)==null?void 0:T.phone)||e.applicant_mobile,email:(N=l.applicant)==null?void 0:N.email,callingStatus:v.applicant||"3",contactTypeId:1},...((O=l.co_applicants)==null?void 0:O.map((G,X)=>({type:"co_applicant",displayType:`Co-Applicant ${l.co_applicants.length>1?X+1:""}`,name:G.name,mobile:G.phone,email:G.email,callingStatus:v.co_applicant||"3",contactTypeId:2})))||[],...((W=l.guarantors)==null?void 0:W.map((G,X)=>({type:"guarantor",displayType:`Guarantor ${l.guarantors.length>1?X+1:""}`,name:G.name,mobile:G.phone,email:G.email,callingStatus:v.guarantor||"3",contactTypeId:3})))||[],...((P=l.references)==null?void 0:P.map((G,X)=>({type:"reference",displayType:`Reference ${l.references.length>1?X+1:""}`,name:G.name,mobile:G.phone,email:G.email,callingStatus:v.reference||"3",contactTypeId:4})))||[]]:[]},x=()=>[{type:"applicant",displayType:"Applicant",name:e.applicant_name,mobile:e.applicant_mobile,email:void 0,callingStatus:v.applicant||"3",contactTypeId:1},...e.co_applicant_name?[{type:"co_applicant",displayType:"Co-Applicant",name:e.co_applicant_name,mobile:e.co_applicant_mobile,email:void 0,callingStatus:v.co_applicant||"3",contactTypeId:2}]:[],...e.guarantor_name?[{type:"guarantor",displayType:"Guarantor",name:e.guarantor_name,mobile:e.guarantor_mobile,email:void 0,callingStatus:v.guarantor||"3",contactTypeId:3}]:[],...e.reference_name?[{type:"reference",displayType:"Reference",name:e.reference_name,mobile:e.reference_mobile,email:void 0,callingStatus:v.reference||"3",contactTypeId:4}]:[]],S=_.useMemo(()=>{console.log("🔄 ContactsTab: Rebuilding contacts array with statuses:",v);const E=l?w():x();return console.log("🔄 ContactsTab: Built contacts array:",E.map(k=>({type:k.type,callingStatus:k.callingStatus}))),console.log("🔄 ContactsTab: Contacts array dependencies changed - apiContacts:",!!l,"localContactStatuses:",v,"selectedMonth:",n),E},[l,v,e,n]),b=async(E,k,T)=>{var N,O,W;try{console.log("🔄 Updating contact status:",{contactType:E,from:T,to:k,applicationId:e.applicant_id,loanId:e.loan_id,paymentId:e.payment_id,selectedMonth:n,repaymentId:(N=e.payment_id)==null?void 0:N.toString()});const P=e.loan_id?e.loan_id.toString():e.applicant_id;if(console.log("🔑 Using contact ID for API call:",P,"(loan_id available:",!!e.loan_id,")"),console.log("🔑 Using repayment ID for API call:",(O=e.payment_id)==null?void 0:O.toString(),"(payment_id available:",!!e.payment_id,")"),!S.find(V=>V.type===E))throw new Error(`Contact type ${E} not found`);await m(P,E,k,n,(W=e.payment_id)==null?void 0:W.toString()),p(V=>{const K={...V,[E]:k},Y=`${n}-${e.payment_id}`;return h.current[Y]=K,console.log("🔄 ContactsTab: Stored updated state in ref for month:",Y,K),console.log("🔄 ContactsTab: Updated status for",E,"to:",k),K}),e.calling_statuses&&(e.calling_statuses[E]=k),p(V=>({...V})),console.log("🔄 Updated local status for",E,"to:",k),await r(E,k,T),console.log("✅ Contact status updated successfully"),a?(console.log("🔄 ContactsTab: Calling onReloadApplication callback..."),a()):console.warn("⚠️ ContactsTab: onReloadApplication callback is not available");const X=k==="1"?"Answered":k==="2"?"Not Answered":k==="3"?"Not Called":k;console.log("🔄 ContactsTab: Success message - status:",k,"display:",X),Se.success(`${E.replace("_"," ")} status updated to "${X}" successfully`)}catch(P){console.error("❌ Failed to update contact status:",P);const G=P.message||"Unknown error";G.includes("Updated:")||G.includes("Calling records created:")?(console.log("🔄 Backend returned success message:",G),p(X=>{const V={...X,[E]:k},K=`${n}-${e.payment_id}`;return h.current[K]=V,console.log("🔄 ContactsTab: Stored updated state in ref for month (error case):",K,V),V}),e.calling_statuses&&(e.calling_statuses[E]=k),p(X=>({...X})),a?(console.log("🔄 ContactsTab: Calling onReloadApplication callback (error case)..."),a()):console.warn("⚠️ ContactsTab: onReloadApplication callback is not available (error case)"),Se.success(`${E.replace("_"," ")} status updated successfully`)):Se.error(`Failed to update ${E.replace("_"," ")} status: ${G}`)}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(gu,{className:"h-5 w-5 text-blue-600"}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Application Contacts"})]}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:d,disabled:u,className:"flex items-center gap-2",children:[c.jsx(Cx,{className:`h-4 w-4 ${u?"animate-spin":""}`}),"Refresh"]})]}),f&&c.jsx(qe,{className:"border-red-200 bg-red-50",children:c.jsx(Je,{className:"pt-4",children:c.jsxs("div",{className:"text-sm text-red-600",children:[c.jsx("p",{className:"font-medium",children:"Error loading contacts:"}),c.jsx("p",{children:f}),c.jsx(Ee,{variant:"outline",size:"sm",onClick:d,className:"mt-2",children:"Retry"})]})})}),u&&c.jsx(qe,{children:c.jsx(Je,{className:"pt-4",children:c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsx(Cx,{className:"h-4 w-4 animate-spin"}),"Loading contacts..."]})})}),!u&&!f&&c.jsx("div",{className:"space-y-4",children:S.map((E,k)=>c.jsx(x7,{title:E.displayType,name:E.name,mobile:E.mobile,email:E.email,currentStatus:E.callingStatus,onStatusChange:T=>b(E.type,T,E.callingStatus),contactTypeId:E.contactTypeId},`${E.type}-${E.callingStatus}-${n}`))}),c.jsx(C7,{fiLocation:e.fi_location}),c.jsxs(qe,{children:[c.jsx(pt,{className:"pb-3",children:c.jsxs(gt,{className:"text-sm flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(LA,{className:"h-4 w-4"}),"Recent Call Activity"]}),t.length>0&&c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>i(!0),className:"text-xs h-7",children:["Log (",t.length,")"]})]})}),c.jsx(Je,{className:"pt-0",children:y.length===0?c.jsx("div",{className:"text-sm text-gray-500 text-center py-3",children:"No call activity recorded yet"}):c.jsx("div",{className:"space-y-2",children:y.map(E=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded text-sm",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("span",{className:"font-medium text-blue-700 capitalize",children:E.contact_type.replace("_"," ")}),c.jsxs("div",{className:"text-xs text-gray-600",children:[c.jsx("span",{className:"text-red-600",children:E.previous_status||"not called"})," → ",c.jsx("span",{className:"text-green-600",children:E.new_status})]})]}),c.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[c.jsx("div",{children:g(E.created_at)}),c.jsxs("div",{children:["by ",E.user_name||"Unknown"]})]})]},E.id))})})]}),c.jsx(kv,{open:s,onClose:()=>i(!1),logs:t,title:"Call Activity History",type:"calling"})]})},P7=e=>_.useMemo(()=>{console.log("=== FILTERING AUDIT LOGS ==="),console.log("Total audit logs received:",e.length);const t=e.filter(r=>{const n=r.field==="Status",a=r.field==="PTP Date",s=r.field==="Amount Collected",i=r.field==="Calling Status";return console.log(`Log ${r.id}: field="${r.field}" -> include=${n||a||s||i}`),n||a||s||i});return console.log("Filtered status-related logs:",t.length),console.log("Status-related logs:",t.map(r=>({id:r.id,field:r.field,previous:r.previous_value,new:r.new_value,created_at:r.created_at}))),t},[e]),WT=()=>{const{user:e}=Ht(),[t,r]=_.useState(!1),n=_.useCallback(async(s,i)=>{if(s.length===0)return{};if(console.log("🔍 fetchFieldStatus called with:",{applicationIdsCount:s.length,selectedMonth:i,sampleIds:s.slice(0,3)}),i){const{start:o,end:l}=hi(i);console.log("🔍 Fetching field status for month range:",o,"to",l);const{data:u,error:f}=await Pe.from("field_status").select("*").in("application_id",s).gte("demand_date",o).lte("demand_date",l).order("created_at",{ascending:!1});if(f)return console.error("❌ Error fetching field status:",f),{};console.log("📋 Raw field status data:",(u==null?void 0:u.length)||0,"records"),console.log("📋 Sample field status records:",u==null?void 0:u.slice(0,3));const d={},m=new Set;return u==null||u.forEach(h=>{m.has(h.application_id)||(d[h.application_id]=h.status,m.add(h.application_id))}),console.log(`✅ Fetched field status for ${Object.keys(d).length} applications (month: ${i})`),console.log("📊 Status distribution from field_status table:",Object.values(d).reduce((h,v)=>(h[v]=(h[v]||0)+1,h),{})),d}else{console.log("🔍 Fetching latest field status for all applications (analytics mode)");const{data:o,error:l}=await Pe.from("field_status").select("*").in("application_id",s).order("created_at",{ascending:!1});if(l)return console.error("❌ Error fetching field status:",l),{};console.log("📋 Raw field status data (analytics mode):",(o==null?void 0:o.length)||0,"records");const u={},f=new Set;return o==null||o.forEach(d=>{f.has(d.application_id)||(u[d.application_id]=d.status,f.add(d.application_id))}),console.log(`✅ Fetched latest field status for ${Object.keys(u).length} applications (analytics mode)`),console.log("📊 Status distribution from field_status table (analytics):",Object.values(u).reduce((d,m)=>(d[m]=(d[m]||0)+1,d),{})),u}},[]),a=_.useCallback(async(s,i,o)=>{if(!e||!o)return null;r(!0);try{const l=o.match(/^\d{4}-\d{2}$/)?`${o}-05`:o;console.log("Updating field status:",{applicationId:s,newStatus:i,emiDate:l});const u={application_id:s,status:i,demand_date:l,user_id:e.id,user_email:e.email,updated_at:new Date().toISOString()},{data:f,error:d}=await Pe.from("field_status").upsert(u,{onConflict:"application_id,demand_date",ignoreDuplicates:!1}).select().single();if(d)throw console.error("Error updating field status:",d),d;return f}catch(l){throw console.error("Error updating field status:",l),l}finally{r(!1)}},[e]);return{fetchFieldStatus:n,updateFieldStatus:a,loading:t}},bp=[{value:"1",label:"Deposited in Bank"},{value:"2",label:"Cash Collected"},{value:"3",label:"PTP Taken"},{value:"4",label:"No Response"}],Ep={"deposited in bank":"Deposited in Bank","cash collected":"Cash Collected","ptp taken":"PTP Taken","no response":"No Response",no_response:"No Response",noresponse:"No Response",deposited_in_bank:"Deposited in Bank",cash_collected:"Cash Collected",ptp_taken:"PTP Taken",1:"Deposited in Bank",2:"Cash Collected",3:"PTP Taken",4:"No Response"},_c=[{value:"1",label:"Future"},{value:"2",label:"Partially Paid"},{value:"4",label:"Overdue"},{value:"5",label:"Foreclose"},{value:"6",label:"Paid (Pending Approval)"}],j7=({application:e,auditLogs:t,onStatusChange:r,onPtpDateChange:n,addAuditLog:a,selectedMonth:s,refetchStatusCounts:i,monthlyData:o})=>{var G,X;console.log("🔍 StatusTab: Application data received:",{applicant_id:e.applicant_id,demand_calling_status:e.demand_calling_status,status:e.status,ptp_date:e.ptp_date,amount_collected:e.amount_collected});const[l,u]=_.useState(""),[f,d]=_.useState(!1),{user:m}=Ht(),[h,v]=_.useState(((G=e.amount_collected)==null?void 0:G.toString())??"");WT();const[p,g]=_.useState("Not Set"),[y,w]=_.useState(""),[x,S]=_.useState({demandStatus:"",repaymentStatus:"",ptpDate:"",amountCollected:""}),[b,E]=_.useState(!1),k=_.useMemo(()=>p==="3"||p==="Paid",[p]);_.useEffect(()=>{if(console.log("📅 StatusTab: Synchronizing PTP date for month:",s),console.log("Application PTP date:",e.ptp_date),console.log("Type of PTP date:",typeof e.ptp_date),e.ptp_date)try{let V="";if(typeof e.ptp_date=="string"){let K;e.ptp_date.includes("T")||e.ptp_date.includes("Z")?K=new Date(e.ptp_date):e.ptp_date.match(/^\d{4}-\d{2}-\d{2}$/)?K=new Date(e.ptp_date+"T00:00:00.000Z"):K=new Date(e.ptp_date),isNaN(K.getTime())?console.warn("⚠️ Could not parse date:",e.ptp_date):(V=K.toISOString().split("T")[0],console.log("✅ Parsed date for input:",V))}}catch(V){console.error("❌ Error parsing PTP date:",V)}},[e.ptp_date,s]),_.useEffect(()=>{console.log("🚀 StatusTab: Component mounted, synchronizing form data with API:",{amount_collected:e.amount_collected,demand_calling_status:e.demand_calling_status,status:e.status,ptp_date:e.ptp_date}),e.demand_calling_status&&w(e.demand_calling_status),e.status&&e.status!=="Unknown"&&g(e.status)},[]),_.useEffect(()=>{(async()=>{try{if(console.log("🔄 Fetching current status for application:",e.applicant_id),o&&o.length>0){console.log("🔍 StatusTab: Available monthlyData:",o.map(ce=>({demand_date:ce.demand_date,demand_month:ce.demand_month,demand_year:ce.demand_year,lms_status:ce.lms_status,id:ce.id})));const ne=o.find(ce=>{if(ce.demand_date)return ce.demand_date===s;if(ce.demand_month&&ce.demand_year){const z=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][ce.demand_month],L=ce.demand_year.toString().slice(-2);return`${z}-${L}`===s}return!1});if(ne)if(console.log("✅ StatusTab: Found matching month data:",ne),ne.lms_status){console.log("✅ StatusTab: Found lms_status in monthlyData:",ne.lms_status),g(ne.lms_status);return}else console.log("⚠️ StatusTab: No lms_status found in monthlyData for month:",s);else console.log("⚠️ StatusTab: No month data found for selectedMonth:",s)}else console.log("⚠️ StatusTab: No monthlyData available");e.status&&e.status!=="Unknown"&&(console.log("✅ StatusTab: Using application status from API:",e.status),g(e.status)),e.demand_calling_status&&(console.log("✅ StatusTab: Using demand_calling_status from API:",e.demand_calling_status),w(e.demand_calling_status));const{data:K,error:Y}=await Pe.from("field_status").select("status, calling_status").eq("application_id",e.applicant_id).order("created_at",{ascending:!1}).maybeSingle();if(Y){console.error("❌ Error fetching status:",Y);return}const H=(K==null?void 0:K.status)||"Not Set",M=(K==null?void 0:K.calling_status)||"";console.log("📋 Fetched status from field_status:",{status:H,demandStatus:M}),(!e.status||e.status==="Unknown")&&g(H),e.demand_calling_status?console.log("✅ Keeping API demand_calling_status, not overriding with database value"):(console.log("⚠️ No API demand_calling_status, using database fallback:",M),w(M))}catch(K){console.error("❌ Error fetching status:",K)}})()},[e.applicant_id,s,o]),_.useEffect(()=>{if(console.log("💰 StatusTab: Initializing amount collected from API:",{apiValue:e.amount_collected,type:typeof e.amount_collected,currentFormValue:x.amountCollected}),e.amount_collected!==void 0&&e.amount_collected!==null){const V=e.amount_collected.toString();V!=="0"?(console.log("✅ StatusTab: Setting amount collected display from API:",V),v(V)):(console.log("⚠️ StatusTab: API amount is 0 or empty, setting display to empty"),v(""))}else console.log("⚠️ StatusTab: No amount collected in API, setting display to empty"),v("")},[e.amount_collected,s]),_.useEffect(()=>{console.log("🔍 StatusTab: Application data changed:",{applicant_id:e.applicant_id,amount_collected:e.amount_collected,amount_collected_type:typeof e.amount_collected,demand_calling_status:e.demand_calling_status,status:e.status,ptp_date:e.ptp_date})},[e]),_.useEffect(()=>{console.log("💰 StatusTab: Amount collected debug:",{apiValue:e.amount_collected,apiValueType:typeof e.amount_collected,formValue:x.amountCollected,formValueType:typeof x.amountCollected,stateValue:h,stateValueType:typeof h})},[e.amount_collected,x.amountCollected,h]),_.useEffect(()=>{console.log("🔍 currentDemandStatus changed:",y),console.log("🔍 Application demand_calling_status:",e.demand_calling_status),console.log("🔍 Form data demandStatus:",x.demandStatus),console.log("🔍 Available mapping keys:",Object.keys(Ep)),y&&console.log("🔍 Mapping result:",Ep[y.toLowerCase()])},[y,e.demand_calling_status,x.demandStatus]),_.useEffect(()=>{console.log("🔍 Selected month changed:",s),console.log("🔍 Application demand_calling_status:",e.demand_calling_status),console.log("🔍 Current demand status state:",y)},[s,e.demand_calling_status,y]),_.useEffect(()=>{e.demand_calling_status&&!y&&(console.log("🔍 Initializing demand status from application data:",e.demand_calling_status),w(e.demand_calling_status))},[e.demand_calling_status,y]),_.useEffect(()=>{e.demand_calling_status&&e.demand_calling_status!==y&&(console.log("🔍 Synchronizing demand status from application data change:",e.demand_calling_status),w(e.demand_calling_status))},[e.demand_calling_status]),_.useEffect(()=>{console.log("🔍 API demand_calling_status changed:",e.demand_calling_status),e.demand_calling_status&&w(e.demand_calling_status)},[e.demand_calling_status]);const T=P7(t),N=(V,K)=>{console.log(`🔄 Form field change: ${V} =`,K,"Type:",typeof K),V==="demandStatus"&&console.log("🎯 Demand status change:",{oldValue:x.demandStatus,newValue:K,oldType:typeof x.demandStatus,newType:typeof K}),S(Y=>{const H={...Y,[V]:K};return console.log("📝 Updated form data:",H),H})};_.useEffect(()=>{var V,K;console.log("📊 Form data changed:",{demandStatus:{value:x.demandStatus,type:typeof x.demandStatus,label:((V=bp.find(Y=>Y.value===x.demandStatus))==null?void 0:V.label)||"Not found"},repaymentStatus:{value:x.repaymentStatus,type:typeof x.repaymentStatus,label:((K=_c.find(Y=>Y.value===x.repaymentStatus))==null?void 0:K.label)||"Not found"},ptpDate:x.ptpDate,amountCollected:x.amountCollected})},[x.demandStatus,x.repaymentStatus,x.ptpDate,x.amountCollected]),_.useEffect(()=>{console.log("🔍 Current form data:",x),console.log("🔍 Current demand status state:",{currentDemandStatus:y,applicationDemandStatus:e.demand_calling_status,formDemandStatus:x.demandStatus,formDemandStatusType:typeof x.demandStatus}),console.log("🔍 Current validation state:",{user:!!m,selectedMonth:s,applicantId:e==null?void 0:e.applicant_id,hasFormData:!!(x.demandStatus||x.repaymentStatus||x.ptpDate||x.amountCollected!==void 0&&x.amountCollected!==""&&x.amountCollected!=="0")})},[x,m,s,e==null?void 0:e.applicant_id,y,e.demand_calling_status]);const O=async()=>{var K,Y,H,M,ne,ce,j;if(console.log("🔍 Submit validation check:",{user:!!m,selectedMonth:s,applicantId:e==null?void 0:e.applicant_id,formData:x,currentFormData:x}),!m){Se.error("User not authenticated. Please log in again.");return}if(!(x.demandStatus||x.repaymentStatus||x.ptpDate||x.amountCollected!==void 0&&x.amountCollected!==""&&x.amountCollected!=="0")){Se.error("Please fill in at least one field before submitting.");return}if(k&&(x.demandStatus||x.repaymentStatus||x.ptpDate||x.amountCollected!=="")){Se.error('Cannot change any fields when current status is "Paid". All fields are locked for paid applications.');return}console.log("✅ All validation passed, proceeding with submission"),E(!0);try{console.log("🚀 Submitting status update with form data:",x);const z=((K=e.loan_id)==null?void 0:K.toString())||e.applicant_id,L=((Y=e.payment_id)==null?void 0:Y.toString())||"";console.log("🔍 StatusTab: Using payment_id:",L,"for month:",s,"application:",e.applicant_id);const U={repayment_id:L,calling_type:2,demand_calling_status:x.demandStatus?parseInt(x.demandStatus,10):void 0,repayment_status:x.repaymentStatus?parseInt(x.repaymentStatus,10):void 0,ptp_date:x.ptpDate||void 0,amount_collected:x.amountCollected?parseFloat(x.amountCollected):void 0,contact_calling_status:0,contact_type:1};Object.keys(U).forEach(q=>{U[q]===void 0&&delete U[q]}),console.log("📤 Submitting to StatusManagementService:",U);const Q=await Sv.updateApplicationStatus(z,U);if(console.log("✅ Status update successful:",Q),x.demandStatus&&w(x.demandStatus),x.repaymentStatus&&(g(x.repaymentStatus),r(x.repaymentStatus)),x.ptpDate&&(u(x.ptpDate),n(x.ptpDate)),x.amountCollected!==void 0&&v(x.amountCollected),x.demandStatus&&x.demandStatus!==y){const q=Ep[y==null?void 0:y.toLowerCase()]||y,ae=((H=bp.find(oe=>oe.value===x.demandStatus))==null?void 0:H.label)||x.demandStatus;await a(e.applicant_id,"Demand Status",q,ae,"")}if(x.repaymentStatus&&x.repaymentStatus!==p){const q=((M=_c.find(oe=>oe.value===p))==null?void 0:M.label)||p,ae=((ne=_c.find(oe=>oe.value===x.repaymentStatus))==null?void 0:ne.label)||x.repaymentStatus;await a(e.applicant_id,"Repayment Status",q,ae,"")}x.ptpDate&&x.ptpDate!==l&&await a(e.applicant_id,"PTP Date",l||null,x.ptpDate,""),x.amountCollected!==void 0&&x.amountCollected!==(((ce=e.amount_collected)==null?void 0:ce.toString())||"0")&&await a(e.applicant_id,"Amount Collected",((j=e.amount_collected)==null?void 0:j.toString())||"0",x.amountCollected.toString(),""),i&&i(),Se.success("Status updated successfully!")}catch(z){console.error("❌ Failed to submit status update:",z),Se.error(`Failed to update status: ${z instanceof Error?z.message:"Unknown error"}`)}finally{E(!1)}},W=_.useMemo(()=>V=>{try{const K=new Date(V);return`${vt(K,"dd-MMM-yyyy")} at ${vt(K,"HH:mm")}`}catch{return V}},[]),P=_.useMemo(()=>{if(!Array.isArray(T))return[];const V=new Set;return T.filter(Y=>{const H=`${Y.field}-${Y.created_at}-${Y.new_value}`;return V.has(H)?!1:(V.add(H),!0)}).slice(0,2)},[T]);return c.jsxs("div",{className:"space-y-4",children:[c.jsxs(qe,{children:[c.jsx(pt,{className:"pb-3",children:c.jsx(gt,{className:"text-sm",children:"Status Management"})}),c.jsxs(Je,{className:"pt-0",children:[k&&c.jsxs("div",{className:"mb-4 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 text-amber-800",children:[c.jsx(Bk,{className:"h-4 w-4"}),c.jsx("span",{className:"font-medium",children:"Status Locked"})]}),c.jsx("p",{className:"text-sm text-amber-700 mt-1",children:'This application has a "Paid" status. All fields are locked and cannot be modified.'})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(Ke,{htmlFor:"demandStatus",children:"Demand Status"}),c.jsxs(jn,{value:x.demandStatus||"",onValueChange:V=>N("demandStatus",V),disabled:k,children:[c.jsx(mn,{className:"mt-1",children:c.jsx(Dn,{placeholder:"Select demand status..."})}),c.jsx(pn,{children:bp.map(V=>c.jsx(bt,{value:V.value,children:V.label},V.value))})]},`demand-${x.demandStatus}`),k&&c.jsx("div",{className:"text-xs text-amber-600 mt-1",children:'Demand status cannot be changed when repayment status is "Paid"'})]}),c.jsxs("div",{className:"col-span-2 bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsxs("div",{className:"text-xs text-gray-600 mb-2 font-medium",children:["Current Demand Status for ",s]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-gray-500",children:"Demand Status:"}),c.jsx(Fr,{variant:"outline",className:"text-xs",children:(()=>{const V=e.demand_calling_status;return V?{"no response":"No Response",no_response:"No Response","ptp taken":"PTP Taken",ptp_taken:"PTP Taken","deposited in bank":"Deposited in Bank",deposited_in_bank:"Deposited in Bank","cash collected":"Cash Collected",cash_collected:"Cash Collected"}[V.toLowerCase()]||V:"Not Set"})()})]})]}),c.jsxs("div",{children:[c.jsx(Ke,{htmlFor:"status",children:"Repayment Status"}),c.jsxs(jn,{value:x.repaymentStatus||"",onValueChange:V=>N("repaymentStatus",V),disabled:k,children:[c.jsx(mn,{className:"mt-1",children:c.jsx(Dn,{placeholder:"Select repayment status..."})}),c.jsx(pn,{children:_c.map(V=>c.jsx(bt,{value:V.value,children:V.label},V.value))})]},`repayment-${x.repaymentStatus}`),k&&c.jsx("div",{className:"text-xs text-amber-600 mt-1",children:'Repayment status cannot be changed when current status is "Paid"'})]}),c.jsxs("div",{className:"col-span-2 bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsxs("div",{className:"text-xs text-gray-600 mb-2 font-medium",children:["Current Repayment Status for ",s]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-gray-500",children:"Repayment Status:"}),c.jsx(Fr,{variant:"outline",className:"text-xs",children:p?((X=_c.find(V=>V.value===p))==null?void 0:X.label)||p:"Not Set"})]})]}),c.jsxs("div",{children:[c.jsx(Ke,{htmlFor:"ptpDate",children:"PTP Date"}),c.jsx(Qr,{id:"ptpDate",type:"date",value:x.ptpDate||"",onChange:V=>N("ptpDate",V.target.value),className:"mt-1",placeholder:"Select PTP date",disabled:k},`ptp-${x.ptpDate}`),!e.ptp_date&&!k&&c.jsx("div",{className:"text-xs text-gray-500",children:"No PTP date set"}),k&&c.jsx("div",{className:"text-xs text-amber-600 mt-1",children:'PTP date cannot be changed when current status is "Paid"'})]}),c.jsxs("div",{className:"col-span-2 bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsxs("div",{className:"text-xs text-gray-600 mb-2 font-medium",children:["Current PTP Date for ",s]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-gray-500",children:"PTP Date:"}),c.jsx(Fr,{variant:"outline",className:"text-xs",children:e.ptp_date?(()=>{try{const V=new Date(e.ptp_date);return vt(V,"dd-MMM-yyyy")}catch{return e.ptp_date}})():"Not Set"})]})]}),c.jsxs("div",{children:[c.jsx(Ke,{htmlFor:"amount-collected",children:"Amount Collected"}),c.jsx(Qr,{id:"amount-collected",type:"text",value:x.amountCollected||"",onChange:V=>N("amountCollected",V.target.value),placeholder:"Enter amount collected",className:"mt-1",disabled:k}),k&&c.jsx("div",{className:"text-xs text-amber-600 mt-1",children:'Amount collected cannot be changed when current status is "Paid"'})]}),c.jsxs("div",{className:"col-span-2 bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsxs("div",{className:"text-xs text-gray-600 mb-2 font-medium",children:["Current Amount Collected for ",s]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"text-gray-500",children:"Amount Collected:"}),c.jsx(Fr,{variant:"outline",className:"text-xs",children:e.amount_collected?`₹${e.amount_collected.toLocaleString("en-IN")}`:"₹0"})]})]}),c.jsx("div",{className:"pt-4",children:c.jsx(Ee,{onClick:O,disabled:b||k,className:"w-full",size:"lg",children:b?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating Status..."]}):k?c.jsxs(c.Fragment,{children:[c.jsx(L0,{className:"h-4 w-4 mr-2"}),"No Changes Allowed"]}):c.jsxs(c.Fragment,{children:[c.jsx(L0,{className:"h-4 w-4 mr-2"}),"Submit Status Update"]})})})]})]})]}),c.jsxs(qe,{children:[c.jsx(pt,{className:"pb-3",children:c.jsxs(gt,{className:"text-sm flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Uh,{className:"h-4 w-4"}),"Recent Changes"]}),Array.isArray(T)&&T.length>0&&c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>d(!0),className:"text-xs h-7",children:["Log (",T.length,")"]})]})}),c.jsx(Je,{className:"pt-0",children:P.length===0?c.jsx("div",{className:"text-sm text-gray-500 text-center py-3",children:"No status or PTP date changes recorded yet"}):c.jsx("div",{className:"space-y-2",children:P.map(V=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded text-sm",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("span",{className:"font-medium text-blue-700",children:V.field}),c.jsxs("div",{className:"text-xs text-gray-600",children:[c.jsx("span",{className:"text-red-600",children:V.previous_value||"Not Set"})," → ",c.jsx("span",{className:"text-green-600",children:V.new_value||"Cleared"})]})]}),c.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[c.jsx("div",{children:W(V.created_at)}),c.jsxs("div",{children:["by ",V.user_name||"Unknown"]})]})]},V.id))})})]}),c.jsx(kv,{open:f,onClose:()=>d(!1),logs:Array.isArray(T)?T:[],title:"Status & PTP Date History",type:"audit"})]})},sh=_.forwardRef(({className:e,...t},r)=>c.jsx("textarea",{className:Ae("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));sh.displayName="Textarea";const D7=({comments:e,onAddComment:t,paymentId:r})=>{const[n,a]=_.useState(""),s=l=>{try{const u=new Date(l);return`${vt(u,"dd-MMM-yy")} at ${vt(u,"HH:mm")}`}catch{return l}},i=async()=>{n.trim()&&(console.log("🔍 CommentsTab: Adding comment with paymentId:",r),await t(n,r),a(""))},o=l=>!l||l.trim()===""||l==="Unknown User"?"Unknown User":(l.includes("@"),l);return c.jsxs(qe,{children:[c.jsx(pt,{className:"pb-3",children:c.jsx(gt,{className:"text-sm",children:"Comments"})}),c.jsx(Je,{className:"pt-0",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx(Ke,{htmlFor:"newComment",children:"Add Comment"}),c.jsx(sh,{id:"newComment",value:n,onChange:l=>a(l.target.value),placeholder:"Add your comment here...",className:"min-h-[80px] resize-none text-sm"}),c.jsx(Ee,{onClick:i,className:"mt-3 w-full",size:"sm",disabled:!n.trim(),children:"Add Comment"})]}),e.length>0&&c.jsxs("div",{className:"border-t pt-4",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-3",children:["All Comments (",e.length,"):"]}),c.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:e.map(l=>c.jsx("div",{className:"border rounded-lg p-3 bg-gray-50 hover:bg-gray-100 transition-colors",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:c.jsx(_1,{className:"h-3 w-3 sm:h-4 sm:w-4 text-white"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-2 mb-2",children:[c.jsxs("span",{className:"font-medium text-xs sm:text-sm text-blue-700 flex items-center gap-1",children:[o(l.user_name),l.user_name==="Unknown User"&&c.jsx(Bk,{className:"h-3 w-3 text-orange-500"})]}),c.jsx("span",{className:"text-xs text-gray-500",children:s(l.commented_at||l.created_at||"")})]}),c.jsx("div",{className:"text-xs sm:text-sm text-gray-800 leading-relaxed break-words",children:l.content})]})]})},l.id))})]}),e.length===0&&c.jsx("div",{className:"text-sm text-gray-400 italic text-center py-8",children:"No comments added yet"})]})})]})},HT=[{value:"None",label:"None",color:"bg-gray-400 text-white"},{value:"Repossessed",label:"Repossessed",color:"bg-red-600 text-white"},{value:"Need to repossess",label:"Need to repossess",color:"bg-orange-500 text-white"},{value:"Third party",label:"Third party",color:"bg-blue-500 text-white"}],R7=e=>{var t;return((t=HT.find(r=>r.value===e))==null?void 0:t.color)||"bg-gray-400 text-white"},qt=({label:e,value:t})=>c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:e}),c.jsx("p",{className:"text-sm font-semibold text-gray-800 break-words",children:t||"N/A"})]}),M7=({application:e,repaymentHistory:t,auditLogs:r,onVehicleStatusChange:n,monthlyData:a,selectedMonth:s})=>{const[i,o]=_.useState(!1);if(console.log("🔍 DetailsTab: Component rendered with props:",{selectedMonth:s,hasMonthlyData:!!a,monthlyDataLength:(a==null?void 0:a.length)||0,applicationId:e==null?void 0:e.applicant_id,paymentId:e==null?void 0:e.payment_id,timestamp:new Date().toISOString()}),!e)return c.jsx("div",{children:"Loading..."});const l=_.useMemo(()=>{if(console.log("🔍 DetailsTab: Calculating month-specific data for month:",s),console.log("🔍 DetailsTab: Available monthlyData:",a),!s||!a||a.length===0)return console.log("🔍 DetailsTab: No monthlyData or selectedMonth, returning null"),null;const p=a.find(g=>{if(console.log("🔍 DetailsTab: Checking item:",g),g.demand_date){const y=g.demand_date===s;return console.log("🔍 DetailsTab: Checking demand_date:",g.demand_date,"against selectedMonth:",s,"matches:",y),y}if(g.demand_month&&g.demand_year){const w=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][g.demand_month],x=g.demand_year.toString().slice(-2),S=`${w}-${x}`,b=S===s;return console.log("🔍 DetailsTab: Checking constructed month:",S,"against selectedMonth:",s,"matches:",b),b}return!1});return console.log("🔍 DetailsTab: Found month data:",p),p},[s,a]);_.useEffect(()=>{console.log("🔍 DetailsTab: Data updated:",{selectedMonth:s,hasMonthlyData:!!a,monthlyDataLength:(a==null?void 0:a.length)||0,hasMonthSpecificData:!!l,applicationData:{emi_amount:e.emi_amount,lms_status:e.lms_status,field_status:e.field_status,ptp_date:e.ptp_date,amount_collected:e.amount_collected,demand_num:e.demand_num}})},[s,a,l,e]);const u=()=>{var p;return l?((p=l.repayment_status)==null?void 0:p.repayment_status)||l.lms_status||l.field_status||e.lms_status||e.field_status:e.lms_status||e.field_status},f=(p,g)=>l&&l[p]!==void 0&&l[p]!==null?l[p]:g&&l&&l[g]!==void 0&&l[g]!==null?l[g]:e[p],d=_.useMemo(()=>r?r.filter(p=>p.field==="Vehicle Status").sort((p,g)=>new Date(g.created_at).getTime()-new Date(p.created_at).getTime()):[],[r]),m=p=>{try{const g=new Date(p);return`${vt(g,"dd-MMM-yy")} at ${vt(g,"HH:mm")}`}catch{return p}},h=t.sort((p,g)=>p.repayment_number-g.repayment_number).map(p=>p.delay_in_days).join(" | "),v=a==null?void 0:a.filter(p=>p.demand_date).sort((p,g)=>{const y=p.demand_date||"",w=g.demand_date||"";return y.localeCompare(w)}).map(p=>{var S;const g=p.demand_amount||0,y=((S=p.repayment_status)==null?void 0:S.repayment_status)||"Unknown",w=p.demand_date?Xn(p.demand_date):"Unknown Month",x=g?parseFloat(g.toString()).toLocaleString():"0";return`${w}: ₹${x} (${y})`}).join(" → ");return c.jsxs("div",{className:"space-y-4",children:[c.jsxs(qe,{className:"overflow-hidden",children:[c.jsx(pt,{children:c.jsx(gt,{children:"Application Information"})}),c.jsx(Je,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(qt,{label:"Application ID",value:e.applicant_id}),c.jsx(qt,{label:"Applicant Name",value:e.applicant_name}),c.jsx(qt,{label:"EMI Month",value:s||e.emi_month}),c.jsx(qt,{label:"Current Status",value:u()})]})})]}),c.jsxs(qe,{className:"overflow-hidden",children:[c.jsx(pt,{children:c.jsx(gt,{children:"Loan & Repayment Details"})}),c.jsx(Je,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(qt,{label:"Loan Amount",value:e.loan_amount?`₹${e.loan_amount.toLocaleString()}`:"N/A"}),c.jsx(qt,{label:"Disbursement Date",value:e.disbursement_date}),c.jsx(qt,{label:"EMI Amount",value:f("emi_amount","demand_amount")?`₹${parseFloat(f("emi_amount","demand_amount").toString()).toLocaleString()}`:"N/A"}),c.jsx(qt,{label:"Repayment Number",value:f("demand_num")||"N/A"}),c.jsx(qt,{label:"House Ownership",value:e.house_ownership}),c.jsx(qt,{label:"Payment Mode",value:e.payment_mode}),c.jsx("div",{className:"col-span-2 md:grid-cols-3",children:c.jsx(qt,{label:"Repayment History (Delay in Days)",value:h||"No history"})}),a&&a.length>1&&c.jsx("div",{className:"col-span-2 md:col-span-3",children:c.jsx(qt,{label:"Monthly Progression (EMI & Status)",value:v||"No progression data"})})]})})]}),c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsx(gt,{children:"Assignment & Status"})}),c.jsx(Je,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(qt,{label:"RM Name",value:e.rm_name}),c.jsx(qt,{label:"Team Lead",value:e.team_lead}),c.jsx(qt,{label:"Branch",value:e.branch_name}),c.jsx(qt,{label:"Dealer",value:e.dealer_name}),c.jsx(qt,{label:"Lender",value:e.lender_name})]})})]}),c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsx(gt,{children:"PTP & Payment Information"})}),c.jsx(Je,{children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-x-6 gap-y-8",children:[c.jsx(qt,{label:"PTP Date",value:f("ptp_date")}),c.jsx(qt,{label:"Amount Collected",value:f("amount_collected")?`₹${parseFloat(f("amount_collected").toString()).toLocaleString()}`:"N/A"}),c.jsx(qt,{label:"Payment Mode",value:f("payment_mode","mode")})]})})]}),e.recent_comments&&e.recent_comments.length>0&&c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsx(gt,{children:"Recent Comments"})}),c.jsx(Je,{children:c.jsx("div",{className:"space-y-3",children:e.recent_comments.map((p,g)=>c.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-800",children:p.content}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["by ",p.user_name]})]},g))})})]}),c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsx(gt,{children:"Vehicle Status"})}),c.jsxs(Je,{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-64",children:c.jsxs(jn,{value:e.vehicle_status||"None",onValueChange:p=>n(p==="None"?"":p),children:[c.jsx(mn,{children:c.jsx(Dn,{placeholder:"Select vehicle status..."})}),c.jsx(pn,{children:HT.map(p=>c.jsx(bt,{value:p.value,children:p.label},p.value))})]})}),e.vehicle_status&&e.vehicle_status!=="None"&&c.jsx(Fr,{className:`${R7(e.vehicle_status)}`,children:e.vehicle_status})]})]}),c.jsxs(qe,{children:[c.jsx(pt,{className:"pb-3",children:c.jsxs(gt,{className:"text-sm flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Uh,{className:"h-4 w-4"}),"Vehicle Status History"]}),d.length>0&&c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>o(!0),className:"text-xs h-7",children:["Log (",d.length,")"]})]})}),c.jsx(Je,{className:"pt-0",children:d.length===0?c.jsx("div",{className:"text-sm text-gray-500 text-center py-3",children:"No changes recorded yet"}):c.jsx("div",{className:"space-y-2",children:d.slice(0,2).map(p=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded text-sm",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("span",{className:"font-medium text-blue-700 capitalize",children:p.field}),c.jsxs("div",{className:"text-xs text-gray-600",children:[c.jsx("span",{className:"text-red-600",children:p.previous_value||"None"})," → ",c.jsx("span",{className:"text-green-600",children:p.new_value||"None"})]})]}),c.jsxs("div",{className:"text-xs text-gray-500 text-right",children:[c.jsx("div",{children:m(p.created_at)}),c.jsxs("div",{children:["by ",p.user_name||"Unknown"]})]})]},p.id))})})]}),c.jsx(kv,{open:i,onClose:()=>o(!1),logs:d,title:"Vehicle Status Change History",type:"audit"})]})},O7=(e,t,r,n,a,s)=>{const i=_.useCallback(async f=>{if(!e||!t||!s)return;const d=e,m=d.lms_status,h={...e,lms_status:f};a(h);try{const{error:v}=await Pe.from("applications").update({lms_status:f}).eq("applicant_id",d.applicant_id);if(v)throw console.error("Database error updating status:",v),v;await r(d.applicant_id,"Status",m,f,Dl(s)),Se.success("Status updated successfully")}catch(v){console.error("Failed to update status:",v),Se.error("Failed to update status. Reverting change."),a(d)}},[e,t,r,a,s]),o=_.useCallback(async f=>{if(!e||!t||!s)return;const d=e,m=d.ptp_date||null,h={...e,ptp_date:f};a(h);try{const v=s.match(/^\d{4}-\d{2}$/)?`${s}-05`:s,{error:p}=await Pe.from("ptp_dates").upsert({application_id:e.applicant_id,ptp_date:f,demand_date:v,user_id:t.id,user_email:t.email,updated_at:new Date().toISOString()},{onConflict:"application_id,demand_date",ignoreDuplicates:!1});if(p)throw console.error("Database error updating PTP date:",p),p;await r(d.applicant_id,"PTP Date",m||"None",f||"None",v),Se.success("PTP Date updated successfully")}catch(v){console.error("Failed to update PTP Date:",v),Se.error("Failed to update PTP Date. Reverting change."),a(d)}},[e,t,r,a,s]),l=_.useCallback(async(f,d,m)=>{var h,v;if(!(!e||!t||!s))try{console.log("=== UPDATING CALLING STATUS ==="),console.log("Application ID:",e.applicant_id),console.log("Contact Type:",f),console.log("New Status:",d),console.log("Selected Month:",s);const p=s.match(/^\d{4}-\d{2}$/)?`${s}-05`:s,g={...e,[`${f}_calling_status`]:d};a(g),await n(f,m||"not called",d);const y=e.loan_id?e.loan_id.toString():e.applicant_id.toString();console.log("🔑 ApplicationHandlers: Using contact ID for API call:",y,"(loan_id available:",!!e.loan_id,")"),console.log("🔑 ApplicationHandlers: Using repayment ID for API call:",(h=e.payment_id)==null?void 0:h.toString(),"(payment_id available:",!!e.payment_id,")");const w=await Sv.updateContactCallingStatus(y,f,d,p,(v=e.payment_id)==null?void 0:v.toString());if(w.success)console.log("✅ Contact calling status updated successfully via API:",w),Se.success(`Calling status updated for ${f}`);else throw new Error(w.message||"Failed to update calling status")}catch(p){console.error("Failed to update calling status:",p),Se.error("Failed to update calling status"),a(e)}},[e,t,n,a,s]),u=_.useCallback(async f=>{if(!e||!t||!s)return;const d=e.amount_collected||0;try{console.log("=== UPDATING AMOUNT COLLECTED ==="),console.log("Application ID:",e.applicant_id),console.log("New Amount:",f),console.log("Selected Month:",s);const m=s.match(/^\d{4}-\d{2}$/)?`${s}-05`:s,h={application_id:e.applicant_id,demand_date:m,amount_collected:f,team_lead:e.team_lead,rm_name:e.rm_name,repayment:e.repayment,emi_amount:e.emi_amount,last_month_bounce:e.last_month_bounce,lms_status:e.lms_status,collection_rm:e.collection_rm,updated_at:new Date().toISOString()},{error:v}=await Pe.from("collection").upsert(h,{onConflict:"application_id,demand_date",ignoreDuplicates:!1});if(v)throw console.error("Error updating amount collected:",v),v;await r(e.applicant_id,"Amount Collected",(d==null?void 0:d.toString())||"0",(f==null?void 0:f.toString())||"0",m);const p={...e,amount_collected:f};a(p),console.log("✅ Amount collected updated successfully")}catch(m){throw console.error("Error in handleAmountCollectedChange:",m),m}},[e,t,r,a,s]);return{handleStatusChange:i,handlePtpDateChange:o,handleCallingStatusChange:l,handleAmountCollectedChange:u}},I7=e=>{const[t,r]=_.useState([]),[n,a]=_.useState(!1);return _.useEffect(()=>{(async()=>{if(!e){r([]);return}a(!0);try{const{data:i,error:o}=await Pe.from("repayment_history").select("*").eq("application_id",e).order("repayment_number",{ascending:!0});if(o)throw o;r(i||[])}catch(i){console.error("Error fetching repayment history:",i),r([])}finally{a(!1)}})()},[e]),{repaymentHistory:t,loading:n}},F7=e=>{const[t,r]=_.useState([]),[n,a]=_.useState(!1),[s,i]=_.useState([]),[o,l]=_.useState([]),u=_.useCallback(async()=>{if(!e){r([]),i([]),l([]);return}a(!0);try{console.log("📅 Fetching loan-specific months for applicant:",e);const{data:d,error:m}=await Pe.from("loan_details").select("loan_application_id").eq("applicant_id",e).maybeSingle();if(m){console.error("Error fetching loan details:",m);return}if(!d){console.warn("No loan found for applicant:",e),i([]),l([]),r([]);return}const h=d.loan_application_id;console.log("📅 Found loan_application_id:",h,"for applicant:",e);const{data:v,error:p}=await Pe.from("payment_details").select(`
          id, 
          demand_month, 
          demand_year, 
          demand_date, 
          demand_amount, 
          amount_collected, 
          ptp_date, 
          demand_num, 
          fees, 
          fees_status, 
          payment_date, 
          mode, 
          payment_information,
          repayment_status_id,
          repayment_status(repayment_status)
        `).eq("loan_application_id",h).order("demand_year",{ascending:!0}).order("demand_month",{ascending:!0});if(p){console.error("Error fetching payment details:",p);return}if(!v||v.length===0){console.warn("No payment details found for loan_application_id:",h),i([]),l([]),r([]);return}console.log("📅 Found payment details:",v);const g=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let y=[];v[0].demand_date?(y=v.map(S=>S.demand_date),console.log("📅 Using demand_date from payment_details:",y)):(y=v.map(S=>{const b=g[S.demand_month],E=S.demand_year.toString().slice(-2);return`${b}-${E}`}),console.log("📅 Constructed months from demand_month/demand_year:",y));const w=[...new Set(y)].sort();i(w);const x=w.map(S=>S.includes("-")&&S.length===6?S:Xn(S));l(x),r(v),console.log("✅ Loan-specific monthly data updated:",{applicantId:e,loanApplicationId:h,uniqueMonths:w,monthsFormatted:x,paymentDetailsCount:v.length})}catch(d){console.error("Error in fetchMonthlyData:",d)}finally{a(!1)}},[e]),f=_.useCallback(d=>{const m=t.find(h=>h.demand_date===d);return m?{...m,amount_collected:m.amount_collected||null}:null},[t]);return _.useEffect(()=>{u()},[u]),{monthlyData:t,availableMonths:s,availableMonthsFormatted:o,loading:n,getApplicationForMonth:f,refetch:u}};class L7{static async getMonthDropdownOptions(t){try{console.log("📅 Fetching month dropdown options for loan_id:",t);const r=await fetch(`${Mr}/month-dropdown/${t}/months`);if(!r.ok)return console.error("❌ Failed to fetch month dropdown options:",r.status,r.statusText),null;const n=await r.json();return console.log("✅ Month dropdown options fetched:",n),n}catch(r){return console.error("❌ Error fetching month dropdown options:",r),null}}}class B7{static async getFilteredApplications(t){const r=new URLSearchParams;t.emi_month&&r.append("emi_month",t.emi_month),t.search&&r.append("search",t.search),t.branch&&r.append("branch",t.branch),t.dealer&&r.append("dealer",t.dealer),t.lender&&r.append("lender",t.lender),t.status&&r.append("status",t.status),t.rm_name&&r.append("rm_name",t.rm_name),t.tl_name&&r.append("tl_name",t.tl_name),t.ptp_date_filter&&r.append("ptp_date_filter",t.ptp_date_filter),t.offset!==void 0&&r.append("offset",t.offset.toString()),t.limit!==void 0&&r.append("limit",t.limit.toString());const n=await fetch(`${Mr}/applications/?${r.toString()}`);if(!n.ok)throw new Error(`Failed to fetch filtered applications: ${n.status}`);return await n.json()}static async getApplications(t="Aug-25",r="",n=0,a=20){const s={emi_month:t,search:r,offset:n,limit:a},i=await this.getFilteredApplications(s);return{total:i.total,applications:i.results}}static async getAllApplications(t="Aug-25"){const r={emi_month:t,offset:0,limit:1e3};return(await this.getFilteredApplications(r)).results}static async getApplicationDetails(t,r="Aug-25"){const n={emi_month:r,search:t,offset:0,limit:1},a=await this.getFilteredApplications(n);if(a.results&&a.results.length>0)return a.results[0];throw new Error("Application not found")}static async getApplicationByLoanAndMonth(t,r){try{const n={emi_month:r,offset:0,limit:1e3},s=(await this.getFilteredApplications(n)).results.find(i=>i.loan_id===t);return s?(console.log("✅ Found application for loan_id:",t,"and month:",r),s):(console.log("⚠️ No application found for loan_id:",t,"and month:",r),null)}catch(n){return console.error("❌ Error fetching application by loan_id and month:",n),null}}}const U7=(e,t)=>{const[r,n]=_.useState({months:[],currentMonth:"",totalMonths:0,loading:!1,error:null}),[a,s]=_.useState(""),[i,o]=_.useState(null),l=_.useCallback(async()=>{if(!e){n(d=>({...d,months:[],currentMonth:"",totalMonths:0}));return}n(d=>({...d,loading:!0,error:null}));try{const d=await L7.getMonthDropdownOptions(e);if(d)if(n({months:d.months,currentMonth:d.current_month,totalMonths:d.total_months,loading:!1,error:null}),d.months.length>0&&t){console.log("🔄 useMonthDropdown: Months populated, looking for repayment_id match:",t);const m=d.months.find(h=>h.repayment_id===t.toString());m?(console.log("✅ useMonthDropdown: Found matching month for repayment_id:",t,"->",m.month),s(m.month)):(console.log("⚠️ useMonthDropdown: No matching month found for repayment_id:",t,"Available months:",d.months.map(h=>({month:h.month,repayment_id:h.repayment_id}))),s(d.months[0].month))}else d.months.length>0&&s(d.months[0].month);else n(m=>({...m,loading:!1,error:"Failed to fetch month options"}))}catch(d){console.error("Error fetching month options:",d),n(m=>({...m,loading:!1,error:"Error fetching month options"}))}},[e,t]),u=_.useCallback(async d=>{if(!e||!d)return null;try{const m=r.months.find(v=>v.month===d);if(!m)return console.error("useMonthDropdown: Month option not found for:",d),null;const h=await B7.getApplicationByLoanAndMonth(e,d);return h?{monthOption:m,application:h}:(console.log("useMonthDropdown: No application found for month:",d),null)}catch(m){return console.error("useMonthDropdown: Error fetching application for month:",m),null}},[e,r.months]),f=_.useCallback(async d=>{if(console.log("useMonthDropdown: Month changed to:",d),s(d),(!r.months||r.months.length===0)&&(console.log("useMonthDropdown: Fetching month options first"),await l(),await new Promise(h=>setTimeout(h,100)),!r.months||r.months.length===0))return console.log("useMonthDropdown: ❌ No month data available after fetch"),null;const m=await u(d);return m?(console.log("useMonthDropdown: ✅ Fetched result for month:",d,"with repayment_id:",m.monthOption.repayment_id),o(m.application),m):(console.log("useMonthDropdown: ⚠️ No result returned for month:",d),null)},[u,r.months,l]);return _.useEffect(()=>{e&&l()},[e,l]),_.useEffect(()=>{if(t&&r.months.length>0){console.log("🔄 useMonthDropdown: currentApplicationPaymentId changed, looking for matching month:",t);const d=r.months.find(m=>m.repayment_id===t.toString());d?(console.log("✅ useMonthDropdown: Auto-selecting month for repayment_id:",t,"->",d.month),s(d.month)):console.log("⚠️ useMonthDropdown: No matching month found for repayment_id:",t,"Available months:",r.months.map(m=>({month:m.month,repayment_id:m.repayment_id})))}},[t,r.months]),{...r,selectedMonth:a,currentApplication:i,handleMonthChange:f,fetchApplicationForMonth:u,refreshMonthOptions:l}},$7=({availableMonths:e,availableMonthsFormatted:t,selectedMonth:r,onMonthChange:n,loading:a=!1,loanId:s,currentApplicationPaymentId:i})=>{var k;const[o,l]=_.useState(0),[u,f]=_.useState(!1),{months:d,selectedMonth:m,handleMonthChange:h,loading:v,error:p}=U7(e.length===0?s:void 0,i),g=t||e;_.useEffect(()=>{console.log("MonthSelector: Updating current month index"),console.log("Available months:",e),console.log("Selected month:",r);const T=e.findIndex(N=>N===r);if(console.log("Found index:",T),T>=0)l(T);else if(e.length>0){const N=e.length-1;console.log("Setting default index:",N),l(N),n(e[N])}},[r,e,n]);const y=async()=>{if(o>0&&!u){f(!0);const T=o-1;console.log("Previous month: index",T,"month",e[T]),l(T),await n(e[T]),f(!1)}},w=async()=>{if(o<e.length-1&&!u){f(!0);const T=o+1;console.log("Next month: index",T,"month",e[T]),l(T),await n(e[T]),f(!1)}},x=async T=>{console.log("Select change: value",T);const N=g.findIndex(O=>O===T);if(console.log("Display index:",N),N>=0){const O=e[N];console.log("Setting raw month:",O),l(N),await n(O)}},S=async T=>{console.log("MonthSelector: Month changed to:",T);const N=await h(T);await n(T,N)},b=T=>{T.key==="ArrowLeft"&&o>0?(T.preventDefault(),y()):T.key==="ArrowRight"&&o<e.length-1&&(T.preventDefault(),w())};if(e.length===0)return c.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 border-b bg-gradient-to-r from-gray-50 to-gray-100 space-y-3 sm:space-y-0",role:"region","aria-label":"Demand month selector",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm border border-gray-200",children:c.jsx(Fi,{className:"h-5 w-5 text-blue-600"})}),c.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Demand Month:"})]}),c.jsx("div",{className:"flex items-center space-x-3 w-full sm:w-auto justify-center",children:v?c.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:[c.jsx(Jo,{className:"h-4 w-4 animate-spin text-blue-600"}),c.jsx("span",{className:"text-sm text-gray-500",children:"Loading months..."})]}):p?c.jsx("div",{className:"flex items-center space-x-2 px-4 py-2 bg-red-50 rounded-lg border border-red-200 shadow-sm",children:c.jsxs("span",{className:"text-sm text-red-500",children:["Error: ",p]})}):d.length>0?c.jsxs(jn,{value:m||((k=d[0])==null?void 0:k.month)||"",onValueChange:S,disabled:v,children:[c.jsx(mn,{className:"w-28 sm:w-36 h-8 sm:h-9 rounded-lg border-gray-300 bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all duration-200",children:c.jsx(Dn,{placeholder:"Select month",className:"text-sm font-semibold text-gray-900"})}),c.jsx(pn,{className:"bg-white border border-gray-200 rounded-lg shadow-xl max-h-60",children:d.map(T=>c.jsx(bt,{value:T.month,className:"text-sm hover:bg-blue-50 focus:bg-blue-50 cursor-pointer data-[state=checked]:bg-blue-100 data-[state=checked]:text-blue-900",children:T.month},T.month))})]}):c.jsx("div",{className:"flex items-center space-x-2 px-4 py-2 bg-white rounded-lg border border-gray-200 shadow-sm",children:c.jsx("span",{className:"text-sm text-gray-500",children:"No months available"})})}),c.jsx("div",{className:"w-full sm:w-20"})]});const E=g[o]||r;return console.log("MonthSelector render:",{availableMonths:e,selectedMonth:r,currentMonthIndex:o,selectedMonthDisplay:E,displayMonths:g}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 sm:p-4 border-b bg-gradient-to-r from-gray-50 to-gray-100 space-y-3 sm:space-y-0",onKeyDown:b,tabIndex:0,role:"region","aria-label":"Month selector",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"p-2 bg-white rounded-lg shadow-sm border border-gray-200",children:c.jsx(Fi,{className:"h-5 w-5 text-blue-600"})}),c.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Month:"})]}),c.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 w-full sm:w-auto justify-center",children:[c.jsx(Ee,{variant:"outline",size:"sm",onClick:y,disabled:o===0||a||u,className:Ae("h-8 w-8 sm:h-9 sm:w-9 p-0 rounded-lg border-gray-300 hover:bg-white hover:border-blue-400 hover:shadow-md transition-all duration-200","disabled:opacity-50 disabled:cursor-not-allowed","focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),"aria-label":"Previous month",children:u?c.jsx(Jo,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600 animate-spin"}):c.jsx(v1,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600"})}),c.jsxs(jn,{value:E,onValueChange:x,disabled:a||u,children:[c.jsx(mn,{className:"w-28 sm:w-36 h-8 sm:h-9 rounded-lg border-gray-300 bg-white hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 shadow-sm transition-all duration-200",children:c.jsx(Dn,{className:"text-sm font-semibold text-gray-900",children:a?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Jo,{className:"h-3 w-3 animate-spin"}),c.jsx("span",{className:"hidden sm:inline",children:"Loading..."})]}):E})}),c.jsx(pn,{className:"bg-white border border-gray-200 rounded-lg shadow-xl max-h-60",children:g.map((T,N)=>c.jsx(bt,{value:T,className:"text-sm hover:bg-blue-50 focus:bg-blue-50 cursor-pointer data-[state=checked]:bg-blue-100 data-[state=checked]:text-blue-900",children:T},T))})]}),c.jsx(Ee,{variant:"outline",size:"sm",onClick:w,disabled:o===e.length-1||a||u,className:Ae("h-8 w-8 sm:h-9 sm:w-9 p-0 rounded-lg border-gray-300 hover:bg-white hover:border-blue-400 hover:shadow-md transition-all duration-200","disabled:opacity-50 disabled:cursor-not-allowed","focus:ring-2 focus:ring-blue-500 focus:border-blue-500"),"aria-label":"Next month",children:u?c.jsx(Jo,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600 animate-spin"}):c.jsx(Lh,{className:"h-3 w-3 sm:h-4 sm:w-4 text-gray-600"})})]}),c.jsx("div",{className:"flex items-center space-x-2 w-full sm:w-auto justify-center sm:justify-end",children:c.jsx("div",{className:"px-3 py-1 bg-white rounded-lg border border-gray-200 shadow-sm",children:c.jsxs("span",{className:"text-xs font-semibold text-gray-600",children:[o+1," of ",e.length]})})})]})},zT=({application:e,onClose:t,onSave:r,onDataChanged:n,selectedEmiMonth:a,refetchStatusCounts:s})=>{const{user:i}=Ht(),[o,l]=_.useState(e),[u,f]=_.useState(""),[d,m]=_.useState(null),[h,v]=_.useState("contacts"),p=_.useRef(!1),g=_.useRef(!1),y=_.useRef(!1),{monthlyData:w,availableMonths:x,availableMonthsFormatted:S,loading:b,getApplicationForMonth:E,refetch:k}=F7(o==null?void 0:o.applicant_id);_.useEffect(()=>{console.log("ApplicationDetailsPanel: Monthly data state changed:",{hasMonthlyData:!!w,monthlyDataLength:(w==null?void 0:w.length)||0,monthlyLoading:b,currentPaymentId:o==null?void 0:o.payment_id,selectedMonth:u}),w&&w.length>0&&console.log("ApplicationDetailsPanel: Monthly data available:",w.map(J=>({id:J.id,demand_date:J.demand_date,demand_month:J.demand_month,demand_year:J.demand_year})))},[w,b,o==null?void 0:o.payment_id,u]),_.useEffect(()=>{console.log("ApplicationDetailsPanel: Application changed",{applicantId:e==null?void 0:e.applicant_id,paymentId:e==null?void 0:e.payment_id,emiMonth:e==null?void 0:e.emi_month}),l(e),y.current=!1,p.current=!1,f(""),e!=null&&e.payment_id&&console.log("ApplicationDetailsPanel: Expecting to initialize month for payment_id:",e.payment_id)},[e]),_.useEffect(()=>{(async()=>{if(o!=null&&o.applicant_id&&(o!=null&&o.emi_month))try{console.log("ApplicationDetailsPanel: Fetching full application details from API for:",o.applicant_id);const A=await ip(o.applicant_id,o.emi_month);if(A){console.log("ApplicationDetailsPanel: Received API application data:",A);const pe={...o,...A,field_status:o.field_status,applicant_calling_status:o.applicant_calling_status,co_applicant_calling_status:o.co_applicant_calling_status,guarantor_calling_status:o.guarantor_calling_status,reference_calling_status:o.reference_calling_status};console.log("ApplicationDetailsPanel: Enhanced application with API data:",pe),l(pe)}}catch(A){console.error("ApplicationDetailsPanel: Failed to fetch full application details:",A)}})()},[o==null?void 0:o.applicant_id,o==null?void 0:o.emi_month]);const{repaymentHistory:T}=I7(o==null?void 0:o.applicant_id),{fetchComments:N,addComment:O,clearComments:W}=rT(u),P=_.useCallback(async J=>{if(J)try{console.log("🔍 Fetching comments for payment_id:",J);const A=await Eu.getCommentsByRepaymentAndType(J.toString(),bu.APPLICATION_DETAILS,0,100);A.results&&A.results.length>0?(console.log("✅ Found comments for payment_id:",J,"count:",A.results.length),X(A.results.map(pe=>({...pe,user_name:pe.user_id===1?"User 1":`User ${pe.user_id}`,content:pe.comment,application_id:(o==null?void 0:o.applicant_id)||""})))):(console.log("ℹ️ No comments found for payment_id:",J),X([]))}catch(A){console.error("❌ Error fetching comments by payment_id:",A),X([])}},[o==null?void 0:o.applicant_id]),[G,X]=_.useState([]),{auditLogs:V,addAuditLog:K}=LL(o==null?void 0:o.applicant_id,u),{callingLogs:Y,addCallingLog:H}=BL(o==null?void 0:o.applicant_id,u);_.useEffect(()=>{m(null)},[o==null?void 0:o.applicant_id,u]),_.useEffect(()=>{console.log("ApplicationDetailsPanel: Clearing comments for application",o==null?void 0:o.applicant_id),W(),X([])},[o==null?void 0:o.applicant_id,W]),_.useEffect(()=>{o!=null&&o.payment_id&&(console.log("🔍 ApplicationDetailsPanel: Fetching comments for payment_id:",o.payment_id),P(o.payment_id))},[o==null?void 0:o.payment_id,P]),_.useEffect(()=>{if(console.log("ApplicationDetailsPanel: Month initialization check",{selectedEmiMonth:a,availableMonths:x,currentApplicationId:o==null?void 0:o.applicant_id,selectedMonth:u,applicationEmiMonth:o==null?void 0:o.emi_month,applicationDemandDate:o==null?void 0:o.demand_date,applicationPaymentId:o==null?void 0:o.payment_id,userSelectedMonth:p.current,isUpdatingStatus:g.current,initialized:y.current,monthlyLoading:b,monthlyDataAvailable:!!w&&w.length>0}),!(y.current&&(p.current||u)||g.current||!(o!=null&&o.applicant_id)||p.current&&u)&&!u){let J="";if(a){const A=x.find(pe=>Xn(pe)===a);A?(J=A,console.log("ApplicationDetailsPanel: ✅ Using selectedEmiMonth from dashboard:",a,"->",J)):console.log("ApplicationDetailsPanel: ⚠️ selectedEmiMonth",a,"not available for this loan. Available months:",x.map(pe=>Xn(pe)))}if(!J&&(o!=null&&o.payment_id)&&w&&w.length>0){console.log("ApplicationDetailsPanel: Checking payment_id match:",{paymentId:o.payment_id,monthlyDataCount:w.length,monthlyData:w.map(pe=>({id:pe.id,demand_date:pe.demand_date,demand_month:pe.demand_month,demand_year:pe.demand_year}))});const A=w.find(pe=>pe.id===o.payment_id);if(A)if(console.log("ApplicationDetailsPanel: Found matching payment in main logic:",A),A.demand_date)J=A.demand_date,console.log("ApplicationDetailsPanel: ✅ Found month for payment_id using demand_date:",o.payment_id,"->",J);else if(A.demand_month&&A.demand_year){const Ne=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][A.demand_month],$e=A.demand_year.toString().slice(-2);J=`${Ne}-${$e}`,console.log("ApplicationDetailsPanel: ✅ Found month for payment_id using demand_month/demand_year:",o.payment_id,"->",J)}else console.log("ApplicationDetailsPanel: ❌ No month information available for payment_id:",o.payment_id);else console.log("ApplicationDetailsPanel: ❌ No matching payment found for payment_id:",o.payment_id,"in monthlyData")}else console.log("ApplicationDetailsPanel: ⚠️ Cannot check payment_id match:",{hasPaymentId:!!(o!=null&&o.payment_id),hasMonthlyData:!!w,monthlyDataLength:(w==null?void 0:w.length)||0});if(!J&&(o!=null&&o.emi_month||o!=null&&o.demand_date)){const A=(o==null?void 0:o.emi_month)||(o==null?void 0:o.demand_date),pe=x.find(Ne=>Ne===A);if(pe)J=pe,console.log("ApplicationDetailsPanel: Found exact match for application emi_month/demand_date",A,"->",J);else{const Ne=Xn(A),$e=x.find(Me=>Xn(Me)===Ne);$e&&(J=$e,console.log("ApplicationDetailsPanel: Found formatted match for application emi_month/demand_date",Ne,"->",J))}}if(!J&&x.length>0&&(J=x[x.length-1],console.log("ApplicationDetailsPanel: Using most recent month for this loan:",J)),!J){console.warn("ApplicationDetailsPanel: No month found through normal channels, trying emergency fallback");return}console.log("ApplicationDetailsPanel: Setting initial month to",J,"based on selectedEmiMonth:",a,"payment_id:",o==null?void 0:o.payment_id,"and application EMI month:",o==null?void 0:o.emi_month),f(J),y.current=!0,p.current=!1}},[x,u,o==null?void 0:o.applicant_id,o==null?void 0:o.demand_date,o==null?void 0:o.payment_id,a,w,b]),_.useEffect(()=>{if(w&&w.length>0&&!u&&(o!=null&&o.payment_id)&&!y.current){console.log("ApplicationDetailsPanel: Monthly data became available, attempting to initialize month"),console.log("ApplicationDetailsPanel: Monthly data structure:",w.map(A=>({id:A.id,demand_date:A.demand_date,demand_month:A.demand_month,demand_year:A.demand_year})));let J="";if(a){const A=x.find(pe=>Xn(pe)===a);A?(J=A,console.log("ApplicationDetailsPanel: ✅ Using selectedEmiMonth from dashboard:",a,"->",J)):console.log("ApplicationDetailsPanel: ⚠️ selectedEmiMonth",a,"not available for this loan. Available months:",x.map(pe=>Xn(pe)))}if(!J){const A=w.find(pe=>pe.id===o.payment_id);if(A){if(console.log("ApplicationDetailsPanel: Found matching payment:",A),A.demand_date)J=A.demand_date,console.log("ApplicationDetailsPanel: Using demand_date:",J);else if(A.demand_month&&A.demand_year){const Ne=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][A.demand_month],$e=A.demand_year.toString().slice(-2);J=`${Ne}-${$e}`,console.log("ApplicationDetailsPanel: Constructed month from demand_month/demand_year:",J)}}else console.log("ApplicationDetailsPanel: ❌ Still no matching payment found after data load for payment_id:",o.payment_id)}J?(console.log("ApplicationDetailsPanel: ✅ Setting month to:",J,"for payment_id:",o.payment_id),f(J),y.current=!0,p.current=!1):console.log("ApplicationDetailsPanel: ❌ Could not determine month for payment_id:",o.payment_id)}},[w,u,o==null?void 0:o.payment_id,a,x]),_.useEffect(()=>{!u&&x.length>0&&!b&&(console.log("ApplicationDetailsPanel: Emergency fallback - setting month to first available:",x[0]),f(x[0]),y.current=!0)},[u,x,b]);const M=_.useCallback(async(J,A)=>{if(console.log("ApplicationDetailsPanel: Month changed to",J),f(J),p.current=!0,A&&A.monthOption&&A.monthOption.repayment_id){const pe={...A.application,payment_id:parseInt(A.monthOption.repayment_id,10),emi_month:J,demand_date:A.monthOption.demand_date};console.log("ApplicationDetailsPanel: ✅ Updated payment_id to",pe.payment_id,"for month:",J),l(pe),v(h)}else console.log("ApplicationDetailsPanel: ⚠️ No monthOption data found, using application as-is"),A&&A.application&&l(A.application);if(w&&w.length>0&&(console.log("ApplicationDetailsPanel: 🔄 Refreshing monthly data for new month:",J),setTimeout(()=>{k()},100)),o!=null&&o.applicant_id)try{console.log("ApplicationDetailsPanel: 🔄 Fetching application data for new month:",J);const pe=await ip(o.applicant_id,J);if(pe){console.log("ApplicationDetailsPanel: ✅ Received API application data for month:",J,pe);const Ne={...o,...pe,emi_month:J,field_status:o.field_status,applicant_calling_status:o.applicant_calling_status,co_applicant_calling_status:o.co_applicant_calling_status,guarantor_calling_status:o.guarantor_calling_status,reference_calling_status:o.reference_calling_status};console.log("ApplicationDetailsPanel: ✅ Enhanced application with new month data:",Ne),l(Ne)}}catch(pe){console.error("ApplicationDetailsPanel: ❌ Failed to fetch application data for month:",J,pe)}},[h,w,k,o]),ne=_.useCallback(async()=>{if(o!=null&&o.applicant_id&&u){console.log("ApplicationDetailsPanel: Fetching comments for active tab",{applicationId:o.applicant_id,selectedMonth:u});try{await N(o.applicant_id)}catch(J){console.error("Error fetching comments:",J)}}},[o==null?void 0:o.applicant_id,u,N]),ce=_.useCallback(J=>{v(J),J==="comments"&&ne()},[ne]),j=u?E(u):null,{handleStatusChange:z,handlePtpDateChange:L,handleCallingStatusChange:U}=O7(o,i,K,H,J=>{l(J),r(J),n==null||n()},u);_.useCallback(async J=>{g.current=!0;try{await z(J)}finally{setTimeout(()=>{g.current=!1},1e3)}},[z]);const Q=_.useCallback(async J=>{g.current=!0,p.current=!0;try{await L(J)}finally{setTimeout(()=>{g.current=!1},1e3)}},[L]),q=o?j?{...o,team_lead:j.team_lead||o.team_lead,rm_name:j.rm_name||o.rm_name,repayment:j.repayment||o.repayment,emi_amount:j.emi_amount||o.emi_amount,last_month_bounce:j.last_month_bounce||o.last_month_bounce,lms_status:j.lms_status||o.lms_status,collection_rm:j.collection_rm||o.collection_rm,demand_date:j.demand_date||o.demand_date,amount_collected:j.amount_collected||o.amount_collected,ptp_date:d||o.ptp_date,vehicle_status:o.vehicle_status}:{...o,ptp_date:d||o.ptp_date,vehicle_status:o.vehicle_status}:null;if(!o)return null;const ae=async(J,A)=>{if(o!=null&&o.applicant_id)try{if(console.log("🔍 handleAddComment called with:",{content:J,paymentId:A,currentApplicationPaymentId:o.payment_id}),A){const pe={repayment_id:A.toString(),comment:J.trim(),user_id:1,comment_type:bu.APPLICATION_DETAILS};console.log("🚀 Creating comment with payment_id directly:",pe),await Eu.createComment(pe),await P(A)}else await O(o.applicant_id,J,u,o.loan_id,u);Se.success("Comment added"),A||await N(o.applicant_id),await(n==null?void 0:n())}catch(pe){console.error("Error adding comment:",pe),Se.error("Failed to add comment")}},oe=async J=>{Se.error("Vehicle status update not available in this mode.")},se=_.useCallback(async()=>{if(o!=null&&o.applicant_id&&u)try{console.log("🔄 ApplicationDetailsPanel: Reloading application details after contact status update..."),console.log("🔄 ApplicationDetailsPanel: Calling getApplicationDetails with:",{applicantId:o.applicant_id,selectedMonth:u}),console.log("🔄 ApplicationDetailsPanel: Waiting 500ms for backend transaction to commit..."),await new Promise(A=>setTimeout(A,500));const J=await ip(o.applicant_id,u);if(J){console.log("🔄 ApplicationDetailsPanel: Received updated API application data:",J),console.log("🔄 ApplicationDetailsPanel: Current calling statuses:",{applicant:o.applicant_calling_status,co_applicant:o.co_applicant_calling_status,guarantor:o.guarantor_calling_status,reference:o.reference_calling_status}),console.log("🔄 ApplicationDetailsPanel: API calling statuses:",{applicant:J.applicant_calling_status,co_applicant:J.co_applicant_calling_status,guarantor:J.guarantor_calling_status,reference:J.reference_calling_status});const A={...o,...J,field_status:o.field_status,applicant_calling_status:J.applicant_calling_status||o.applicant_calling_status,co_applicant_calling_status:J.co_applicant_calling_status||o.co_applicant_calling_status,guarantor_calling_status:J.guarantor_calling_status||o.guarantor_calling_status,reference_calling_status:J.reference_calling_status||o.reference_calling_status};console.log("🔄 ApplicationDetailsPanel: Enhanced application with updated API data:",A),console.log("🔄 ApplicationDetailsPanel: Final calling statuses after merge:",{applicant:A.applicant_calling_status,co_applicant:A.co_applicant_calling_status,guarantor:A.guarantor_calling_status,reference:A.reference_calling_status}),l(A),n==null||n(),console.log("✅ Application details reloaded successfully")}}catch(J){console.error("❌ ApplicationDetailsPanel: Failed to reload application details:",J)}else console.warn("⚠️ ApplicationDetailsPanel: Cannot reload application details - missing applicant_id or selectedMonth")},[o==null?void 0:o.applicant_id,u,n]);return c.jsxs("div",{className:"application-details-panel bg-white flex flex-col",children:[c.jsxs("div",{className:"flex-shrink-0 p-4 sm:p-6 border-b bg-white",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-6",children:[c.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Application Details"}),c.jsx(Ee,{variant:"ghost",size:"sm",onClick:t,className:"hover:bg-gray-100 rounded-full h-8 w-8 p-0",children:c.jsx(Ns,{className:"h-4 w-4"})})]}),c.jsx($L,{application:q})]}),c.jsx($7,{availableMonths:x,availableMonthsFormatted:S,selectedMonth:u,onMonthChange:M,loading:b,loanId:o==null?void 0:o.loan_id,currentApplicationPaymentId:o==null?void 0:o.payment_id}),c.jsx("div",{className:"flex-1 flex-col-min-h-0",children:c.jsxs(tT,{value:h,onValueChange:ce,className:"h-full flex flex-col",children:[c.jsx("div",{className:"flex-shrink-0 pt-3 sm:pt-4 border-b",children:c.jsxs(wv,{className:"grid w-full grid-cols-4 text-xs sm:text-sm h-auto",children:[c.jsx(us,{value:"contacts",className:"py-2",children:"Contacts"}),c.jsx(us,{value:"status",className:"py-2",children:"Status"}),c.jsx(us,{value:"comments",className:"py-2",children:"Comments"}),c.jsx(us,{value:"details",className:"py-2",children:"Details"})]})}),c.jsxs("div",{className:"application-details-content flex-1 overflow-y-auto p-4 sm:p-4",children:[c.jsx(fs,{value:"contacts",className:"m-0",children:c.jsx(A7,{application:o,callingLogs:Y,onCallingStatusChange:U,selectedMonth:u,onReloadApplication:se},`contacts-${o==null?void 0:o.payment_id}-${u}`)}),c.jsx(fs,{value:"status",className:"m-0",children:c.jsx(j7,{application:o,auditLogs:V,onStatusChange:()=>{},onPtpDateChange:Q,addAuditLog:K,selectedMonth:u,refetchStatusCounts:s,monthlyData:w},`status-${o==null?void 0:o.payment_id}-${u}`)}),c.jsx(fs,{value:"comments",className:"m-0",children:c.jsx(D7,{comments:G,onAddComment:ae,paymentId:o.payment_id})}),c.jsx(fs,{value:"details",className:"m-0",children:c.jsx(M7,{application:o,repaymentHistory:T,auditLogs:V,onVehicleStatusChange:oe,monthlyData:w,selectedMonth:u},`details-${o==null?void 0:o.payment_id}-${u}`)})]})]})})]})},Sc=20,W7=()=>{ef();const{user:e,loading:t}=Ht(),{isAdmin:r,loading:n}=B1();Gl();const[a,s]=_.useState(1),[i,o]=_.useState(""),[l,u]=_.useState(null),[f,d]=_.useState([]),[m,h]=_.useState(!0),[v,p]=_.useState(0),[g,y]=_.useState([]),[w,x]=_.useState(null),[S,b]=_.useState({branch:[],teamLead:[],rm:[],dealer:[],lender:[],status:[],repayment:[],lastMonthBounce:[],ptpDate:[],vehicleStatus:[]}),[E,k]=_.useState("Aug-25"),[T,N]=_.useState(null),[O,W]=_.useState(!1),P=E||"Aug-25";_.useEffect(()=>{console.log("🔍 Index.tsx: Fetching filter options..."),w8().then(Q=>{console.log("🔍 Index.tsx: Filter options received from API:",Q),console.log("🔍 Index.tsx: demand_num from API:",Q.demand_num),console.log("🔍 Index.tsx: ptpDateOptions from API:",Q.ptpDateOptions),x(Q)}).catch(Q=>{console.error("❌ Index.tsx: Error fetching filter options:",Q)})},[]),_.useEffect(()=>{h(!0);const Q={search:i,branch:S.branch,teamLead:S.teamLead,rm:S.rm,dealer:S.dealer,lender:S.lender,status:S.status,repayment:S.repayment,lastMonthBounce:S.lastMonthBounce,ptpDate:S.ptpDate,vehicleStatus:S.vehicleStatus};console.log("Sending filter params to API:",Q),console.log("Current filters state:",S),_8(P,0,1e3,Q).then(q=>{y((q.results||[]).map(Qb)),p(q.count||0)}).catch(()=>{d([])}).finally(()=>h(!1))},[P,a,i,S.branch,S.teamLead,S.rm,S.dealer,S.lender,S.status,S.repayment,S.lastMonthBounce,S.ptpDate,S.vehicleStatus]),_.useEffect(()=>{W(!0),x8(P,S).then(N).catch(()=>N(null)).finally(()=>W(!1))},[P,S]),_.useEffect(()=>{const q=setInterval(()=>{w&&x({...w})},864e5);return()=>clearInterval(q)},[w]);const G=_.useCallback((Q,q)=>Q.filter(ae=>!(q.branch&&q.branch.length>0&&!q.branch.includes(ae.branch_name)||q.teamLead&&q.teamLead.length>0&&!q.teamLead.includes(ae.tl_name)||q.rm&&q.rm.length>0&&!q.rm.includes(ae.rm_name)||q.dealer&&q.dealer.length>0&&!q.dealer.includes(ae.dealer_name)||q.lender&&q.lender.length>0&&!q.lender.includes(ae.lender_name)||q.status&&q.status.length>0&&!q.status.includes(ae.status)||q.vehicleStatus&&q.vehicleStatus.length>0&&!q.vehicleStatus.includes(ae.vehicle_status))),[]);_.useEffect(()=>{if(g.length>0){const Q=G(g,S);d(Q),p(Q.length),s(1)}},[S,g,G]);const X=_.useMemo(()=>{const Q=(a-1)*Sc,q=Q+Sc;return f.slice(Q,q)},[f,a,Sc]),V=Q=>{console.log("EMI Month changed to:",Q),console.log("Previous selectedEmiMonthRaw:",E),k(Q),s(1)},K=(Q,q)=>{console.log("Filter change:",Q,q),b(ae=>({...ae,[Q]:q})),s(1)},Y=Q=>u(Q),H=()=>u(null),M=()=>{u(null),s(1)},ne=Q=>{u(Q)},ce=Q=>{o(Q),s(1)},j=()=>{console.log("Export full requested")},z=()=>{console.log("Export PTP comments requested")},L=Q=>{console.log("Export plan vs achievement requested for:",Q)},U=w&&{emiMonthOptions:lL(),branches:w.branches,dealers:w.dealers,lenders:w.lenders,statuses:w.statuses,ptpDateOptions:w.ptpDateOptions,vehicle_statuses:w.vehicle_statuses,team_leads:w.team_leads,rms:w.rms,repayments:w.demand_num,lastMonthBounce:["Not paid","Paid on time","1-5 days late","6-15 days late","15+ days late"]};return _.useEffect(()=>{w&&(console.log("🔍 Index.tsx: Filter options from API:",w),console.log("🔍 Index.tsx: Mapped options for frontend:",U),console.log("🔍 Index.tsx: Repayments (demand_num):",w.demand_num),console.log("🔍 Index.tsx: PTP Date options:",w.ptpDateOptions),console.log("🔍 Index.tsx: Mapped repayments:",U==null?void 0:U.repayments),console.log("🔍 Index.tsx: Mapped ptpDateOptions:",U==null?void 0:U.ptpDateOptions))},[w,U]),t||n?c.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8",children:c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsx(rL,{onExportFull:j,onExportPtpComments:z,onExportPlanVsAchievement:L}),c.jsx(yL,{filters:S,availableOptions:U,onFilterChange:K,searchTerm:i,onSearchChange:ce,selectedEmiMonth:P,onEmiMonthChange:V,emiMonthOptions:U==null?void 0:U.emiMonthOptions,loading:!w,searchLoading:m,totalCount:v}),O?c.jsx(DL,{}):c.jsx(jL,{statusCounts:T}),r&&c.jsx(ML,{onUpdate:()=>{}}),c.jsx(AL,{applications:X,onRowClick:Y,onApplicationDeleted:M,selectedApplicationId:l==null?void 0:l.id,currentPage:a,totalPages:Math.ceil((v||1)/Sc),onPageChange:s,totalCount:v,pageSize:Sc,selectedEmiMonth:P})]})}),c.jsx(PL,{}),l&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:H}),c.jsx("div",{className:"fixed inset-y-0 right-0 w-[95%] sm:w-96 lg:w-[500px] z-50",children:c.jsx(zT,{application:l,onClose:H,onSave:ne,selectedEmiMonth:P})})]})]})},H7=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(!0),[a,s]=_.useState(""),[i,o]=_.useState(!1),[l,u]=_.useState(""),[f,d]=_.useState(""),[m,h]=_.useState(""),[v,p]=_.useState("user"),[g,y]=_.useState(!1),w=async()=>{try{const{data:k,error:T}=await Pe.from("profiles").select("id, email, full_name").order("email");if(T){console.error("Error fetching profiles:",T),Se.error("Failed to fetch users");return}if(!k){t([]);return}const{data:N,error:O}=await Pe.from("user_roles").select("user_id, role, created_at");if(O){console.error("Error fetching user roles:",O),Se.error("Failed to fetch user roles");return}const W=k.map(P=>{const G=N==null?void 0:N.find(X=>X.user_id===P.id);return{id:P.id,email:P.email||"",full_name:P.full_name,role:(G==null?void 0:G.role)||"user",role_created_at:G==null?void 0:G.created_at}});t(W)}catch(k){console.error("Error fetching users:",k),Se.error("Failed to fetch users")}finally{n(!1)}};_.useEffect(()=>{w()},[]);const x=async k=>{k.preventDefault(),y(!0);try{console.log("Creating user with role assignment:",{email:l,fullName:m,role:v});const{data:T,error:N}=await Pe.functions.invoke("create-bulk-users",{body:{users:[{email:l.trim(),fullName:m.trim(),password:f,role:v}]}});if(N){console.error("Edge Function error:",N),Se.error("Failed to create user. Please try again.");return}const O=T;O.successful>0?(Se.success(`User created successfully with ${v} role!`),u(""),d(""),h(""),p("user"),o(!1),await w()):Se.error(`Failed to create user: ${O.errors[0]||"Unknown error"}`)}catch(T){console.error("Unexpected error creating user:",T),Se.error("An error occurred while creating the user")}finally{y(!1)}},S=async(k,T)=>{try{const{error:N}=await Pe.from("user_roles").upsert({user_id:k,role:T});if(N){console.error("Error updating role:",N),Se.error("Failed to update user role");return}Se.success(`User role updated to ${T}`),await w()}catch(N){console.error("Error updating role:",N),Se.error("Failed to update user role")}},b=async k=>{try{const{error:T}=await Pe.from("user_roles").delete().eq("user_id",k);if(T){console.error("Error removing role:",T),Se.error("Failed to remove user role");return}Se.success("User role removed"),await w()}catch(T){console.error("Error removing role:",T),Se.error("Failed to remove user role")}},E=e.filter(k=>k.email.toLowerCase().includes(a.toLowerCase())||k.full_name&&k.full_name.toLowerCase().includes(a.toLowerCase()));return r?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading users..."})]}):c.jsx("div",{className:"space-y-6",children:c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs(gt,{className:"flex items-center gap-2",children:[c.jsx(B0,{className:"h-5 w-5"}),"User Management"]}),c.jsxs(So,{open:i,onOpenChange:o,children:[c.jsx(tf,{asChild:!0,children:c.jsxs(Ee,{children:[c.jsx(B0,{className:"h-4 w-4 mr-2"}),"Create User"]})}),c.jsxs(_i,{className:"sm:max-w-md",children:[c.jsxs(Si,{children:[c.jsx(ko,{children:"Create New User"}),c.jsx(rf,{children:"Add a new user to the system with assigned role"})]}),c.jsxs("form",{onSubmit:x,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"fullName",children:"Full Name"}),c.jsx(Qr,{id:"fullName",type:"text",placeholder:"Enter full name",value:m,onChange:k=>h(k.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"email",children:"Email"}),c.jsx(Qr,{id:"email",type:"email",placeholder:"Enter email address",value:l,onChange:k=>u(k.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"password",children:"Password"}),c.jsx(Qr,{id:"password",type:"password",placeholder:"Enter password",value:f,onChange:k=>d(k.target.value),required:!0,minLength:6})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"role",children:"Role"}),c.jsxs(jn,{value:v,onValueChange:k=>p(k),children:[c.jsx(mn,{children:c.jsx(Dn,{placeholder:"Select role"})}),c.jsxs(pn,{children:[c.jsx(bt,{value:"user",children:"User"}),c.jsx(bt,{value:"admin",children:"Admin"})]})]})]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Ee,{type:"button",variant:"outline",onClick:()=>o(!1),disabled:g,children:"Cancel"}),c.jsx(Ee,{type:"submit",disabled:g,children:g?"Creating...":"Create User"})]})]})]})]})]})}),c.jsxs(Je,{children:[c.jsx("div",{className:"flex items-center gap-4 mb-6",children:c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(x1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx(Qr,{placeholder:"Search by email or name...",value:a,onChange:k=>s(k.target.value),className:"pl-10"})]})}),c.jsx("div",{className:"border rounded-lg",children:c.jsxs(Yl,{children:[c.jsx(uf,{children:c.jsxs(ma,{children:[c.jsx(ft,{children:"User"}),c.jsx(ft,{children:"Email"}),c.jsx(ft,{children:"Current Role"}),c.jsx(ft,{children:"Role Assigned"}),c.jsx(ft,{children:"Actions"})]})}),c.jsx(Xl,{children:E.map(k=>c.jsxs(ma,{children:[c.jsx(mt,{children:c.jsx("div",{className:"font-medium",children:k.full_name||"No name set"})}),c.jsx(mt,{children:k.email}),c.jsx(mt,{children:c.jsx(Fr,{variant:k.role==="admin"?"default":"secondary",children:k.role})}),c.jsx(mt,{children:k.role_created_at?c.jsx("span",{className:"text-sm text-gray-600",children:vt(new Date(k.role_created_at),"dd-MMM-yyyy")}):c.jsx("span",{className:"text-sm text-gray-400",children:"Default"})}),c.jsx(mt,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs(jn,{value:k.role,onValueChange:T=>S(k.id,T),children:[c.jsx(mn,{className:"w-24",children:c.jsx(Dn,{})}),c.jsxs(pn,{children:[c.jsx(bt,{value:"user",children:"User"}),c.jsx(bt,{value:"admin",children:"Admin"})]})]}),k.role_created_at&&c.jsx(Ee,{variant:"outline",size:"sm",onClick:()=>b(k.id),className:"text-red-600 hover:text-red-700",children:c.jsx(qA,{className:"h-4 w-4"})})]})})]},k.id))})]})}),E.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-500",children:"No users found matching your search criteria"})]})]})})},z7=({uploadType:e,onTypeChange:t})=>c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ke,{className:"text-sm font-medium",children:"Upload Type"}),c.jsxs(am,{value:e,onValueChange:r=>t(r),children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"applications",id:"applications"}),c.jsxs(Ke,{htmlFor:"applications",className:"text-sm",children:[c.jsx("strong",{children:"Applications"})," - Upload application data with all fields"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"repayment_history",id:"repayment_history"}),c.jsxs(Ke,{htmlFor:"repayment_history",className:"text-sm",children:[c.jsx("strong",{children:"Repayment History"})," - Upload repayment history data only"]})]})]})]}),V7=({uploadMode:e,onModeChange:t})=>c.jsxs("div",{className:"space-y-3",children:[c.jsx(Ke,{className:"text-sm font-medium",children:"Upload Mode"}),c.jsxs(am,{value:e,onValueChange:r=>t(r),children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"mixed",id:"mixed"}),c.jsxs(Ke,{htmlFor:"mixed",className:"text-sm",children:[c.jsx("strong",{children:"Smart Mode"})," - Automatically add new or update existing (Recommended)"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"add",id:"add"}),c.jsxs(Ke,{htmlFor:"add",className:"text-sm",children:[c.jsx("strong",{children:"Add Only"})," - Only create new applications"]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(ms,{value:"update",id:"update"}),c.jsxs(Ke,{htmlFor:"update",className:"text-sm",children:[c.jsx("strong",{children:"Update Only"})," - Only update existing applications"]})]})]})]});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ih={};ih.version="0.18.5";var VT=1252,G7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],bv={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ev=function(e){G7.indexOf(e)!=-1&&(VT=bv[0]=e)};function Y7(){Ev(1252)}var pa=function(e){Ev(e)};function Tv(){pa(1200),Y7()}function Pw(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function X7(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function GT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Pc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?X7(e.slice(2)):t==254&&r==255?GT(e.slice(2)):t==65279?e.slice(1):e},Kf=function(t){return String.fromCharCode(t)},jw=function(t){return String.fromCharCode(t)},Nu,Zs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cu(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Zs.charAt(s)+Zs.charAt(i)+Zs.charAt(o)+Zs.charAt(l);return t}function Rn(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Zs.indexOf(e.charAt(u++)),i=Zs.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Zs.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Zs.indexOf(e.charAt(u++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Cs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function mi(e){return Ge?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Dw(e){return Ge?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var En=function(t){return Ge?Cs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function dm(e){if(typeof ArrayBuffer>"u")return En(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ti(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function K7(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Nv(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Nv(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var dr=Ge?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Cs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function q7(e){for(var t=[],r=0,n=e.length+250,a=mi(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=mi(65535),n=65530)}return t.push(a.slice(0,r)),dr(t)}var Zr=/\u0000/g,jc=/[\u0001-\u0006]/g;function cl(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ga(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}function Cv(e,t){var r=""+e;return r.length>=t?r:Ut(" ",t-r.length)+r}function oh(e,t){var r=""+e;return r.length>=t?r:r+Ut(" ",t-r.length)}function Q7(e,t){var r=""+Math.round(e);return r.length>=t?r:Ut("0",t-r.length)+r}function J7(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}var Rw=Math.pow(2,32);function Oo(e,t){if(e>Rw||e<-Rw)return Q7(e,t);var r=Math.round(e);return J7(r,t)}function lh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Mw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Tp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Z7(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var De={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ow={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},e9={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ch(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*i+s,f=d*u+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=s):(f=u,o=i)),!r)return[0,n*o,f];var m=Math.floor(n*o/f);return[m,n*o-m*f,f]}function Li(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=i9(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var YT=new Date(1899,11,31,0,0,0),t9=YT.getTime(),r9=new Date(1900,2,1,0,0,0);function XT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=r9&&(r+=24*60*60*1e3),(r-(t9+(e.getTimezoneOffset()-YT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Av(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function n9(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function a9(e){var t=e<0?12:11,r=Av(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function s9(e){var t=Av(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Au(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=a9(e):t===10?r=e.toFixed(10).substr(0,12):r=s9(e),Av(n9(r.toUpperCase()))}function uo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Au(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ta(14,XT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function i9(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function o9(e,t,r,n){var a="",s=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return Tp[r.m-1][1];case 5:return Tp[r.m-1][0];default:return Tp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return Mw[r.q][0];default:return Mw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ga(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=ga(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?ga(l,u):"";return f}function ei(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var KT=/%/g;function l9(e,t,r){var n=t.replace(KT,""),a=t.length-n.length;return ps(e,n,r*Math.pow(10,2*a))+Ut("%",a)}function c9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ps(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function qT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qT(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var QT=/# (\?+)( ?)\/( ?)(\d+)/;function u9(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Ut(" ",e[1].length+1+e[4].length):Cv(i,e[1].length)+e[2]+"/"+e[3]+ga(o,e[4].length))}function f9(e,t,r){return r+(t===0?"":""+t)+Ut(" ",e[1].length+2+e[4].length)}var JT=/^#*0*\.([0#]+)/,ZT=/\).*[0#]/,eN=/\(###\) ###\\?-####/;function Xr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Iw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Fw(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function d9(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function h9(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Un(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Un("n",n,r):"("+Un("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return c9(e,t,r);if(t.indexOf("%")!==-1)return l9(e,t,r);if(t.indexOf("E")!==-1)return qT(t,r);if(t.charCodeAt(0)===36)return"$"+Un(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Oo(l,t.length);if(t.match(/^[#?]+$/))return a=Oo(r,0),a==="0"&&(a=""),a.length>t.length?a:Xr(t.substr(0,t.length-a.length))+a;if(s=t.match(QT))return u9(s,l,u);if(t.match(/^#+0+$/))return u+Oo(l,t.length-t.indexOf("0"));if(s=t.match(JT))return a=Iw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Xr(s[1])).replace(/\.$/,"."+Xr(s[1])).replace(/\.(\d*)$/,function(v,p){return"."+p+Ut("0",Xr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+Iw(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ei(Oo(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Un(e,t,-r):ei(""+(Math.floor(r)+d9(r,s[1].length)))+"."+ga(Fw(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Un(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cl(Un(e,t.replace(/[\\-]/g,""),r)),i=0,cl(cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(eN))return a=Un(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=ch(l,Math.pow(10,i)-1,!1),a=""+u,f=ps("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=oh(o[2],i),f.length<s[4].length&&(f=Xr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=ch(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Cv(o[1],i)+s[2]+"/"+s[3]+oh(o[2],i):Ut(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Oo(r,0),t.length<=a.length?a:Xr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,m=t.length-a.length-d;return Xr(t.substr(0,d)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Fw(r,s[1].length),r<0?"-"+Un(e,t,-r):ei(h9(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ga(0,3-v.length):"")+v})+"."+ga(i,s[1].length);switch(t){case"###,##0.00":return Un(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ei(Oo(l,0));return h!=="0"?u+h:"";case"###,###.00":return Un(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Un(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function m9(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ps(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function p9(e,t,r){var n=t.replace(KT,""),a=t.length-n.length;return ps(e,n,r*Math.pow(10,2*a))+Ut("%",a)}function tN(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tN(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ra(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ra("n",n,r):"("+Ra("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return m9(e,t,r);if(t.indexOf("%")!==-1)return p9(e,t,r);if(t.indexOf("E")!==-1)return tN(t,r);if(t.charCodeAt(0)===36)return"$"+Ra(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ga(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Xr(t.substr(0,t.length-a.length))+a;if(s=t.match(QT))return f9(s,l,u);if(t.match(/^#+0+$/))return u+ga(l,t.length-t.indexOf("0"));if(s=t.match(JT))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Xr(s[1])).replace(/\.$/,"."+Xr(s[1])),a=a.replace(/\.(\d*)$/,function(v,p){return"."+p+Ut("0",Xr(s[1]).length-p.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+ei(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ra(e,t,-r):ei(""+r)+"."+Ut("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ra(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cl(Ra(e,t.replace(/[\\-]/g,""),r)),i=0,cl(cl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(eN))return a=Ra(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=ch(l,Math.pow(10,i)-1,!1),a=""+u,f=ps("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=oh(o[2],i),f.length<s[4].length&&(f=Xr(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=ch(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Cv(o[1],i)+s[2]+"/"+s[3]+oh(o[2],i):Ut(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Xr(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,m=t.length-a.length-d;return Xr(t.substr(0,d)+a+t.substr(t.length-m))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ra(e,t,-r):ei(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ga(0,3-v.length):"")+v})+"."+ga(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ei(""+l);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Ra(e,t.slice(0,t.lastIndexOf(".")),r)+Xr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ps(e,t,r){return(r|0)===r?Ra(e,t,r):Un(e,t,r)}function g9(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ql(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":lh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(rN))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function v9(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",u,f,d,m="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!lh(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var h=e.charAt(++i),v=h==="("||h===")"?h:"t";a[a.length]={t:v,v:h},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Li(t,r,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Li(t,r),u==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=m),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var p={t:o,v:o};if(u==null&&(u=Li(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",m="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",i+=5,m="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(u!=null&&(p.v=u.H>=12?"下午":"上午"),p.t="T",i+=5,m="h"):(p.t="t",++i),u==null&&p.t==="T")return"";a[a.length]=p,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(rN)){if(u==null&&(u=Li(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ql(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var g=0,y=0,w;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=m,l="h",g<1&&(g=1);break;case"s":(w=a[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[i].v.match(/[Hh]/)&&(g=1),g<2&&a[i].v.match(/[Mm]/)&&(g=2),g<3&&a[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var x="",S;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=o9(a[i].t.charCodeAt(0),a[i].v,u,y),a[i].t="t";break;case"n":case"?":for(S=i+1;a[S]!=null&&((o=a[S].t)==="?"||o==="D"||(o===" "||o==="t")&&a[S+1]!=null&&(a[S+1].t==="?"||a[S+1].t==="t"&&a[S+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[S].v==="/"||a[S].v===" "&&a[S+1]!=null&&a[S+1].t=="?"));)a[i].v+=a[S].v,a[S]={v:"",t:";"},++S;x+=a[i].v,i=S-1;break;case"G":a[i].t="t",a[i].v=uo(t,r);break}var b="",E,k;if(x.length>0){x.charCodeAt(0)==40?(E=t<0&&x.charCodeAt(0)===45?-t:t,k=ps("n",x,E)):(E=t<0&&n>1?-t:t,k=ps("n",x,E),E<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),S=k.length-1;var T=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){T=i;break}var N=a.length;if(T===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(S>=a[i].v.length-1?(S-=a[i].v.length,a[i].v=k.substr(S+1,a[i].v.length)):S<0?a[i].v="":(a[i].v=k.substr(0,S+1),S=-1),a[i].t="t",N=i);S>=0&&N<a.length&&(a[N].v=k.substr(0,S+1)+a[N].v)}else if(T!==a.length&&k.indexOf("E")===-1){for(S=k.indexOf(".")-1,i=T;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")-1:a[i].v.length-1,b=a[i].v.substr(f+1);f>=0;--f)S>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(b=k.charAt(S--)+b);a[i].v=b,a[i].t="t",N=i}for(S>=0&&N<a.length&&(a[N].v=k.substr(0,S+1)+a[N].v),S=k.indexOf(".")+1,i=T;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==T)){for(f=a[i].v.indexOf(".")>-1&&i===T?a[i].v.indexOf(".")+1:0,b=a[i].v.substr(0,f);f<a[i].v.length;++f)S<k.length&&(b+=k.charAt(S++));a[i].v=b,a[i].t="t",N=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(E=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=ps(a[i].t,a[i].v,E),a[i].t="t");var O="";for(i=0;i!==a.length;++i)a[i]!=null&&(O+=a[i].v);return O}var Lw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Bw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function y9(e,t){var r=g9(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Lw),o=r[1].match(Lw);return Bw(t,i)?[n,r[0]]:Bw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function ta(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:De)[e],n==null&&(n=r.table&&r.table[Ow[e]]||De[Ow[e]]),n==null&&(n=e9[e]||"General");break}if(lh(n,0))return uo(t,r);t instanceof Date&&(t=XT(t,r.date1904));var a=y9(n,t);if(lh(a[1]))return uo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return v9(a[1],t,r,a[0])}function gs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(De[r]==null){t<0&&(t=r);continue}if(De[r]==e){t=r;break}}t<0&&(t=391)}return De[t]=e,t}function hm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&gs(e[t],t)}function Ql(){De=Z7()}var x9={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nN=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function w9(e){var t=typeof e=="number"?De[e]:e;return t=t.replace(nN,"(\\d+)"),new RegExp("^"+t+"$")}function _9(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(nN)||[]).forEach(function(d,m){var h=parseInt(r[m+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":i=h;break;case"s":l=h;break;case"m":i>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&a==-1&&s==-1?f:u+"T"+f}var S9=function(){var e={};e.version="1.2.0";function t(){for(var k=0,T=new Array(256),N=0;N!=256;++N)k=N,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,T[N]=k;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(k){var T=0,N=0,O=0,W=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)W[O]=k[O];for(O=0;O!=256;++O)for(N=k[O],T=256+O;T<4096;T+=256)N=W[T]=N>>>8^k[N&255];var P=[];for(O=1;O!=16;++O)P[O-1]=typeof Int32Array<"u"?W.subarray(O*256,O*256+256):W.slice(O*256,O*256+256);return P}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],u=a[4],f=a[5],d=a[6],m=a[7],h=a[8],v=a[9],p=a[10],g=a[11],y=a[12],w=a[13],x=a[14];function S(k,T){for(var N=T^-1,O=0,W=k.length;O<W;)N=N>>>8^r[(N^k.charCodeAt(O++))&255];return~N}function b(k,T){for(var N=T^-1,O=k.length-15,W=0;W<O;)N=x[k[W++]^N&255]^w[k[W++]^N>>8&255]^y[k[W++]^N>>16&255]^g[k[W++]^N>>>24]^p[k[W++]]^v[k[W++]]^h[k[W++]]^m[k[W++]]^d[k[W++]]^f[k[W++]]^u[k[W++]]^l[k[W++]]^o[k[W++]]^i[k[W++]]^s[k[W++]]^r[k[W++]];for(O+=15;W<O;)N=N>>>8^r[(N^k[W++])&255];return~N}function E(k,T){for(var N=T^-1,O=0,W=k.length,P=0,G=0;O<W;)P=k.charCodeAt(O++),P<128?N=N>>>8^r[(N^P)&255]:P<2048?(N=N>>>8^r[(N^(192|P>>6&31))&255],N=N>>>8^r[(N^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,G=k.charCodeAt(O++)&1023,N=N>>>8^r[(N^(240|P>>8&7))&255],N=N>>>8^r[(N^(128|P>>2&63))&255],N=N>>>8^r[(N^(128|G>>6&15|(P&3)<<4))&255],N=N>>>8^r[(N^(128|G&63))&255]):(N=N>>>8^r[(N^(224|P>>12&15))&255],N=N>>>8^r[(N^(128|P>>6&63))&255],N=N>>>8^r[(N^(128|P&63))&255]);return~N}return e.table=r,e.bstr=S,e.buf=b,e.str=E,e}(),Ce=function(){var t={};t.version="1.2.1";function r(C,I){for(var D=C.split("/"),R=I.split("/"),F=0,B=0,ee=Math.min(D.length,R.length);F<ee;++F){if(B=D[F].length-R[F].length)return B;if(D[F]!=R[F])return D[F]<R[F]?-1:1}return D.length-R.length}function n(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:n(C.slice(0,-1));var I=C.lastIndexOf("/");return I===-1?C:C.slice(0,I+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var I=C.lastIndexOf("/");return I===-1?C:C.slice(I+1)}function s(C,I){typeof I=="string"&&(I=new Date(I));var D=I.getHours();D=D<<6|I.getMinutes(),D=D<<5|I.getSeconds()>>>1,C.write_shift(2,D);var R=I.getFullYear()-1980;R=R<<4|I.getMonth()+1,R=R<<5|I.getDate(),C.write_shift(2,R)}function i(C){var I=C.read_shift(2)&65535,D=C.read_shift(2)&65535,R=new Date,F=D&31;D>>>=5;var B=D&15;D>>>=4,R.setMilliseconds(0),R.setFullYear(D+1980),R.setMonth(B-1),R.setDate(F);var ee=I&31;I>>>=5;var le=I&63;return I>>>=6,R.setHours(I),R.setMinutes(le),R.setSeconds(ee<<1),R}function o(C){xr(C,0);for(var I={},D=0;C.l<=C.length-4;){var R=C.read_shift(2),F=C.read_shift(2),B=C.l+F,ee={};switch(R){case 21589:D=C.read_shift(1),D&1&&(ee.mtime=C.read_shift(4)),F>5&&(D&2&&(ee.atime=C.read_shift(4)),D&4&&(ee.ctime=C.read_shift(4))),ee.mtime&&(ee.mt=new Date(ee.mtime*1e3));break}C.l=B,I[R]=ee}return I}var l;function u(){return l||(l={})}function f(C,I){if(C[0]==80&&C[1]==75)return rc(C,I);if((C[0]|32)==109&&(C[1]|32)==105)return wn(C,I);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var D=3,R=512,F=0,B=0,ee=0,le=0,Z=0,te=[],re=C.slice(0,512);xr(re,0);var de=d(re);switch(D=de[0],D){case 3:R=512;break;case 4:R=4096;break;case 0:if(de[1]==0)return rc(C,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}R!==512&&(re=C.slice(0,R),xr(re,28));var we=C.slice(0,R);m(re,D);var ke=re.read_shift(4,"i");if(D===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);re.l+=4,ee=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),le=re.read_shift(4,"i"),F=re.read_shift(4,"i"),Z=re.read_shift(4,"i"),B=re.read_shift(4,"i");for(var me=-1,_e=0;_e<109&&(me=re.read_shift(4,"i"),!(me<0));++_e)te[_e]=me;var Be=h(C,R);g(Z,B,Be,R,te);var jt=w(Be,ee,te,R);jt[ee].name="!Directory",F>0&&le!==G&&(jt[le].name="!MiniFAT"),jt[te[0]].name="!FAT",jt.fat_addrs=te,jt.ssz=R;var Dt={},br=[],ac=[],sc=[];x(ee,jt,Be,br,F,Dt,ac,le),v(ac,sc,br),br.shift();var ic={FileIndex:ac,FullPaths:sc};return I&&I.raw&&(ic.raw={header:we,sectors:Be}),ic}function d(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(X,"Header Signature: "),C.l+=16;var I=C.read_shift(2,"u");return[C.read_shift(2,"u"),I]}function m(C,I){var D=9;switch(C.l+=2,D=C.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function h(C,I){for(var D=Math.ceil(C.length/I)-1,R=[],F=1;F<D;++F)R[F-1]=C.slice(F*I,(F+1)*I);return R[D-1]=C.slice(D*I),R}function v(C,I,D){for(var R=0,F=0,B=0,ee=0,le=0,Z=D.length,te=[],re=[];R<Z;++R)te[R]=re[R]=R,I[R]=D[R];for(;le<re.length;++le)R=re[le],F=C[R].L,B=C[R].R,ee=C[R].C,te[R]===R&&(F!==-1&&te[F]!==F&&(te[R]=te[F]),B!==-1&&te[B]!==B&&(te[R]=te[B])),ee!==-1&&(te[ee]=R),F!==-1&&R!=te[R]&&(te[F]=te[R],re.lastIndexOf(F)<le&&re.push(F)),B!==-1&&R!=te[R]&&(te[B]=te[R],re.lastIndexOf(B)<le&&re.push(B));for(R=1;R<Z;++R)te[R]===R&&(B!==-1&&te[B]!==B?te[R]=te[B]:F!==-1&&te[F]!==F&&(te[R]=te[F]));for(R=1;R<Z;++R)if(C[R].type!==0){if(le=R,le!=te[le])do le=te[le],I[R]=I[le]+"/"+I[R];while(le!==0&&te[le]!==-1&&le!=te[le]);te[R]=-1}for(I[0]+="/",R=1;R<Z;++R)C[R].type!==2&&(I[R]+="/")}function p(C,I,D){for(var R=C.start,F=C.size,B=[],ee=R;D&&F>0&&ee>=0;)B.push(I.slice(ee*P,ee*P+P)),F-=P,ee=Ri(D,ee*4);return B.length===0?ie(0):dr(B).slice(0,C.size)}function g(C,I,D,R,F){var B=G;if(C===G){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ee=D[C],le=(R>>>2)-1;if(!ee)return;for(var Z=0;Z<le&&(B=Ri(ee,Z*4))!==G;++Z)F.push(B);g(Ri(ee,R-4),I-1,D,R,F)}}function y(C,I,D,R,F){var B=[],ee=[];F||(F=[]);var le=R-1,Z=0,te=0;for(Z=I;Z>=0;){F[Z]=!0,B[B.length]=Z,ee.push(C[Z]);var re=D[Math.floor(Z*4/R)];if(te=Z*4&le,R<4+te)throw new Error("FAT boundary crossed: "+Z+" 4 "+R);if(!C[re])break;Z=Ri(C[re],te)}return{nodes:B,data:Qw([ee])}}function w(C,I,D,R){var F=C.length,B=[],ee=[],le=[],Z=[],te=R-1,re=0,de=0,we=0,ke=0;for(re=0;re<F;++re)if(le=[],we=re+I,we>=F&&(we-=F),!ee[we]){Z=[];var me=[];for(de=we;de>=0;){me[de]=!0,ee[de]=!0,le[le.length]=de,Z.push(C[de]);var _e=D[Math.floor(de*4/R)];if(ke=de*4&te,R<4+ke)throw new Error("FAT boundary crossed: "+de+" 4 "+R);if(!C[_e]||(de=Ri(C[_e],ke),me[de]))break}B[we]={nodes:le,data:Qw([Z])}}return B}function x(C,I,D,R,F,B,ee,le){for(var Z=0,te=R.length?2:0,re=I[C].data,de=0,we=0,ke;de<re.length;de+=128){var me=re.slice(de,de+128);xr(me,64),we=me.read_shift(2),ke=Iv(me,0,we-te),R.push(ke);var _e={name:ke,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Be=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Be!==0&&(_e.ct=S(me,me.l-8));var jt=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);jt!==0&&(_e.mt=S(me,me.l-8)),_e.start=me.read_shift(4,"i"),_e.size=me.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=G,_e.name=""),_e.type===5?(Z=_e.start,F>0&&Z!==G&&(I[Z].name="!StreamData")):_e.size>=4096?(_e.storage="fat",I[_e.start]===void 0&&(I[_e.start]=y(D,_e.start,I.fat_addrs,I.ssz)),I[_e.start].name=_e.name,_e.content=I[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:Z!==G&&_e.start!==G&&I[Z]&&(_e.content=p(_e,I[Z].data,(I[le]||{}).data))),_e.content&&xr(_e.content,0),B[ke]=_e,ee.push(_e)}}function S(C,I){return new Date((bn(C,I+4)/1e7*Math.pow(2,32)+bn(C,I)/1e7-11644473600)*1e3)}function b(C,I){return u(),f(l.readFileSync(C),I)}function E(C,I){var D=I&&I.type;switch(D||Ge&&Buffer.isBuffer(C)&&(D="buffer"),D||"base64"){case"file":return b(C,I);case"base64":return f(En(Rn(C)),I);case"binary":return f(En(C),I)}return f(C,I)}function k(C,I){var D=I||{},R=D.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=R+"/",C.FileIndex[0]={name:R,type:5}),D.CLSID&&(C.FileIndex[0].clsid=D.CLSID),T(C)}function T(C){var I="Sh33tJ5";if(!Ce.find(C,"/"+I)){var D=ie(4);D[0]=55,D[1]=D[3]=50,D[2]=54,C.FileIndex.push({name:I,type:2,content:D,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+I),N(C)}}function N(C,I){k(C);for(var D=!1,R=!1,F=C.FullPaths.length-1;F>=0;--F){var B=C.FileIndex[F];switch(B.type){case 0:R?D=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(B.R*B.L*B.C)&&(D=!0),B.R>-1&&B.L>-1&&B.R==B.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!I)){var ee=new Date(1987,1,19),le=0,Z=Object.create?Object.create(null):{},te=[];for(F=0;F<C.FullPaths.length;++F)Z[C.FullPaths[F]]=!0,C.FileIndex[F].type!==0&&te.push([C.FullPaths[F],C.FileIndex[F]]);for(F=0;F<te.length;++F){var re=n(te[F][0]);R=Z[re],R||(te.push([re,{name:a(re).replace("/",""),type:1,clsid:K,ct:ee,mt:ee,content:null}]),Z[re]=!0)}for(te.sort(function(ke,me){return r(ke[0],me[0])}),C.FullPaths=[],C.FileIndex=[],F=0;F<te.length;++F)C.FullPaths[F]=te[F][0],C.FileIndex[F]=te[F][1];for(F=0;F<te.length;++F){var de=C.FileIndex[F],we=C.FullPaths[F];if(de.name=a(we).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||K,F===0)de.C=te.length>1?1:-1,de.size=0,de.type=5;else if(we.slice(-1)=="/"){for(le=F+1;le<te.length&&n(C.FullPaths[le])!=we;++le);for(de.C=le>=te.length?-1:le,le=F+1;le<te.length&&n(C.FullPaths[le])!=n(we);++le);de.R=le>=te.length?-1:le,de.type=1}else n(C.FullPaths[F+1]||"")==n(we)&&(de.R=F+1),de.type=2}}}function O(C,I){var D=I||{};if(D.fileType=="mad")return Ca(C,D);switch(N(C),D.fileType){case"zip":return nc(C,D)}var R=function(ke){for(var me=0,_e=0,Be=0;Be<ke.FileIndex.length;++Be){var jt=ke.FileIndex[Be];if(jt.content){var Dt=jt.content.length;Dt>0&&(Dt<4096?me+=Dt+63>>6:_e+=Dt+511>>9)}}for(var br=ke.FullPaths.length+3>>2,ac=me+7>>3,sc=me+127>>7,ic=ac+_e+br+sc,Ai=ic+127>>7,Em=Ai<=109?0:Math.ceil((Ai-109)/127);ic+Ai+Em+127>>7>Ai;)Em=++Ai<=109?0:Math.ceil((Ai-109)/127);var ts=[1,Em,Ai,sc,br,_e,me,0];return ke.FileIndex[0].size=me<<6,ts[7]=(ke.FileIndex[0].start=ts[0]+ts[1]+ts[2]+ts[3]+ts[4]+ts[5])+(ts[6]+7>>3),ts}(C),F=ie(R[7]<<9),B=0,ee=0;{for(B=0;B<8;++B)F.write_shift(1,V[B]);for(B=0;B<8;++B)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),B=0;B<3;++B)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,R[2]),F.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:G),F.write_shift(4,R[3]),F.write_shift(-4,R[1]?R[0]-1:G),F.write_shift(4,R[1]),B=0;B<109;++B)F.write_shift(-4,B<R[2]?R[1]+B:-1)}if(R[1])for(ee=0;ee<R[1];++ee){for(;B<236+ee*127;++B)F.write_shift(-4,B<R[2]?R[1]+B:-1);F.write_shift(-4,ee===R[1]-1?G:ee+1)}var le=function(ke){for(ee+=ke;B<ee-1;++B)F.write_shift(-4,B+1);ke&&(++B,F.write_shift(-4,G))};for(ee=B=0,ee+=R[1];B<ee;++B)F.write_shift(-4,Y.DIFSECT);for(ee+=R[2];B<ee;++B)F.write_shift(-4,Y.FATSECT);le(R[3]),le(R[4]);for(var Z=0,te=0,re=C.FileIndex[0];Z<C.FileIndex.length;++Z)re=C.FileIndex[Z],re.content&&(te=re.content.length,!(te<4096)&&(re.start=ee,le(te+511>>9)));for(le(R[6]+7>>3);F.l&511;)F.write_shift(-4,Y.ENDOFCHAIN);for(ee=B=0,Z=0;Z<C.FileIndex.length;++Z)re=C.FileIndex[Z],re.content&&(te=re.content.length,!(!te||te>=4096)&&(re.start=ee,le(te+63>>6)));for(;F.l&511;)F.write_shift(-4,Y.ENDOFCHAIN);for(B=0;B<R[4]<<2;++B){var de=C.FullPaths[B];if(!de||de.length===0){for(Z=0;Z<17;++Z)F.write_shift(4,0);for(Z=0;Z<3;++Z)F.write_shift(4,-1);for(Z=0;Z<12;++Z)F.write_shift(4,0);continue}re=C.FileIndex[B],B===0&&(re.start=re.size?re.start-1:G);var we=B===0&&D.root||re.name;if(te=2*(we.length+1),F.write_shift(64,we,"utf16le"),F.write_shift(2,te),F.write_shift(1,re.type),F.write_shift(1,re.color),F.write_shift(-4,re.L),F.write_shift(-4,re.R),F.write_shift(-4,re.C),re.clsid)F.write_shift(16,re.clsid,"hex");else for(Z=0;Z<4;++Z)F.write_shift(4,0);F.write_shift(4,re.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,re.start),F.write_shift(4,re.size),F.write_shift(4,0)}for(B=1;B<C.FileIndex.length;++B)if(re=C.FileIndex[B],re.size>=4096)if(F.l=re.start+1<<9,Ge&&Buffer.isBuffer(re.content))re.content.copy(F,F.l,0,re.size),F.l+=re.size+511&-512;else{for(Z=0;Z<re.size;++Z)F.write_shift(1,re.content[Z]);for(;Z&511;++Z)F.write_shift(1,0)}for(B=1;B<C.FileIndex.length;++B)if(re=C.FileIndex[B],re.size>0&&re.size<4096)if(Ge&&Buffer.isBuffer(re.content))re.content.copy(F,F.l,0,re.size),F.l+=re.size+63&-64;else{for(Z=0;Z<re.size;++Z)F.write_shift(1,re.content[Z]);for(;Z&63;++Z)F.write_shift(1,0)}if(Ge)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function W(C,I){var D=C.FullPaths.map(function(Z){return Z.toUpperCase()}),R=D.map(function(Z){var te=Z.split("/");return te[te.length-(Z.slice(-1)=="/"?2:1)]}),F=!1;I.charCodeAt(0)===47?(F=!0,I=D[0].slice(0,-1)+I):F=I.indexOf("/")!==-1;var B=I.toUpperCase(),ee=F===!0?D.indexOf(B):R.indexOf(B);if(ee!==-1)return C.FileIndex[ee];var le=!B.match(jc);for(B=B.replace(Zr,""),le&&(B=B.replace(jc,"!")),ee=0;ee<D.length;++ee)if((le?D[ee].replace(jc,"!"):D[ee]).replace(Zr,"")==B||(le?R[ee].replace(jc,"!"):R[ee]).replace(Zr,"")==B)return C.FileIndex[ee];return null}var P=64,G=-2,X="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],K="00000000000000000000000000000000",Y={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:K,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(C,I,D){u();var R=O(C,D);l.writeFileSync(I,R)}function M(C){for(var I=new Array(C.length),D=0;D<C.length;++D)I[D]=String.fromCharCode(C[D]);return I.join("")}function ne(C,I){var D=O(C,I);switch(I&&I.type||"buffer"){case"file":return u(),l.writeFileSync(I.filename,D),D;case"binary":return typeof D=="string"?D:M(D);case"base64":return Cu(typeof D=="string"?D:M(D));case"buffer":if(Ge)return Buffer.isBuffer(D)?D:Cs(D);case"array":return typeof D=="string"?En(D):D}return D}var ce;function j(C){try{var I=C.InflateRaw,D=new I;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)ce=C;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function z(C,I){if(!ce)return xf(C,I);var D=ce.InflateRaw,R=new D,F=R._processChunk(C.slice(C.l),R._finishFlushFlag);return C.l+=R.bytesRead,F}function L(C){return ce?ce.deflateRawSync(C):Le(C)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ae(C){var I=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(I>>16|I>>8|I)&255}for(var oe=typeof Uint8Array<"u",se=oe?new Uint8Array(256):[],J=0;J<256;++J)se[J]=ae(J);function A(C,I){var D=se[C&255];return I<=8?D>>>8-I:(D=D<<8|se[C>>8&255],I<=16?D>>>16-I:(D=D<<8|se[C>>16&255],D>>>24-I))}function pe(C,I){var D=I&7,R=I>>>3;return(C[R]|(D<=6?0:C[R+1]<<8))>>>D&3}function Ne(C,I){var D=I&7,R=I>>>3;return(C[R]|(D<=5?0:C[R+1]<<8))>>>D&7}function $e(C,I){var D=I&7,R=I>>>3;return(C[R]|(D<=4?0:C[R+1]<<8))>>>D&15}function Me(C,I){var D=I&7,R=I>>>3;return(C[R]|(D<=3?0:C[R+1]<<8))>>>D&31}function xe(C,I){var D=I&7,R=I>>>3;return(C[R]|(D<=1?0:C[R+1]<<8))>>>D&127}function ht(C,I,D){var R=I&7,F=I>>>3,B=(1<<D)-1,ee=C[F]>>>R;return D<8-R||(ee|=C[F+1]<<8-R,D<16-R)||(ee|=C[F+2]<<16-R,D<24-R)||(ee|=C[F+3]<<24-R),ee&B}function nr(C,I,D){var R=I&7,F=I>>>3;return R<=5?C[F]|=(D&7)<<R:(C[F]|=D<<R&255,C[F+1]=(D&7)>>8-R),I+3}function vn(C,I,D){var R=I&7,F=I>>>3;return D=(D&1)<<R,C[F]|=D,I+1}function Wr(C,I,D){var R=I&7,F=I>>>3;return D<<=R,C[F]|=D&255,D>>>=8,C[F+1]=D,I+8}function js(C,I,D){var R=I&7,F=I>>>3;return D<<=R,C[F]|=D&255,D>>>=8,C[F+1]=D&255,C[F+2]=D>>>8,I+16}function kr(C,I){var D=C.length,R=2*D>I?2*D:I+5,F=0;if(D>=I)return C;if(Ge){var B=Dw(R);if(C.copy)C.copy(B);else for(;F<C.length;++F)B[F]=C[F];return B}else if(oe){var ee=new Uint8Array(R);if(ee.set)ee.set(C);else for(;F<D;++F)ee[F]=C[F];return ee}return C.length=R,C}function Hr(C){for(var I=new Array(C),D=0;D<C;++D)I[D]=0;return I}function na(C,I,D){var R=1,F=0,B=0,ee=0,le=0,Z=C.length,te=oe?new Uint16Array(32):Hr(32);for(B=0;B<32;++B)te[B]=0;for(B=Z;B<D;++B)C[B]=0;Z=C.length;var re=oe?new Uint16Array(Z):Hr(Z);for(B=0;B<Z;++B)te[F=C[B]]++,R<F&&(R=F),re[B]=0;for(te[0]=0,B=1;B<=R;++B)te[B+16]=le=le+te[B-1]<<1;for(B=0;B<Z;++B)le=C[B],le!=0&&(re[B]=te[le+16]++);var de=0;for(B=0;B<Z;++B)if(de=C[B],de!=0)for(le=A(re[B],R)>>R-de,ee=(1<<R+4-de)-1;ee>=0;--ee)I[le|ee<<de]=de&15|B<<4;return R}var zt=oe?new Uint16Array(512):Hr(512),Fn=oe?new Uint16Array(32):Hr(32);if(!oe){for(var gr=0;gr<512;++gr)zt[gr]=0;for(gr=0;gr<32;++gr)Fn[gr]=0}(function(){for(var C=[],I=0;I<32;I++)C.push(5);na(C,Fn,32);var D=[];for(I=0;I<=143;I++)D.push(8);for(;I<=255;I++)D.push(9);for(;I<=279;I++)D.push(7);for(;I<=287;I++)D.push(8);na(D,zt,288)})();var Ln=function(){for(var I=oe?new Uint8Array(32768):[],D=0,R=0;D<q.length-1;++D)for(;R<q[D+1];++R)I[R]=D;for(;R<32768;++R)I[R]=29;var F=oe?new Uint8Array(259):[];for(D=0,R=0;D<Q.length-1;++D)for(;R<Q[D+1];++R)F[R]=D;function B(le,Z){for(var te=0;te<le.length;){var re=Math.min(65535,le.length-te),de=te+re==le.length;for(Z.write_shift(1,+de),Z.write_shift(2,re),Z.write_shift(2,~re&65535);re-- >0;)Z[Z.l++]=le[te++]}return Z.l}function ee(le,Z){for(var te=0,re=0,de=oe?new Uint16Array(32768):[];re<le.length;){var we=Math.min(65535,le.length-re);if(we<10){for(te=nr(Z,te,+(re+we==le.length)),te&7&&(te+=8-(te&7)),Z.l=te/8|0,Z.write_shift(2,we),Z.write_shift(2,~we&65535);we-- >0;)Z[Z.l++]=le[re++];te=Z.l*8;continue}te=nr(Z,te,+(re+we==le.length)+2);for(var ke=0;we-- >0;){var me=le[re];ke=(ke<<5^me)&32767;var _e=-1,Be=0;if((_e=de[ke])&&(_e|=re&-32768,_e>re&&(_e-=32768),_e<re))for(;le[_e+Be]==le[re+Be]&&Be<250;)++Be;if(Be>2){me=F[Be],me<=22?te=Wr(Z,te,se[me+1]>>1)-1:(Wr(Z,te,3),te+=5,Wr(Z,te,se[me-23]>>5),te+=3);var jt=me<8?0:me-4>>2;jt>0&&(js(Z,te,Be-Q[me]),te+=jt),me=I[re-_e],te=Wr(Z,te,se[me]>>3),te-=3;var Dt=me<4?0:me-2>>1;Dt>0&&(js(Z,te,re-_e-q[me]),te+=Dt);for(var br=0;br<Be;++br)de[ke]=re&32767,ke=(ke<<5^le[re])&32767,++re;we-=Be-1}else me<=143?me=me+48:te=vn(Z,te,1),te=Wr(Z,te,se[me]),de[ke]=re&32767,++re}te=Wr(Z,te,0)-1}return Z.l=(te+7)/8|0,Z.l}return function(Z,te){return Z.length<8?B(Z,te):ee(Z,te)}}();function Le(C){var I=ie(50+Math.floor(C.length*1.1)),D=Ln(C,I);return I.slice(0,D)}var At=oe?new Uint16Array(32768):Hr(32768),zr=oe?new Uint16Array(32768):Hr(32768),Pt=oe?new Uint16Array(128):Hr(128),rn=1,ec=1;function Ds(C,I){var D=Me(C,I)+257;I+=5;var R=Me(C,I)+1;I+=5;var F=$e(C,I)+4;I+=4;for(var B=0,ee=oe?new Uint8Array(19):Hr(19),le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,te=oe?new Uint8Array(8):Hr(8),re=oe?new Uint8Array(8):Hr(8),de=ee.length,we=0;we<F;++we)ee[U[we]]=B=Ne(C,I),Z<B&&(Z=B),te[B]++,I+=3;var ke=0;for(te[0]=0,we=1;we<=Z;++we)re[we]=ke=ke+te[we-1]<<1;for(we=0;we<de;++we)(ke=ee[we])!=0&&(le[we]=re[ke]++);var me=0;for(we=0;we<de;++we)if(me=ee[we],me!=0){ke=se[le[we]]>>8-me;for(var _e=(1<<7-me)-1;_e>=0;--_e)Pt[ke|_e<<me]=me&7|we<<3}var Be=[];for(Z=1;Be.length<D+R;)switch(ke=Pt[xe(C,I)],I+=ke&7,ke>>>=3){case 16:for(B=3+pe(C,I),I+=2,ke=Be[Be.length-1];B-- >0;)Be.push(ke);break;case 17:for(B=3+Ne(C,I),I+=3;B-- >0;)Be.push(0);break;case 18:for(B=11+xe(C,I),I+=7;B-- >0;)Be.push(0);break;default:Be.push(ke),Z<ke&&(Z=ke);break}var jt=Be.slice(0,D),Dt=Be.slice(D);for(we=D;we<286;++we)jt[we]=0;for(we=R;we<30;++we)Dt[we]=0;return rn=na(jt,At,286),ec=na(Dt,zr,30),I}function Sm(C,I){if(C[0]==3&&!(C[1]&3))return[mi(I),2];for(var D=0,R=0,F=Dw(I||1<<18),B=0,ee=F.length>>>0,le=0,Z=0;!(R&1);){if(R=Ne(C,D),D+=3,R>>>1)R>>1==1?(le=9,Z=5):(D=Ds(C,D),le=rn,Z=ec);else{D&7&&(D+=8-(D&7));var te=C[D>>>3]|C[(D>>>3)+1]<<8;if(D+=32,te>0)for(!I&&ee<B+te&&(F=kr(F,B+te),ee=F.length);te-- >0;)F[B++]=C[D>>>3],D+=8;continue}for(;;){!I&&ee<B+32767&&(F=kr(F,B+32767),ee=F.length);var re=ht(C,D,le),de=R>>>1==1?zt[re]:At[re];if(D+=de&15,de>>>=4,!(de>>>8&255))F[B++]=de;else{if(de==256)break;de-=257;var we=de<8?0:de-4>>2;we>5&&(we=0);var ke=B+Q[de];we>0&&(ke+=ht(C,D,we),D+=we),re=ht(C,D,Z),de=R>>>1==1?Fn[re]:zr[re],D+=de&15,de>>>=4;var me=de<4?0:de-2>>1,_e=q[de];for(me>0&&(_e+=ht(C,D,me),D+=me),!I&&ee<ke&&(F=kr(F,ke+100),ee=F.length);B<ke;)F[B]=F[B-_e],++B}}}return I?[F,D+7>>>3]:[F.slice(0,B),D+7>>>3]}function xf(C,I){var D=C.slice(C.l||0),R=Sm(D,I);return C.l+=R[1],R[0]}function tc(C,I){if(C)typeof console<"u"&&console.error(I);else throw new Error(I)}function rc(C,I){var D=C;xr(D,0);var R=[],F=[],B={FileIndex:R,FullPaths:F};k(B,{root:I.root});for(var ee=D.length-4;(D[ee]!=80||D[ee+1]!=75||D[ee+2]!=5||D[ee+3]!=6)&&ee>=0;)--ee;D.l=ee+4,D.l+=4;var le=D.read_shift(2);D.l+=6;var Z=D.read_shift(4);for(D.l=Z,ee=0;ee<le;++ee){D.l+=20;var te=D.read_shift(4),re=D.read_shift(4),de=D.read_shift(2),we=D.read_shift(2),ke=D.read_shift(2);D.l+=8;var me=D.read_shift(4),_e=o(D.slice(D.l+de,D.l+de+we));D.l+=de+we+ke;var Be=D.l;D.l=me+4,km(D,te,re,B,_e),D.l=Be}return B}function km(C,I,D,R,F){C.l+=2;var B=C.read_shift(2),ee=C.read_shift(2),le=i(C);if(B&8257)throw new Error("Unsupported ZIP encryption");for(var Z=C.read_shift(4),te=C.read_shift(4),re=C.read_shift(4),de=C.read_shift(2),we=C.read_shift(2),ke="",me=0;me<de;++me)ke+=String.fromCharCode(C[C.l++]);if(we){var _e=o(C.slice(C.l,C.l+we));(_e[21589]||{}).mt&&(le=_e[21589].mt),((F||{})[21589]||{}).mt&&(le=F[21589].mt)}C.l+=we;var Be=C.slice(C.l,C.l+te);switch(ee){case 8:Be=z(C,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ee)}var jt=!1;B&8&&(Z=C.read_shift(4),Z==134695760&&(Z=C.read_shift(4),jt=!0),te=C.read_shift(4),re=C.read_shift(4)),te!=I&&tc(jt,"Bad compressed size: "+I+" != "+te),re!=D&&tc(jt,"Bad uncompressed size: "+D+" != "+re),Vr(R,ke,Be,{unsafe:!0,mt:le})}function nc(C,I){var D=I||{},R=[],F=[],B=ie(1),ee=D.compression?8:0,le=0,Z=0,te=0,re=0,de=0,we=C.FullPaths[0],ke=we,me=C.FileIndex[0],_e=[],Be=0;for(Z=1;Z<C.FullPaths.length;++Z)if(ke=C.FullPaths[Z].slice(we.length),me=C.FileIndex[Z],!(!me.size||!me.content||ke=="Sh33tJ5")){var jt=re,Dt=ie(ke.length);for(te=0;te<ke.length;++te)Dt.write_shift(1,ke.charCodeAt(te)&127);Dt=Dt.slice(0,Dt.l),_e[de]=S9.buf(me.content,0);var br=me.content;ee==8&&(br=L(br)),B=ie(30),B.write_shift(4,67324752),B.write_shift(2,20),B.write_shift(2,le),B.write_shift(2,ee),me.mt?s(B,me.mt):B.write_shift(4,0),B.write_shift(-4,_e[de]),B.write_shift(4,br.length),B.write_shift(4,me.content.length),B.write_shift(2,Dt.length),B.write_shift(2,0),re+=B.length,R.push(B),re+=Dt.length,R.push(Dt),re+=br.length,R.push(br),B=ie(46),B.write_shift(4,33639248),B.write_shift(2,0),B.write_shift(2,20),B.write_shift(2,le),B.write_shift(2,ee),B.write_shift(4,0),B.write_shift(-4,_e[de]),B.write_shift(4,br.length),B.write_shift(4,me.content.length),B.write_shift(2,Dt.length),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(4,0),B.write_shift(4,jt),Be+=B.l,F.push(B),Be+=Dt.length,F.push(Dt),++de}return B=ie(22),B.write_shift(4,101010256),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(2,de),B.write_shift(2,de),B.write_shift(4,Be),B.write_shift(4,re),B.write_shift(2,0),dr([dr(R),dr(F),B])}var yn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function bm(C,I){if(C.ctype)return C.ctype;var D=C.name||"",R=D.match(/\.([^\.]+)$/);return R&&yn[R[1]]||I&&(R=(D=I).match(/[\.\\]([^\.\\])+$/),R&&yn[R[1]])?yn[R[1]]:"application/octet-stream"}function Fe(C){for(var I=Cu(C),D=[],R=0;R<I.length;R+=76)D.push(I.slice(R,R+76));return D.join(`\r
`)+`\r
`}function st(C){var I=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(te){var re=te.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],R=I.split(`\r
`),F=0;F<R.length;++F){var B=R[F];if(B.length==0){D.push("");continue}for(var ee=0;ee<B.length;){var le=76,Z=B.slice(ee,ee+le);Z.charAt(le-1)=="="?le--:Z.charAt(le-2)=="="?le-=2:Z.charAt(le-3)=="="&&(le-=3),Z=B.slice(ee,ee+le),ee+=le,ee<B.length&&(Z+="="),D.push(Z)}}return D.join(`\r
`)}function yt(C){for(var I=[],D=0;D<C.length;++D){for(var R=C[D];D<=C.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+C[++D];I.push(R)}for(var F=0;F<I.length;++F)I[F]=I[F].replace(/[=][0-9A-Fa-f]{2}/g,function(B){return String.fromCharCode(parseInt(B.slice(1),16))});return En(I.join(`\r
`))}function xn(C,I,D){for(var R="",F="",B="",ee,le=0;le<10;++le){var Z=I[le];if(!Z||Z.match(/^\s*$/))break;var te=Z.match(/^(.*?):\s*([^\s].*)$/);if(te)switch(te[1].toLowerCase()){case"content-location":R=te[2].trim();break;case"content-type":B=te[2].trim();break;case"content-transfer-encoding":F=te[2].trim();break}}switch(++le,F.toLowerCase()){case"base64":ee=En(Rn(I.slice(le).join("")));break;case"quoted-printable":ee=yt(I.slice(le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var re=Vr(C,R.slice(D.length),ee,{unsafe:!0});B&&(re.ctype=B)}function wn(C,I){if(M(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=I&&I.root||"",R=(Ge&&Buffer.isBuffer(C)?C.toString("binary"):M(C)).split(`\r
`),F=0,B="";for(F=0;F<R.length;++F)if(B=R[F],!!/^Content-Location:/i.test(B)&&(B=B.slice(B.indexOf("file")),D||(D=B.slice(0,B.lastIndexOf("/")+1)),B.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),B.slice(0,D.length)!=D););var ee=(R[1]||"").match(/boundary="(.*?)"/);if(!ee)throw new Error("MAD cannot find boundary");var le="--"+(ee[1]||""),Z=[],te=[],re={FileIndex:Z,FullPaths:te};k(re);var de,we=0;for(F=0;F<R.length;++F){var ke=R[F];ke!==le&&ke!==le+"--"||(we++&&xn(re,R.slice(de,F),D),de=F)}return re}function Ca(C,I){var D=I||{},R=D.boundary||"SheetJS";R="------="+R;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],B=C.FullPaths[0],ee=B,le=C.FileIndex[0],Z=1;Z<C.FullPaths.length;++Z)if(ee=C.FullPaths[Z].slice(B.length),le=C.FileIndex[Z],!(!le.size||!le.content||ee=="Sh33tJ5")){ee=ee.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var te=le.content,re=Ge&&Buffer.isBuffer(te)?te.toString("binary"):M(te),de=0,we=Math.min(1024,re.length),ke=0,me=0;me<=we;++me)(ke=re.charCodeAt(me))>=32&&ke<128&&++de;var _e=de>=we*4/5;F.push(R),F.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+ee),F.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),F.push("Content-Type: "+bm(le,ee)),F.push(""),F.push(_e?st(re):Fe(re))}return F.push(R+`--\r
`),F.join(`\r
`)}function es(C){var I={};return k(I,C),I}function Vr(C,I,D,R){var F=R&&R.unsafe;F||k(C);var B=!F&&Ce.find(C,I);if(!B){var ee=C.FullPaths[0];I.slice(0,ee.length)==ee?ee=I:(ee.slice(-1)!="/"&&(ee+="/"),ee=(ee+I).replace("//","/")),B={name:a(I),type:2},C.FileIndex.push(B),C.FullPaths.push(ee),F||Ce.utils.cfb_gc(C)}return B.content=D,B.size=D?D.length:0,R&&(R.CLSID&&(B.clsid=R.CLSID),R.mt&&(B.mt=R.mt),R.ct&&(B.ct=R.ct)),B}function Aa(C,I){k(C);var D=Ce.find(C,I);if(D){for(var R=0;R<C.FileIndex.length;++R)if(C.FileIndex[R]==D)return C.FileIndex.splice(R,1),C.FullPaths.splice(R,1),!0}return!1}function l3(C,I,D){k(C);var R=Ce.find(C,I);if(R){for(var F=0;F<C.FileIndex.length;++F)if(C.FileIndex[F]==R)return C.FileIndex[F].name=a(D),C.FullPaths[F]=D,!0}return!1}function c3(C){N(C,!0)}return t.find=W,t.read=E,t.parse=f,t.write=ne,t.writeFile=H,t.utils={cfb_new:es,cfb_add:Vr,cfb_del:Aa,cfb_mov:l3,cfb_gc:c3,ReadShift:zc,CheckField:EN,prep_blob:xr,bconcat:dr,use_zlib:j,_deflateRaw:Le,_inflateRaw:xf,consts:Y},t}();function k9(e){return typeof e=="string"?dm(e):Array.isArray(e)?K7(e):e}function ff(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=dm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ha(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([k9(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ti(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function b9(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Wt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Uw(e,t){for(var r=[],n=Wt(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function mm(e){for(var t=[],r=Wt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function pm(e){for(var t=[],r=Wt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function E9(e){for(var t=[],r=Wt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var uh=new Date(1899,11,30,0,0,0);function or(e,t){var r=e.getTime(),n=uh.getTime()+(e.getTimezoneOffset()-uh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var aN=new Date,T9=uh.getTime()+(aN.getTimezoneOffset()-uh.getTimezoneOffset())*6e4,$w=aN.getTimezoneOffset();function gm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+T9),t.getTimezoneOffset()!==$w&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$w)*6e4),t}function N9(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Ww=new Date("2017-02-19T19:06:09.000Z"),sN=isNaN(Ww.getFullYear())?new Date("2/19/17"):Ww,C9=sN.getFullYear()==2017;function Tt(e,t){var r=new Date(e);if(C9)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(sN.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function fo(e,t){if(Ge&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ha(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ha(GT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ha(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ha(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Nt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Nt(e[r]));return t}function Ut(e,t){for(var r="";r.length<t;)r+=e;return r}function xa(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var A9=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&A9.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var P9=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function iN(e){return e?e.content&&e.type?fo(e.content,!0):e.data?Pc(e.data):e.asNodeBuffer&&Ge?Pc(e.asNodeBuffer().toString("binary")):e.asBinary?Pc(e.asBinary()):e._data&&e._data.getContent?Pc(fo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function oN(e){if(!e)return null;if(e.data)return Pw(e.data);if(e.asNodeBuffer&&Ge)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Pw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function j9(e){return e&&e.name.slice(-4)===".bin"?oN(e):iN(e)}function Hn(e,t){for(var r=e.FullPaths||Wt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Pv(e,t){var r=Hn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Jt(e,t,r){if(!r)return j9(Pv(e,t));if(!t)return null;try{return Jt(e,t)}catch{return null}}function Tn(e,t,r){if(!r)return iN(Pv(e,t));if(!t)return null;try{return Tn(e,t)}catch{return null}}function D9(e,t,r){return oN(Pv(e,t))}function Hw(e){for(var t=e.FullPaths||Wt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ze(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ge?n=Cs(r):n=q7(r),Ce.utils.cfb_add(e,t,n)}Ce.utils.cfb_add(e,t,r)}else e.file(t,r)}function jv(){return Ce.utils.cfb_new()}function lN(e,t){switch(t.type){case"base64":return Ce.read(e,{type:"base64"});case"binary":return Ce.read(e,{type:"binary"});case"buffer":case"array":return Ce.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Dc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Kt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R9=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,zw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,M9=/<[^>]*>/g,$r=Kt.match(zw)?zw:M9,O9=/<\w*:/,I9=/<(\/?)\w+:/;function Ie(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(R9),o=0,l="",u=0,f="",d="",m=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(m=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+m,d.length-m),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var h=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[h]&&f.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function Ja(e){return e.replace(I9,"<$1")}var cN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dv=mm(cN),et=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return cN[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Rv=/[&<>'"]/g,F9=/[\u0000-\u0008\u000b-\u001f]/g;function ct(e){var t=e+"";return t.replace(Rv,function(r){return Dv[r]}).replace(F9,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Vw(e){return ct(e).replace(/ /g,"_x0020_")}var uN=/[\u0000-\u001f]/g;function Mv(e){var t=e+"";return t.replace(Rv,function(r){return Dv[r]}).replace(/\n/g,"<br/>").replace(uN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function L9(e){var t=e+"";return t.replace(Rv,function(r){return Dv[r]}).replace(uN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Gw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function B9(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function kt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Np(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Yw(e){var t=mi(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function Xw(e){return Cs(e,"binary").toString("utf8")}var qf="foo bar bazâð£",dt=Ge&&(Xw(qf)==Np(qf)&&Xw||Yw(qf)==Np(qf)&&Yw)||Np,Ha=Ge?function(e){return Cs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Pu=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),fN=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),U9=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),$9=/<\/?(?:vt:)?variant>/g,W9=/<(?:vt:)([^>]*)>([\s\S]*)</;function Kw(e,t){var r=Ie(e),n=e.match(U9(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace($9,"").match(W9);i&&a.push({v:dt(i[2]),t:i[1]})}),a}var dN=/(^\s|\s$|\n)/;function wr(e,t){return"<"+e+(t.match(dN)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ju(e){return Wt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ve(e,t,r){return"<"+e+(r!=null?ju(r):"")+(t!=null?(t.match(dN)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function og(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function H9(e,t){switch(typeof e){case"string":var r=ve("vt:lpwstr",ct(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ve((e|0)==e?"vt:i4":"vt:r8",ct(String(e)));case"boolean":return ve("vt:bool",e?"true":"false")}if(e instanceof Date)return ve("vt:filetime",og(e));throw new Error("Unable to serialize "+e)}function Ov(e){if(Ge&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return dt(Ti(Nv(e)));throw new Error("Bad input format: expected Buffer or string")}var Du=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},bo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],kn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function z9(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function V9(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var qw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Qw=Ge?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Cs(t)})):qw(e)}:qw,Jw=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ds(e,a)));return n.join("").replace(Zr,"")},Iv=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zr,""):Jw(e,t,r)}:Jw,Zw=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},hN=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Zw(e,t,r)}:Zw,e2=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Bo(e,a)));return n.join("")},df=Ge?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):e2(t,r,n)}:e2,mN=function(e,t){var r=bn(e,t);return r>0?df(e,t+4,t+4+r-1):""},pN=mN,gN=function(e,t){var r=bn(e,t);return r>0?df(e,t+4,t+4+r-1):""},vN=gN,yN=function(e,t){var r=2*bn(e,t);return r>0?df(e,t+4,t+4+r-1):""},xN=yN,wN=function(t,r){var n=bn(t,r);return n>0?Iv(t,r+4,r+4+n):""},_N=wN,SN=function(e,t){var r=bn(e,t);return r>0?df(e,t+4,t+4+r):""},kN=SN,bN=function(e,t){return z9(e,t)},fh=bN,Fv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ge&&(pN=function(t,r){if(!Buffer.isBuffer(t))return mN(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},vN=function(t,r){if(!Buffer.isBuffer(t))return gN(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},xN=function(t,r){if(!Buffer.isBuffer(t))return yN(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},_N=function(t,r){if(!Buffer.isBuffer(t))return wN(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},kN=function(t,r){if(!Buffer.isBuffer(t))return SN(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},fh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):bN(t,r)},Fv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Bo=function(e,t){return e[t]},ds=function(e,t){return e[t+1]*256+e[t]},G9=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},bn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ri=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Y9=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function zc(e,t){var r="",n,a,s=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,Ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ds(this,u)),u+=2;e*=2;break;case"utf8":r=df(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Iv(this,this.l,this.l+e);break;case"wstr":return zc.call(this,e,"dbcs");case"lpstr-ansi":r=pN(this,this.l),e=4+bn(this,this.l);break;case"lpstr-cp":r=vN(this,this.l),e=4+bn(this,this.l);break;case"lpwstr":r=xN(this,this.l),e=4+2*bn(this,this.l);break;case"lpp4":e=4+bn(this,this.l),r=_N(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bn(this,this.l),r=kN(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Bo(this,this.l+e++))!==0;)s.push(Kf(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=ds(this,this.l+e))!==0;)s.push(Kf(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Bo(this,u),this.l=u+1,o=zc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Kf(ds(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Bo(this,u),this.l=u+1,o=zc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Kf(Bo(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Bo(this,this.l),this.l++,n;case 2:return n=(t==="i"?G9:ds)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ri:Y9)(this,this.l),this.l+=4,n):(a=bn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=fh(this,this.l):a=fh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=hN(this,this.l,e);break}}return this.l+=e,r}var X9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},K9=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},q9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Q9(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)q9(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,X9(this,t,this.l);break;case 8:if(n=8,r==="f"){V9(this,t,this.l);break}case 16:break;case-4:n=4,K9(this,t,this.l);break}return this.l+=n,this}function EN(e,t){var r=hN(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function xr(e,t){e.l=t,e.read_shift=zc,e.chk=EN,e.write_shift=Q9}function Ur(e,t){e.l+=t}function ie(e){var t=mi(e);return xr(t,0),t}function As(e,t,r){if(e){var n,a,s;xr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Lu[o]||Lu[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=u.f&&u.f(e,s,r);if(e.l=l,t(f,u,o))return}}}function dn(){var e=[],t=Ge?256:2048,r=function(u){var f=ie(u);return xr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},i=function(){return a(),dr(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function fe(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=Lu[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Fv(r)&&e.push(r)}}function Vc(e,t,r){var n=Nt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function t2(e,t,r){var n=Nt(e);return n.s=Vc(n.s,t.s,r),n.e=Vc(n.e,t.s,r),n}function Gc(e,t){if(e.cRel&&e.c<0)for(e=Nt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Nt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Re(e);return!e.cRel&&e.cRel!=null&&(r=eB(r)),!e.rRel&&e.rRel!=null&&(r=J9(r)),r}function Cp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mt(e.s.c)+":"+(e.e.cRel?"":"$")+Mt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xt(e.s.r)+":"+(e.e.rRel?"":"$")+Xt(e.e.r):Gc(e.s,t.biff)+":"+Gc(e.e,t.biff)}function Lv(e){return parseInt(Z9(e),10)-1}function Xt(e){return""+(e+1)}function J9(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z9(e){return e.replace(/\$(\d+)$/,"$1")}function Bv(e){for(var t=tB(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Mt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function eB(e){return e.replace(/^([A-Z])/,"$$$1")}function tB(e){return e.replace(/^\$([A-Z])/,"$1")}function rB(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ot(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Re(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function gn(e){var t=e.indexOf(":");return t==-1?{s:Ot(e),e:Ot(e)}:{s:Ot(e.slice(0,t)),e:Ot(e.slice(t+1))}}function We(e,t){return typeof t>"u"||typeof t=="number"?We(e.s,e.e):(typeof e!="string"&&(e=Re(e)),typeof t!="string"&&(t=Re(t)),e==t?e:e+":"+t)}function rt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function r2(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ta(e.z,r?or(t):t)}catch{}try{return e.w=ta((e.XF||{}).numFmtId||(r?14:0),r?or(t):t)}catch{return""+t}}function Es(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Ps[e.v]||e.v:t==null?r2(e,e.v):r2(e,t))}function Ni(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function TN(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Ot(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=rt(s["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var m=0;m!=t[d].length;++m)if(!(typeof t[d][m]>"u")){var h={v:t[d][m]},v=i+d,p=o+m;if(u.s.r>v&&(u.s.r=v),u.s.c>p&&(u.s.c=p),u.e.r<v&&(u.e.r=v),u.e.c<p&&(u.e.c=p),t[d][m]&&typeof t[d][m]=="object"&&!Array.isArray(t[d][m])&&!(t[d][m]instanceof Date))h=t[d][m];else if(Array.isArray(h.v)&&(h.f=t[d][m][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||De[14],n.cellDates?(h.t="d",h.w=ta(h.z,or(h.v))):(h.t="n",h.v=or(h.v),h.w=ta(h.z,h.v))):h.t="s";if(a)s[v]||(s[v]=[]),s[v][p]&&s[v][p].z&&(h.z=s[v][p].z),s[v][p]=h;else{var g=Re({c:p,r:v});s[g]&&s[g].z&&(h.z=s[g].z),s[g]=h}}}return u.s.c<1e7&&(s["!ref"]=We(u)),s}function Jl(e,t){return TN(null,e,t)}function nB(e){return e.read_shift(4,"i")}function wa(e,t){return t||(t=ie(4)),t.write_shift(4,e),t}function Lr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function hr(e,t){var r=!1;return t==null&&(r=!0,t=ie(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function aB(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function sB(e,t){return t||(t=ie(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Uv(e,t){var r=e.l,n=e.read_shift(1),a=Lr(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(aB(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function iB(e,t){var r=!1;return t==null&&(r=!0,t=ie(15+4*e.t.length)),t.write_shift(1,0),hr(e.t,t),r?t.slice(0,t.l):t}var oB=Uv;function lB(e,t){var r=!1;return t==null&&(r=!0,t=ie(23+4*e.t.length)),t.write_shift(1,1),hr(e.t,t),t.write_shift(4,1),sB({},t),r?t.slice(0,t.l):t}function ra(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Eo(e,t){return t==null&&(t=ie(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function To(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function No(e,t){return t==null&&(t=ie(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var cB=Lr,NN=hr;function $v(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function dh(e,t){var r=!1;return t==null&&(r=!0,t=ie(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var uB=Lr,lg=$v,Wv=dh;function Hv(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?fh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ri(t,0)>>2;return r?a/100:a}function CN(e,t){t==null&&(t=ie(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function AN(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function fB(e,t){return t||(t=ie(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Co=AN,Zl=fB;function Or(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ho(e,t){return(t||ie(8)).write_shift(8,e,"f")}function dB(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Xi[a];u&&(t.rgb=Mu(u));break;case 2:t.rgb=Mu([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function hh(e,t){if(t||(t=ie(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function hB(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function mB(e,t){t||(t=ie(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function PN(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function pB(e){return PN(e,1)}function gB(e){return PN(e,2)}var zv=2,an=3,Qf=11,n2=12,mh=19,Jf=64,vB=65,yB=71,xB=4108,wB=4126,ur=80,jN=81,_B=[ur,jN],cg={1:{n:"CodePage",t:zv},2:{n:"Category",t:ur},3:{n:"PresentationFormat",t:ur},4:{n:"ByteCount",t:an},5:{n:"LineCount",t:an},6:{n:"ParagraphCount",t:an},7:{n:"SlideCount",t:an},8:{n:"NoteCount",t:an},9:{n:"HiddenCount",t:an},10:{n:"MultimediaClipCount",t:an},11:{n:"ScaleCrop",t:Qf},12:{n:"HeadingPairs",t:xB},13:{n:"TitlesOfParts",t:wB},14:{n:"Manager",t:ur},15:{n:"Company",t:ur},16:{n:"LinksUpToDate",t:Qf},17:{n:"CharacterCount",t:an},19:{n:"SharedDoc",t:Qf},22:{n:"HyperlinksChanged",t:Qf},23:{n:"AppVersion",t:an,p:"version"},24:{n:"DigSig",t:vB},26:{n:"ContentType",t:ur},27:{n:"ContentStatus",t:ur},28:{n:"Language",t:ur},29:{n:"Version",t:ur},255:{},2147483648:{n:"Locale",t:mh},2147483651:{n:"Behavior",t:mh},1919054434:{}},ug={1:{n:"CodePage",t:zv},2:{n:"Title",t:ur},3:{n:"Subject",t:ur},4:{n:"Author",t:ur},5:{n:"Keywords",t:ur},6:{n:"Comments",t:ur},7:{n:"Template",t:ur},8:{n:"LastAuthor",t:ur},9:{n:"RevNumber",t:ur},10:{n:"EditTime",t:Jf},11:{n:"LastPrinted",t:Jf},12:{n:"CreatedDate",t:Jf},13:{n:"ModifiedDate",t:Jf},14:{n:"PageCount",t:an},15:{n:"WordCount",t:an},16:{n:"CharCount",t:an},17:{n:"Thumbnail",t:yB},18:{n:"Application",t:ur},19:{n:"DocSecurity",t:an},255:{},2147483648:{n:"Locale",t:mh},2147483651:{n:"Behavior",t:mh},1919054434:{}},a2={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},SB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function kB(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var bB=kB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xi=Nt(bB),Ps={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},DN={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},fg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Vv(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function EB(e){var t=Vv();if(!e||!e.match)return t;var r={};if((e.match($r)||[]).forEach(function(n){var a=Ie(n);switch(a[0].replace(O9,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[fg[a.ContentType]]!==void 0&&t[fg[a.ContentType]].push(a.PartName);break}}),t.xmlns!==sr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function RN(e,t){var r=E9(fg),n=[],a;n[n.length]=Kt,n[n.length]=ve("Types",null,{xmlns:sr.CT,"xmlns:xsd":sr.xsd,"xmlns:xsi":sr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ve("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=ve("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Zf[l][t.bookType]||Zf[l].xlsx}))},i=function(l){(e[l]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Zf[l][t.bookType]||Zf[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ye={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ru(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Yc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match($r)||[]).forEach(function(a){var s=Ie(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Dc(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function ul(e){var t=[Kt,ve("Relationships",null,{xmlns:sr.RELS})];return Wt(e["!id"]).forEach(function(r){t[t.length]=ve("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function lt(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Ye.HLINK,Ye.XPATH,Ye.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var TB="application/vnd.oasis.opendocument.spreadsheet";function NB(e,t){for(var r=Ov(e),n,a;n=Du.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ie(n[0],!1),a.path=="/"&&a.type!==TB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function CB(e){var t=[Kt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function s2(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function AB(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function PB(e){var t=[Kt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(s2(e[r][0],e[r][1])),t.push(AB("",e[r][0]));return t.push(s2("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function MN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ih.version+"</meta:generator></office:meta></office:document-meta>"}var Qn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],jB=function(){for(var e=new Array(Qn.length),t=0;t<Qn.length;++t){var r=Qn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function ON(e){var t={};e=dt(e);for(var r=0;r<Qn.length;++r){var n=Qn[r],a=e.match(jB[r]);a!=null&&a.length>0&&(t[n[1]]=et(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Tt(t[n[1]]))}return t}function Ap(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=ct(t),n[n.length]=r?ve(e,t,r):wr(e,t))}function IN(e,t){var r=t||{},n=[Kt,ve("cp:coreProperties",null,{"xmlns:cp":sr.CORE_PROPS,"xmlns:dc":sr.dc,"xmlns:dcterms":sr.dcterms,"xmlns:dcmitype":sr.dcmitype,"xmlns:xsi":sr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Ap("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:og(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Ap("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:og(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Qn.length;++s){var i=Qn[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Ap(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ki=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],FN=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function LN(e,t,r,n){var a=[];if(typeof e=="string")a=Kw(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Kw(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==a.length;u+=2){switch(l=+a[u+1].v,a[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function DB(e,t,r){var n={};return t||(t={}),e=dt(e),Ki.forEach(function(a){var s=(e.match(Pu(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=et(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&LN(n.HeadingPairs,n.TitlesOfParts,t,r),t}function BN(e){var t=[],r=ve;return e||(e={}),e.Application="SheetJS",t[t.length]=Kt,t[t.length]=ve("Properties",null,{xmlns:sr.EXT_PROPS,"xmlns:vt":sr.vt}),Ki.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=ct(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ct(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var RB=/<[^>]+>[^<]*/g;function MB(e,t){var r={},n="",a=e.match(RB);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Ie(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=et(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=et(f);break;case"bool":r[n]=kt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Tt(f);break;case"cy":case"error":r[n]=et(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function UN(e){var t=[Kt,ve("Properties",null,{xmlns:sr.CUST_PROPS,"xmlns:vt":sr.vt})];if(!e)return t.join("");var r=1;return Wt(e).forEach(function(a){++r,t[t.length]=ve("property",H9(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ct(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Pp;function OB(e,t,r){Pp||(Pp=mm(dg)),t=Pp[t]||t,e[t]=r}function IB(e,t){var r=[];return Wt(dg).map(function(n){for(var a=0;a<Qn.length;++a)if(Qn[a][1]==n)return Qn[a];for(a=0;a<Ki.length;++a)if(Ki[a][1]==n)return Ki[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(wr(dg[n[1]]||n[1],a))}}),ve("DocumentProperties",r.join(""),{xmlns:kn.o})}function FB(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Wt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<Qn.length;++i)if(s==Qn[i][1])return;for(i=0;i<Ki.length;++i)if(s==Ki[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(ve(Vw(s),o,{"dt:dt":l}))}}),t&&Wt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(ve(Vw(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+kn.o+'">'+a.join("")+"</"+n+">"}function Gv(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function LB(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=ie(8);return i.write_shift(4,n),i.write_shift(4,a),i}function $N(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function WN(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function HN(e,t,r){return t===31?WN(e):$N(e,t,r)}function hg(e,t,r){return HN(e,t,r===!1?0:4)}function BB(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return HN(e,t,0)}function UB(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Zr,""),e.l-a&2&&(e.l+=2)}return r}function $B(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Zr,"");return r}function WB(e){var t=e.l,r=ph(e,jN);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ph(e,an);return[r,n]}function HB(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(WB(e));return r}function i2(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Zr,"").replace(jc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function zN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function zB(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ph(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==n2&&n!==t&&_B.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===n2?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return $N(e,n,4).replace(Zr,"");case 31:return WN(e);case 64:return Gv(e);case 65:return zN(e);case 71:return zB(e);case 80:return hg(e,n,!s.raw).replace(Zr,"");case 81:return BB(e,n).replace(Zr,"");case 4108:return HB(e);case 4126:case 4127:return n==4127?UB(e):$B(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function o2(e,t){var r=ie(4),n=ie(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ie(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=LB(t);break;case 31:case 80:for(n=ie(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return dr([r,n])}function l2(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,u={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(w,x){return w[1]-x[1]});var m={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var h=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],h=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(h=!1,e.l=s[i][1]),h)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[s[i][0]];if(m[v.n]=ph(e,v.t,{raw:!0}),v.p==="version"&&(m[v.n]=String(m[v.n]>>16)+"."+("0000"+String(m[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(m[v.n]){case 0:m[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:pa(o=m[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+m[v.n])}}else if(s[i][0]===1){if(o=m.CodePage=ph(e,zv),pa(o),l!==-1){var p=e.l;e.l=s[l][1],u=i2(e,o),e.l=p}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}u=i2(e,o)}else{var g=u[s[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=zN(e);break;case 30:e.l+=4,y=hg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=hg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Vt(e,4);break;case 64:e.l+=4,y=Tt(Gv(e));break;default:throw new Error("unparsed value: "+e[e.l])}m[g]=y}}return e.l=r+n,m}var VN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function VB(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function c2(e,t,r){var n=ie(8),a=[],s=[],i=8,o=0,l=ie(8),u=ie(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),a.push(u),i+=8+l.length,!t){u=ie(8),u.write_shift(4,0),a.unshift(u);var f=[ie(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=ie(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=dr(f),s.unshift(l),i+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(VN.indexOf(e[o][0])>-1||FN.indexOf(e[o][0])>-1)&&e[o][1]!=null){var m=e[o][1],h=0;if(t){h=+t[e[o][0]];var v=r[h];if(v.p=="version"&&typeof m=="string"){var p=m.split(".");m=(+p[0]<<16)+(+p[1]||0)}l=o2(v.t,m)}else{var g=VB(m);g==-1&&(g=31,m=String(m)),l=o2(g,m)}s.push(l),u=ie(8),u.write_shift(4,t?h:2+o),a.push(u),i+=8+l.length}var y=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,y),y+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),dr([n].concat(a).concat(s))}function u2(e,t,r){var n=e.content;if(!n)return{};xr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Ce.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=l2(n,t),m={SystemIdentifier:u};for(var h in d)m[h]=d[h];if(m.FMTID=s,a===1)return m;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=l2(n,null)}catch{}for(h in v)m[h]=v[h];return m.FMTID=[s,i],m}function f2(e,t,r,n,a,s){var i=ie(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ce.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var l=c2(e,r,n);if(o.push(l),a){var u=c2(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+l.length),o.push(u)}return dr(o)}function Ls(e,t){return e.read_shift(t),null}function GB(e,t){t||(t=ie(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function YB(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Vt(e,t){return e.read_shift(t)===1}function Kr(e,t){return t||(t=ie(2)),t.write_shift(2,+!!e),t}function Zt(e){return e.read_shift(2,"u")}function Vn(e,t){return t||(t=ie(2)),t.write_shift(2,e),t}function GN(e,t){return YB(e,t,Zt)}function XB(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function YN(e,t,r){return r||(r=ie(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function hf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function KB(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function qB(e){var t=e.t||"",r=ie(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ie(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return dr(a)}function mo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function mf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):mo(e,n,r)}function Ao(e,t,r){if(r.biff>5)return mf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function XN(e,t,r){return r||(r=ie(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function QB(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function JB(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Zr,"");return n&&(e.l+=24),a}function ZB(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Zr,"");return r+i}function eU(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return JB(e);case"0303000000000000c000000000000046":return ZB(e);default:throw new Error("Unsupported Moniker "+r)}}function ed(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zr,""):"";return r}function d2(e,t){t||(t=ie(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function tU(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,u="",f,d;a&16&&(s=ed(e,r-e.l)),a&128&&(i=ed(e,r-e.l)),(a&257)===257&&(o=ed(e,r-e.l)),(a&257)===1&&(l=eU(e,r-e.l)),a&8&&(u=ed(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=Gv(e)),e.l=r;var m=i||o||l||"";m&&u&&(m+="#"+u),m||(m="#"+u),a&2&&m.charAt(0)=="/"&&m.charAt(1)!="/"&&(m="file://"+m);var h={Target:m};return f&&(h.guid=f),d&&(h.time=d),s&&(h.Tooltip=s),h}function rU(e){var t=ie(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),d2(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&d2(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function KN(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function qN(e,t){var r=KN(e);return r[3]=0,r}function Za(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function po(e,t,r,n){return n||(n=ie(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function nU(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function aU(e,t,r){return t===0?"":Ao(e,t,r)}function sU(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function QN(e){var t=e.read_shift(2),r=Hv(e);return[t,r]}function iU(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=hf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function vm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function JN(e,t){return t||(t=ie(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ZN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var oU=ZN;function eC(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function lU(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function cU(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Cr(e){e.l+=2,e.l+=e.read_shift(2)}var uU={0:Cr,4:Cr,5:Cr,6:Cr,7:cU,8:Cr,9:Cr,10:Cr,11:Cr,12:Cr,13:lU,14:Cr,15:Cr,16:Cr,17:Cr,18:Cr,19:Cr,20:Cr,21:eC};function fU(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(uU[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function td(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Yv(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ie(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function dU(e,t){return t===0||e.read_shift(2),1200}function hU(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ao(e,0,r);return e.read_shift(t+n-e.l),a}function mU(e,t){var r=!t||t.biff==8,n=ie(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function pU(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gU(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=hf(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function vU(e,t){var r=!t||t.biff>=8?2:1,n=ie(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function yU(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(KB(e));return s.Count=n,s.Unique=a,s}function xU(e,t){var r=ie(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=qB(e[a]);var s=dr([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function wU(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function _U(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function SU(e){var t=nU(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function kU(e){return e.read_shift(2),e.read_shift(4)}function h2(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function bU(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function EU(){var e=ie(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function TU(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function NU(e){var t=ie(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function CU(){}function AU(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=hf(e,0,r),n}function PU(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=ie(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function jU(e){var t=Za(e);return t.isst=e.read_shift(4),t}function DU(e,t,r,n){var a=ie(10);return po(e,t,n,a),a.write_shift(4,r),a}function RU(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Za(e);r.biff==2&&e.l++;var s=mf(e,n-e.l,r);return a.val=s,a}function MU(e,t,r,n,a){var s=!a||a.biff==8,i=ie(8+ +s+(1+s)*r.length);return po(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function OU(e,t,r){var n=e.read_shift(2),a=Ao(e,0,r);return[n,a]}function IU(e,t,r,n){var a=r&&r.biff==5;n||(n=ie(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var FU=Ao;function m2(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function LU(e,t){var r=t.biff==8||!t.biff?4:2,n=ie(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function BU(e){var t=e.read_shift(2),r=e.read_shift(2),n=QN(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function UU(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(QN(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function $U(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function WU(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=SB[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function HU(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=WU(e,t,n.fStyle,r),n}function p2(e,t,r,n){var a=r&&r.biff==5;n||(n=ie(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function zU(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function VU(e){var t=ie(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function g2(e,t,r){var n=Za(e);(r.biff==2||t==9)&&++e.l;var a=XB(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function GU(e,t,r,n,a,s){var i=ie(8);return po(e,t,n,i),YN(r,s,i),i}function YU(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Za(e),a=Or(e);return n.val=a,n}function XU(e,t,r,n){var a=ie(14);return po(e,t,n,a),ho(r,a),a}var v2=aU;function KU(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=mo(e,s),o=[];n>e.l;)o.push(mf(e));return[s,a,i,o]}function y2(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=iU(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var qU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function x2(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=mo(e,i,r);a&32&&(u=qU[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:fV(e,f,r,o);return{chKey:s,Name:u,itab:l,rgce:d}}function tC(e,t,r){if(r.biff<8)return QU(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(sU(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function QU(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=hf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function JU(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=mo(e,n,r),i=mo(e,a,r);return[s,i]}function ZU(e,t,r){var n=ZN(e);e.l++;var a=e.read_shift(1);return t-=8,[dV(e,t,r),a,n]}function w2(e,t,r){var n=oU(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,cV(e,t,r)]}function e$(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function t$(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Ao(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function r$(e,t,r){return t$(e,t,r)}function n$(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(vm(e));return r}function a$(e){var t=ie(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)JN(e[r],t);return t}function s$(e,t,r){if(r&&r.biff<8)return o$(e,t,r);var n=eC(e),a=fU(e,t-22,n[1]);return{cmo:n,ft:a}}var i$={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function o$(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((i$[n]||Ur)(e,t,r)),{cmo:[a,n,s],ft:i}}function l$(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=QB(e,6,r);var o=e.read_shift(2);e.read_shift(2),Zt(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=mo(e,e.lens[u+1]-e.lens[u]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function c$(e,t){var r=vm(e);e.l+=16;var n=tU(e,t-24);return[r,n]}function u$(e){var t=ie(24),r=Ot(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return dr([t,rU(e[1])])}function f$(e,t){e.read_shift(2);var r=vm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Zr,""),[r,n]}function d$(e){var t=e[1].Tooltip,r=ie(10+2*(t.length+1));r.write_shift(2,2048);var n=Ot(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function h$(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=a2[r]||r,r=e.read_shift(2),t[1]=a2[r]||r,t}function m$(e){return e||(e=ie(4)),e.write_shift(2,1),e.write_shift(2,1),e}function p$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qN(e));return r}function g$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qN(e));return r}function v$(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rC(e,t,r){if(!r.cellStyles)return Ur(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function y$(e,t){var r=ie(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function x$(e,t){var r={};return t<32||(e.l+=16,r.header=Or(e),r.footer=Or(e),e.l+=2),r}function w$(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function _$(e){for(var t=ie(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var S$=Za,k$=GN,b$=mf;function E$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function T$(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Za(e);++e.l;var a=Ao(e,t-7,r);return n.t="str",n.val=a,n}function N$(e){var t=Za(e);++e.l;var r=Or(e);return t.t="n",t.val=r,t}function C$(e,t,r){var n=ie(15);return yf(n,e,t),n.write_shift(8,r,"f"),n}function A$(e){var t=Za(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function P$(e,t,r){var n=ie(9);return yf(n,e,t),n.write_shift(2,r),n}function j$(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function D$(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function R$(e,t,r){var n=e.l+t,a=Za(e),s=e.read_shift(2),i=mo(e,s,r);return e.l=n,a.t="str",a.val=i,a}var M$=[2,3,48,49,131,139,140,245],mg=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=mm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=mi(1);switch(l.type){case"base64":f=En(Rn(o));break;case"binary":f=En(o);break;case"buffer":case"array":f=o;break}xr(f,0);var d=f.read_shift(1),m=!!(d&136),h=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,m=!0;break;case 49:h=!0,m=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var p=0,g=521;d==2&&(p=f.read_shift(2)),f.l+=3,d!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),d!=2&&(g=f.read_shift(2));var y=f.read_shift(2),w=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var x=[],S={},b=Math.min(f.length,d==2?521:g-10-(h?264:0)),E=v?32:11;f.l<b&&f[f.l]!=13;)switch(S={},S.name=Nu.utils.decode(w,f.slice(f.l,f.l+E)).replace(/[\u0000\r\n].*$/g,""),f.l+=E,S.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),d==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&x.push(S),d!=2&&(f.l+=v?13:14),S.type){case"B":(!h||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var k=0,T=0;for(u[0]=[],T=0;T!=x.length;++T)u[0][T]=x[T].name;for(;p-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++k]=[],T=0,T=0;T!=x.length;++T){var N=f.slice(f.l,f.l+x[T].len);f.l+=x[T].len,xr(N,0);var O=Nu.utils.decode(w,N);switch(x[T].type){case"C":O.trim().length&&(u[k][T]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[k][T]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[k][T]=O;break;case"F":u[k][T]=parseFloat(O.trim());break;case"+":case"I":u[k][T]=v?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[k][T]=!0;break;case"N":case"F":u[k][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!m)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[k][T]="##MEMO##"+(v?parseInt(O.trim(),10):N.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[k][T]=+O||0);break;case"@":u[k][T]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":u[k][T]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":u[k][T]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][T]=-N.read_shift(-8,"f");break;case"B":if(h&&x[T].len==8){u[k][T]=N.read_shift(8,"f");break}case"G":case"P":N.l+=x[T].len;break;case"0":if(x[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[T].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=x,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Jl(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,l){try{return Ni(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&pa(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=dn(),d=yh(o,{header:1,raw:!0,cellDates:!0}),m=d[0],h=d.slice(1),v=o["!cols"]||[],p=0,g=0,y=0,w=1;for(p=0;p<m.length;++p){if(((v[p]||{}).DBF||{}).name){m[p]=v[p].DBF.name,++y;continue}if(m[p]!=null){if(++y,typeof m[p]=="number"&&(m[p]=m[p].toString(10)),typeof m[p]!="string")throw new Error("DBF Invalid column name "+m[p]+" |"+typeof m[p]+"|");if(m.indexOf(m[p])!==p){for(g=0;g<1024;++g)if(m.indexOf(m[p]+"_"+g)==-1){m[p]+="_"+g;break}}}}var x=rt(o["!ref"]),S=[],b=[],E=[];for(p=0;p<=x.e.c-x.s.c;++p){var k="",T="",N=0,O=[];for(g=0;g<h.length;++g)h[g][p]!=null&&O.push(h[g][p]);if(O.length==0||m[p]==null){S[p]="?";continue}for(g=0;g<O.length;++g){switch(typeof O[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=O[g]instanceof Date?"D":"C";break;default:T="C"}N=Math.max(N,String(O[g]).length),k=k&&k!=T?"C":T}N>250&&(N=250),T=((v[p]||{}).DBF||{}).type,T=="C"&&v[p].DBF.len>N&&(N=v[p].DBF.len),k=="B"&&T=="N"&&(k="N",E[p]=v[p].DBF.dec,N=v[p].DBF.len),b[p]=k=="C"||T=="N"?N:s[k]||0,w+=b[p],S[p]=k}var W=f.next(32);for(W.write_shift(4,318902576),W.write_shift(4,h.length),W.write_shift(2,296+32*y),W.write_shift(2,w),p=0;p<4;++p)W.write_shift(4,0);for(W.write_shift(4,0|(+t[VT]||3)<<8),p=0,g=0;p<m.length;++p)if(m[p]!=null){var P=f.next(32),G=(m[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,G,"sbcs"),P.write_shift(1,S[p]=="?"?"C":S[p],"sbcs"),P.write_shift(4,g),P.write_shift(1,b[p]||s[S[p]]||0),P.write_shift(1,E[p]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),g+=b[p]||s[S[p]]||0}var X=f.next(264);for(X.write_shift(4,13),p=0;p<65;++p)X.write_shift(4,0);for(p=0;p<h.length;++p){var V=f.next(w);for(V.write_shift(1,0),g=0;g<m.length;++g)if(m[g]!=null)switch(S[g]){case"L":V.write_shift(1,h[p][g]==null?63:h[p][g]?84:70);break;case"B":V.write_shift(8,h[p][g]||0,"f");break;case"N":var K="0";for(typeof h[p][g]=="number"&&(K=h[p][g].toFixed(E[g]||0)),y=0;y<b[g]-K.length;++y)V.write_shift(1,32);V.write_shift(1,K,"sbcs");break;case"D":h[p][g]?(V.write_shift(4,("0000"+h[p][g].getFullYear()).slice(-4),"sbcs"),V.write_shift(2,("00"+(h[p][g].getMonth()+1)).slice(-2),"sbcs"),V.write_shift(2,("00"+h[p][g].getDate()).slice(-2),"sbcs")):V.write_shift(8,"00000000","sbcs");break;case"C":var Y=String(h[p][g]!=null?h[p][g]:"").slice(0,b[g]);for(V.write_shift(1,Y,"sbcs"),y=0;y<b[g]-Y.length;++y)V.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),nC=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Wt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(m,h){var v=e[h];return typeof v=="number"?jw(v):v},n=function(m,h,v){var p=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?m:jw(p)};e["|"]=254;function a(m,h){switch(h.type){case"base64":return s(Rn(m),h);case"binary":return s(m,h);case"buffer":return s(Ge&&Buffer.isBuffer(m)?m.toString("binary"):Ti(m),h);case"array":return s(fo(m),h)}throw new Error("Unrecognized type "+h.type)}function s(m,h){var v=m.split(/[\n\r]+/),p=-1,g=-1,y=0,w=0,x=[],S=[],b=null,E={},k=[],T=[],N=[],O=0,W;for(+h.codepage>=0&&pa(+h.codepage);y!==v.length;++y){O=0;var P=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=P.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),X=G[0],V;if(P.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&S.push(P.slice(3).replace(/;;/g,";"));break;case"C":var K=!1,Y=!1,H=!1,M=!1,ne=-1,ce=-1;for(w=1;w<G.length;++w)switch(G[w].charAt(0)){case"A":break;case"X":g=parseInt(G[w].slice(1))-1,Y=!0;break;case"Y":for(p=parseInt(G[w].slice(1))-1,Y||(g=0),W=x.length;W<=p;++W)x[W]=[];break;case"K":V=G[w].slice(1),V.charAt(0)==='"'?V=V.slice(1,V.length-1):V==="TRUE"?V=!0:V==="FALSE"?V=!1:isNaN(xa(V))?isNaN(Rl(V).getDate())||(V=Tt(V)):(V=xa(V),b!==null&&ql(b)&&(V=gm(V))),K=!0;break;case"E":M=!0;var j=fl(G[w].slice(1),{r:p,c:g});x[p][g]=[x[p][g],j];break;case"S":H=!0,x[p][g]=[x[p][g],"S5S"];break;case"G":break;case"R":ne=parseInt(G[w].slice(1))-1;break;case"C":ce=parseInt(G[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(K&&(x[p][g]&&x[p][g].length==2?x[p][g][0]=V:x[p][g]=V,b=null),H){if(M)throw new Error("SYLK shared formula cannot have own formula");var z=ne>-1&&x[ne][ce];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");x[p][g][1]=_C(z[1],{r:p-ne,c:g-ce})}break;case"F":var L=0;for(w=1;w<G.length;++w)switch(G[w].charAt(0)){case"X":g=parseInt(G[w].slice(1))-1,++L;break;case"Y":for(p=parseInt(G[w].slice(1))-1,W=x.length;W<=p;++W)x[W]=[];break;case"M":O=parseInt(G[w].slice(1))/20;break;case"F":break;case"G":break;case"P":b=S[parseInt(G[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=G[w].slice(1).split(" "),W=parseInt(N[0],10);W<=parseInt(N[1],10);++W)O=parseInt(N[2],10),T[W-1]=O===0?{hidden:!0}:{wch:O},pi(T[W-1]);break;case"C":g=parseInt(G[w].slice(1))-1,T[g]||(T[g]={});break;case"R":p=parseInt(G[w].slice(1))-1,k[p]||(k[p]={}),O>0?(k[p].hpt=O,k[p].hpx=Ol(O)):O===0&&(k[p].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}L<1&&(b=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return k.length>0&&(E["!rows"]=k),T.length>0&&(E["!cols"]=T),h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),[x,E]}function i(m,h){var v=a(m,h),p=v[0],g=v[1],y=Jl(p,h);return Wt(g).forEach(function(w){y[w]=g[w]}),y}function o(m,h){return Ni(i(m,h),h)}function l(m,h,v,p){var g="C;Y"+(v+1)+";X"+(p+1)+";K";switch(m.t){case"n":g+=m.v||0,m.f&&!m.F&&(g+=";E"+Zv(m.f,{r:v,c:p}));break;case"b":g+=m.v?"TRUE":"FALSE";break;case"e":g+=m.w||m.v;break;case"d":g+='"'+(m.w||m.v)+'"';break;case"s":g+='"'+m.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(m,h){h.forEach(function(v,p){var g="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?g+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ou(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Iu(v.wpx)),typeof v.wch=="number"&&(g+=Math.round(v.wch))),g.charAt(g.length-1)!=" "&&m.push(g)})}function f(m,h){h.forEach(function(v,p){var g="F;";v.hidden?g+="M0;":v.hpt?g+="M"+20*v.hpt+";":v.hpx&&(g+="M"+20*Fu(v.hpx)+";"),g.length>2&&m.push(g+"R"+(p+1))})}function d(m,h){var v=["ID;PWXL;N;E"],p=[],g=rt(m["!ref"]),y,w=Array.isArray(m),x=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),m["!cols"]&&u(v,m["!cols"]),m["!rows"]&&f(v,m["!rows"]),v.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var S=g.s.r;S<=g.e.r;++S)for(var b=g.s.c;b<=g.e.c;++b){var E=Re({r:S,c:b});y=w?(m[S]||[])[b]:m[E],!(!y||y.v==null&&(!y.f||y.F))&&p.push(l(y,m,S,b))}return v.join(x)+x+p.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),aC=function(){function e(s,i){switch(i.type){case"base64":return t(Rn(s),i);case"binary":return t(s,i);case"buffer":return t(Ge&&Buffer.isBuffer(s)?s.toString("binary"):Ti(s),i);case"array":return t(fo(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var m=o[f].trim().split(","),h=m[0],v=m[1];++f;for(var p=o[f]||"";(p.match(/["]/g)||[]).length&1&&f<o.length-1;)p+=`
`+o[++f];switch(p=p.trim(),+h){case-1:if(p==="BOT"){d[++l]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?d[l][u]=!0:p==="FALSE"?d[l][u]=!1:isNaN(xa(v))?isNaN(Rl(v).getDate())?d[l][u]=v:d[l][u]=Tt(v):d[l][u]=xa(v),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),d[l][u++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return Jl(e(s,i),i)}function n(s,i){return Ni(r(s,i),i)}var a=function(){var s=function(l,u,f,d,m){l.push(u),l.push(f+","+d),l.push('"'+m.replace(/"/g,'""')+'"')},i=function(l,u,f,d){l.push(u+","+f),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],f=rt(l["!ref"]),d,m=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,f.e.r-f.s.r+1,""),s(u,"TUPLES",0,f.e.c-f.s.c+1,""),s(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){i(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var p=Re({r:h,c:v});if(d=m?(l[h]||[])[v]:l[p],!d){i(u,1,0,"");continue}switch(d.t){case"n":var g=d.w;!g&&d.v!=null&&(g=d.v),g==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=ta(d.z||De[14],or(Tt(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),sC=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,m){for(var h=d.split(`
`),v=-1,p=-1,g=0,y=[];g!==h.length;++g){var w=h[g].trim().split(":");if(w[0]==="cell"){var x=Ot(w[1]);if(y.length<=x.r)for(v=y.length;v<=x.r;++v)y[v]||(y[v]=[]);switch(v=x.r,p=x.c,w[2]){case"t":y[v][p]=e(w[3]);break;case"v":y[v][p]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[v][p]=!!+w[4];break;default:y[v][p]=+w[4];break}w[2]=="vtf"&&(y[v][p]=[y[v][p],S])}}}return m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),y}function n(d,m){return Jl(r(d,m),m)}function a(d,m){return Ni(n(d,m),m)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var m=[],h=[],v,p="",g=gn(d["!ref"]),y=Array.isArray(d),w=g.s.r;w<=g.e.r;++w)for(var x=g.s.c;x<=g.e.c;++x)if(p=Re({r:w,c:x}),v=y?(d[w]||[])[x]:d[p],!(!v||v.v==null||v.t==="z")){switch(h=["cell",p,"t"],v.t){case"s":case"str":h.push(t(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=t(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var S=or(Tt(v.v));h[2]="vtc",h[3]="nd",h[4]=""+S,h[5]=v.w||ta(v.z||De[14],S);break;case"e":continue}m.push(h.join(":"))}return m.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),m.push("valueformat:1:text-wiki"),m.join(`
`)}function f(d){return[s,i,o,i,u(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Ml=function(){function e(f,d,m,h,v){v.raw?d[m][h]=f:f===""||(f==="TRUE"?d[m][h]=!0:f==="FALSE"?d[m][h]=!1:isNaN(xa(f))?isNaN(Rl(f).getDate())?d[m][h]=f:d[m][h]=Tt(f):d[m][h]=xa(f))}function t(f,d){var m=d||{},h=[];if(!f||f.length===0)return h;for(var v=f.split(/[\r\n]/),p=v.length-1;p>=0&&v[p].length===0;)--p;for(var g=10,y=0,w=0;w<=p;++w)y=v[w].indexOf(" "),y==-1?y=v[w].length:y++,g=Math.max(g,y);for(w=0;w<=p;++w){h[w]=[];var x=0;for(e(v[w].slice(0,g).trim(),h,w,x,m),x=1;x<=(v[w].length-g)/10+1;++x)e(v[w].slice(g+(x-1)*10,g+x*10).trim(),h,w,x,m)}return m.sheetRows&&(h=h.slice(0,m.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},m=!1,h=0,v=0;h<f.length;++h)(v=f.charCodeAt(h))==34?m=!m:!m&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&v.push([d[h],h]);if(!v.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&v.push([d[h],h])}return v.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[v.pop()[1]]||44}function s(f,d){var m=d||{},h="",v=m.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=a(f.slice(0,1024)):m&&m.FS?h=m.FS:h=a(f.slice(0,1024));var g=0,y=0,w=0,x=0,S=0,b=h.charCodeAt(0),E=!1,k=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var N=m.dateNF!=null?w9(m.dateNF):null;function O(){var W=f.slice(x,S),P={};if(W.charAt(0)=='"'&&W.charAt(W.length-1)=='"'&&(W=W.slice(1,-1).replace(/""/g,'"')),W.length===0)P.t="z";else if(m.raw)P.t="s",P.v=W;else if(W.trim().length===0)P.t="s",P.v=W;else if(W.charCodeAt(0)==61)W.charCodeAt(1)==34&&W.charCodeAt(W.length-1)==34?(P.t="s",P.v=W.slice(2,-1).replace(/""/g,'"')):KH(W)?(P.t="n",P.f=W.slice(1)):(P.t="s",P.v=W);else if(W=="TRUE")P.t="b",P.v=!0;else if(W=="FALSE")P.t="b",P.v=!1;else if(!isNaN(w=xa(W)))P.t="n",m.cellText!==!1&&(P.w=W),P.v=w;else if(!isNaN(Rl(W).getDate())||N&&W.match(N)){P.z=m.dateNF||De[14];var G=0;N&&W.match(N)&&(W=_9(W,m.dateNF,W.match(N)||[]),G=1),m.cellDates?(P.t="d",P.v=Tt(W,G)):(P.t="n",P.v=or(Tt(W,G))),m.cellText!==!1&&(P.w=ta(P.z,P.v instanceof Date?or(P.v):P.v)),m.cellNF||delete P.z}else P.t="s",P.v=W;if(P.t=="z"||(m.dense?(v[g]||(v[g]=[]),v[g][y]=P):v[Re({c:y,r:g})]=P),x=S+1,T=f.charCodeAt(x),p.e.c<y&&(p.e.c=y),p.e.r<g&&(p.e.r=g),k==b)++y;else if(y=0,++g,m.sheetRows&&m.sheetRows<=g)return!0}e:for(;S<f.length;++S)switch(k=f.charCodeAt(S)){case 34:T===34&&(E=!E);break;case b:case 10:case 13:if(!E&&O())break e;break}return S-x>0&&O(),v["!ref"]=We(p),v}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):Jl(t(f,d),d)}function o(f,d){var m="",h=d.type=="string"?[0,0,0,0]:oy(f,d);switch(d.type){case"base64":m=Rn(f);break;case"binary":m=f;break;case"buffer":d.codepage==65001?m=f.toString("utf8"):d.codepage&&typeof Nu<"u"||(m=Ge&&Buffer.isBuffer(f)?f.toString("binary"):Ti(f));break;case"array":m=fo(f);break;case"string":m=f;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?m=dt(m.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?m=dt(m):d.type=="binary"&&typeof Nu<"u",m.slice(0,19)=="socialcalc:version:"?sC.to_sheet(d.type=="string"?m:dt(m),d):i(m,d)}function l(f,d){return Ni(o(f,d),d)}function u(f){for(var d=[],m=rt(f["!ref"]),h,v=Array.isArray(f),p=m.s.r;p<=m.e.r;++p){for(var g=[],y=m.s.c;y<=m.e.c;++y){var w=Re({r:p,c:y});if(h=v?(f[p]||[])[y]:f[w],!h||h.v==null){g.push("          ");continue}for(var x=(h.w||(Es(h),h.w)||"").slice(0,10);x.length<10;)x+=" ";g.push(x+(y===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function O$(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=nC.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ml.to_workbook(e,t)}}var qi=function(){function e(j,z,L){if(j){xr(j,j.l||0);for(var U=L.Enum||ne;j.l<j.length;){var Q=j.read_shift(2),q=U[Q]||U[65535],ae=j.read_shift(2),oe=j.l+ae,se=q.f&&q.f(j,ae,L);if(j.l=oe,z(se,q,Q))return}}}function t(j,z){switch(z.type){case"base64":return r(En(Rn(j)),z);case"binary":return r(En(j),z);case"buffer":case"array":return r(j,z)}throw"Unsupported type "+z.type}function r(j,z){if(!j)return j;var L=z||{},U=L.dense?[]:{},Q="Sheet1",q="",ae=0,oe={},se=[],J=[],A={s:{r:0,c:0},e:{r:0,c:0}},pe=L.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)L.Enum=ne,e(j,function(xe,ht,nr){switch(nr){case 0:L.vers=xe,xe>=4096&&(L.qpro=!0);break;case 6:A=xe;break;case 204:xe&&(q=xe);break;case 222:q=xe;break;case 15:case 51:L.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:nr==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=L.dateNF||De[14],L.cellDates&&(xe[1].t="d",xe[1].v=gm(xe[1].v))),L.qpro&&xe[3]>ae&&(U["!ref"]=We(A),oe[Q]=U,se.push(Q),U=L.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},ae=xe[3],Q=q||"Sheet"+(ae+1),q="");var vn=L.dense?(U[xe[0].r]||[])[xe[0].c]:U[Re(xe[0])];if(vn){vn.t=xe[1].t,vn.v=xe[1].v,xe[1].z!=null&&(vn.z=xe[1].z),xe[1].f!=null&&(vn.f=xe[1].f);break}L.dense?(U[xe[0].r]||(U[xe[0].r]=[]),U[xe[0].r][xe[0].c]=xe[1]):U[Re(xe[0])]=xe[1];break}},L);else if(j[2]==26||j[2]==14)L.Enum=ce,j[2]==14&&(L.qpro=!0,j.l=0),e(j,function(xe,ht,nr){switch(nr){case 204:Q=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>ae&&(U["!ref"]=We(A),oe[Q]=U,se.push(Q),U=L.dense?[]:{},A={s:{r:0,c:0},e:{r:0,c:0}},ae=xe[3],Q="Sheet"+(ae+1)),pe>0&&xe[0].r>=pe)break;L.dense?(U[xe[0].r]||(U[xe[0].r]=[]),U[xe[0].r][xe[0].c]=xe[1]):U[Re(xe[0])]=xe[1],A.e.c<xe[0].c&&(A.e.c=xe[0].c),A.e.r<xe[0].r&&(A.e.r=xe[0].r);break;case 27:xe[14e3]&&(J[xe[14e3][0]]=xe[14e3][1]);break;case 1537:J[xe[0]]=xe[1],xe[0]==ae&&(Q=xe[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(U["!ref"]=We(A),oe[q||Q]=U,se.push(q||Q),!J.length)return{SheetNames:se,Sheets:oe};for(var Ne={},$e=[],Me=0;Me<J.length;++Me)oe[se[Me]]?($e.push(J[Me]||se[Me]),Ne[J[Me]]=oe[J[Me]]||oe[se[Me]]):($e.push(J[Me]),Ne[J[Me]]={"!ref":"A1"});return{SheetNames:$e,Sheets:Ne}}function n(j,z){var L=z||{};if(+L.codepage>=0&&pa(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var U=dn(),Q=rt(j["!ref"]),q=Array.isArray(j),ae=[];ye(U,0,s(1030)),ye(U,6,l(Q));for(var oe=Math.min(Q.e.r,8191),se=Q.s.r;se<=oe;++se)for(var J=Xt(se),A=Q.s.c;A<=Q.e.c;++A){se===Q.s.r&&(ae[A]=Mt(A));var pe=ae[A]+J,Ne=q?(j[se]||[])[A]:j[pe];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?ye(U,13,h(se,A,Ne.v)):ye(U,14,p(se,A,Ne.v));else{var $e=Es(Ne);ye(U,15,d(se,A,$e.slice(0,239)))}}return ye(U,1),U.end()}function a(j,z){var L=z||{};if(+L.codepage>=0&&pa(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var U=dn();ye(U,0,i(j));for(var Q=0,q=0;Q<j.SheetNames.length;++Q)(j.Sheets[j.SheetNames[Q]]||{})["!ref"]&&ye(U,27,M(j.SheetNames[Q],q++));var ae=0;for(Q=0;Q<j.SheetNames.length;++Q){var oe=j.Sheets[j.SheetNames[Q]];if(!(!oe||!oe["!ref"])){for(var se=rt(oe["!ref"]),J=Array.isArray(oe),A=[],pe=Math.min(se.e.r,8191),Ne=se.s.r;Ne<=pe;++Ne)for(var $e=Xt(Ne),Me=se.s.c;Me<=se.e.c;++Me){Ne===se.s.r&&(A[Me]=Mt(Me));var xe=A[Me]+$e,ht=J?(oe[Ne]||[])[Me]:oe[xe];if(!(!ht||ht.t=="z"))if(ht.t=="n")ye(U,23,O(Ne,Me,ae,ht.v));else{var nr=Es(ht);ye(U,22,k(Ne,Me,ae,nr.slice(0,239)))}}++ae}}return ye(U,1),U.end()}function s(j){var z=ie(2);return z.write_shift(2,j),z}function i(j){var z=ie(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var L=0,U=0,Q=0,q=0;q<j.SheetNames.length;++q){var ae=j.SheetNames[q],oe=j.Sheets[ae];if(!(!oe||!oe["!ref"])){++Q;var se=gn(oe["!ref"]);L<se.e.r&&(L=se.e.r),U<se.e.c&&(U=se.e.c)}}return L>8191&&(L=8191),z.write_shift(2,L),z.write_shift(1,Q),z.write_shift(1,U),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(j,z,L){var U={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&L.qpro?(U.s.c=j.read_shift(1),j.l++,U.s.r=j.read_shift(2),U.e.c=j.read_shift(1),j.l++,U.e.r=j.read_shift(2),U):(U.s.c=j.read_shift(2),U.s.r=j.read_shift(2),z==12&&L.qpro&&(j.l+=2),U.e.c=j.read_shift(2),U.e.r=j.read_shift(2),z==12&&L.qpro&&(j.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(j){var z=ie(8);return z.write_shift(2,j.s.c),z.write_shift(2,j.s.r),z.write_shift(2,j.e.c),z.write_shift(2,j.e.r),z}function u(j,z,L){var U=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(U[0].c=j.read_shift(1),U[3]=j.read_shift(1),U[0].r=j.read_shift(2),j.l+=2):(U[2]=j.read_shift(1),U[0].c=j.read_shift(2),U[0].r=j.read_shift(2)),U}function f(j,z,L){var U=j.l+z,Q=u(j,z,L);if(Q[1].t="s",L.vers==20768){j.l++;var q=j.read_shift(1);return Q[1].v=j.read_shift(q,"utf8"),Q}return L.qpro&&j.l++,Q[1].v=j.read_shift(U-j.l,"cstr"),Q}function d(j,z,L){var U=ie(7+L.length);U.write_shift(1,255),U.write_shift(2,z),U.write_shift(2,j),U.write_shift(1,39);for(var Q=0;Q<U.length;++Q){var q=L.charCodeAt(Q);U.write_shift(1,q>=128?95:q)}return U.write_shift(1,0),U}function m(j,z,L){var U=u(j,z,L);return U[1].v=j.read_shift(2,"i"),U}function h(j,z,L){var U=ie(7);return U.write_shift(1,255),U.write_shift(2,z),U.write_shift(2,j),U.write_shift(2,L,"i"),U}function v(j,z,L){var U=u(j,z,L);return U[1].v=j.read_shift(8,"f"),U}function p(j,z,L){var U=ie(13);return U.write_shift(1,255),U.write_shift(2,z),U.write_shift(2,j),U.write_shift(8,L,"f"),U}function g(j,z,L){var U=j.l+z,Q=u(j,z,L);if(Q[1].v=j.read_shift(8,"f"),L.qpro)j.l=U;else{var q=j.read_shift(2);S(j.slice(j.l,j.l+q),Q),j.l+=q}return Q}function y(j,z,L){var U=z&32768;return z&=-32769,z=(U?j:0)+(z>=8192?z-16384:z),(U?"":"$")+(L?Mt(z):Xt(z))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(j,z){xr(j,0);for(var L=[],U=0,Q="",q="",ae="",oe="";j.l<j.length;){var se=j[j.l++];switch(se){case 0:L.push(j.read_shift(8,"f"));break;case 1:q=y(z[0].c,j.read_shift(2),!0),Q=y(z[0].r,j.read_shift(2),!1),L.push(q+Q);break;case 2:{var J=y(z[0].c,j.read_shift(2),!0),A=y(z[0].r,j.read_shift(2),!1);q=y(z[0].c,j.read_shift(2),!0),Q=y(z[0].r,j.read_shift(2),!1),L.push(J+A+":"+q+Q)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(j.read_shift(2));break;case 6:{for(var pe="";se=j[j.l++];)pe+=String.fromCharCode(se);L.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:oe=L.pop(),ae=L.pop(),L.push(["AND","OR"][se-20]+"("+ae+","+oe+")");break;default:if(se<32&&x[se])oe=L.pop(),ae=L.pop(),L.push(ae+x[se]+oe);else if(w[se]){if(U=w[se][1],U==69&&(U=j[j.l++]),U>L.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+L.join("|")+"|");return}var Ne=L.slice(-U);L.length-=U,L.push(w[se][0]+"("+Ne.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}L.length==1?z[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function b(j){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=j.read_shift(2),z[3]=j[j.l++],z[0].c=j[j.l++],z}function E(j,z){var L=b(j);return L[1].t="s",L[1].v=j.read_shift(z-4,"cstr"),L}function k(j,z,L,U){var Q=ie(6+U.length);Q.write_shift(2,j),Q.write_shift(1,L),Q.write_shift(1,z),Q.write_shift(1,39);for(var q=0;q<U.length;++q){var ae=U.charCodeAt(q);Q.write_shift(1,ae>=128?95:ae)}return Q.write_shift(1,0),Q}function T(j,z){var L=b(j);L[1].v=j.read_shift(2);var U=L[1].v>>1;if(L[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return L[1].v=U,L}function N(j,z){var L=b(j),U=j.read_shift(4),Q=j.read_shift(4),q=j.read_shift(2);if(q==65535)return U===0&&Q===3221225472?(L[1].t="e",L[1].v=15):U===0&&Q===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var ae=q&32768;return q=(q&32767)-16446,L[1].v=(1-ae*2)*(Q*Math.pow(2,q+32)+U*Math.pow(2,q)),L}function O(j,z,L,U){var Q=ie(14);if(Q.write_shift(2,j),Q.write_shift(1,L),Q.write_shift(1,z),U==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var q=0,ae=0,oe=0,se=0;return U<0&&(q=1,U=-U),ae=Math.log2(U)|0,U/=Math.pow(2,ae-31),se=U>>>0,se&2147483648||(U/=2,++ae,se=U>>>0),U-=se,se|=2147483648,se>>>=0,U*=Math.pow(2,32),oe=U>>>0,Q.write_shift(4,oe),Q.write_shift(4,se),ae+=16383+(q?32768:0),Q.write_shift(2,ae),Q}function W(j,z){var L=N(j);return j.l+=z-14,L}function P(j,z){var L=b(j),U=j.read_shift(4);return L[1].v=U>>6,L}function G(j,z){var L=b(j),U=j.read_shift(8,"f");return L[1].v=U,L}function X(j,z){var L=G(j);return j.l+=z-10,L}function V(j,z){return j[j.l+z-1]==0?j.read_shift(z,"cstr"):""}function K(j,z){var L=j[j.l++];L>z-1&&(L=z-1);for(var U="";U.length<L;)U+=String.fromCharCode(j[j.l++]);return U}function Y(j,z,L){if(!(!L.qpro||z<21)){var U=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var Q=j.read_shift(z-21,"cstr");return[U,Q]}}function H(j,z){for(var L={},U=j.l+z;j.l<U;){var Q=j.read_shift(2);if(Q==14e3){for(L[Q]=[0,""],L[Q][0]=j.read_shift(2);j[j.l];)L[Q][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return L}function M(j,z){var L=ie(5+j.length);L.write_shift(2,14e3),L.write_shift(2,z);for(var U=0;U<j.length;++U){var Q=j.charCodeAt(U);L[L.l++]=Q>127?95:Q}return L[L.l++]=0,L}var ne={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:m},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:V},222:{n:"SHEETNAMELP",f:K},65535:{n:""}},ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:W},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:V},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Y},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function I$(e){var t={},r=e.match($r),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ie(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=bv[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var F$=function(){var e=Pu("t"),t=Pu("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:et(i[1])},l=s.match(t);return l&&(o.s=I$(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),L$=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),B$=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,U$=/<(?:\w+:)?r>/,$$=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Xv(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=et(dt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=dt(e),r&&(n.h=Mv(n.t))):e.match(U$)&&(n.r=dt(e),n.t=et(dt((e.replace($$,"").match(B$)||[]).join("").replace($r,""))),r&&(n.h=L$(F$(n.r)))),n):{t:""}}var W$=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,H$=/<(?:\w+:)?(?:si|sstItem)>/g,z$=/<\/(?:\w+:)?(?:si|sstItem)>/;function V$(e,t){var r=[],n="";if(!e)return r;var a=e.match(W$);if(a){n=a[2].replace(H$,"").split(z$);for(var s=0;s!=n.length;++s){var i=Xv(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ie(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var G$=/^\s|\s$|[\t\n\r]/;function iC(e,t){if(!t.bookSST)return"";var r=[Kt];r[r.length]=ve("sst",null,{xmlns:bo[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(G$)&&(s+=' xml:space="preserve"'),s+=">"+ct(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Y$(e){return[e.read_shift(4),e.read_shift(4)]}function X$(e,t){var r=[],n=!1;return As(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function K$(e,t){return t||(t=ie(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var q$=iB;function Q$(e){var t=dn();fe(t,159,K$(e));for(var r=0;r<e.length;++r)fe(t,19,q$(e[r]));return fe(t,160),t.end()}function oC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function vs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function J$(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=vs(e,4),t.U=vs(e,4),t.W=vs(e,4),t}function Z$(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function eW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Z$(e));return t}function tW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function rW(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=vs(e,4),t.U=vs(e,4),t.W=vs(e,4),t}function nW(e){var t=rW(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lC(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cC(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function aW(e){var t=vs(e);switch(t.Minor){case 2:return[t.Minor,sW(e)];case 3:return[t.Minor,iW()];case 4:return[t.Minor,oW(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function sW(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=lC(e,r),a=cC(e,e.length-e.l);return{t:"Std",h:n,v:a}}function iW(){throw new Error("File is password-protected: ECMA-376 Extensible")}function oW(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace($r,function(s){var i=Ie(s);switch(Ja(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function lW(e,t){var r={},n=r.EncryptionVersionInfo=vs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=lC(e,a),t-=a,r.EncryptionVerifier=cC(e,t),r}function cW(e){var t={},r=t.EncryptionVersionInfo=vs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Kv(e){var t=0,r,n=oC(e),a=n.length+1,s,i,o,l,u;for(r=mi(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var uC=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=oC(i),l=s(o),u=o.length,f=mi(16),d=0;d!=16;++d)f[d]=0;var m,h,v;for((u&1)===1&&(m=l>>8,f[u]=a(e[0],m),--u,m=l&255,h=o[o.length-1],f[u]=a(h,m));u>0;)--u,m=l>>8,f[u]=a(o[u],m),--u,m=l&255,f[u]=a(o[u],m);for(u=15,v=15-o.length;v>0;)m=l>>8,f[u]=a(e[v],m),--u,--v,m=l&255,f[u]=a(o[u],m),--u,--v;return f}}(),uW=function(e,t,r,n,a){a||(a=t),n||(n=uC(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},fW=function(e){var t=0,r=uC(e);return function(n){var a=uW("",n,t,r);return t=a[1],a[0]}};function dW(e,t,r,n){var a={key:Zt(e),verificationBytes:Zt(e)};return r.password&&(a.verifier=Kv(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=fW(r.password)),a}function hW(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=cW(e):n.Data=lW(e,t),n}function mW(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?hW(e,t-2,n):dW(e,r.biff>=8?t:t-2,r,n),n}var fC=function(){function e(a,s){switch(s.type){case"base64":return t(Rn(a),s);case"binary":return t(a,s);case"buffer":return t(Ge&&Buffer.isBuffer(a)?a.toString("binary"):Ti(a),s);case"array":return t(fo(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var m=/\\\w+\b/g,h=0,v,p=-1;v=m.exec(f);){switch(v[0]){case"\\cell":var g=f.slice(h,m.lastIndex-v[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var y={v:g,t:"s"};Array.isArray(o)?o[d][p]=y:o[Re({r:d,c:p})]=y}break}h=m.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=We(u),o}function r(a,s){return Ni(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=rt(a["!ref"]),o,l=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Re({r:u,c:f});o=l?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Es(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function pW(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Mu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function gW(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,u=a+s;switch(l=i/(u>1?2-u:u),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,u/2]}function vW(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function gh(e,t){if(t===0)return e;var r=gW(pW(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Mu(vW(r))}var dC=6,yW=15,xW=1,Rr=dC;function Ou(e){return Math.floor((e+Math.round(128/Rr)/256)*Rr)}function Iu(e){return Math.floor((e-5)/Rr*100+.5)/100}function vh(e){return Math.round((e*Rr+5)/Rr*256)/256}function jp(e){return vh(Iu(Ou(e)))}function qv(e){var t=Math.abs(e-jp(e)),r=Rr;if(t>.005)for(Rr=xW;Rr<yW;++Rr)Math.abs(e-jp(e))<=t&&(t=Math.abs(e-jp(e)),r=Rr);Rr=r}function pi(e){e.width?(e.wpx=Ou(e.width),e.wch=Iu(e.wpx),e.MDW=Rr):e.wpx?(e.wch=Iu(e.wpx),e.width=vh(e.wch),e.MDW=Rr):typeof e.wch=="number"&&(e.width=vh(e.wch),e.wpx=Ou(e.width),e.MDW=Rr),e.customWidth&&delete e.customWidth}var wW=96,hC=wW;function Fu(e){return e*96/hC}function Ol(e){return e*hC/96}var _W={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function SW(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match($r)||[]).forEach(function(i){var o=Ie(i);switch(Ja(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=kt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=kt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function kW(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match($r)||[]).forEach(function(i){var o=Ie(i);switch(Ja(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function bW(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match($r)||[]).forEach(function(i){var o=Ie(i);switch(Ja(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=dt(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?kt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?kt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?kt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?kt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?kt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?kt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?kt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=bv[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=kt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Xi[a.color.index];a.color.index==81&&(l=Xi[1]),l||(l=Xi[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=gh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function EW(e,t,r){t.NumberFmt=[];for(var n=Wt(De),a=0;a<n.length;++a)t.NumberFmt[n[a]]=De[n[a]];var s=e[0].match($r);if(s)for(a=0;a<s.length;++a){var i=Ie(s[a]);switch(Ja(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=et(dt(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}gs(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function TW(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ve("numFmt",null,{numFmtId:n,formatCode:ct(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ve("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var rd=["numFmtId","fillId","fontId","borderId","xfId"],nd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function NW(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match($r)||[]).forEach(function(s){var i=Ie(s),o=0;switch(Ja(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<rd.length;++o)n[rd[o]]&&(n[rd[o]]=parseInt(n[rd[o]],10));for(o=0;o<nd.length;++o)n[nd[o]]&&(n[nd[o]]=kt(n[nd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=kt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function CW(e){var t=[];return t[t.length]=ve("cellXfs",null),e.forEach(function(r){t[t.length]=ve("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ve("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var AW=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&EW(d,f,u),(d=o.match(a))&&bW(d,f,l,u),(d=o.match(n))&&kW(d,f,l,u),(d=o.match(s))&&SW(d,f,l,u),(d=o.match(r))&&NW(d,f,u),f}}();function mC(e,t){var r=[Kt,ve("styleSheet",null,{xmlns:bo[0],"xmlns:vt":sr.vt})],n;return e.SSF&&(n=TW(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=CW(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function PW(e,t){var r=e.read_shift(2),n=Lr(e);return[r,n]}function jW(e,t,r){r||(r=ie(6+4*t.length)),r.write_shift(2,e),hr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function DW(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=hB(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=dB(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Lr(e),n}function RW(e,t){t||(t=ie(25+4*32)),t.write_shift(2,e.sz*20),mB(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),hh(e.color,t);var n=0;return n=2,t.write_shift(1,n),hr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var MW=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Dp,OW=Ur;function _2(e,t){t||(t=ie(4*3+8*7+16*1)),Dp||(Dp=mm(MW));var r=Dp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(hh({auto:1},t),hh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function IW(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function pC(e,t,r){r||(r=ie(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function kc(e,t){return t||(t=ie(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var FW=Ur;function LW(e,t){return t||(t=ie(51)),t.write_shift(1,0),kc(null,t),kc(null,t),kc(null,t),kc(null,t),kc(null,t),t.length>t.l?t.slice(0,t.l):t}function BW(e,t){return t||(t=ie(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),dh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function UW(e,t,r){var n=ie(2052);return n.write_shift(4,e),dh(t,n),dh(r,n),n.length>n.l?n.slice(0,n.l):n}function $W(e,t,r){var n={};n.NumberFmt=[];for(var a in De)n.NumberFmt[a]=De[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return As(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],gs(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=gh(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(u.T>0)s.push(f);else if(u.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function WW(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(fe(e,615,wa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&fe(e,44,jW(a,t[a]))}),fe(e,616))}}function HW(e){var t=1;fe(e,611,wa(t)),fe(e,43,RW({sz:12,color:{theme:1},name:"Calibri",family:2})),fe(e,612)}function zW(e){var t=2;fe(e,603,wa(t)),fe(e,45,_2({patternType:"none"})),fe(e,45,_2({patternType:"gray125"})),fe(e,604)}function VW(e){var t=1;fe(e,613,wa(t)),fe(e,46,LW()),fe(e,614)}function GW(e){var t=1;fe(e,626,wa(t)),fe(e,47,pC({numFmtId:0},65535)),fe(e,627)}function YW(e,t){fe(e,617,wa(t.length)),t.forEach(function(r){fe(e,47,pC(r,0))}),fe(e,618)}function XW(e){var t=1;fe(e,619,wa(t)),fe(e,48,BW({xfId:0,name:"Normal"})),fe(e,620)}function KW(e){var t=0;fe(e,505,wa(t)),fe(e,506)}function qW(e){var t=0;fe(e,508,UW(t,"TableStyleMedium9","PivotStyleMedium4")),fe(e,509)}function QW(e,t){var r=dn();return fe(r,278),WW(r,e.SSF),HW(r),zW(r),VW(r),GW(r),YW(r,t.cellXfs),XW(r),KW(r),qW(r),fe(r,279),r.end()}var JW=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ZW(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match($r)||[]).forEach(function(a){var s=Ie(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[JW.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function eH(){}function tH(){}var rH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sH(e,t,r){t.themeElements={};var n;[["clrScheme",rH,ZW],["fontScheme",nH,eH],["fmtScheme",aH,tH]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var iH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function gC(e,t){(!e||e.length===0)&&(e=Qv());var r,n={};if(!(r=e.match(iH)))throw new Error("themeElements not found in theme");return sH(r[0],n,t),n.raw=e,n}function Qv(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Kt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function oH(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=lN(s,{type:"array"})}catch{return}var o=Tn(i,"theme/theme/theme1.xml",!0);if(o)return gC(o,r)}}function lH(e){return e.read_shift(4)}function cH(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=uH(e,4);break;case 2:t.xclrValue=KN(e);break;case 3:t.xclrValue=lH(e);break;case 4:e.l+=4;break}return e.l+=8,t}function uH(e,t){return Ur(e,t)}function fH(e,t){return Ur(e,t)}function dH(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=cH(e);break;case 6:n[1]=fH(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function hH(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(dH(e,r-e.l));return{ixfe:n,ext:s}}function mH(e,t){t.forEach(function(r){switch(r[0]){}})}function pH(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Lr(e)}}function gH(e){var t=ie(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),hr(e.name,t),t.slice(0,t.l)}function vH(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function yH(e){var t=ie(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function xH(e,t){var r=ie(8+2*t.length);return r.write_shift(4,e),hr(t,r),r.slice(0,r.l)}function wH(e){return e.l+=4,e.read_shift(4)!=0}function _H(e,t){var r=ie(8);return r.write_shift(4,e),r.write_shift(4,1),r}function SH(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return As(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!u.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function kH(){var e=dn();return fe(e,332),fe(e,334,wa(1)),fe(e,335,gH({name:"XLDAPR",version:12e4,flags:3496657072})),fe(e,336),fe(e,339,xH(1,"XLDAPR")),fe(e,52),fe(e,35,wa(514)),fe(e,4096,wa(0)),fe(e,4097,Vn(1)),fe(e,36),fe(e,53),fe(e,340),fe(e,337,_H(1)),fe(e,51,yH([[1,0]])),fe(e,338),fe(e,333),e.end()}function bH(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace($r,function(o){var l=Ie(o);switch(Ja(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function vC(){var e=[Kt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function EH(e){var t=[];if(!e)return t;var r=1;return(e.match($r)||[]).forEach(function(n){var a=Ie(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function TH(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Re(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function NH(e,t,r){var n=[];return As(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function CH(e,t,r,n){if(!e)return e;var a=n||{},s=!1;As(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function AH(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Zo=1024;function yC(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[ve("xml",null,{"xmlns:v":kn.v,"xmlns:o":kn.o,"xmlns:x":kn.x,"xmlns:mv":kn.mv}).replace(/\/>/,">"),ve("o:shapelayout",ve("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ve("v:shapetype",[ve("v:stroke",null,{joinstyle:"miter"}),ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Zo<e*1e3;)Zo+=1e3;return t.forEach(function(s){var i=Ot(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ve("v:fill",l,o),f={on:"t",obscured:"t"};++Zo,a=a.concat(["<v:shape"+ju({id:"_x0000_s"+Zo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ve("v:shadow",null,f),ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),wr("x:AutoFill","False"),wr("x:Row",String(i.r)),wr("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function S2(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Ot(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=rt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=We(l);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function PH(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ie(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Ot(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),m=!!d&&!!d[1]&&Xv(d[1])||{r:"",t:"",h:""};u.r=m.r,m.r=="<t></t>"&&(m.t=m.h=""),u.t=(m.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=m.h),n.push(u)}}}}),n}function xC(e){var t=[Kt,ve("comments",null,{xmlns:bo[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=ct(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(ct(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(wr("t",ct(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(wr("t",ct(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function jH(e,t){var r=[],n=!1,a={},s=0;return e.replace($r,function(o,l){var u=Ie(o);switch(Ja(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function DH(e,t,r){var n=[Kt,ve("ThreadedComments",null,{xmlns:sr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(ve("threadedComment",wr("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function RH(e,t){var r=[],n=!1;return e.replace($r,function(s){var i=Ie(s);switch(Ja(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function MH(e){var t=[Kt,ve("personList",null,{xmlns:sr.TCMNT,"xmlns:x":bo[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function OH(e){var t={};t.iauthor=e.read_shift(4);var r=Co(e);return t.rfx=r.s,t.ref=Re(r.s),e.l+=16,t}function IH(e,t){return t==null&&(t=ie(36)),t.write_shift(4,e[1].iauthor),Zl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var FH=Lr;function LH(e){return hr(e.slice(0,54))}function BH(e,t){var r=[],n=[],a={},s=!1;return As(e,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function UH(e){var t=dn(),r=[];return fe(t,628),fe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),fe(t,632,LH(a.a)))})}),fe(t,631),fe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:Ot(n[0]),e:Ot(n[0])};fe(t,635,IH([s,a])),a.t&&a.t.length>0&&fe(t,637,lB(a)),fe(t,636),delete a.iauthor})}),fe(t,634),fe(t,629),t.end()}var $H="application/vnd.ms-office.vbaProject";function WH(e){var t=Ce.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ce.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ce.write(t)}function HH(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ce.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var wC=["xlsb","xlsm","xlam","biff8","xla"];function zH(){return{"!type":"dialog"}}function VH(){return{"!type":"dialog"}}function GH(){return{"!type":"macro"}}function YH(){return{"!type":"macro"}}var fl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,a+(o?"":"$")+Mt(f)+(l?"":"$")+Xt(u)}return function(a,s){return t=s,a.replace(e,r)}}(),Jv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Zv=function(){return function(t,r){return t.replace(Jv,function(n,a,s,i,o,l){var u=Bv(i)-(s?0:r.c),f=Lv(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",m=u==0?"":s?u+1:"["+u+"]";return a+"R"+d+"C"+m})}}();function _C(e,t){return e.replace(Jv,function(r,n,a,s,i,o){return n+(a=="$"?a+s:Mt(Bv(s)+t.c))+(i=="$"?i+o:Xt(Lv(o)+t.r))})}function XH(e,t,r){var n=gn(t),a=n.s,s=Ot(r),i={r:s.r-a.r,c:s.c-a.c};return _C(e,i)}function KH(e){return e.length!=1}function k2(e){return e.replace(/_xlfn\./g,"")}function Qt(e){e.l+=1}function gi(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function SC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return kC(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=gi(e),o=gi(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function kC(e){var t=gi(e),r=gi(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function qH(e,t,r){if(r.biff<8)return kC(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=gi(e),i=gi(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function bC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return QH(e);var n=e.read_shift(r&&r.biff==12?4:2),a=gi(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function QH(e){var t=gi(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function JH(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function ZH(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ez(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function ez(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function tz(e,t,r){var n=(e[e.l++]&96)>>5,a=SC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function rz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=SC(e,s,r);return[n,a,i]}function nz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function az(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function sz(e,t,r){var n=(e[e.l++]&96)>>5,a=qH(e,t-1,r);return[n,a]}function iz(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function b2(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function oz(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function lz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function cz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function uz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function fz(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function EC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function dz(e){return e.read_shift(2),EC(e)}function hz(e){return e.read_shift(2),EC(e)}function mz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=bC(e,0,r);return[n,a]}function pz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=ZH(e,0,r);return[n,a]}function gz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=bC(e,0,r);return[n,a,s]}function vz(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[wV[a],CC[a],n]}function yz(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:xz(e);return[a,(s[0]===0?CC:xV)[s[1]]]}function xz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function wz(e,t,r){e.l+=r&&r.biff==2?3:4}function _z(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Sz(e){return e.l++,Ps[e.read_shift(1)]}function kz(e){return e.l++,e.read_shift(2)}function bz(e){return e.l++,e.read_shift(1)!==0}function Ez(e){return e.l++,Or(e)}function Tz(e,t,r){return e.l++,hf(e,t-1,r)}function Nz(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Vt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Ps[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Or(e);break;case 2:r[1]=Ao(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Cz(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Co:vm)(e));return a}function Az(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=Nz(e,r.biff);return i}function Pz(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function jz(e,t,r){if(r.biff==5)return Dz(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function Dz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Rz(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Mz(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Oz(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Iz(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Fz=Ur,Lz=Ur,Bz=Ur;function pf(e,t,r){return e.l+=2,[JH(e)]}function ey(e){return e.l+=6,[]}var Uz=pf,$z=ey,Wz=ey,Hz=pf;function TC(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var zz=pf,Vz=TC,Gz=ey,Yz=pf,Xz=pf,Kz=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qz(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=Kz[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function Qz(e){return e.l+=2,[e.read_shift(4)]}function Jz(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Zz(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function eV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function tV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function rV(e){return e.l+=4,[0,0]}var E2={1:{n:"PtgExp",f:_z},2:{n:"PtgTbl",f:Bz},3:{n:"PtgAdd",f:Qt},4:{n:"PtgSub",f:Qt},5:{n:"PtgMul",f:Qt},6:{n:"PtgDiv",f:Qt},7:{n:"PtgPower",f:Qt},8:{n:"PtgConcat",f:Qt},9:{n:"PtgLt",f:Qt},10:{n:"PtgLe",f:Qt},11:{n:"PtgEq",f:Qt},12:{n:"PtgGe",f:Qt},13:{n:"PtgGt",f:Qt},14:{n:"PtgNe",f:Qt},15:{n:"PtgIsect",f:Qt},16:{n:"PtgUnion",f:Qt},17:{n:"PtgRange",f:Qt},18:{n:"PtgUplus",f:Qt},19:{n:"PtgUminus",f:Qt},20:{n:"PtgPercent",f:Qt},21:{n:"PtgParen",f:Qt},22:{n:"PtgMissArg",f:Qt},23:{n:"PtgStr",f:Tz},26:{n:"PtgSheet",f:Jz},27:{n:"PtgEndSheet",f:Zz},28:{n:"PtgErr",f:Sz},29:{n:"PtgBool",f:bz},30:{n:"PtgInt",f:kz},31:{n:"PtgNum",f:Ez},32:{n:"PtgArray",f:iz},33:{n:"PtgFunc",f:vz},34:{n:"PtgFuncVar",f:yz},35:{n:"PtgName",f:Pz},36:{n:"PtgRef",f:mz},37:{n:"PtgArea",f:tz},38:{n:"PtgMemArea",f:Rz},39:{n:"PtgMemErr",f:Fz},40:{n:"PtgMemNoMem",f:Lz},41:{n:"PtgMemFunc",f:Mz},42:{n:"PtgRefErr",f:Oz},43:{n:"PtgAreaErr",f:nz},44:{n:"PtgRefN",f:pz},45:{n:"PtgAreaN",f:sz},46:{n:"PtgMemAreaN",f:eV},47:{n:"PtgMemNoMemN",f:tV},57:{n:"PtgNameX",f:jz},58:{n:"PtgRef3d",f:gz},59:{n:"PtgArea3d",f:rz},60:{n:"PtgRefErr3d",f:Iz},61:{n:"PtgAreaErr3d",f:az},255:{}},nV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},aV={1:{n:"PtgElfLel",f:TC},2:{n:"PtgElfRw",f:Yz},3:{n:"PtgElfCol",f:Uz},6:{n:"PtgElfRwV",f:Xz},7:{n:"PtgElfColV",f:Hz},10:{n:"PtgElfRadical",f:zz},11:{n:"PtgElfRadicalS",f:Gz},13:{n:"PtgElfColS",f:$z},15:{n:"PtgElfColSV",f:Wz},16:{n:"PtgElfRadicalLel",f:Vz},25:{n:"PtgList",f:qz},29:{n:"PtgSxName",f:Qz},255:{}},sV={0:{n:"PtgAttrNoop",f:rV},1:{n:"PtgAttrSemi",f:fz},2:{n:"PtgAttrIf",f:cz},4:{n:"PtgAttrChoose",f:oz},8:{n:"PtgAttrGoto",f:lz},16:{n:"PtgAttrSum",f:wz},32:{n:"PtgAttrBaxcel",f:b2},33:{n:"PtgAttrBaxcel",f:b2},64:{n:"PtgAttrSpace",f:dz},65:{n:"PtgAttrSpaceSemi",f:hz},128:{n:"PtgAttrIfError",f:uz},255:{}};function gf(e,t,r,n){if(n.biff<8)return Ur(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Az(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Cz(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(Ur(e,t)),s}function vf(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=E2[s]||E2[nV[s]],(s===24||s===25)&&(a=(s===24?aV:sV)[e[e.l+1]]),!a||!a.f?Ur(e,t):i.push([a.n,a.f(e,t,r)]);return i}function iV(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var oV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function lV(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function NC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function T2(e,t,r){var n=NC(e,t,r);return n=="#REF"?n:lV(n,r)}function jr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,u,f,d=0,m=0,h,v="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",y=0,w=e[0].length;y<w;++y){var x=e[0][y];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Ut(" ",e[0][p][1][1]);break;case 1:g=Ut("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}o.push(u+oV[x[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Vc(x[1][1],i,a),o.push(Gc(f,s));break;case"PtgRefN":f=r?Vc(x[1][1],r,a):x[1][1],o.push(Gc(f,s));break;case"PtgRef3d":d=x[1][1],f=Vc(x[1][2],i,a),v=T2(n,d,a),o.push(v+"!"+Gc(f,s));break;case"PtgFunc":case"PtgFuncVar":var S=x[1][0],b=x[1][1];S||(S=0),S&=127;var E=S==0?[]:o.slice(-S);o.length-=S,b==="User"&&(b=E.shift()),o.push(b+"("+E.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":h=t2(x[1][1],r?{s:r}:i,a),o.push(Cp(h,a));break;case"PtgArea":h=t2(x[1][1],i,a),o.push(Cp(h,a));break;case"PtgArea3d":d=x[1][1],h=x[1][2],v=T2(n,d,a),o.push(v+"!"+Cp(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":m=x[1][2];var k=(n.names||[])[m-1]||(n[0]||[])[m],T=k?k.Name:"SH33TJSNAME"+String(m);T&&T.slice(0,6)=="_xlfn."&&!a.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var N=x[1][1];m=x[1][2];var O;if(a.biff<=5)N<0&&(N=-N),n[N]&&(O=n[N][m]);else{var W="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][m]&&n[N][m].itab>0&&(W=n.SheetNames[n[N][m].itab-1]+"!"):W=n.SheetNames[m-1]+"!"),n[N]&&n[N][m])W+=n[N][m].Name;else if(n[0]&&n[0][m])W+=n[0][m].Name;else{var P=(NC(n,N,a)||"").split(";;");P[m-1]?W=P[m-1]:W+="SH33TJSERRX"}o.push(W);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var G="(",X=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:G=Ut(" ",e[0][p][1][1])+G;break;case 3:G=Ut("\r",e[0][p][1][1])+G;break;case 4:X=Ut(" ",e[0][p][1][1])+X;break;case 5:X=Ut("\r",e[0][p][1][1])+X;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(G+o.pop()+X);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var V={c:r.c,r:r.r};if(n.sharedf[Re(f)]){var K=n.sharedf[Re(f)];o.push(jr(K,i,V,n,a))}else{var Y=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(jr(u[1],i,V,n,a)),Y=!0;break}Y||o.push(x[1])}break;case"PtgArray":o.push("{"+iV(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&p>=0&&H.indexOf(e[0][y][0])==-1){x=e[0][p];var M=!0;switch(x[1][0]){case 4:M=!1;case 0:g=Ut(" ",x[1][1]);break;case 5:M=!1;case 1:g=Ut("\r",x[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((M?g:"")+o.pop()+(M?"":g)),p=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function cV(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Ur(e,t-2)];var o=vf(e,i,r);return t!==i+a&&(s=gf(e,t-i-a,o,r)),e.l=n,[o,s]}function uV(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],Ur(e,t-2)];var o=vf(e,i,r);return t!==i+a&&(s=gf(e,t-i-a,o,r)),e.l=n,[o,s]}function fV(e,t,r,n){var a=e.l+t,s=vf(e,n,r),i;return a!==e.l&&(i=gf(e,a-e.l,s,r)),[s,i]}function dV(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=vf(e,s,r);return s==65535?[[],Ur(e,t-2)]:(t!==s+2&&(a=gf(e,n-s-2,i,r)),[i,a])}function hV(e){var t;if(ds(e,e.l+6)!==65535)return[Or(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function mV(e){if(e==null){var t=ie(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ho(e);return ho(0)}function Rp(e,t,r){var n=e.l+t,a=Za(e);r.biff==2&&++e.l;var s=hV(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=uV(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function pV(e,t,r,n,a){var s=po(t,r,a),i=mV(e.v),o=ie(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=ie(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=dr([s,i,o,u]);return d}function ym(e,t,r){var n=e.read_shift(4),a=vf(e,n,r),s=e.read_shift(4),i=s>0?gf(e,s,a,r):null;return[a,i]}var gV=ym,xm=ym,vV=ym,yV=ym,xV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},CC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},wV={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function N2(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function _V(e){var t="of:="+e.replace(Jv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Mp(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function SV(e){return e.replace(/\./,"!")}var Xc={},dl={},Kc=typeof Map<"u";function ty(e,t,r){var n=0,a=e.length;if(r){if(Kc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Kc?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Kc?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function wm(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Rr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Iu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=vh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Qi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ci(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){gs(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function AC(e,t,r,n,a,s){try{n.cellNF&&(e.z=De[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Tt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(De[t]==null&&gs(x9[t]||"General",t),e.t==="e")e.w=e.w||Ps[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v);else if(e.t==="d"){var i=or(e.v);(i|0)===i?e.w=i.toString(10):e.w=Au(i)}else{if(e.v===void 0)return"";e.w=uo(e.v,dl)}else e.t==="d"?e.w=ta(t,or(e.v),dl):e.w=ta(t,e.v,dl)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=gh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=gh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function kV(e,t,r){if(e&&e["!ref"]){var n=rt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function bV(e,t){var r=rt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=We(r))}var EV=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,TV=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,NV=/<(?:\w:)?hyperlink [^>]*>/mg,CV=/"(\w*:\w*)"/,AV=/<(?:\w:)?col\b[^>]*[\/]?>/g,PV=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,jV=/<(?:\w:)?pageMargins[^>]*\/>/g,PC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,DV=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,RV=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function MV(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(TV);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var m=u.match(PC);m?ry(m[0],o,a,r):(m=u.match(DV))&&IV(m[0],m[1]||"",o,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var v=u.slice(h,h+50).match(CV);v&&bV(o,v[1])}var p=u.match(RV);p&&p[1]&&KV(p[1],a);var g=[];if(t.cellStyles){var y=u.match(AV);y&&zV(g,y)}d&&JV(d[1],o,t,l,s,i);var w=f.match(PV);w&&(o["!autofilter"]=GV(w[0]));var x=[],S=f.match(EV);if(S)for(h=0;h!=S.length;++h)x[h]=rt(S[h].slice(S[h].indexOf('"')+1));var b=f.match(NV);b&&$V(o,b,n);var E=f.match(jV);if(E&&(o["!margins"]=WV(Ie(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=We(l)),t.sheetRows>0&&o["!ref"]){var k=rt(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=We(k))}return g.length>0&&(o["!cols"]=g),x.length>0&&(o["!merges"]=x),o}function OV(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+We(e[r])+'"/>';return t+"</mergeCells>"}function ry(e,t,r,n){var a=Ie(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=et(dt(a.codeName)))}function IV(e,t,r,n,a){ry(e.slice(0,e.indexOf(">")),r,n,a)}function FV(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,i.codeName=Ha(ct(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ve("outlinePr",null,u)}!s&&!o||(a[a.length]=ve("sheetPr",o,i))}var LV=["objects","scenarios","selectLockedCells","selectUnlockedCells"],BV=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UV(e){var t={sheet:1};return LV.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),BV.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Kv(e.password).toString(16).toUpperCase()),ve("sheetProtection",null,t)}function $V(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ie(dt(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+et(s.location))):(s.Target="#"+et(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=rt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=Re({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function WV(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function HV(e){return Qi(e),ve("pageMargins",null,e)}function zV(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ie(t[n],!0);a.hidden&&(a.hidden=kt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,qv(a.width)),pi(a);s<=i;)e[s++]=Nt(a)}}function VV(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=ve("col",null,wm(a,n)));return r[r.length]="</cols>",r.join("")}function GV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function YV(e,t,r,n){var a=typeof e.ref=="string"?e.ref:We(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=gn(a);i.s.r==i.e.r&&(i.e.r=gn(t["!ref"]).e.r,a=We(i));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ve("autoFilter",null,{ref:a})}var XV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function KV(e,t){t.Views||(t.Views=[{}]),(e.match(XV)||[]).forEach(function(r,n){var a=Ie(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),kt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function qV(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ve("sheetViews",ve("sheetView",null,a),{})}function QV(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Ps[e.v];break;case"d":n&&n.cellDates?a=Tt(e.v,-1).toISOString():(e=Nt(e),e.t="n",a=""+(e.v=or(Tt(e.v)))),typeof e.z>"u"&&(e.z=De[14]);break;default:a=e.v;break}var o=wr("v",ct(a)),l={r:t},u=Ci(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=wr("v",""+ty(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ve("f",ct(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ve("c",o,l)}var JV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Pu("v"),i=Pu("f");return function(l,u,f,d,m,h){for(var v=0,p="",g=[],y=[],w=0,x=0,S=0,b="",E,k,T=0,N=0,O,W,P=0,G=0,X=Array.isArray(h.CellXf),V,K=[],Y=[],H=Array.isArray(u),M=[],ne={},ce=!1,j=!!f.sheetStubs,z=l.split(t),L=0,U=z.length;L!=U;++L){p=z[L].trim();var Q=p.length;if(Q!==0){var q=0;e:for(v=0;v<Q;++v)switch(p[v]){case">":if(p[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(k=Ie(p.slice(q,v),!0),T=k.r!=null?parseInt(k.r,10):T+1,N=-1,f.sheetRows&&f.sheetRows<T)continue;ne={},ce=!1,k.ht&&(ce=!0,ne.hpt=parseFloat(k.ht),ne.hpx=Ol(ne.hpt)),k.hidden=="1"&&(ce=!0,ne.hidden=!0),k.outlineLevel!=null&&(ce=!0,ne.level=+k.outlineLevel),ce&&(M[T-1]=ne)}break;case"<":q=v;break}if(q>=v)break;if(k=Ie(p.slice(q,v),!0),T=k.r!=null?parseInt(k.r,10):T+1,N=-1,!(f.sheetRows&&f.sheetRows<T)){d.s.r>T-1&&(d.s.r=T-1),d.e.r<T-1&&(d.e.r=T-1),f&&f.cellStyles&&(ne={},ce=!1,k.ht&&(ce=!0,ne.hpt=parseFloat(k.ht),ne.hpx=Ol(ne.hpt)),k.hidden=="1"&&(ce=!0,ne.hidden=!0),k.outlineLevel!=null&&(ce=!0,ne.level=+k.outlineLevel),ce&&(M[T-1]=ne)),g=p.slice(v).split(e);for(var ae=0;ae!=g.length&&g[ae].trim().charAt(0)=="<";++ae);for(g=g.slice(ae),v=0;v!=g.length;++v)if(p=g[v].trim(),p.length!==0){if(y=p.match(r),w=v,x=0,S=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(w=0,b=y[1],x=0;x!=b.length&&!((S=b.charCodeAt(x)-64)<1||S>26);++x)w=26*w+S;--w,N=w}else++N;for(x=0;x!=p.length&&p.charCodeAt(x)!==62;++x);if(++x,k=Ie(p.slice(0,x),!0),k.r||(k.r=Re({r:T-1,c:N})),b=p.slice(x),E={t:""},(y=b.match(s))!=null&&y[1]!==""&&(E.v=et(y[1])),f.cellFormula){if((y=b.match(i))!=null&&y[1]!==""){if(E.f=et(dt(y[1])).replace(/\r\n/g,`
`),f.xlfn||(E.f=k2(E.f)),y[0].indexOf('t="array"')>-1)E.F=(b.match(a)||[])[1],E.F.indexOf(":")>-1&&K.push([rt(E.F),E.F]);else if(y[0].indexOf('t="shared"')>-1){W=Ie(y[0]);var oe=et(dt(y[1]));f.xlfn||(oe=k2(oe)),Y[parseInt(W.si,10)]=[W,oe,k.r]}}else(y=b.match(/<f[^>]*\/>/))&&(W=Ie(y[0]),Y[W.si]&&(E.f=XH(Y[W.si][1],Y[W.si][2],k.r)));var se=Ot(k.r);for(x=0;x<K.length;++x)se.r>=K[x][0].s.r&&se.r<=K[x][0].e.r&&se.c>=K[x][0].s.c&&se.c<=K[x][0].e.c&&(E.F=K[x][1])}if(k.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(j)E.t="z";else continue;else E.t=k.t||"n";switch(d.s.c>N&&(d.s.c=N),d.e.c<N&&(d.e.c=N),E.t){case"n":if(E.v==""||E.v==null){if(!j)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!j)continue;E.t="z"}else O=Xc[parseInt(E.v,10)],E.v=O.t,E.r=O.r,f.cellHTML&&(E.h=O.h);break;case"str":E.t="s",E.v=E.v!=null?dt(E.v):"",f.cellHTML&&(E.h=Mv(E.v));break;case"inlineStr":y=b.match(n),E.t="s",y!=null&&(O=Xv(y[1]))?(E.v=O.t,f.cellHTML&&(E.h=O.h)):E.v="";break;case"b":E.v=kt(E.v);break;case"d":f.cellDates?E.v=Tt(E.v,1):(E.v=or(Tt(E.v,1)),E.t="n");break;case"e":(!f||f.cellText!==!1)&&(E.w=E.v),E.v=DN[E.v];break}if(P=G=0,V=null,X&&k.s!==void 0&&(V=h.CellXf[k.s],V!=null&&(V.numFmtId!=null&&(P=V.numFmtId),f.cellStyles&&V.fillId!=null&&(G=V.fillId))),AC(E,P,G,f,m,h),f.cellDates&&X&&E.t=="n"&&ql(De[P])&&(E.t="d",E.v=gm(E.v)),k.cm&&f.xlmeta){var J=(f.xlmeta.Cell||[])[+k.cm-1];J&&J.type=="XLDAPR"&&(E.D=!0)}if(H){var A=Ot(k.r);u[A.r]||(u[A.r]=[]),u[A.r][A.c]=E}else u[k.r]=E}}}}M.length>0&&(u["!rows"]=M)}}();function ZV(e,t,r,n){var a=[],s=[],i=rt(e["!ref"]),o="",l,u="",f=[],d=0,m=0,h=e["!rows"],v=Array.isArray(e),p={r:u},g,y=-1;for(m=i.s.c;m<=i.e.c;++m)f[m]=Mt(m);for(d=i.s.r;d<=i.e.r;++d){for(s=[],u=Xt(d),m=i.s.c;m<=i.e.c;++m){l=f[m]+u;var w=v?(e[d]||[])[m]:e[l];w!==void 0&&(o=QV(w,l,e,t))!=null&&s.push(o)}(s.length>0||h&&h[d])&&(p={r:u},h&&h[d]&&(g=h[d],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=Fu(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),a[a.length]=ve("row",s.join(""),p))}if(h)for(;d<h.length;++d)h&&h[d]&&(p={r:d+1},g=h[d],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=Fu(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level),a[a.length]=ve("row","",p));return a.join("")}function jC(e,t,r,n){var a=[Kt,ve("worksheet",null,{xmlns:bo[0],"xmlns:r":sr.r})],s=r.SheetNames[e],i=0,o="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",f=rt(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=We(f)}n||(n={}),l["!comments"]=[];var d=[];FV(l,r,e,t,a),a[a.length]=ve("dimension",null,{ref:u}),a[a.length]=qV(l,t,e,r),t.sheetFormat&&(a[a.length]=ve("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=VV(l,l["!cols"])),a[i=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=ZV(l,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),l["!protect"]&&(a[a.length]=UV(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=YV(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=OV(l["!merges"]));var m=-1,h,v=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(p){p[1].Target&&(h={ref:p[0]},p[1].Target.charAt(0)!="#"&&(v=lt(n,-1,ct(p[1].Target).replace(/#.*$/,""),Ye.HLINK),h["r:id"]="rId"+v),(m=p[1].Target.indexOf("#"))>-1&&(h.location=ct(p[1].Target.slice(m+1))),p[1].Tooltip&&(h.tooltip=ct(p[1].Tooltip)),a[a.length]=ve("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=HV(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=wr("ignoredErrors",ve("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(v=lt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ye.DRAW),a[a.length]=ve("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=d),l["!comments"].length>0&&(v=lt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ye.VML),a[a.length]=ve("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function eG(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function tG(e,t,r){var n=ie(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Fu(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,m=-1,h=f<<10;h<f+1<<10;++h){u.c=h;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Re(u)];v&&(d<0&&(d=h),m=h)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,m))}var p=n.l;return n.l=l,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function rG(e,t,r,n){var a=tG(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&fe(e,0,a)}var nG=Co,aG=Zl;function sG(){}function iG(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=cB(e),r}function oG(e,t,r){r==null&&(r=ie(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return hh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),NN(e,r),r.slice(0,r.l)}function lG(e){var t=ra(e);return[t]}function cG(e,t,r){return r==null&&(r=ie(8)),Eo(t,r)}function uG(e){var t=To(e);return[t]}function fG(e,t,r){return r==null&&(r=ie(4)),No(t,r)}function dG(e){var t=ra(e),r=e.read_shift(1);return[t,r,"b"]}function hG(e,t,r){return r==null&&(r=ie(9)),Eo(t,r),r.write_shift(1,e.v?1:0),r}function mG(e){var t=To(e),r=e.read_shift(1);return[t,r,"b"]}function pG(e,t,r){return r==null&&(r=ie(5)),No(t,r),r.write_shift(1,e.v?1:0),r}function gG(e){var t=ra(e),r=e.read_shift(1);return[t,r,"e"]}function vG(e,t,r){return r==null&&(r=ie(9)),Eo(t,r),r.write_shift(1,e.v),r}function yG(e){var t=To(e),r=e.read_shift(1);return[t,r,"e"]}function xG(e,t,r){return r==null&&(r=ie(8)),No(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function wG(e){var t=ra(e),r=e.read_shift(4);return[t,r,"s"]}function _G(e,t,r){return r==null&&(r=ie(12)),Eo(t,r),r.write_shift(4,t.v),r}function SG(e){var t=To(e),r=e.read_shift(4);return[t,r,"s"]}function kG(e,t,r){return r==null&&(r=ie(8)),No(t,r),r.write_shift(4,t.v),r}function bG(e){var t=ra(e),r=Or(e);return[t,r,"n"]}function EG(e,t,r){return r==null&&(r=ie(16)),Eo(t,r),ho(e.v,r),r}function DC(e){var t=To(e),r=Or(e);return[t,r,"n"]}function TG(e,t,r){return r==null&&(r=ie(12)),No(t,r),ho(e.v,r),r}function NG(e){var t=ra(e),r=Hv(e);return[t,r,"n"]}function CG(e,t,r){return r==null&&(r=ie(12)),Eo(t,r),CN(e.v,r),r}function AG(e){var t=To(e),r=Hv(e);return[t,r,"n"]}function PG(e,t,r){return r==null&&(r=ie(8)),No(t,r),CN(e.v,r),r}function jG(e){var t=ra(e),r=Uv(e);return[t,r,"is"]}function DG(e){var t=ra(e),r=Lr(e);return[t,r,"str"]}function RG(e,t,r){return r==null&&(r=ie(12+4*e.v.length)),Eo(t,r),hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function MG(e){var t=To(e),r=Lr(e);return[t,r,"str"]}function OG(e,t,r){return r==null&&(r=ie(8+4*e.v.length)),No(t,r),hr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function IG(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=xm(e,n-e.l,r);i[3]=jr(o,null,a,r.supbooks,r)}else e.l=n;return i}function FG(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=xm(e,n-e.l,r);i[3]=jr(o,null,a,r.supbooks,r)}else e.l=n;return i}function LG(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=Or(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=xm(e,n-e.l,r);i[3]=jr(o,null,a,r.supbooks,r)}else e.l=n;return i}function BG(e,t,r){var n=e.l+t,a=ra(e);a.r=r["!row"];var s=Lr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=xm(e,n-e.l,r);i[3]=jr(o,null,a,r.supbooks,r)}else e.l=n;return i}var UG=Co,$G=Zl;function WG(e,t){return t==null&&(t=ie(4)),t.write_shift(4,e),t}function HG(e,t){var r=e.l+t,n=Co(e),a=$v(e),s=Lr(e),i=Lr(e),o=Lr(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function zG(e,t){var r=ie(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Zl({s:Ot(e[0]),e:Ot(e[0])},r),Wv("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return hr(a||"",r),hr(e[1].Tooltip||"",r),hr("",r),r.slice(0,r.l)}function VG(){}function GG(e,t,r){var n=e.l+t,a=AN(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=gV(e,n-e.l,r);i[1]=o}else e.l=n;return i}function YG(e,t,r){var n=e.l+t,a=Co(e),s=[a];if(r.cellFormula){var i=yV(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function XG(e,t,r){r==null&&(r=ie(18));var n=wm(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var RC=["left","right","top","bottom","header","footer"];function KG(e){var t={};return RC.forEach(function(r){t[r]=Or(e)}),t}function qG(e,t){return t==null&&(t=ie(6*8)),Qi(e),RC.forEach(function(r){ho(e[r],t)}),t}function QG(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function JG(e,t,r){r==null&&(r=ie(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function ZG(e){var t=ie(24);return t.write_shift(4,4),t.write_shift(4,1),Zl(e,t),t}function eY(e,t){return t==null&&(t=ie(16*4+2)),t.write_shift(2,e.password?Kv(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function tY(){}function rY(){}function nY(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,m=!1,h,v,p,g,y,w,x,S,b,E=[];o.biff=12,o["!row"]=0;var k=0,T=!1,N=[],O={},W=o.supbooks||a.supbooks||[[]];if(W.sharedf=O,W.arrayf=N,W.SheetNames=a.SheetNames||a.Sheets.map(function(H){return H.name}),!o.supbooks&&(o.supbooks=W,a.Names))for(var P=0;P<a.Names.length;++P)W[0][P+1]=a.Names[P];var G=[],X=[],V=!1;Lu[16]={n:"BrtShortReal",f:DC};var K;if(As(e,function(M,ne,ce){if(!m)switch(ce){case 148:u=M;break;case 0:h=M,o.sheetRows&&o.sheetRows<=h.r&&(m=!0),S=Xt(g=h.r),o["!row"]=h.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Ol(M.hpt)),X[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:M[2]},M[2]){case"n":v.v=M[1];break;case"s":x=Xc[M[1]],v.v=x.t,v.r=x.r;break;case"b":v.v=!!M[1];break;case"e":v.v=M[1],o.cellText!==!1&&(v.w=Ps[v.v]);break;case"str":v.t="s",v.v=M[1];break;case"is":v.t="s",v.v=M[1].t;break}if((p=i.CellXf[M[0].iStyleRef])&&AC(v,p.numFmtId,null,o,s,i),y=M[0].c==-1?y+1:M[0].c,o.dense?(l[g]||(l[g]=[]),l[g][y]=v):l[Mt(y)+S]=v,o.cellFormula){for(T=!1,k=0;k<N.length;++k){var j=N[k];h.r>=j[0].s.r&&h.r<=j[0].e.r&&y>=j[0].s.c&&y<=j[0].e.c&&(v.F=We(j[0]),T=!0)}!T&&M.length>3&&(v.f=M[3])}if(f.s.r>h.r&&(f.s.r=h.r),f.s.c>y&&(f.s.c=y),f.e.r<h.r&&(f.e.r=h.r),f.e.c<y&&(f.e.c=y),o.cellDates&&p&&v.t=="n"&&ql(De[p.numFmtId])){var z=Li(v.v);z&&(v.t="d",v.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}K&&(K.type=="XLDAPR"&&(v.D=!0),K=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;v={t:"z",v:void 0},y=M[0].c==-1?y+1:M[0].c,o.dense?(l[g]||(l[g]=[]),l[g][y]=v):l[Mt(y)+S]=v,f.s.r>h.r&&(f.s.r=h.r),f.s.c>y&&(f.s.c=y),f.e.r<h.r&&(f.e.r=h.r),f.e.c<y&&(f.e.c=y),K&&(K.type=="XLDAPR"&&(v.D=!0),K=void 0);break;case 176:E.push(M);break;case 49:K=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var L=n["!id"][M.relId];for(L?(M.Target=L.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=L):M.relId==""&&(M.Target="#"+M.loc),g=M.rfx.s.r;g<=M.rfx.e.r;++g)for(y=M.rfx.s.c;y<=M.rfx.e.c;++y)o.dense?(l[g]||(l[g]=[]),l[g][y]||(l[g][y]={t:"z",v:void 0}),l[g][y].l=M):(w=Re({c:y,r:g}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=M);break;case 426:if(!o.cellFormula)break;N.push(M),b=o.dense?l[g][y]:l[Mt(y)+S],b.f=jr(M[1],f,{r:h.r,c:y},W,o),b.F=We(M[0]);break;case 427:if(!o.cellFormula)break;O[Re(M[0].s)]=M[1],b=o.dense?l[g][y]:l[Mt(y)+S],b.f=jr(M[1],f,{r:h.r,c:y},W,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)G[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},V||(V=!0,qv(M.w/256)),pi(G[M.e+1]);break;case 161:l["!autofilter"]={ref:We(M)};break;case 476:l["!margins"]=M;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),M.name&&(a.Sheets[r].CodeName=M.name),(M.above||M.left)&&(l["!outline"]={above:M.above,left:M.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),M.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ne.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+ce.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=We(u||f)),o.sheetRows&&l["!ref"]){var Y=rt(l["!ref"]);o.sheetRows<=+Y.e.r&&(Y.e.r=o.sheetRows-1,Y.e.r>f.e.r&&(Y.e.r=f.e.r),Y.e.r<Y.s.r&&(Y.s.r=Y.e.r),Y.e.c>f.e.c&&(Y.e.c=f.e.c),Y.e.c<Y.s.c&&(Y.s.c=Y.e.c),l["!fullref"]=l["!ref"],l["!ref"]=We(Y))}return E.length>0&&(l["!merges"]=E),G.length>0&&(l["!cols"]=G),X.length>0&&(l["!rows"]=X),l}function aY(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Nt(t),t.z=t.z||De[14],t.v=or(Tt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Ci(a.cellXfs,t,a),t.l&&s["!links"].push([Re(l),t.l]),t.c&&s["!comments"].push([Re(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=ty(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,i?fe(e,18,kG(t,l)):fe(e,7,_G(t,l))):(l.t="str",i?fe(e,17,OG(t,l)):fe(e,6,RG(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?fe(e,13,PG(t,l)):fe(e,2,CG(t,l)):i?fe(e,16,TG(t,l)):fe(e,5,EG(t,l)),!0;case"b":return l.t="b",i?fe(e,15,pG(t,l)):fe(e,4,hG(t,l)),!0;case"e":return l.t="e",i?fe(e,14,xG(t,l)):fe(e,3,vG(t,l)),!0}return i?fe(e,12,fG(t,l)):fe(e,1,cG(t,l)),!0}function sY(e,t,r,n){var a=rt(t["!ref"]||"A1"),s,i="",o=[];fe(e,145);var l=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){i=Xt(f),rG(e,t,a,f);var d=!1;if(f<=a.e.r)for(var m=a.s.c;m<=a.e.c;++m){f===a.s.r&&(o[m]=Mt(m)),s=o[m]+i;var h=l?(t[f]||[])[m]:t[s];if(!h){d=!1;continue}d=aY(e,h,f,m,n,t,d)}}fe(e,146)}function iY(e,t){!t||!t["!merges"]||(fe(e,177,WG(t["!merges"].length)),t["!merges"].forEach(function(r){fe(e,176,$G(r))}),fe(e,178))}function oY(e,t){!t||!t["!cols"]||(fe(e,390),t["!cols"].forEach(function(r,n){r&&fe(e,60,XG(n,r))}),fe(e,391))}function lY(e,t){!t||!t["!ref"]||(fe(e,648),fe(e,649,ZG(rt(t["!ref"]))),fe(e,650))}function cY(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=lt(r,-1,n[1].Target.replace(/#.*$/,""),Ye.HLINK);fe(e,494,zG(n,a))}}),delete t["!links"]}function uY(e,t,r,n){if(t["!comments"].length>0){var a=lt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ye.VML);fe(e,551,Wv("rId"+a)),t["!legacy"]=a}}function fY(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:We(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=gn(s);o.s.r==o.e.r&&(o.e.r=gn(t["!ref"]).e.r,s=We(o));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fe(e,161,Zl(rt(s))),fe(e,162)}}function dY(e,t,r){fe(e,133),fe(e,137,JG(t,r)),fe(e,138),fe(e,134)}function hY(e,t){t["!protect"]&&fe(e,535,eY(t["!protect"]))}function mY(e,t,r,n){var a=dn(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=rt(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],fe(a,129),(r.vbaraw||i["!outline"])&&fe(a,147,oG(o,i["!outline"])),fe(a,148,aG(l)),dY(a,i,r.Workbook),oY(a,i),sY(a,i,e,t),hY(a,i),fY(a,i,r,e),iY(a,i),cY(a,i,n),i["!margins"]&&fe(a,476,qG(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&lY(a,i),uY(a,i,e,n),fe(a,130),a.end()}function pY(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=et((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function gY(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var m=pY(d);f.s.r=f.s.c=0,f.e.c=o,u=Mt(o),m[0].forEach(function(h,v){i[u+Xt(v)]={t:"n",v:h,z:m[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=We(f)),i}function vY(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(PC);return o&&ry(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function yY(e,t){e.l+=10;var r=Lr(e);return{name:r}}function xY(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return As(e,function(l,u,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ny=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],wY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],_Y=[],SY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function C2(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=kt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function A2(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=kt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function MC(e){A2(e.WBProps,ny),A2(e.CalcPr,SY),C2(e.WBView,wY),C2(e.Sheets,_Y),dl.date1904=kt(e.WBProps.date1904)}function kY(e){return!e.Workbook||!e.Workbook.WBProps?"false":kt(e.Workbook.WBProps.date1904)?"true":"false"}var bY="][*?/\\".split("");function OC(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return bY.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function EY(e,t,r){e.forEach(function(n,a){OC(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function TY(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];EY(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)kV(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var NY=/<\w+:workbook/;function CY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace($r,function(l,u){var f=Ie(l);switch(Ja(f[0])){case"<?xml":break;case"<workbook":l.match(NY)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ny.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=kt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=dt(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=et(dt(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=dt(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),kt(f.hidden||"0")&&(s.Hidden=!0),i=u+l.length;break;case"</definedName>":s.Ref=et(dt(e.slice(i,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),bo.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return MC(r),r}function IC(e){var t=[Kt];t[t.length]=ve("workbook",null,{xmlns:bo[0],"xmlns:r":sr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ny.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ve("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:ct(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ve("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=ve("definedName",ct(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function AY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=lg(e),r.name=Lr(e),r}function PY(e,t){return t||(t=ie(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Wv(e.strRelID,t),hr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function jY(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Lr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function DY(e,t){t||(t=ie(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),NN(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function RY(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function MY(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=uB(e),i=vV(e,0,r),o=$v(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function OY(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Lu[16]={n:"BrtFRTArchID$",f:RY},As(e,function(l,u,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=jr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),MC(r),r.Names=s,r.supbooks=i,r}function IY(e,t){fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};fe(e,156,PY(a))}fe(e,144)}function FY(e,t){t||(t=ie(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return hr("SheetJS",t),hr(ih.version,t),hr(ih.version,t),hr("7262",t),t.length>t.l?t.slice(0,t.l):t}function LY(e,t){t||(t=ie(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function BY(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(fe(e,135),fe(e,158,LY(a)),fe(e,136))}}function UY(e,t){var r=dn();return fe(r,131),fe(r,128,FY()),fe(r,153,DY(e.Workbook&&e.Workbook.WBProps||null)),BY(r,e),IY(r,e),fe(r,132),r.end()}function $Y(e,t,r){return t.slice(-4)===".bin"?OY(e,r):CY(e,r)}function WY(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?nY(e,n,r,a,s,i,o):MV(e,n,r,a,s,i,o)}function HY(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?xY(e,n,r,a,s):vY(e,n,r,a,s)}function zY(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?GH():YH()}function VY(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?zH():VH()}function GY(e,t,r,n){return t.slice(-4)===".bin"?$W(e,r,n):AW(e,r,n)}function YY(e,t,r){return gC(e,r)}function XY(e,t,r){return t.slice(-4)===".bin"?X$(e,r):V$(e,r)}function KY(e,t,r){return t.slice(-4)===".bin"?BH(e,r):PH(e,r)}function qY(e,t,r){return t.slice(-4)===".bin"?NH(e):EH(e)}function QY(e,t,r,n){return r.slice(-4)===".bin"?CH(e,t,r,n):void 0}function JY(e,t,r){return t.slice(-4)===".bin"?SH(e,t,r):bH(e,t,r)}function ZY(e,t,r){return(t.slice(-4)===".bin"?UY:IC)(e)}function eX(e,t,r,n,a){return(t.slice(-4)===".bin"?mY:jC)(e,r,n,a)}function tX(e,t,r){return(t.slice(-4)===".bin"?QW:mC)(e,r)}function rX(e,t,r){return(t.slice(-4)===".bin"?Q$:iC)(e,r)}function nX(e,t,r){return(t.slice(-4)===".bin"?UH:xC)(e)}function aX(e){return(e.slice(-4)===".bin"?kH:vC)()}var FC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ia(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(FC),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(LC),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function sX(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(FC),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(LC),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var qc;function iX(e,t){var r=qc[e]||et(e);return r==="General"?uo(t):ta(r,t)}function oX(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=kt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Tt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[et(t)]=a}function lX(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Ps[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v):e.w=uo(e.v):e.w=iX(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=qc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ql(n)){var a=Li(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function cX(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=_W[n.Pattern]||n.Pattern)}e[t.ID]=t}function uX(e,t,r,n,a,s,i,o,l,u){var f="General",d=n.StyleID,m={};u=u||{};var h=[],v=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&h.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=kt(e);break;case"String":n.t="s",n.r=Gw(et(e)),n.v=e.indexOf("<")>-1?et(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Tt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=et(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=DN[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Gw(t||e));break}if(lX(n,f,u),u.cellFormula!==!1)if(n.Formula){var p=et(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=fl(p,a),delete n.Formula,n.ArrayRange=="RC"?n.F=fl("RC:RC",a):n.ArrayRange&&(n.F=fl(n.ArrayRange,a),l.push([rt(n.F),n.F]))}else for(v=0;v<l.length;++v)a.r>=l[v][0].s.r&&a.r<=l[v][0].e.r&&a.c>=l[v][0].s.c&&a.c<=l[v][0].e.c&&(n.F=l[v][1]);u.cellStyles&&(h.forEach(function(g){!m.patternType&&g.patternType&&(m.patternType=g.patternType)}),n.s=m),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fX(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Op(e,t){var r=t||{};Ql();var n=Pc(Ov(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=dt(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=Nt(r);return i.type="string",Ml.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ht){a.indexOf("<"+ht)>=0&&(s=!0)}),s)return qX(n,r);qc={"General Number":"General","General Date":De[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":De[15],"Short Date":De[14],"Long Time":De[19],"Medium Time":De[18],"Short Time":De[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:De[2],Standard:De[4],Percent:De[10],Scientific:De[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},d=[],m=r.dense?[]:{},h="",v={},p={},g=ia('<Data ss:Type="String">'),y=0,w=0,x=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},E={},k="",T=0,N=[],O={},W={},P=0,G=[],X=[],V={},K=[],Y,H=!1,M=[],ne=[],ce={},j=0,z=0,L={Sheets:[],WBProps:{date1904:!1}},U={};Du.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";o=Du.exec(n);)switch(o[3]=(Q=o[3]).toLowerCase()){case"data":if(Q=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?uX(n.slice(y,o.index),k,g,l[l.length-1][0]=="comment"?V:v,{c:w,r:x},b,K[w],p,M,r):(k="",g=ia(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(X.length>0&&(v.c=X),(!r.sheetRows||r.sheetRows>x)&&v.v!==void 0&&(r.dense?(m[x]||(m[x]=[]),m[x][w]=v):m[Mt(w)+Xt(x)]=v),v.HRef&&(v.l={Target:et(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(j=w+(parseInt(v.MergeAcross,10)|0),z=x+(parseInt(v.MergeDown,10)|0),N.push({s:{c:w,r:x},e:{c:j,r:z}})),!r.sheetStubs)v.MergeAcross?w=j+1:++w;else if(v.MergeAcross||v.MergeDown){for(var q=w;q<=j;++q)for(var ae=x;ae<=z;++ae)(q>w||ae>x)&&(r.dense?(m[ae]||(m[ae]=[]),m[ae][q]={t:"z"}):m[Mt(q)+Xt(ae)]={t:"z"});w=j+1}else++w;else v=sX(o[0]),v.Index&&(w=+v.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),o[0].slice(-2)==="/>"&&++w,X=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<S.s.r&&(S.s.r=x),x>S.e.r&&(S.e.r=x),o[0].slice(-2)==="/>"&&(p=ia(o[0]),p.Index&&(x=+p.Index-1)),w=0,++x):(p=ia(o[0]),p.Index&&(x=+p.Index-1),ce={},(p.AutoFitHeight=="0"||p.Height)&&(ce.hpx=parseInt(p.Height,10),ce.hpt=Fu(ce.hpx),ne[x]=ce),p.Hidden=="1"&&(ce.hidden=!0,ne[x]=ce));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(h),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(m["!ref"]=We(S),r.sheetRows&&r.sheetRows<=S.e.r&&(m["!fullref"]=m["!ref"],S.e.r=r.sheetRows-1,m["!ref"]=We(S))),N.length&&(m["!merges"]=N),K.length>0&&(m["!cols"]=K),ne.length>0&&(m["!rows"]=ne),f[h]=m}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=w=0,l.push([o[3],!1]),u=ia(o[0]),h=et(u.Name),m=r.dense?[]:{},N=[],M=[],ne=[],U={name:h,Hidden:0},L.Sheets.push(U);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),K=[],H=!1}break;case"style":o[1]==="/"?cX(b,E,r):E=ia(o[0]);break;case"numberformat":E.nf=et(ia(o[0]).Format||"General"),qc[E.nf]&&(E.nf=qc[E.nf]);for(var oe=0;oe!=392&&De[oe]!=E.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if(De[oe]==null){gs(E.nf,oe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Y=ia(o[0]),Y.Hidden&&(Y.hidden=!0,delete Y.Hidden),Y.Width&&(Y.wpx=parseInt(Y.Width,10)),!H&&Y.wpx>10){H=!0,Rr=dC;for(var se=0;se<K.length;++se)K[se]&&pi(K[se])}H&&pi(Y),K[Y.Index-1||K.length]=Y;for(var J=0;J<+Y.Span;++J)K[K.length]=Nt(Y);break;case"namedrange":if(o[1]==="/")break;L.Names||(L.Names=[]);var A=Ie(o[0]),pe={Name:A.Name,Ref:fl(A.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(pe.Sheet=L.Sheets.length-1),L.Names.push(pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=ia(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?OB(O,Q,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));fX(V),X.push(V)}else l.push([o[3],!1]),u=ia(o[0]),V={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ne=ia(o[0]);m["!autofilter"]={ref:fl(Ne.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return M2(n,r);var $e=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:$e=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:$e=!1}break;case"excelworkbook":switch(o[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:$e=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:$e=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else P=o.index+o[0].length;break;case"header":m["!margins"]||Qi(m["!margins"]={},"xlml"),isNaN(+Ie(o[0]).Margin)||(m["!margins"].header=+Ie(o[0]).Margin);break;case"footer":m["!margins"]||Qi(m["!margins"]={},"xlml"),isNaN(+Ie(o[0]).Margin)||(m["!margins"].footer=+Ie(o[0]).Margin);break;case"pagemargins":var Me=Ie(o[0]);m["!margins"]||Qi(m["!margins"]={},"xlml"),isNaN(+Me.Top)||(m["!margins"].top=+Me.Top),isNaN(+Me.Left)||(m["!margins"].left=+Me.Left),isNaN(+Me.Right)||(m["!margins"].right=+Me.Right),isNaN(+Me.Bottom)||(m["!margins"].bottom=+Me.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":m["!outline"]||(m["!outline"]={}),m["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:$e=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:$e=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:$e=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:$e=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:$e=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:$e=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:$e=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:$e=!1}break;case"smarttags":break;default:$e=!1;break}if($e||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?oX(W,Q,G,n.slice(P,o.index)):(G=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=f),xe.SheetNames=d,xe.Workbook=L,xe.SSF=Nt(De),xe.Props=O,xe.Custprops=W,xe}function pg(e,t){switch(sy(t=t||{}),t.type||"base64"){case"base64":return Op(Rn(e),t);case"binary":case"buffer":case"file":return Op(e,t);case"array":return Op(Ti(e),t)}}function dX(e,t){var r=[];return e.Props&&r.push(IB(e.Props,t)),e.Custprops&&r.push(FB(e.Props,e.Custprops)),r.join("")}function hX(){return""}function mX(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(ve("NumberFormat",null,{"ss:Format":ct(De[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(ve("Style",s.join(""),i))}),ve("Styles",r.join(""))}function BC(e){return ve("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Zv(e.Ref,{r:0,c:0})})}function pX(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(BC(a)))}return ve("Names",r.join(""))}function gX(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(BC(o)))}return s.join("")}function vX(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(ve("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(ve("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(ve("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(wr("ProtectContents","True")),e["!protect"].objects&&a.push(wr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(wr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(wr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(wr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":ve("WorksheetOptions",a.join(""),{xmlns:kn.x})}function yX(e){return e.map(function(t){var r=B9(t.t||""),n=ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ve("Comment",n,{"ss:Author":t.a})}).join("")}function xX(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ct(Zv(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var l=Ot(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ct(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ct(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=i.c||u[f].s.r!=i.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",m="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",m=String(e.v);break;case"b":d="Boolean",m=e.v?"1":"0";break;case"e":d="Error",m=Ps[e.v];break;case"d":d="DateTime",m=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||De[14]);break;case"s":d="String",m=L9(e.v||"");break}var h=Ci(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=i.c+1;var v=e.v!=null?m:"",p=e.t=="z"?"":'<Data ss:Type="'+d+'">'+v+"</Data>";return(e.c||[]).length>0&&(p+=yX(e.c)),ve("Cell",p,o)}function wX(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ol(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function _X(e,t,r,n){if(!e["!ref"])return"";var a=rt(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,y){pi(g);var w=!!g.width,x=wm(y,g),S={"ss:Index":y+1};w&&(S["ss:Width"]=Ou(x.width)),g.hidden&&(S["ss:Hidden"]="1"),o.push(ve("Column",null,S))});for(var l=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[wX(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var m=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>d)&&!(s[i].s.r>u)&&!(s[i].e.c<d)&&!(s[i].e.r<u)){(s[i].s.c!=d||s[i].s.r!=u)&&(m=!0);break}if(!m){var h={r:u,c:d},v=Re(h),p=l?(e[u]||[])[d]:e[v];f.push(xX(p,v,e,t,r,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function SX(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?gX(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?_X(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(vX(s,t,e,r)),n.join("")}function kX(e,t){t||(t={}),e.SSF||(e.SSF=Nt(De)),e.SSF&&(Ql(),hm(e.SSF),t.revssf=pm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ci(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(dX(e,t)),r.push(hX()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ve("Worksheet",SX(n,t,e),{"ss:Name":ct(e.SheetNames[n])}));return r[2]=mX(e,t),r[3]=pX(e),Kt+ve("Workbook",r.join(""),{xmlns:kn.ss,"xmlns:o":kn.o,"xmlns:x":kn.x,"xmlns:ss":kn.ss,"xmlns:dt":kn.dt,"xmlns:html":kn.html})}function bX(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=pB(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=gB(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var EX=[60,1084,2066,2165,2175];function TX(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=ds(r,r.l),u=gg[l],f=0;u!=null&&EX.indexOf(l)>-1;)s=ds(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,u=gg[l=ds(r,r.l)];var d=dr(i);xr(d,0);var m=0;d.lens=[];for(var h=0;h<i.length;++h)d.lens.push(m),m+=i[h].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function Da(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=De[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ps[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Au(e.v):e.w=uo(e.v):e.w=ta(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ql(De[n]||String(n))){var a=Li(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function ad(e,t,r){return{v:e,ixfe:t,t:r}}function NX(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],u="",f={},d,m="",h,v,p,g,y={},w=[],x,S,b=[],E=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},N=function(Le){return Le<8?Xi[Le]:Le<64&&E[Le-8]||Xi[Le]},O=function(Le,At,zr){var Pt=At.XF.data;if(!(!Pt||!Pt.patternType||!zr||!zr.cellStyles)){At.s={},At.s.patternType=Pt.patternType;var rn;(rn=Mu(N(Pt.icvFore)))&&(At.s.fgColor={rgb:rn}),(rn=Mu(N(Pt.icvBack)))&&(At.s.bgColor={rgb:rn})}},W=function(Le,At,zr){if(!(ce>1)&&!(zr.sheetRows&&Le.r>=zr.sheetRows)){if(zr.cellStyles&&At.XF&&At.XF.data&&O(Le,At,zr),delete At.ixfe,delete At.XF,d=Le,m=Re(Le),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Le.r<i.s.r&&(i.s.r=Le.r),Le.c<i.s.c&&(i.s.c=Le.c),Le.r+1>i.e.r&&(i.e.r=Le.r+1),Le.c+1>i.e.c&&(i.e.c=Le.c+1),zr.cellFormula&&At.f){for(var Pt=0;Pt<w.length;++Pt)if(!(w[Pt][0].s.c>Le.c||w[Pt][0].s.r>Le.r)&&!(w[Pt][0].e.c<Le.c||w[Pt][0].e.r<Le.r)){At.F=We(w[Pt][0]),(w[Pt][0].s.c!=Le.c||w[Pt][0].s.r!=Le.r)&&delete At.f,At.f&&(At.f=""+jr(w[Pt][1],i,Le,M,P));break}}zr.dense?(a[Le.r]||(a[Le.r]=[]),a[Le.r][Le.c]=At):a[m]=At}},P={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var G,X=[],V=[],K=[],Y=[],H=!1,M=[];M.SheetNames=P.snames,M.sharedf=P.sharedf,M.arrayf=P.arrayf,M.names=[],M.XTI=[];var ne=0,ce=0,j=0,z=[],L=[],U;P.codepage=1200,pa(1200);for(var Q=!1;e.l<e.length-1;){var q=e.l,ae=e.read_shift(2);if(ae===0&&ne===10)break;var oe=e.l===e.length?0:e.read_shift(2),se=gg[ae];if(se&&se.f){if(t.bookSheets&&ne===133&&ae!==133)break;if(ne=ae,se.r===2||se.r==12){var J=e.read_shift(2);if(oe-=2,!P.enc&&J!==ae&&((J&255)<<8|J>>8)!==ae)throw new Error("rt mismatch: "+J+"!="+ae);se.r==12&&(e.l+=10,oe-=10)}var A={};if(ae===10?A=se.f(e,oe,P):A=TX(ae,se,e,oe,P),ce==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(ae){case 34:r.opts.Date1904=k.WBProps.date1904=A;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=A,!t.password)throw new Error("File is password-protected");if(A.valid==null)throw new Error("Encryption scheme unsupported");if(!A.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=A;break;case 66:var pe=Number(A);switch(pe){case 21010:pe=1200;break;case 32768:pe=1e4;break;case 32769:pe=1252;break}pa(P.codepage=pe),Q=!0;break;case 317:P.rrtabid=A;break;case 25:P.winlocked=A;break;case 439:r.opts.RefreshAll=A;break;case 12:r.opts.CalcCount=A;break;case 16:r.opts.CalcDelta=A;break;case 17:r.opts.CalcIter=A;break;case 13:r.opts.CalcMode=A;break;case 14:r.opts.CalcPrecision=A;break;case 95:r.opts.CalcSaveRecalc=A;break;case 15:P.CalcRefMode=A;break;case 2211:r.opts.FullCalc=A;break;case 129:A.fDialog&&(a["!type"]="dialog"),A.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),A.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:b.push(A);break;case 430:M.push([A]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(A);break;case 24:case 536:U={Name:A.Name,Ref:jr(A.rgce,i,null,M,P)},A.itab>0&&(U.Sheet=A.itab-1),M.names.push(U),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(A),A.Name=="_xlnm._FilterDatabase"&&A.itab>0&&A.rgce&&A.rgce[0]&&A.rgce[0][0]&&A.rgce[0][0][0]=="PtgArea3d"&&(L[A.itab-1]={ref:We(A.rgce[0][0][1][2])});break;case 22:P.ExternCount=A;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(A),M.XTI=M.XTI.concat(A);break;case 2196:if(P.biff<8)break;U!=null&&(U.Comment=A[1]);break;case 18:a["!protect"]=A;break;case 19:A!==0&&P.WTF&&console.error("Password verifier: "+A);break;case 133:s[A.pos]=A,P.snames.push(A.name);break;case 10:{if(--ce)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=We(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ne=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=We(i),i.e.r=Ne}i.e.r++,i.e.c++}X.length>0&&(a["!merges"]=X),V.length>0&&(a["!objects"]=V),K.length>0&&(a["!cols"]=K),Y.length>0&&(a["!rows"]=Y),k.Sheets.push(T)}u===""?f=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[A.BIFFVer]||8),P.biffguess=A.BIFFVer==0,A.BIFFVer==0&&A.dt==4096&&(P.biff=5,Q=!0,pa(P.codepage=28591)),P.biff==8&&A.BIFFVer==0&&A.dt==16&&(P.biff=2),ce++)break;if(a=t.dense?[]:{},P.biff<8&&!Q&&(Q=!0,pa(P.codepage=t.codepage||1252)),P.biff<5||A.BIFFVer==0&&A.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var $e={pos:e.l-oe,name:u};s[$e.pos]=$e,P.snames.push(u)}else u=(s[q]||{name:""}).name;A.dt==32&&(a["!type"]="chart"),A.dt==64&&(a["!type"]="macro"),X=[],V=[],P.arrayf=w=[],K=[],Y=[],H=!1,T={Hidden:(s[q]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[A.r]||[])[A.c]:a[Re({c:A.c,r:A.r})])&&++A.c,x={ixfe:A.ixfe,XF:b[A.ixfe]||{},v:A.val,t:"n"},j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:A.c,r:A.r},x,t);break;case 5:case 517:x={ixfe:A.ixfe,XF:b[A.ixfe],v:A.val,t:A.t},j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:A.c,r:A.r},x,t);break;case 638:x={ixfe:A.ixfe,XF:b[A.ixfe],v:A.rknum,t:"n"},j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:A.c,r:A.r},x,t);break;case 189:for(var Me=A.c;Me<=A.C;++Me){var xe=A.rkrec[Me-A.c][0];x={ixfe:xe,XF:b[xe],v:A.rkrec[Me-A.c][1],t:"n"},j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:Me,r:A.r},x,t)}break;case 6:case 518:case 1030:{if(A.val=="String"){o=A;break}if(x=ad(A.val,A.cell.ixfe,A.tt),x.XF=b[x.ixfe],t.cellFormula){var ht=A.formula;if(ht&&ht[0]&&ht[0][0]&&ht[0][0][0]=="PtgExp"){var nr=ht[0][0][1][0],vn=ht[0][0][1][1],Wr=Re({r:nr,c:vn});y[Wr]?x.f=""+jr(A.formula,i,A.cell,M,P):x.F=((t.dense?(a[nr]||[])[vn]:a[Wr])||{}).F}else x.f=""+jr(A.formula,i,A.cell,M,P)}j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W(A.cell,x,t),o=A}break;case 7:case 519:if(o)o.val=A,x=ad(A,o.cell.ixfe,"s"),x.XF=b[x.ixfe],t.cellFormula&&(x.f=""+jr(o.formula,i,o.cell,M,P)),j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(A);var js=Re(A[0].s);if(h=t.dense?(a[A[0].s.r]||[])[A[0].s.c]:a[js],t.cellFormula&&h){if(!o||!js||!h)break;h.f=""+jr(A[1],i,A[0],M,P),h.F=We(A[0])}}break;case 1212:{if(!t.cellFormula)break;if(m){if(!o)break;y[Re(o.cell)]=A[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Re(o.cell)],(h||{}).f=""+jr(A[0],i,d,M,P)}}break;case 253:x=ad(l[A.isst].t,A.ixfe,"s"),l[A.isst].h&&(x.h=l[A.isst].h),x.XF=b[x.ixfe],j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:A.c,r:A.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:A.ixfe,XF:b[A.ixfe],t:"z"},j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:A.c,r:A.r},x,t));break;case 190:if(t.sheetStubs)for(var kr=A.c;kr<=A.C;++kr){var Hr=A.ixfe[kr-A.c];x={ixfe:Hr,XF:b[Hr],t:"z"},j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:kr,r:A.r},x,t)}break;case 214:case 516:case 4:x=ad(A.val,A.ixfe,"s"),x.XF=b[x.ixfe],j>0&&(x.z=z[x.ixfe>>8&63]),Da(x,t,r.opts.Date1904),W({c:A.c,r:A.r},x,t);break;case 0:case 512:ce===1&&(i=A);break;case 252:l=A;break;case 1054:if(P.biff==4){z[j++]=A[1];for(var na=0;na<j+163&&De[na]!=A[1];++na);na>=163&&gs(A[1],j+163)}else gs(A[1],A[0]);break;case 30:{z[j++]=A;for(var zt=0;zt<j+163&&De[zt]!=A;++zt);zt>=163&&gs(A,j+163)}break;case 229:X=X.concat(A);break;case 93:V[A.cmo[0]]=P.lastobj=A;break;case 438:P.lastobj.TxO=A;break;case 127:P.lastobj.ImData=A;break;case 440:for(g=A[0].s.r;g<=A[0].e.r;++g)for(p=A[0].s.c;p<=A[0].e.c;++p)h=t.dense?(a[g]||[])[p]:a[Re({c:p,r:g})],h&&(h.l=A[1]);break;case 2048:for(g=A[0].s.r;g<=A[0].e.r;++g)for(p=A[0].s.c;p<=A[0].e.c;++p)h=t.dense?(a[g]||[])[p]:a[Re({c:p,r:g})],h&&h.l&&(h.l.Tooltip=A[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=t.dense?(a[A[0].r]||[])[A[0].c]:a[Re(A[0])];var Fn=V[A[2]];h||(t.dense?(a[A[0].r]||(a[A[0].r]=[]),h=a[A[0].r][A[0].c]={t:"z"}):h=a[Re(A[0])]={t:"z"},i.e.r=Math.max(i.e.r,A[0].r),i.s.r=Math.min(i.s.r,A[0].r),i.e.c=Math.max(i.e.c,A[0].c),i.s.c=Math.min(i.s.c,A[0].c)),h.c||(h.c=[]),v={a:A[1],t:Fn.TxO.t},h.c.push(v)}break;case 2173:mH(b[A.ixfe],A.ext);break;case 125:{if(!P.cellStyles)break;for(;A.e>=A.s;)K[A.e--]={width:A.w/256,level:A.level||0,hidden:!!(A.flags&1)},H||(H=!0,qv(A.w/256)),pi(K[A.e+1])}break;case 520:{var gr={};A.level!=null&&(Y[A.r]=gr,gr.level=A.level),A.hidden&&(Y[A.r]=gr,gr.hidden=!0),A.hpt&&(Y[A.r]=gr,gr.hpt=A.hpt,gr.hpx=Ol(A.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Qi(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ae]]=A;break;case 161:a["!margins"]||Qi(a["!margins"]={}),a["!margins"].header=A.header,a["!margins"].footer=A.footer;break;case 574:A.RTL&&(k.Views[0].RTL=!0);break;case 146:E=A;break;case 2198:G=A;break;case 140:S=A;break;case 442:u?T.CodeName=A||T.name:k.WBProps.CodeName=A||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+ae.toString(16)),e.l+=oe}return r.SheetNames=Wt(s).sort(function(Ln,Le){return Number(Ln)-Number(Le)}).map(function(Ln){return s[Ln].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&L.forEach(function(Ln,Le){r.Sheets[r.SheetNames[Le]]["!autofilter"]=Ln}),r.Strings=l,r.SSF=Nt(De),P.enc&&(r.Encryption=P.enc),G&&(r.Themes=G),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),M.names.length>0&&(k.Names=M.names),r.Workbook=k,r}var Qc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function CX(e,t,r){var n=Ce.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=u2(n,cg,Qc.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var i=Ce.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=u2(i,ug,Qc.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(LN(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function AX(e,t){var r=[],n=[],a=[],s=0,i,o=Uw(cg,"n"),l=Uw(ug,"n");if(e.Props)for(i=Wt(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Wt(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var u=[];for(s=0;s<a.length;++s)VN.indexOf(a[s][0])>-1||FN.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&Ce.utils.cfb_add(t,"/SummaryInformation",f2(n,Qc.SI,l,ug)),(r.length||u.length)&&Ce.utils.cfb_add(t,"/DocumentSummaryInformation",f2(r,Qc.DSI,o,cg,u.length?u:null,Qc.UDI))}function UC(e,t){t||(t={}),sy(t),Tv(),t.codepage&&Ev(t.codepage);var r,n;if(e.FullPaths){if(Ce.find(e,"/encryption"))throw new Error("File is password-protected");r=Ce.find(e,"!CompObj"),n=Ce.find(e,"/Workbook")||Ce.find(e,"/Book")}else{switch(t.type){case"base64":e=En(Rn(e));break;case"binary":e=En(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}xr(e,0),n={content:e}}var a,s;if(r&&bX(r),t.bookProps&&!t.bookSheets)a={};else{var i=Ge?"buffer":"array";if(n&&n.content)a=NX(n.content,t);else if((s=Ce.find(e,"PerfectOffice_MAIN"))&&s.content)a=qi.to_workbook(s.content,(t.type=i,t));else if((s=Ce.find(e,"NativeContent_MAIN"))&&s.content)a=qi.to_workbook(s.content,(t.type=i,t));else throw(s=Ce.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ce.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=WH(e))}var o={};return e.FullPaths&&CX(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function PX(e,t){var r=t||{},n=Ce.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ce.utils.cfb_add(n,a,$C(e,r)),r.biff==8&&(e.Props||e.Custprops)&&AX(e,n),r.biff==8&&e.vbaraw&&HH(n,Ce.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Lu={0:{f:eG},1:{f:lG},2:{f:NG},3:{f:gG},4:{f:dG},5:{f:bG},6:{f:DG},7:{f:wG},8:{f:BG},9:{f:LG},10:{f:IG},11:{f:FG},12:{f:uG},13:{f:AG},14:{f:yG},15:{f:mG},16:{f:DC},17:{f:MG},18:{f:SG},19:{f:Uv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:MY},40:{},42:{},43:{f:DW},44:{f:PW},45:{f:OW},46:{f:FW},47:{f:IW},48:{},49:{f:nB},50:{},51:{f:vH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rC},62:{f:jG},63:{f:TH},64:{f:tY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ur,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:QG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:iG},148:{f:nG,p:16},151:{f:VG},152:{},153:{f:jY},154:{},155:{},156:{f:AY},157:{},158:{},159:{T:1,f:Y$},160:{T:-1},161:{T:1,f:Co},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:UG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:pH},336:{T:-1},337:{f:wH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:lg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:GG},427:{f:YG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:KG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:sG},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:HG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:lg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FH},633:{T:1},634:{T:-1},635:{T:1,f:OH},636:{T:-1},637:{f:oB},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},gg={6:{f:Rp},10:{f:Ls},12:{f:Zt},13:{f:Zt},14:{f:Vt},15:{f:Vt},16:{f:Or},17:{f:Vt},18:{f:Vt},19:{f:Zt},20:{f:v2},21:{f:v2},23:{f:tC},24:{f:x2},25:{f:Vt},26:{},27:{},28:{f:r$},29:{},34:{f:Vt},35:{f:y2},38:{f:Or},39:{f:Or},40:{f:Or},41:{f:Or},42:{f:Vt},43:{f:Vt},47:{f:mW},49:{f:AU},51:{f:Zt},60:{},61:{f:bU},64:{f:Vt},65:{f:CU},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:hU},93:{f:s$},94:{},95:{f:Vt},96:{},97:{},99:{f:Vt},125:{f:rC},128:{f:zU},129:{f:pU},130:{f:Zt},131:{f:Vt},132:{f:Vt},133:{f:gU},134:{},140:{f:h$},141:{f:Zt},144:{},146:{f:g$},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:k$},161:{f:x$},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UU},190:{f:$U},193:{f:Ls},197:{},198:{},199:{},200:{},201:{},202:{f:Vt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:Vt},222:{},224:{f:HU},225:{f:dU},226:{f:Ls},227:{},229:{f:n$},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:yU},253:{f:jU},255:{f:wU},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:GN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Vt},353:{f:Ls},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:KU},431:{f:Vt},432:{},433:{},434:{},437:{},438:{f:l$},439:{f:Vt},440:{f:c$},441:{},442:{f:mf},443:{},444:{f:Zt},445:{},446:{},448:{f:Ls},449:{f:kU,r:2},450:{f:Ls},512:{f:m2},513:{f:S$},515:{f:YU},516:{f:RU},517:{f:g2},519:{f:b$},520:{f:_U},523:{},545:{f:w2},549:{f:h2},566:{},574:{f:TU},638:{f:BU},659:{},1048:{},1054:{f:OU},1084:{},1212:{f:ZU},2048:{f:f$},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:td},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ls},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:v$,r:12},2173:{f:hH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Vt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:JU,r:12},2197:{},2198:{f:oH,r:12},2199:{},2200:{},2201:{},2202:{f:e$,r:12},2203:{f:Ls},2204:{},2205:{},2206:{},2207:{},2211:{f:SU},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:w$},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:p$},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:m2},1:{},2:{f:A$},3:{f:N$},4:{f:T$},5:{f:g2},7:{f:j$},8:{},9:{f:td},11:{},22:{f:Zt},30:{f:FU},31:{},32:{},33:{f:w2},36:{},37:{f:h2},50:{f:D$},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:E$},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:R$},223:{},234:{},354:{},421:{},518:{f:Rp},521:{f:td},536:{f:x2},547:{f:y2},561:{},579:{},1030:{f:Rp},1033:{f:td},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ye(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Fv(r)&&e.push(r)}}function jX(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return ye(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,l=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,s),f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function yf(e,t,r){return e||(e=ie(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function DX(e,t,r,n){var a=ie(9);return yf(a,e,t),YN(r,n||"b",a),a}function RX(e,t,r){var n=ie(8+2*r.length);return yf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function MX(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?or(Tt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?ye(e,2,P$(r,n,a)):ye(e,3,C$(r,n,a));return;case"b":case"e":ye(e,5,DX(r,n,t.v,t.t));return;case"s":case"str":ye(e,4,RX(r,n,(t.v||"").slice(0,255)));return}ye(e,1,yf(null,r,n))}function OX(e,t,r,n){var a=Array.isArray(t),s=rt(t["!ref"]||"A1"),i,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=We(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Xt(u);for(var f=s.s.c;f<=s.e.c;++f){u===s.s.r&&(l[f]=Mt(f)),i=l[f]+o;var d=a?(t[u]||[])[f]:t[i];d&&MX(e,d,u,f)}}}function IX(e,t){for(var r=t||{},n=dn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ye(n,r.biff==4?1033:r.biff==3?521:9,Yv(e,16,r)),OX(n,e.Sheets[e.SheetNames[a]],a,r),ye(n,10),n.end()}function FX(e,t,r){ye(e,49,PU({sz:12,name:"Arial"},r))}function LX(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ye(e,1054,IU(a,t[a],r))})}function BX(e,t){var r=ie(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ye(e,2151,r),r=ie(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),JN(rt(t["!ref"]||"A1"),r),r.write_shift(4,4),ye(e,2152,r)}function UX(e,t){for(var r=0;r<16;++r)ye(e,224,p2({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ye(e,224,p2(n,0,t))})}function $X(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ye(e,440,u$(n)),n[1].Tooltip&&ye(e,2048,d$(n))}delete t["!links"]}function WX(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&ye(e,125,y$(wm(a,n),a))})}}function HX(e,t,r,n,a){var s=16+Ci(a.cellXfs,t,a);if(t.v==null&&!t.bf){ye(e,513,po(r,n,s));return}if(t.bf)ye(e,6,pV(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?or(Tt(t.v)):t.v;ye(e,515,XU(r,n,i,s));break;case"b":case"e":ye(e,517,GU(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=ty(a.Strings,t.v,a.revStrings);ye(e,253,DU(r,n,o,s))}else ye(e,516,MU(r,n,(t.v||"").slice(0,255),s,a));break;default:ye(e,513,po(r,n,s))}}function zX(e,t,r){var n=dn(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,f,d="",m=[],h=rt(s["!ref"]||"A1"),v=u?65536:16384;if(h.e.c>255||h.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,v-1)}ye(n,2057,Yv(r,16,t)),ye(n,13,Vn(1)),ye(n,12,Vn(100)),ye(n,15,Kr(!0)),ye(n,17,Kr(!1)),ye(n,16,ho(.001)),ye(n,95,Kr(!0)),ye(n,42,Kr(!1)),ye(n,43,Kr(!1)),ye(n,130,Vn(1)),ye(n,128,VU()),ye(n,131,Kr(!1)),ye(n,132,Kr(!1)),u&&WX(n,s["!cols"]),ye(n,512,LU(h,t)),u&&(s["!links"]=[]);for(var p=h.s.r;p<=h.e.r;++p){d=Xt(p);for(var g=h.s.c;g<=h.e.c;++g){p===h.s.r&&(m[g]=Mt(g)),f=m[g]+d;var y=l?(s[p]||[])[g]:s[f];y&&(HX(n,y,p,g,t),u&&y.l&&s["!links"].push([f,y.l]))}}var w=o.CodeName||o.name||a;return u&&ye(n,574,NU((i.Views||[])[0])),u&&(s["!merges"]||[]).length&&ye(n,229,a$(s["!merges"])),u&&$X(n,s),ye(n,442,XN(w)),u&&BX(n,s),ye(n,10),n.end()}function VX(e,t,r){var n=dn(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(ye(n,2057,Yv(e,5,r)),r.bookType=="xla"&&ye(n,135),ye(n,225,o?Vn(1200):null),ye(n,193,GB(2)),l&&ye(n,191),l&&ye(n,192),ye(n,226),ye(n,92,mU("SheetJS",r)),ye(n,66,Vn(o?1200:1252)),o&&ye(n,353,Vn(0)),o&&ye(n,448),ye(n,317,_$(e.SheetNames.length)),o&&e.vbaraw&&ye(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";ye(n,442,XN(u))}ye(n,156,Vn(17)),ye(n,25,Kr(!1)),ye(n,18,Kr(!1)),ye(n,19,Vn(0)),o&&ye(n,431,Kr(!1)),o&&ye(n,444,Vn(0)),ye(n,61,EU()),ye(n,64,Kr(!1)),ye(n,141,Vn(0)),ye(n,34,Kr(kY(e)=="true")),ye(n,14,Kr(!0)),o&&ye(n,439,Kr(!1)),ye(n,218,Vn(0)),FX(n,e,r),LX(n,e.SSF,r),UX(n,r),o&&ye(n,352,Kr(!1));var f=n.end(),d=dn();o&&ye(d,140,m$()),o&&r.Strings&&jX(d,252,xU(r.Strings)),ye(d,10);var m=d.end(),h=dn(),v=0,p=0;for(p=0;p<e.SheetNames.length;++p)v+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=f.length+v+m.length;for(p=0;p<e.SheetNames.length;++p){var y=s[p]||{};ye(h,133,vU({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var w=h.end();if(v!=w.length)throw new Error("BS8 "+v+" != "+w.length);var x=[];return f.length&&x.push(f),w.length&&x.push(w),m.length&&x.push(m),dr(x)}function GX(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Nt(De)),e&&e.SSF&&(Ql(),hm(e.SSF),r.revssf=pm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,iy(r),r.cellXfs=[],Ci(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=zX(a,r,e);return n.unshift(VX(e,n,r)),dr(n)}function $C(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=gn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return GX(e,t);case 4:case 3:case 2:return IX(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function P2(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=P9(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,m=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<l.length;++i){var p=l[i].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var y=p.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var w=y[o].trim();if(w.match(/<t[dh]/i)){for(var x=w,S=0;x.charAt(0)=="<"&&(S=x.indexOf(">"))>-1;)x=x.slice(S+1);for(var b=0;b<v.length;++b){var E=v[b];E.s.c==f&&E.s.r<u&&u<=E.e.r&&(f=E.e.c+1,b=-1)}var k=Ie(w.slice(0,w.indexOf(">")));m=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||m>1)&&v.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+m-1}});var T=k.t||k["data-t"]||"";if(!x.length){f+=m;continue}if(x=fN(x),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>f&&(h.s.c=f),h.e.c<f&&(h.e.c=f),!x.length){f+=m;continue}var N={t:"s",v:x};r.raw||!x.trim().length||T=="s"||(x==="TRUE"?N={t:"b",v:!0}:x==="FALSE"?N={t:"b",v:!1}:isNaN(xa(x))?isNaN(Rl(x).getDate())||(N={t:"d",v:Tt(x)},r.cellDates||(N={t:"n",v:or(N.v)}),N.z=r.dateNF||De[14]):N={t:"n",v:xa(x)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=N):n[Re({r:u,c:f})]=N,f+=m}}}}return n["!ref"]=We(h),v.length&&(n["!merges"]=v),n}function YX(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>i)&&!(a[u].e.r<r||a[u].e.c<i)){if(a[u].s.r<r||a[u].s.c<i){o=-1;break}o=a[u].e.r-a[u].s.r+1,l=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=Re({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],m=d&&d.v!=null&&(d.h||Mv(d.w||(Es(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?m='<span contenteditable="true">'+m+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(m='<a href="'+d.l.Target+'">'+m+"</a>")),h.id=(n.id||"sjs")+"-"+f,s.push(ve("td",m,h))}}var v="<tr>";return v+s.join("")+"</tr>"}var XX='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',KX="</body></html>";function qX(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ni(P2(r[0],t),t);var n=cy();return r.forEach(function(a,s){uy(n,P2(a,t),"Sheet"+(s+1))}),n}function QX(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function WC(e,t){var r=t||{},n=r.header!=null?r.header:XX,a=r.footer!=null?r.footer:KX,s=[n],i=gn(e["!ref"]);r.dense=Array.isArray(e),s.push(QX(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(YX(e,i,o,r));return s.push("</table>"+a),s.join("")}function HC(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Ot(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=gn(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],m=0,h=e["!rows"]||(e["!rows"]=[]),v=0,p=0,g=0,y=0,w=0,x=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&p<l;++v){var S=o[v];if(j2(S)){if(n.display)continue;h[p]={hidden:!0}}var b=S.children;for(g=y=0;g<b.length;++g){var E=b[g];if(!(n.display&&j2(E))){var k=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):fN(E.innerHTML),T=E.getAttribute("data-z")||E.getAttribute("z");for(m=0;m<d.length;++m){var N=d[m];N.s.c==y+s&&N.s.r<p+a&&p+a<=N.e.r&&(y=N.e.c+1-s,m=-1)}x=+E.getAttribute("colspan")||1,((w=+E.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:p+a,c:y+s},e:{r:p+a+(w||1)-1,c:y+s+(x||1)-1}});var O={t:"s",v:k},W=E.getAttribute("data-t")||E.getAttribute("t")||"";k!=null&&(k.length==0?O.t=W||"z":n.raw||k.trim().length==0||W=="s"||(k==="TRUE"?O={t:"b",v:!0}:k==="FALSE"?O={t:"b",v:!1}:isNaN(xa(k))?isNaN(Rl(k).getDate())||(O={t:"d",v:Tt(k)},n.cellDates||(O={t:"n",v:or(O.v)}),O.z=n.dateNF||De[14]):O={t:"n",v:xa(k)})),O.z===void 0&&T!=null&&(O.z=T);var P="",G=E.getElementsByTagName("A");if(G&&G.length)for(var X=0;X<G.length&&!(G[X].hasAttribute("href")&&(P=G[X].getAttribute("href"),P.charAt(0)!="#"));++X);P&&P.charAt(0)!="#"&&(O.l={Target:P}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][y+s]=O):e[Re({c:y+s,r:p+a})]=O,u.e.c<y+s&&(u.e.c=y+s),y+=x}}++p}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,p-1+a),e["!ref"]=We(u),p>=l&&(e["!fullref"]=We((u.e.r=o.length-v+p-1+a,u))),e}function zC(e,t){var r=t||{},n=r.dense?[]:{};return HC(n,e,t)}function JX(e,t){return Ni(zC(e,t),t)}function j2(e){var t="",r=ZX(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function ZX(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function eK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=et(t.replace(/<[^>]*>/g,""));return[r]}var D2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function VC(e,t){var r=t||{},n=Ov(e),a=[],s,i,o={name:""},l="",u=0,f,d,m={},h=[],v=r.dense?[]:{},p,g,y={value:""},w="",x=0,S=[],b=-1,E=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,N={},O=[],W={},P=0,G=0,X=[],V=1,K=1,Y=[],H={Names:[]},M={},ne=["",""],ce=[],j={},z="",L=0,U=!1,Q=!1,q=0;for(Du.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Du.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"工作表":p[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?v["!ref"]=We(k):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(v["!fullref"]=v["!ref"],k.e.r=r.sheetRows-1,v["!ref"]=We(k)),O.length&&(v["!merges"]=O),X.length&&(v["!rows"]=X),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),h.push(f.name),m[f.name]=v,Q=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=Ie(p[0],!1),b=E=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,v=r.dense?[]:{},O=[],X=[],Q=!0);break;case"table-row-group":p[1]==="/"?--T:++T;break;case"table-row":case"行":if(p[1]==="/"){b+=V,V=1;break}if(d=Ie(p[0],!1),d.行号?b=d.行号-1:b==-1&&(b=0),V=+d["number-rows-repeated"]||1,V<10)for(q=0;q<V;++q)T>0&&(X[b+q]={level:T});E=-1;break;case"covered-table-cell":p[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(v[b]||(v[b]=[]),v[b][E]={t:"z"}):v[Re({r:b,c:E})]={t:"z"}),w="",S=[];break;case"table-cell":case"数据":if(p[0].charAt(p[0].length-2)==="/")++E,y=Ie(p[0],!1),K=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=N2(et(y.formula))),(y.数据类型||y["value-type"])=="string"&&(g.t="s",g.v=et(y["string-value"]||""),r.dense?(v[b]||(v[b]=[]),v[b][E]=g):v[Re({r:b,c:E})]=g),E+=K-1;else if(p[1]!=="/"){++E,w="",x=0,S=[],K=1;var ae=V?b+V-1:b;if(E>k.e.c&&(k.e.c=E),E<k.s.c&&(k.s.c=E),b<k.s.r&&(k.s.r=b),ae>k.e.r&&(k.e.r=ae),y=Ie(p[0],!1),ce=[],j={},g={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=et(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(P=parseInt(y["number-matrix-rows-spanned"],10)||0,G=parseInt(y["number-matrix-columns-spanned"],10)||0,W={s:{r:b,c:E},e:{r:b+P-1,c:E+G-1}},g.F=We(W),Y.push([W,g.F])),y.formula)g.f=N2(y.formula);else for(q=0;q<Y.length;++q)b>=Y[q][0].s.r&&b<=Y[q][0].e.r&&E>=Y[q][0].s.c&&E<=Y[q][0].e.c&&(g.F=Y[q][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(P=parseInt(y["number-rows-spanned"],10)||0,G=parseInt(y["number-columns-spanned"],10)||0,W={s:{r:b,c:E},e:{r:b+P-1,c:E+G-1}},O.push(W)),y["number-columns-repeated"]&&(K=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=kt(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=Tt(y["date-value"]),r.cellDates||(g.t="n",g.v=or(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=N9(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=gm(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.数据数值);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(w=et(y["string-value"]),S=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(U=!1,g.t==="s"&&(g.v=w||"",S.length&&(g.R=S),U=x==0),M.Target&&(g.l=M),ce.length>0&&(g.c=ce,ce=[]),w&&r.cellText!==!1&&(g.w=w),U&&(g.t="z",delete g.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var oe=0;oe<V;++oe){if(K=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(v[b+oe]||(v[b+oe]=[]),v[b+oe][E]=oe==0?g:Nt(g);--K>0;)v[b+oe][E+K]=Nt(g);else for(v[Re({r:b+oe,c:E})]=g;--K>0;)v[Re({r:b+oe,c:E+K})]=Nt(g);k.e.c<=E&&(k.e.c=E)}K=parseInt(y["number-columns-repeated"]||"1",10),E+=K-1,K=0,g={},w="",S=[]}M={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s;j.t=w,S.length&&(j.R=S),j.a=z,ce.push(j)}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);z="",L=0,w="",x=0,S=[];break;case"creator":p[1]==="/"?z=n.slice(L,p.index):L=p.index+p[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&a.push([p[3],!1]);w="",x=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(N[o.name]=l,(s=a.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(l="",o=Ie(p[0],!1),a.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ie(p[0],!1),l+=D2[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ie(p[0],!1),l+=D2[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":i=Ie(p[0],!1),ne=Mp(i["cell-range-address"]);var se={Name:i.name,Ref:ne[0]+"!"+ne[1]};Q&&(se.Sheet=h.length),H.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var J=eK(n.slice(x,p.index));w=(w.length>0?w+`
`:"")+J[0]}else Ie(p[0],!1),x=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ne=Mp(Ie(p[0])["target-range-address"]),m[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(M=Ie(p[0],!1),!M.href)break;M.Target=et(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(ne=Mp(M.Target.slice(1)),M.Target="#"+ne[0]+"!"+ne[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(p)}}var A={Sheets:m,SheetNames:h,Workbook:H};return r.bookSheets&&delete A.Sheets,A}function R2(e,t){t=t||{},Hn(e,"META-INF/manifest.xml")&&NB(Jt(e,"META-INF/manifest.xml"),t);var r=Tn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=VC(dt(r),t);return Hn(e,"meta.xml")&&(n.Props=ON(Jt(e,"meta.xml"))),n}function M2(e,t){return VC(e,t)}var tK=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ju({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Kt+t}}(),O2=function(){var e=function(s){return ct(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var l=[];l.push('      <table:table table:name="'+ct(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=gn(s["!ref"]||"A1"),m=s["!merges"]||[],h=0,v=Array.isArray(s);if(s["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(s["!cols"][f]?' table:style-name="co'+s["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",g=s["!rows"]||[];for(u=0;u<d.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",l.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=d.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",l.push("        <table:table-row"+p+`>
`),f=0;f<d.s.c;++f)l.push(t);for(;f<=d.e.c;++f){var y=!1,w={},x="";for(h=0;h!=m.length;++h)if(!(m[h].s.c>f)&&!(m[h].s.r>u)&&!(m[h].e.c<f)&&!(m[h].e.r<u)){(m[h].s.c!=f||m[h].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=m[h].e.c-m[h].s.c+1,w["table:number-rows-spanned"]=m[h].e.r-m[h].s.r+1;break}if(y){l.push(r);continue}var S=Re({r:u,c:f}),b=v?(s[u]||[])[f]:s[S];if(b&&b.f&&(w["table:formula"]=ct(_V(b.f)),b.F&&b.F.slice(0,S.length)==S)){var E=gn(b.F);w["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,w["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!b){l.push(t);continue}switch(b.t){case"b":x=b.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=b.v?"true":"false";break;case"n":x=b.w||String(b.v||0),w["office:value-type"]="float",w["office:value"]=b.v||0;break;case"s":case"str":x=b.v==null?"":b.v,w["office:value-type"]="string";break;case"d":x=b.w||Tt(b.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=Tt(b.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var k=e(x);if(b.l&&b.l.Target){var T=b.l.Target;T=T.charAt(0)=="#"?"#"+SV(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),k=ve("text:a",k,{"xlink:href":T.replace(/&/g,"&amp;")})}l.push("          "+ve("table:table-cell",ve("text:p",k,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;pi(d),d.ods=o;var m=u["!cols"][f].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+m+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var d=u["!rows"][f].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var l=[Kt],u=ju({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=ju({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(MN().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),a(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)l.push(n(i.Sheets[i.SheetNames[d]],i,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function GC(e,t){if(t.bookType=="fods")return O2(e,t);var r=jv(),n="",a=[],s=[];return n="mimetype",ze(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ze(r,n,O2(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ze(r,n,tK(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ze(r,n,Kt+MN()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ze(r,n,PB(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ze(r,n,CB(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function go(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function vg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):dt(Ti(e))}function rK(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):En(Ha(e))}function nK(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function vi(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function I2(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function aK(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function sK(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Bu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function it(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function $t(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function at(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Bu(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Bu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function vr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(it(n*8+a.type)),a.type==2&&t.push(it(a.data.length)),t.push(a.data))})}),vi(t)}function ay(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function $n(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Bu(e,n),s=at(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:$t(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=at(o.data),u=$t(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=$t(s[3][0].data)>>>0>0),r.push(i)}return r}function Io(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:it(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:it(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:it(i.data.length)}],n[2].push({data:vr(i.meta),type:2})});var s=vr(n);t.push(it(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),vi(t)}function iK(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Bu(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[vi(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(a.push(a[0].slice(-l)),u-=l;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-l,-l+u))}}var f=vi(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Wn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(iK(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return vi(t)}function Fo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=it(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return vi(t)}function oK(e,t,r,n){var a=go(e),s=a.getUint32(4,!0),i=(n>1?12:8)+I2(s&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=I2(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(u=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function lK(e,t,r){var n=go(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);a&1&&(l=aK(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Ip(e,t){var r=new Uint8Array(32),n=go(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,sK(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Fp(e,t){var r=new Uint8Array(32),n=go(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function cK(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return oK(e,t,r,e[0]);case 5:return lK(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Pr(e){var t=at(e);return Bu(t[1][0].data)}function F2(e,t){var r=at(t.data),n=$t(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=at(i.data),l=$t(o[1][0].data)>>>0;switch(n){case 1:s[l]=vg(o[3][0].data);break;case 8:{var u=e[Pr(o[9][0].data)][0],f=at(u.data),d=e[Pr(f[1][0].data)][0],m=$t(d.meta[1][0].data);if(m!=2001)throw new Error("2000 unexpected reference to ".concat(m));var h=at(d.data);s[l]=h[3].map(function(v){return vg(v.data)}).join("")}break}}),s}function uK(e,t){var r,n,a,s,i,o,l,u,f,d,m,h,v,p,g=at(e),y=$t(g[1][0].data)>>>0,w=$t(g[2][0].data)>>>0,x=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&$t(g[8][0].data)>0||!1,S,b;if((s=(a=g[7])==null?void 0:a[0])!=null&&s.data&&t!=0)S=(o=(i=g[7])==null?void 0:i[0])==null?void 0:o.data,b=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(f=g[4])==null?void 0:f[0])!=null&&d.data&&t!=1)S=(h=(m=g[4])==null?void 0:m[0])==null?void 0:h.data,b=(p=(v=g[3])==null?void 0:v[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=x?4:1,k=go(S),T=[],N=0;N<S.length/2;++N){var O=k.getUint16(N*2,!0);O<65535&&T.push([N,O])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var W=[];for(N=0;N<T.length-1;++N)W[T[N][0]]=b.subarray(T[N][1]*E,T[N+1][1]*E);return T.length>=1&&(W[T[T.length-1][0]]=b.subarray(T[T.length-1][1]*E)),{R:y,cells:W}}function fK(e,t){var r,n=at(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?$t(n[7][0].data)>>>0>0?1:0:-1,s=ay(n[5],function(i){return uK(i,a)});return{nrows:$t(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function dK(e,t,r){var n,a=at(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=($t(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=($t(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=We(s);var i=at(a[4][0].data),o=F2(e,e[Pr(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?F2(e,e[Pr(i[17][0].data)][0]):[],u=at(i[3][0].data),f=0;u[1].forEach(function(d){var m=at(d.data),h=e[Pr(m[2][0].data)][0],v=$t(h.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var p=fK(e,h);p.data.forEach(function(g,y){g.forEach(function(w,x){var S=Re({r:f+y,c:x}),b=cK(w,o,l);b&&(r[S]=b)})}),f+=p.nrows})}function hK(e,t){var r=at(t.data),n={"!ref":"A1"},a=e[Pr(r[2][0].data)],s=$t(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return dK(e,a[0],n),n}function mK(e,t){var r,n=at(t.data),a={name:(r=n[1])!=null&&r[0]?vg(n[1][0].data):"",sheets:[]},s=ay(n[2],Pr);return s.forEach(function(i){e[i].forEach(function(o){var l=$t(o.meta[1][0].data);l==6e3&&a.sheets.push(hK(e,o))})}),a}function pK(e,t){var r=cy(),n=at(t.data),a=ay(n[1],Pr);if(a.forEach(function(s){e[s].forEach(function(i){var o=$t(i.meta[1][0].data);if(o==2){var l=mK(e,i);l.sheets.forEach(function(u,f){uy(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Lp(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=Wn(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=$n(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&$t(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(u){var f=$t(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return pK(s,o)}function gK(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&$t(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=go(e[7][0].data),f=0,d=[],m=go(e[4][0].data),h=0,v=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535);continue}u.setUint16(p*2,f,!0),m.setUint16(p*2,h,!0);var g,y;switch(typeof t[p]){case"string":g=Ip({t:"s",v:t[p]},r),y=Fp({t:"s",v:t[p]},r);break;case"number":g=Ip({t:"n",v:t[p]},r),y=Fp({t:"n",v:t[p]},r);break;case"boolean":g=Ip({t:"b",v:t[p]},r),y=Fp({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}d.push(g),f+=g.length,v.push(y),h+=y.length,++l}for(e[2][0].data=it(l);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),m.setUint16(p*2,65535,!0);return e[6][0].data=vi(d),e[3][0].data=vi(v),l}function vK(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=gn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(We(n)));var s=yh(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(L){typeof L=="string"&&i.push(L)})});var o={},l=[],u=Ce.read(t.numbers,{type:"base64"});u.FileIndex.map(function(z,L){return[z,u.FullPaths[L]]}).forEach(function(z){var L=z[0],U=z[1];if(L.type==2&&L.name.match(/\.iwa/)){var Q=L.content,q=Wn(Q),ae=$n(q);ae.forEach(function(oe){l.push(oe.id),o[oe.id]={deps:[],location:U,type:$t(oe.messages[0].meta[1][0].data)}})}}),l.sort(function(z,L){return z-L});var f=l.filter(function(z){return z>1}).map(function(z){return[z,it(z)]});u.FileIndex.map(function(z,L){return[z,u.FullPaths[L]]}).forEach(function(z){var L=z[0];if(z[1],!!L.name.match(/\.iwa/)){var U=$n(Wn(L.content));U.forEach(function(Q){Q.messages.forEach(function(q){f.forEach(function(ae){Q.messages.some(function(oe){return $t(oe.meta[1][0].data)!=11006&&nK(oe.data,ae[1])})&&o[ae[0]].deps.push(Q.id)})})})}});for(var d=Ce.find(u,o[1].location),m=$n(Wn(d.content)),h,v=0;v<m.length;++v){var p=m[v];p.id==1&&(h=p)}var g=Pr(at(h.messages[0].data)[1][0].data);for(d=Ce.find(u,o[g].location),m=$n(Wn(d.content)),v=0;v<m.length;++v)p=m[v],p.id==g&&(h=p);for(g=Pr(at(h.messages[0].data)[2][0].data),d=Ce.find(u,o[g].location),m=$n(Wn(d.content)),v=0;v<m.length;++v)p=m[v],p.id==g&&(h=p);for(g=Pr(at(h.messages[0].data)[2][0].data),d=Ce.find(u,o[g].location),m=$n(Wn(d.content)),v=0;v<m.length;++v)p=m[v],p.id==g&&(h=p);var y=at(h.messages[0].data);{y[6][0].data=it(n.e.r+1),y[7][0].data=it(n.e.c+1);var w=Pr(y[46][0].data),x=Ce.find(u,o[w].location),S=$n(Wn(x.content));{for(var b=0;b<S.length&&S[b].id!=w;++b);if(S[b].id!=w)throw"Bad ColumnRowUIDMapArchive";var E=at(S[b].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var k=0;k<=n.e.c;++k){var T=[];T[1]=T[2]=[{type:0,data:it(k+420690)}],E[1].push({type:2,data:vr(T)}),E[2].push({type:0,data:it(k)}),E[3].push({type:0,data:it(k)})}E[4]=[],E[5]=[],E[6]=[];for(var N=0;N<=n.e.r;++N)T=[],T[1]=T[2]=[{type:0,data:it(N+726270)}],E[4].push({type:2,data:vr(T)}),E[5].push({type:0,data:it(N)}),E[6].push({type:0,data:it(N)});S[b].messages[0].data=vr(E)}x.content=Fo(Io(S)),x.size=x.content.length,delete y[46];var O=at(y[4][0].data);{O[7][0].data=it(n.e.r+1);var W=at(O[1][0].data),P=Pr(W[2][0].data);x=Ce.find(u,o[P].location),S=$n(Wn(x.content));{if(S[0].id!=P)throw"Bad HeaderStorageBucket";var G=at(S[0].messages[0].data);for(N=0;N<s.length;++N){var X=at(G[2][0].data);X[1][0].data=it(N),X[4][0].data=it(s[N].length),G[2][N]={type:G[2][0].type,data:vr(X)}}S[0].messages[0].data=vr(G)}x.content=Fo(Io(S)),x.size=x.content.length;var V=Pr(O[2][0].data);x=Ce.find(u,o[V].location),S=$n(Wn(x.content));{if(S[0].id!=V)throw"Bad HeaderStorageBucket";for(G=at(S[0].messages[0].data),k=0;k<=n.e.c;++k)X=at(G[2][0].data),X[1][0].data=it(k),X[4][0].data=it(n.e.r+1),G[2][k]={type:G[2][0].type,data:vr(X)};S[0].messages[0].data=vr(G)}x.content=Fo(Io(S)),x.size=x.content.length;var K=Pr(O[4][0].data);(function(){for(var z=Ce.find(u,o[K].location),L=$n(Wn(z.content)),U,Q=0;Q<L.length;++Q){var q=L[Q];q.id==K&&(U=q)}var ae=at(U.messages[0].data);{ae[3]=[];var oe=[];i.forEach(function(A,pe){oe[1]=[{type:0,data:it(pe)}],oe[2]=[{type:0,data:it(1)}],oe[3]=[{type:2,data:rK(A)}],ae[3].push({type:2,data:vr(oe)})})}U.messages[0].data=vr(ae);var se=Io(L),J=Fo(se);z.content=J,z.size=z.content.length})();var Y=at(O[3][0].data);{var H=Y[1][0];delete Y[2];var M=at(H.data);{var ne=Pr(M[2][0].data);(function(){for(var z=Ce.find(u,o[ne].location),L=$n(Wn(z.content)),U,Q=0;Q<L.length;++Q){var q=L[Q];q.id==ne&&(U=q)}var ae=at(U.messages[0].data);{delete ae[6],delete Y[7];var oe=new Uint8Array(ae[5][0].data);ae[5]=[];for(var se=0,J=0;J<=n.e.r;++J){var A=at(oe);se+=gK(A,s[J],i),A[1][0].data=it(J),ae[5].push({data:vr(A),type:2})}ae[1]=[{type:0,data:it(n.e.c+1)}],ae[2]=[{type:0,data:it(n.e.r+1)}],ae[3]=[{type:0,data:it(se)}],ae[4]=[{type:0,data:it(n.e.r+1)}]}U.messages[0].data=vr(ae);var pe=Io(L),Ne=Fo(pe);z.content=Ne,z.size=z.content.length})()}H.data=vr(M)}O[3][0].data=vr(Y)}y[4][0].data=vr(O)}h.messages[0].data=vr(y);var ce=Io(m),j=Fo(ce);return d.content=j,d.size=d.content.length,u}function YC(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function sy(e){YC([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function iy(e){YC([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function yK(e){return Ye.WS.indexOf(e)>-1?"sheet":e==Ye.CS?"chart":e==Ye.DS?"dialog":e==Ye.MS?"macro":e&&e.length?e:"sheet"}function xK(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,yK(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function wK(e,t,r,n,a,s,i,o,l,u,f,d){try{s[n]=Yc(Tn(e,r,!0),t);var m=Jt(e,t),h;switch(o){case"sheet":h=WY(m,t,a,l,s[n],u,f,d);break;case"chart":if(h=HY(m,t,a,l,s[n],u,f,d),!h||!h["!drawel"])break;var v=Dc(h["!drawel"].Target,t),p=Ru(v),g=AH(Tn(e,v,!0),Yc(Tn(e,p,!0),v)),y=Dc(g,v),w=Ru(y);h=gY(Tn(e,y,!0),y,l,Yc(Tn(e,w,!0),y),u,h);break;case"macro":h=zY(m,t,a,l,s[n],u,f,d);break;case"dialog":h=VY(m,t,a,l,s[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var x=[];s&&s[n]&&Wt(s[n]).forEach(function(S){var b="";if(s[n][S].Type==Ye.CMNT){b=Dc(s[n][S].Target,t);var E=KY(Jt(e,b,!0),b,l);if(!E||!E.length)return;S2(h,E,!1)}s[n][S].Type==Ye.TCMNT&&(b=Dc(s[n][S].Target,t),x=x.concat(jH(Jt(e,b,!0),l)))}),x&&x.length&&S2(h,x,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function Bn(e){return e.charAt(0)=="/"?e.slice(1):e}function _K(e,t){if(Ql(),t=t||{},sy(t),Hn(e,"META-INF/manifest.xml")||Hn(e,"objectdata.xml"))return R2(e,t);if(Hn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Lp<"u"){if(e.FileIndex)return Lp(e);var r=Ce.utils.cfb_new();return Hw(e).forEach(function(X){ze(r,X,D9(e,X))}),Lp(r)}throw new Error("Unsupported NUMBERS file")}if(!Hn(e,"[Content_Types].xml"))throw Hn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Hn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Hw(e),a=EB(Tn(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Jt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Jt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Xc=[],a.sst)try{Xc=XY(Jt(e,Bn(a.sst)),a.sst,t)}catch(X){if(t.WTF)throw X}t.cellStyles&&a.themes.length&&(l=YY(Tn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=GY(Jt(e,Bn(a.style)),a.style,l,t))}a.links.map(function(X){try{var V=Yc(Tn(e,Ru(Bn(X))),X);return QY(Jt(e,Bn(X)),V,X,t)}catch{}});var f=$Y(Jt(e,Bn(a.workbooks[0])),a.workbooks[0],t),d={},m="";a.coreprops.length&&(m=Jt(e,Bn(a.coreprops[0]),!0),m&&(d=ON(m)),a.extprops.length!==0&&(m=Jt(e,Bn(a.extprops[0]),!0),m&&DB(m,d,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(m=Tn(e,Bn(a.custprops[0]),!0),m&&(h=MB(m,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(V){return V.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(v.Props=d,v.Custprops=h),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var p={};t.bookDeps&&a.calcchain&&(p=qY(Jt(e,Bn(a.calcchain)),a.calcchain));var g=0,y={},w,x;{var S=f.Sheets;d.Worksheets=S.length,d.SheetNames=[];for(var b=0;b!=S.length;++b)d.SheetNames[b]=S[b].name}var E=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),T=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Hn(e,T)||(T="xl/_rels/workbook."+E+".rels");var N=Yc(Tn(e,T,!0),T.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=JY(Jt(e,Bn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=RH(Jt(e,Bn(a.people[0])),t)),N&&(N=xK(N,f.Sheets));var O=Jt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var W="sheet";if(N&&N[g]?(w="xl/"+N[g][1].replace(/[\/]?xl\//,""),Hn(e,w)||(w=N[g][1]),Hn(e,w)||(w=T.replace(/_rels\/.*$/,"")+N[g][1]),W=N[g][2]):(w="xl/worksheets/sheet"+(g+1-O)+"."+E,w=w.replace(/sheet0\./,"sheet.")),x=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==g&&(P=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==d.SheetNames[g].toLowerCase()&&(P=1);if(!P)continue e}}wK(e,w,x,d.SheetNames[g],g,y,i,W,t,f,l,u)}return v={Directory:a,Workbook:f,Props:d,Custprops:h,Deps:p,Sheets:i,SheetNames:d.SheetNames,Strings:Xc,Styles:u,Themes:l,SSF:Nt(De)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(X,V){X=X.replace(/^Root Entry[\/]/,""),v.keys.push(X),v.files[X]=e.FileIndex[V]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=Jt(e,Bn(a.vba[0]),!0):a.defaults&&a.defaults.bin===$H&&(v.vbaraw=Jt(e,"xl/vbaProject.bin",!0))),v}function SK(e,t){var r=t||{},n="Workbook",a=Ce.find(e,n);try{if(n="/!DataSpaces/Version",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(J$(a.content),n="/!DataSpaces/DataSpaceMap",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=eW(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=tW(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);nW(a.content)}catch{}if(n="/EncryptionInfo",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=aW(a.content);if(n="/EncryptedPackage",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function kK(e,t){return t.bookType=="ods"?GC(e,t):t.bookType=="numbers"?vK(e,t):t.bookType=="xlsb"?bK(e,t):EK(e,t)}function bK(e,t){Zo=1024,e&&!e.SSF&&(e.SSF=Nt(De)),e&&e.SSF&&(Ql(),hm(e.SSF),t.revssf=pm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Kc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=wC.indexOf(t.bookType)>-1,a=Vv();iy(t=t||{});var s=jv(),i="",o=0;if(t.cellXfs=[],Ci(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",ze(s,i,IN(e.Props,t)),a.coreprops.push(i),lt(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,ze(s,i,BN(e.Props)),a.extprops.push(i),lt(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Wt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",ze(s,i,UN(e.Custprops)),a.custprops.push(i),lt(t.rels,4,i,Ye.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,ze(s,i,eX(o-1,i,t,e,f)),a.sheets.push(i),lt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ye.WS[0])}if(d){var h=d["!comments"],v=!1,p="";h&&h.length>0&&(p="xl/comments"+o+"."+r,ze(s,p,nX(h,p)),a.comments.push(p),lt(f,-1,"../comments"+o+"."+r,Ye.CMNT),v=!0),d["!legacy"]&&v&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",yC(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&ze(s,Ru(i),ul(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,ze(s,i,rX(t.Strings,i,t)),a.strs.push(i),lt(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,ze(s,i,ZY(e,i)),a.workbooks.push(i),lt(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",ze(s,i,Qv(e.Themes,t)),a.themes.push(i),lt(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,ze(s,i,tX(e,i,t)),a.styles.push(i),lt(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",ze(s,i,e.vbaraw),a.vba.push(i),lt(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,ze(s,i,aX(i)),a.metadata.push(i),lt(t.wbrels,-1,"metadata."+r,Ye.XLMETA),ze(s,"[Content_Types].xml",RN(a,t)),ze(s,"_rels/.rels",ul(t.rels)),ze(s,"xl/_rels/workbook."+r+".rels",ul(t.wbrels)),delete t.revssf,delete t.ssf,s}function EK(e,t){Zo=1024,e&&!e.SSF&&(e.SSF=Nt(De)),e&&e.SSF&&(Ql(),hm(e.SSF),t.revssf=pm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Kc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=wC.indexOf(t.bookType)>-1,a=Vv();iy(t=t||{});var s=jv(),i="",o=0;if(t.cellXfs=[],Ci(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",ze(s,i,IN(e.Props,t)),a.coreprops.push(i),lt(t.rels,2,i,Ye.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,ze(s,i,BN(e.Props)),a.extprops.push(i),lt(t.rels,3,i,Ye.EXT_PROPS),e.Custprops!==e.Props&&Wt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",ze(s,i,UN(e.Custprops)),a.custprops.push(i),lt(t.rels,4,i,Ye.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},m=e.Sheets[e.SheetNames[o-1]],h=(m||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,ze(s,i,jC(o-1,t,e,d)),a.sheets.push(i),lt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ye.WS[0])}if(m){var v=m["!comments"],p=!1,g="";if(v&&v.length>0){var y=!1;v.forEach(function(w){w[1].forEach(function(x){x.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+o+"."+r,ze(s,g,DH(v,f,t)),a.threadedcomments.push(g),lt(d,-1,"../threadedComments/threadedComment"+o+"."+r,Ye.TCMNT)),g="xl/comments"+o+"."+r,ze(s,g,xC(v)),a.comments.push(g),lt(d,-1,"../comments"+o+"."+r,Ye.CMNT),p=!0}m["!legacy"]&&p&&ze(s,"xl/drawings/vmlDrawing"+o+".vml",yC(o,m["!comments"])),delete m["!comments"],delete m["!legacy"]}d["!id"].rId1&&ze(s,Ru(i),ul(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,ze(s,i,iC(t.Strings,t)),a.strs.push(i),lt(t.wbrels,-1,"sharedStrings."+r,Ye.SST)),i="xl/workbook."+r,ze(s,i,IC(e)),a.workbooks.push(i),lt(t.rels,1,i,Ye.WB),i="xl/theme/theme1.xml",ze(s,i,Qv(e.Themes,t)),a.themes.push(i),lt(t.wbrels,-1,"theme/theme1.xml",Ye.THEME),i="xl/styles."+r,ze(s,i,mC(e,t)),a.styles.push(i),lt(t.wbrels,-1,"styles."+r,Ye.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",ze(s,i,e.vbaraw),a.vba.push(i),lt(t.wbrels,-1,"vbaProject.bin",Ye.VBA)),i="xl/metadata."+r,ze(s,i,vC()),a.metadata.push(i),lt(t.wbrels,-1,"metadata."+r,Ye.XLMETA),f.length>1&&(i="xl/persons/person.xml",ze(s,i,MH(f)),a.people.push(i),lt(t.wbrels,-1,"persons/person.xml",Ye.PEOPLE)),ze(s,"[Content_Types].xml",RN(a,t)),ze(s,"_rels/.rels",ul(t.rels)),ze(s,"xl/_rels/workbook."+r+".rels",ul(t.wbrels)),delete t.revssf,delete t.ssf,s}function oy(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Rn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function TK(e,t){return Ce.find(e,"EncryptedPackage")?SK(e,t):UC(e,t)}function NK(e,t){var r,n=e,a=t||{};return a.type||(a.type=Ge&&Buffer.isBuffer(e)?"buffer":"base64"),r=lN(n,a),_K(r,a)}function XC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return pg(e.slice(r),t);default:break e}return Ml.to_workbook(e,t)}function CK(e,t){var r="",n=oy(e,t);switch(t.type){case"base64":r=Rn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=fo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=dt(r)),t.type="binary",XC(r,t)}function AK(e,t){var r=e;return t.type=="base64"&&(r=Rn(r)),r=Nu.utils.decode(1200,r.slice(2),"str"),t.type="binary",XC(r,t)}function PK(e){return e.match(/[^\x00-\x7F]/)?Ha(e):e}function Bp(e,t,r,n){return n?(r.type="string",Ml.to_workbook(e,r)):Ml.to_workbook(t,r)}function Uu(e,t){Tv();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Uu(new Uint8Array(e),(r=Nt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),dl={},r.dateNF&&(dl.dateNF=r.dateNF),r.type||(r.type=Ge&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ge?"buffer":"binary",n=b9(e),typeof Uint8Array<"u"&&!Ge&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=PK(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Nt(r),r.type="array",Uu(Nv(n),r)}switch((a=oy(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return TK(Ce.read(n,r),r);break;case 9:if(a[1]<=8)return UC(n,r);break;case 60:return pg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return O$(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return aC.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?NK(n,r):Bp(e,n,r,s);case 239:return a[3]===60?pg(n,r):Bp(e,n,r,s);case 255:if(a[1]===254)return AK(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return qi.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return qi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return mg.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return fC.to_workbook(n,r);break;case 10:case 13:case 32:return CK(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return M$.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?mg.to_workbook(n,r):Bp(e,n,r,s)}function KC(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ff(t.file,Ce.write(e,{type:Ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ce.write(e,t)}function jK(e,t){var r=Nt(t||{}),n=kK(e,r);return DK(n,r)}function DK(e,t){var r={},n=Ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ce.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(dm(a))}return t.password&&typeof encrypt_agile<"u"?KC(encrypt_agile(a,t.password),t):t.type==="file"?ff(t.file,a):t.type=="string"?dt(a):a}function RK(e,t){var r=t||{},n=PX(e,r);return KC(n,r)}function Ma(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Cu(Ha(n));case"binary":return Ha(n);case"string":return e;case"file":return ff(t.file,n,"utf8");case"buffer":return Ge?Cs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ma(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function MK(e,t){switch(t.type){case"base64":return Cu(e);case"binary":return e;case"string":return e;case"file":return ff(t.file,e,"binary");case"buffer":return Ge?Cs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function sd(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Cu(r):t.type=="string"?dt(r):r;case"file":return ff(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function qC(e,t){Tv(),TY(e);var r=Nt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=qC(e,r);return r.type="array",dm(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ma(kX(e,r),r);case"slk":case"sylk":return Ma(nC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Ma(WC(e.Sheets[e.SheetNames[a]],r),r);case"txt":return MK(QC(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Ma(ly(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Ma(aC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return sd(mg.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Ma(Ml.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Ma(fC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Ma(sC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Ma(GC(e,r),r);case"wk1":return sd(qi.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return sd(qi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),sd($C(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),RK(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return jK(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function OK(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Il(e,t,r){var n={};return n.type="file",n.file=t,OK(n),qC(e,n)}function IK(e,t,r,n,a,s,i,o){var l=Xt(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,m=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(m,"__rowNum__",{value:r,enumerable:!1})}catch{m.__rowNum__=r}else m.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var v=i?e[r][h]:e[n[h]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[h]!=null&&(m[s[h]]=u);continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[h]!=null){if(p==null)if(v.t=="e"&&p===null)m[s[h]]=null;else if(u!==void 0)m[s[h]]=u;else if(f&&p===null)m[s[h]]=null;else continue;else m[s[h]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?p:Es(v,p,o);p!=null&&(d=!1)}}return{row:m,isempty:d}}function yh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=rt(f);break;case"number":l=rt(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=Xt(l.s.r),m=[],h=[],v=0,p=0,g=Array.isArray(e),y=l.s.r,w=0,x={};g&&!e[y]&&(e[y]=[]);var S=u.skipHidden&&e["!cols"]||[],b=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(S[w]||{}).hidden)switch(m[w]=Mt(w),r=g?e[y][w]:e[m[w]+d],n){case 1:s[w]=w-l.s.c;break;case 2:s[w]=m[w];break;case 3:s[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Es(r,null,u),p=x[i]||0,!p)x[i]=1;else{do o=i+"_"+p++;while(x[o]);x[i]=p,x[o]=1}s[w]=o}for(y=l.s.r+a;y<=l.e.r;++y)if(!(b[y]||{}).hidden){var E=IK(e,l,y,m,n,s,g,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[v++]=E.row)}return h.length=v,h}var L2=/"/g;function FK(e,t,r,n,a,s,i,o){for(var l=!0,u=[],f="",d=Xt(r),m=t.s.c;m<=t.e.c;++m)if(n[m]){var h=o.dense?(e[r]||[])[m]:e[n[m]+d];if(h==null)f="";else if(h.v!=null){l=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Es(h,null,o));for(var v=0,p=0;v!==f.length;++v)if((p=f.charCodeAt(v))===a||p===s||p===34||o.forceQuotes){f='"'+f.replace(L2,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(l=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(L2,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(i)}function ly(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=rt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var m=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(m[v]||{}).hidden||(d[v]=Mt(v));for(var p=0,g=a.s.r;g<=a.e.r;++g)(h[g]||{}).hidden||(f=FK(e,a,g,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((p++?o:"")+f)));return delete n.dense,r.join("")}function QC(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=ly(e,t);return r}function LK(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=rt(e["!ref"]),s="",i=[],o,l=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=Mt(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=Xt(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function JC(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Ot(n.origin):n.origin;i=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=rt(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var m=n.header||[],h=0;t.forEach(function(p,g){Wt(p).forEach(function(y){(h=m.indexOf(y))==-1&&(m[h=m.length]=y);var w=p[y],x="z",S="",b=Re({c:o+h,r:i+g+a});u=$u(s,b),w&&typeof w=="object"&&!(w instanceof Date)?s[b]=w:(typeof w=="number"?x="n":typeof w=="boolean"?x="b":typeof w=="string"?x="s":w instanceof Date?(x="d",n.cellDates||(x="n",w=or(w)),S=n.dateNF||De[14]):w===null&&n.nullError&&(x="e",w=0),u?(u.t=x,u.v=w,delete u.w,delete u.R,S&&(u.z=S)):s[b]=u={t:x,v:w},S&&(u.z=S))})}),f.e.c=Math.max(f.e.c,o+m.length-1);var v=Xt(i);if(a)for(h=0;h<m.length;++h)s[Mt(h+o)+v]={t:"s",v:m[h]};return s["!ref"]=We(f),s}function BK(e,t){return JC(null,e,t)}function $u(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ot(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?$u(e,Re(t)):$u(e,Re({r:t,c:r||0}))}function UK(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function cy(){return{SheetNames:[],Sheets:{}}}function uy(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(OC(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function $K(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=UK(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function WK(e,t){return e.z=t,e}function ZC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function HK(e,t,r){return ZC(e,"#"+t,r)}function zK(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function VK(e,t,r,n){for(var a=typeof t!="string"?t:rt(t),s=typeof t=="string"?t:We(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=$u(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Yt={encode_col:Mt,encode_row:Xt,encode_cell:Re,encode_range:We,decode_col:Bv,decode_row:Lv,split_cell:rB,decode_cell:Ot,decode_range:gn,format_cell:Es,sheet_add_aoa:TN,sheet_add_json:JC,sheet_add_dom:HC,aoa_to_sheet:Jl,json_to_sheet:BK,table_to_sheet:zC,table_to_book:JX,sheet_to_csv:ly,sheet_to_txt:QC,sheet_to_json:yh,sheet_to_html:WC,sheet_to_formulae:LK,sheet_to_row_object_array:yh,sheet_get_cell:$u,book_new:cy,book_append_sheet:uy,book_set_sheet_visibility:$K,cell_set_number_format:WK,cell_set_hyperlink:ZC,cell_set_internal_link:HK,cell_add_comment:zK,sheet_set_array_formula:VK,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const GK=()=>{const e=()=>{const r=[{"Applicant ID":"PROSAPP250101000001","Applicant Name":"John Doe","Branch Name":"Mumbai Branch","Team Lead":"Team Lead Name","RM Name":"RM Name","Dealer Name":"Dealer Name","Lender Name":"Lender Name","Applicant Mobile Number":"9876543210","Applicant Current Address":"Sample Address","House Ownership":"Own","Co-Applicant Name":"Co-Applicant Name","Coapplicant Mobile Number":"9876543211","Coapplicant Current Address":"Co-Applicant Address","Guarantor Name":"Guarantor Name","Guarantor Mobile Number":"9876543212","Guarantor Current Address":"Guarantor Address","Reference Name":"Reference Name","Reference Mobile Number":"9876543213","Reference Address":"Reference Address","FI Submission Location":"Field Investigation Location","Demand Date":"2024-05-01","Disbursement Date":"2024-01-10","Loan Amount":5e5,"Vehicle Status":"Risky",Repayment:"Monthly","Principle Due":45e3,"Interest Due":2500,EMI:5e3,"Last Month Bounce":0,"Collection RM":"Collection RM Name","LMS Status":"Unpaid",Status:"Unpaid"}],n=Yt.book_new(),a=Yt.json_to_sheet(r),s=[{wch:20},{wch:25},{wch:20},{wch:20},{wch:15},{wch:25},{wch:25},{wch:15},{wch:30},{wch:15},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:25},{wch:12},{wch:15},{wch:12},{wch:12},{wch:12},{wch:15},{wch:25},{wch:20},{wch:20},{wch:15},{wch:15},{wch:15}];a["!cols"]=s,Yt.book_append_sheet(n,a,"Applications");const o=`first-time-upload-template-${new Date().toISOString().split("T")[0]}.xlsx`;Il(n,o),Se.success("First-time upload template downloaded!")},t=()=>{const r=[{"Applicant ID":"PROSAPP250101000001","Demand Date":"2024-05-01","Team Lead":"Team Lead Name","RM Name":"RM Name",Repayment:"Monthly",EMI:5e3,"Last Month Bounce":0,"LMS Status":"Unpaid","Collection RM":"Collection RM Name"}],n=Yt.book_new(),a=Yt.json_to_sheet(r),s=[{wch:20},{wch:12},{wch:20},{wch:15},{wch:12},{wch:15},{wch:15},{wch:15},{wch:20}];a["!cols"]=s,Yt.book_append_sheet(n,a,"Collection");const o=`monthly-update-template-${new Date().toISOString().split("T")[0]}.xlsx`;Il(n,o),Se.success("Monthly update template downloaded!")};return c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[c.jsxs("div",{className:"mb-4",children:[c.jsx("h4",{className:"font-medium text-blue-900",children:"Step 1: Download Template"}),c.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Choose the appropriate template based on your upload type"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border",children:[c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium text-gray-900",children:"First-time Upload Template"}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"For new applications. Includes all columns (static + monthly data)."})]}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:e,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[c.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Download"]})]}),c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded border",children:[c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium text-gray-900",children:"Monthly Update Template"}),c.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"For existing applications. Only monthly columns required."})]}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:t,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[c.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Download"]})]})]})]})},YK=()=>{const e=()=>{const t=[{"Applicant ID":"PROSAPP250101000001","Repayment Number":1,"Delay in Days":4},{"Applicant ID":"PROSAPP250101000001","Repayment Number":2,"Delay in Days":0},{"Applicant ID":"PROSAPP250101000001","Repayment Number":3,"Delay in Days":20},{"Applicant ID":"PROSAPP250101000002","Repayment Number":1,"Delay in Days":15}],r=Yt.book_new(),n=Yt.json_to_sheet(t),a=[{wch:20},{wch:15},{wch:15}];n["!cols"]=a,Yt.book_append_sheet(r,n,"Repayment History");const i=`repayment-history-upload-template-${new Date().toISOString().split("T")[0]}.xlsx`;Il(r,i),Se.success("Repayment history template downloaded successfully!")};return c.jsx("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-green-900",children:"Step 1: Download Repayment History Template"}),c.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Download the Excel template for repayment history data"})]}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:e,className:"border-green-300 text-green-700 hover:bg-green-100",children:[c.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})})},XK=async(e,t)=>{console.log("Processing bulk applications:",e.length);const r={successful:0,failed:0,updated:0,statusUpdated:0,errors:[]};for(const n of e)try{const{status:a,uploadMode:s,...i}=n,o={application_id:n.applicant_id,demand_date:n.demand_date,team_lead:n.team_lead,rm_name:n.rm_name,repayment:n.repayment,emi_amount:n.emi_amount,last_month_bounce:n.last_month_bounce,lms_status:n.lms_status,collection_rm:n.collection_rm,amount_collected:n.amount_collected||null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:l,error:u}=await Pe.from("applications").select("applicant_id").eq("applicant_id",n.applicant_id).maybeSingle();if(!!l)r.updated++;else{const{error:m}=await Pe.from("applications").insert([{...i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]);if(m){r.failed++,r.errors.push(`Failed to insert application ${n.applicant_id}: ${m.message}`);continue}else r.successful++}const{error:d}=await Pe.from("collection").insert([o]);if(d){r.failed++,r.errors.push(`Failed to insert into collection for ${n.applicant_id}: ${d.message}`);continue}}catch(a){r.failed++,r.errors.push(`Unexpected error for ${n.applicant_id}: ${a}`)}return r},KK=async(e,t)=>XK(e),qK=({uploadMode:e,uploading:t,onUploadingChange:r,onApplicationsAdded:n,onDialogClose:a})=>{const{user:s}=Ht(),i=l=>{if(l==null||l==="")return null;const u=parseFloat(l);return isNaN(u)?null:u},o=async l=>{var f;const u=(f=l.target.files)==null?void 0:f[0];if(!(!u||!s)){r(!0),Se.loading("Processing file...",{id:"upload"});try{console.log("Starting file upload process with mode:",e);const d=await u.arrayBuffer(),m=Uu(d),h=m.Sheets[m.SheetNames[0]],v=Yt.sheet_to_json(h);if(console.log("Parsed applications data from file:",v.length,"rows"),v.length===0){Se.error("No application data found in the file",{id:"upload"});return}const p=v.map((y,w)=>(console.log(`Transforming application row ${w+1}:`,y),{applicant_id:y["Applicant ID"]||y.applicant_id,applicant_name:y["Applicant Name"]||y.applicant_name,branch_name:y["Branch Name"]||y.branch_name,team_lead:y["Team Lead"]||y.team_lead,rm_name:y["RM Name"]||y.rm_name,dealer_name:y["Dealer Name"]||y.dealer_name,lender_name:y["Lender Name"]||y.lender_name,lms_status:y["LMS Status"]||y.lms_status||"Unpaid",emi_amount:i(y.EMI||y["EMI Amount"]||y.emi_amount),principle_due:i(y["Principle Due"]||y.principle_due),interest_due:i(y["Interest Due"]||y.interest_due),demand_date:y["Demand Date"]||y.demand_date,disbursement_date:y["Disbursement Date"]||y.disbursement_date,loan_amount:i(y["Loan Amount"]||y.loan_amount),vehicle_status:y["Vehicle Status"]||y.vehicle_status,user_id:s.id,applicant_mobile:y["Applicant Mobile Number"]||y.applicant_mobile,applicant_address:y["Applicant Current Address"]||y.applicant_address,house_ownership:y["House Ownership"]||y.house_ownership,co_applicant_name:y["Co-Applicant Name"]||y.co_applicant_name,co_applicant_mobile:y["Coapplicant Mobile Number"]||y.co_applicant_mobile,co_applicant_address:y["Coapplicant Current Address"]||y.co_applicant_address,guarantor_name:y["Guarantor Name"]||y.guarantor_name,guarantor_mobile:y["Guarantor Mobile Number"]||y.guarantor_mobile,guarantor_address:y["Guarantor Current Address"]||y.guarantor_address,reference_name:y["Reference Name"]||y.reference_name,reference_mobile:y["Reference Mobile Number"]||y.reference_mobile,reference_address:y["Reference Address"]||y.reference_address,fi_location:y["FI Submission Location"]||y.fi_location,repayment:y.Repayment||y.repayment,last_month_bounce:i(y["Last Month Bounce"]||y.last_month_bounce),collection_rm:y["Collection RM"]||y.collection_rm,status:y.Status||y.status,uploadMode:e}));console.log("Transformed applications ready for processing:",p.length);const g=await KK(p,s);if(console.log("Bulk processing results:",g),g.errors.length>0){console.error("Upload errors:",g.errors);let y=`Upload completed with some issues:
`;y+=`✅ ${g.successful} new applications added
`,y+=`✅ ${g.updated} applications updated
`,g.statusUpdated>0&&(y+=`✅ ${g.statusUpdated} statuses updated
`),y+=`❌ ${g.failed} applications failed
`,y+=`
First few errors:
${g.errors.slice(0,3).join(`
`)}`,Se.error(y,{id:"upload",duration:1e4})}else{let y=`🎉 Upload successful!
`;y+=`✅ ${g.successful} new applications added
`,y+=`✅ ${g.updated} applications updated`,g.statusUpdated>0&&(y+=`
✅ ${g.statusUpdated} statuses updated`),Se.success(y,{id:"upload",duration:5e3})}n(),a()}catch(d){console.error("Error processing file:",d),Se.error(`Failed to process file: ${d}`,{id:"upload"})}finally{r(!1),l.target.value=""}}};return c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"p-2 mb-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-900",children:[c.jsx("b",{children:"Upload Instructions:"}),c.jsx("br",{}),c.jsxs("ul",{className:"list-disc ml-4",children:[c.jsxs("li",{children:[c.jsx("b",{children:"First-time upload:"})," Fills both ",c.jsx("code",{children:"applications"})," and ",c.jsx("code",{children:"collection"})," tables. ",c.jsx("b",{children:"All columns"})," required (static + monthly)."]}),c.jsxs("li",{children:[c.jsx("b",{children:"Monthly update:"})," Fills only ",c.jsx("code",{children:"collection"})," table. ",c.jsx("b",{children:"Only monthly columns"})," required (team_lead, rm_name, demand_date, repayment, emi_amount, last_month_bounce, lms_status, collection_rm)."]})]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("b",{children:"Note:"})," ",c.jsx("code",{children:"demand_date"})," is required and must be a text value (e.g., ",c.jsx("code",{children:"2024-05-01"}),")."]})]}),c.jsx(Ke,{htmlFor:"file-upload",className:"text-sm font-medium",children:"Step 2: Select File (Excel/CSV)"}),c.jsx(Qr,{id:"file-upload",type:"file",accept:".xlsx,.xls,.csv",onChange:o,disabled:t})]})},QK=({uploadMode:e,uploading:t,onUploadingChange:r,onApplicationsAdded:n,onDialogClose:a})=>{const{user:s}=Ht(),i=l=>{if(l==null||l==="")return null;const u=parseInt(l);return isNaN(u)?null:u},o=async l=>{var f;const u=(f=l.target.files)==null?void 0:f[0];if(!(!u||!s)){r(!0),Se.loading("Processing repayment history file...",{id:"repayment-upload"});try{console.log("Starting repayment history upload process with mode:",e);const d=await u.arrayBuffer(),m=Uu(d),h=m.Sheets[m.SheetNames[0]],v=Yt.sheet_to_json(h);if(console.log("Parsed repayment history data from file:",v.length,"rows"),v.length===0){Se.error("No repayment history data found in the file",{id:"repayment-upload"});return}let p=[];for(const w of v){const x=w["Applicant ID"]||w.application_id;Object.keys(w).forEach(S=>{const b=S.match(/^Repayment Number[_ ](\d+)$/);if(b){const E=i(b[1]),k=i(w[S]);x&&E!==null&&k!==null&&p.push({application_id:x,repayment_number:E,delay_in_days:k})}})}p.length===0&&(p=v.map((w,x)=>({application_id:w["Applicant ID"]||w.application_id,repayment_number:i(w["Repayment Number"]||w.repayment_number),delay_in_days:i(w["Delay in Days"]||w.delay_in_days)}))),console.log("Transformed repayment history ready for processing:",p.length);const g=p.filter(w=>w.application_id&&w.repayment_number!==null&&w.delay_in_days!==null);if(g.length===0){Se.error("No valid repayment history records found. Please check your data.",{id:"repayment-upload"});return}let y={successful:0,failed:0,errors:[]};if(e==="add"){const{data:w,error:x}=await Pe.from("repayment_history").insert(g);x?(console.error("Error inserting repayment history:",x),y.failed=g.length,y.errors.push(`Failed to insert repayment history: ${x.message}`)):(console.log("Successfully inserted repayment history:",g.length,"records"),y.successful=g.length)}else if(e==="update")for(const w of g)try{const{error:x}=await Pe.from("repayment_history").update({repayment_number:w.repayment_number,delay_in_days:w.delay_in_days}).eq("application_id",w.application_id).eq("repayment_number",w.repayment_number);x?(console.error("Error updating repayment history:",x),y.failed++,y.errors.push(`Failed to update repayment history for ${w.application_id}: ${x.message}`)):y.successful++}catch(x){console.error("Error updating repayment history record:",x),y.failed++,y.errors.push(`Failed to update repayment history for ${w.application_id}: ${x}`)}else for(const w of g)try{const{data:x,error:S}=await Pe.from("repayment_history").select("id").eq("application_id",w.application_id).eq("repayment_number",w.repayment_number).maybeSingle();if(S){console.error("Error checking existing record:",S),y.failed++,y.errors.push(`Failed to check existing record for ${w.application_id}: ${S.message}`);continue}if(x){const{error:b}=await Pe.from("repayment_history").update({delay_in_days:w.delay_in_days}).eq("id",x.id);b?(console.error("Error updating existing repayment history:",b),y.failed++,y.errors.push(`Failed to update repayment history for ${w.application_id}: ${b.message}`)):(y.successful++,console.log(`Updated existing repayment history for ${w.application_id}`))}else{const{error:b}=await Pe.from("repayment_history").insert(w);b?(console.error("Error inserting new repayment history:",b),y.failed++,y.errors.push(`Failed to insert repayment history for ${w.application_id}: ${b.message}`)):(y.successful++,console.log(`Inserted new repayment history for ${w.application_id}`))}}catch(x){console.error("Error processing repayment history record:",x),y.failed++,y.errors.push(`Failed to process repayment history for ${w.application_id}: ${x}`)}if(y.errors.length>0){console.error("Repayment history upload errors:",y.errors);let w=`Repayment history upload completed with some issues:
`;w+=`✅ ${y.successful} records processed successfully
`,w+=`❌ ${y.failed} records failed
`,w+=`
First few errors:
${y.errors.slice(0,3).join(`
`)}`,Se.error(w,{id:"repayment-upload",duration:1e4})}else{let w=`🎉 Repayment history upload successful!
`;w+=`✅ ${y.successful} records processed`,Se.success(w,{id:"repayment-upload",duration:5e3})}n(),a()}catch(d){console.error("Error processing repayment history file:",d),Se.error(`Failed to process repayment history file: ${d}`,{id:"repayment-upload"})}finally{r(!1),l.target.value=""}}};return c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"repayment-file-upload",className:"text-sm font-medium",children:"Step 2: Select Repayment History File (Excel/CSV)"}),c.jsx(Qr,{id:"repayment-file-upload",type:"file",accept:".xlsx,.xls,.csv",onChange:o,disabled:t}),c.jsx("p",{className:"text-xs text-gray-500",children:"File should contain: Applicant ID, Repayment Number, Delay in Days"})]})},JK=({onApplicationsAdded:e})=>{const[t,r]=_.useState(!1),[n,a]=_.useState(!1),[s,i]=_.useState("applications"),[o,l]=_.useState("mixed");return c.jsxs(So,{open:t,onOpenChange:r,children:[c.jsx(tf,{asChild:!0,children:c.jsxs(Ee,{variant:"outline",size:"sm",children:[c.jsx(w1,{className:"h-4 w-4 mr-2"}),"Upload Data"]})}),c.jsxs(_i,{className:"sm:max-w-lg",children:[c.jsxs(Si,{children:[c.jsxs(ko,{className:"flex items-center gap-2",children:[c.jsx(GA,{className:"h-5 w-5"}),"Upload Data"]}),c.jsx(rf,{children:"Upload Excel/CSV files containing application data or repayment history. Choose your upload type and mode, then download the appropriate template."})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(z7,{uploadType:s,onTypeChange:i}),c.jsx(V7,{uploadMode:o,onModeChange:l}),s==="applications"?c.jsx(GK,{}):c.jsx(YK,{}),s==="applications"?c.jsx(qK,{uploadMode:o,uploading:n,onUploadingChange:a,onApplicationsAdded:e,onDialogClose:()=>r(!1)}):c.jsx(QK,{uploadMode:o,uploading:n,onUploadingChange:a,onApplicationsAdded:e,onDialogClose:()=>r(!1)}),c.jsxs("div",{className:"text-xs text-gray-500",children:[c.jsx("p",{children:"Supported formats: Excel (.xlsx, .xls) and CSV (.csv)"}),s==="applications"?c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Applications:"})," Upload application data with all fields"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Status Values:"})," Unpaid, Partially Paid, Cash Collected from Customer, Customer Deposited to Bank, Paid"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Note:"})," Invalid status values will default to 'Unpaid'"]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Repayment History:"})," Upload repayment history data only"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Required Fields:"})," Applicant ID, Repayment Number, Delay in Days"]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Note:"})," All fields are required for valid records"]})]})]})]})]})]})},ZK=()=>{const e=()=>{const t=[{"Email (User ID)":"user@example.com","Full Name":"John Doe",Password:"SecurePassword123",Role:"user"}],r=Yt.book_new(),n=Yt.json_to_sheet(t),a=[{wch:25},{wch:20},{wch:15},{wch:10}];n["!cols"]=a,Yt.book_append_sheet(r,n,"User Template");const i=`user-bulk-upload-template-${new Date().toISOString().split("T")[0]}.xlsx`;Il(r,i),Se.success("Template downloaded successfully!")};return c.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-blue-900",children:"Step 1: Download Template"}),c.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Download the Excel template with Role column for user management"})]}),c.jsxs(Ee,{variant:"outline",size:"sm",onClick:e,className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[c.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})})},eq=({defaultRole:e,onUsersAdded:t,onDialogClose:r})=>{const[n,a]=_.useState(!1),[s,i]=_.useState(null),o=u=>{var d,m;const f=(d=u.target.files)==null?void 0:d[0];if(f){const h=(m=f.name.split(".").pop())==null?void 0:m.toLowerCase();h==="xlsx"||h==="xls"?i(f):(Se.error("Please select an Excel file (.xlsx or .xls)"),u.target.value="")}},l=async()=>{if(s){a(!0);try{const u=await s.arrayBuffer(),f=Uu(u,{type:"array"}),d=f.SheetNames[0],m=f.Sheets[d],h=Yt.sheet_to_json(m);if(console.log("Parsed Excel data:",h),h.length===0){Se.error("No data found in Excel file");return}const v=["Email (User ID)","Full Name","Password"],p=h[0],g=v.filter(b=>!(b in p));if(g.length>0){Se.error(`Missing required columns: ${g.join(", ")}`);return}const y=h.map(b=>({email:String(b["Email (User ID)"]).trim(),fullName:String(b["Full Name"]).trim(),password:String(b.Password).trim(),role:b.Role?String(b.Role).toLowerCase():e}));console.log("Calling Edge Function with users:",y.length);const{data:w,error:x}=await Pe.functions.invoke("create-bulk-users",{body:{users:y}});if(x){console.error("Edge Function error:",x),Se.error("Failed to process users. Please try again.");return}const S=w;S.successful>0&&Se.success(`Successfully created/updated ${S.successful} users with roles!`),S.failed>0&&(Se.error(`Failed to process ${S.failed} users. Check console for details.`),console.log("Failed user processing details:",S.errors)),S.successful>0&&t(),i(null),r()}catch(u){console.error("Excel processing error:",u),Se.error("Failed to process Excel file. Please check the format.")}finally{a(!1)}}};return c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Step 2: Upload Your File"}),c.jsx(Ke,{htmlFor:"excel-file",children:"Select Excel File"}),c.jsx(Qr,{id:"excel-file",type:"file",accept:".xlsx,.xls",onChange:o,className:"mt-1"}),c.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Supported formats: .xlsx, .xls"})]}),s&&c.jsxs("div",{className:"p-3 bg-green-50 rounded-md border border-green-200",children:[c.jsxs("p",{className:"text-sm font-medium text-green-800",children:["Selected file: ",s.name]}),c.jsxs("p",{className:"text-xs text-green-600",children:["Size: ",(s.size/1024).toFixed(1)," KB"]})]}),c.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[c.jsx(Ee,{variant:"outline",onClick:r,disabled:n,children:"Cancel"}),c.jsx(Ee,{onClick:l,disabled:!s||n,children:n?"Processing...":"Upload Users"})]})]})},tq=({onUsersAdded:e})=>{const[t,r]=_.useState(!1),[n,a]=_.useState("user");return c.jsxs(So,{open:t,onOpenChange:r,children:[c.jsx(tf,{asChild:!0,children:c.jsxs(Ee,{variant:"outline",size:"sm",children:[c.jsx(w1,{className:"h-4 w-4 mr-2"}),"Bulk Upload Users"]})}),c.jsxs(_i,{className:"sm:max-w-[500px]",children:[c.jsxs(Si,{children:[c.jsx(ko,{children:"Bulk Upload Users"}),c.jsx(rf,{children:"Upload multiple users with role assignment using an Excel file. Download the template to get started."})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(ZK,{}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"default-role",children:"Default Role (if not specified in Excel)"}),c.jsxs(jn,{value:n,onValueChange:s=>a(s),children:[c.jsx(mn,{children:c.jsx(Dn,{placeholder:"Select default role"})}),c.jsxs(pn,{children:[c.jsx(bt,{value:"user",children:"User"}),c.jsx(bt,{value:"admin",children:"Admin"})]})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"This role will be assigned to users where the Role column is empty"})]}),c.jsx(eq,{defaultRole:n,onUsersAdded:e,onDialogClose:()=>r(!1)})]})]})]})},rq=()=>{const[e,t]=_.useState(!1),[r,n]=_.useState(""),[a,s]=_.useState(""),[i,o]=_.useState(""),[l,u]=_.useState(!1),f=async()=>{u(!0),console.log("Creating test user for kanishk@prosparity.in");try{const{data:m,error:h}=await Pe.auth.signUp({email:"kanishk@prosparity.in",password:"Kanishk@123",options:{data:{full_name:"Kanishk"},emailRedirectTo:void 0}});console.log("Test user creation response:",{signUpData:m,signUpError:h}),h&&!h.message.includes("User already registered")?(console.error("Error creating test user:",h),Se.error(`Error creating test user: ${h.message}`)):(console.log("Test user created successfully or already exists"),Se.success("Test user account is ready! You can now try signing in."))}catch(m){console.error("Unexpected error creating test user:",m),Se.error("An unexpected error occurred while creating test user")}finally{u(!1)}},d=async m=>{m.preventDefault(),u(!0),console.log("Creating user with:",{email:r,fullName:i});try{const{data:h,error:v}=await Pe.auth.signUp({email:r,password:a,options:{data:{full_name:i},emailRedirectTo:void 0}});console.log("User creation response:",{data:h,error:v}),v?(console.error("User creation error:",v),v.message.includes("User already registered")?Se.error("User already exists with this email"):Se.error(v.message)):(console.log("User created successfully"),Se.success("User created successfully! They can now sign in."),n(""),s(""),o(""),t(!1))}catch(h){console.error("Unexpected error creating user:",h),Se.error("An error occurred while creating the user")}finally{u(!1)}};return c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Ee,{variant:"outline",size:"sm",onClick:f,disabled:l,children:l?"Creating...":"Setup Test Account"}),c.jsxs(So,{open:e,onOpenChange:t,children:[c.jsx(tf,{asChild:!0,children:c.jsxs(Ee,{variant:"outline",size:"sm",children:[c.jsx(pu,{className:"h-4 w-4 mr-2"}),"Settings"]})}),c.jsxs(_i,{className:"sm:max-w-md",children:[c.jsxs(Si,{children:[c.jsxs(ko,{className:"flex items-center gap-2",children:[c.jsx(B0,{className:"h-5 w-5"}),"Create New User"]}),c.jsx(rf,{children:"Add a new user to the system. They will be able to log in with these credentials."})]}),c.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"fullName",children:"Full Name"}),c.jsx(Qr,{id:"fullName",type:"text",placeholder:"Enter full name",value:i,onChange:m=>o(m.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"email",children:"Email"}),c.jsx(Qr,{id:"email",type:"email",placeholder:"Enter email address",value:r,onChange:m=>n(m.target.value),required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"password",children:"Password"}),c.jsx(Qr,{id:"password",type:"password",placeholder:"Enter password",value:a,onChange:m=>s(m.target.value),required:!0,minLength:6})]}),c.jsxs("div",{className:"flex justify-end space-x-2",children:[c.jsx(Ee,{type:"button",variant:"outline",onClick:()=>t(!1),disabled:l,children:"Cancel"}),c.jsx(Ee,{type:"submit",disabled:l,children:l?"Creating...":"Create User"})]})]})]})]})]})},nq=({onApplicationsAdded:e,onUsersAdded:t})=>c.jsx("div",{className:"space-y-6",children:c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsxs(gt,{className:"flex items-center gap-2",children:[c.jsx(Uk,{className:"h-5 w-5"}),"Data Management"]})}),c.jsx(Je,{children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(w1,{className:"h-4 w-4 text-blue-600"}),c.jsx("h3",{className:"font-medium",children:"Application Data"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Bulk upload applications from Excel files"}),c.jsx(JK,{onApplicationsAdded:e})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(gu,{className:"h-4 w-4 text-green-600"}),c.jsx("h3",{className:"font-medium",children:"User Data"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Bulk upload users from Excel files"}),c.jsx(tq,{onUsersAdded:t})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[c.jsx(gu,{className:"h-4 w-4 text-purple-600"}),c.jsx("h3",{className:"font-medium",children:"User Creation"})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create individual user accounts"}),c.jsx(rq,{})]})]})})]})}),aq=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(!0),[a,s]=_.useState(""),[i,o]=_.useState("all"),l=async()=>{try{const{data:d,error:m}=await Pe.from("status_change_requests").select("*").order("request_timestamp",{ascending:!1});if(m){console.error("Error fetching request history:",m),Se.error("Failed to fetch request history");return}t(d||[])}catch(d){console.error("Error fetching request history:",d),Se.error("Failed to fetch request history")}finally{n(!1)}};_.useEffect(()=>{l()},[]);const u=e.filter(d=>{var v,p,g,y;const m=d.application_id.toLowerCase().includes(a.toLowerCase())||((v=d.requested_by_email)==null?void 0:v.toLowerCase().includes(a.toLowerCase()))||((p=d.requested_by_name)==null?void 0:p.toLowerCase().includes(a.toLowerCase()))||((g=d.reviewed_by_email)==null?void 0:g.toLowerCase().includes(a.toLowerCase()))||((y=d.reviewed_by_name)==null?void 0:y.toLowerCase().includes(a.toLowerCase())),h=i==="all"||d.approval_status===i;return m&&h}),f=d=>{switch(d){case"pending":return"bg-yellow-50 text-yellow-800 border-yellow-200";case"approved":return"bg-green-50 text-green-800 border-green-200";case"rejected":return"bg-red-50 text-red-800 border-red-200";default:return"bg-gray-50 text-gray-800 border-gray-200"}};return r?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading request history..."})]}):c.jsx("div",{className:"space-y-6",children:c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsxs(gt,{className:"flex items-center gap-2",children:[c.jsx(Uh,{className:"h-5 w-5"}),"Status Change Request History"]})}),c.jsxs(Je,{children:[c.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(x1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx(Qr,{placeholder:"Search by application ID, user name, or email...",value:a,onChange:d=>s(d.target.value),className:"pl-10"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx($k,{className:"h-4 w-4 text-gray-400"}),c.jsxs(jn,{value:i,onValueChange:o,children:[c.jsx(mn,{className:"w-32",children:c.jsx(Dn,{})}),c.jsxs(pn,{children:[c.jsx(bt,{value:"all",children:"All Status"}),c.jsx(bt,{value:"pending",children:"Pending"}),c.jsx(bt,{value:"approved",children:"Approved"}),c.jsx(bt,{value:"rejected",children:"Rejected"})]})]})]})]}),c.jsx("div",{className:"border rounded-lg",children:c.jsxs(Yl,{children:[c.jsx(uf,{children:c.jsxs(ma,{children:[c.jsx(ft,{children:"Application ID"}),c.jsx(ft,{children:"Status Change"}),c.jsx(ft,{children:"Requested By"}),c.jsx(ft,{children:"Request Date"}),c.jsx(ft,{children:"Status"}),c.jsx(ft,{children:"Reviewed By"}),c.jsx(ft,{children:"Review Date"}),c.jsx(ft,{children:"Comments"})]})}),c.jsx(Xl,{children:u.map(d=>c.jsxs(ma,{children:[c.jsx(mt,{children:c.jsx("div",{className:"font-medium text-blue-600",children:d.application_id})}),c.jsx(mt,{children:c.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[c.jsx("span",{className:"px-2 py-1 bg-red-50 text-red-700 rounded",children:d.current_status}),c.jsx("span",{children:"→"}),c.jsx("span",{className:"px-2 py-1 bg-green-50 text-green-700 rounded",children:d.requested_status})]})}),c.jsx(mt,{children:c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium",children:d.requested_by_name||"Unknown"}),c.jsx("div",{className:"text-gray-500",children:d.requested_by_email})]})}),c.jsx(mt,{children:c.jsx("div",{className:"text-sm text-gray-600",children:vt(new Date(d.request_timestamp),"dd-MMM-yyyy HH:mm")})}),c.jsx(mt,{children:c.jsx(Fr,{variant:"outline",className:f(d.approval_status),children:d.approval_status})}),c.jsx(mt,{children:d.reviewed_by_name||d.reviewed_by_email?c.jsxs("div",{className:"text-sm",children:[c.jsx("div",{className:"font-medium",children:d.reviewed_by_name||"Unknown"}),c.jsx("div",{className:"text-gray-500",children:d.reviewed_by_email})]}):c.jsx("span",{className:"text-gray-400 text-sm",children:"Not reviewed"})}),c.jsx(mt,{children:d.review_timestamp?c.jsx("div",{className:"text-sm text-gray-600",children:vt(new Date(d.review_timestamp),"dd-MMM-yyyy HH:mm")}):c.jsx("span",{className:"text-gray-400 text-sm",children:"-"})}),c.jsx(mt,{children:d.review_comments?c.jsx("div",{className:"text-sm max-w-xs truncate",title:d.review_comments,children:d.review_comments}):c.jsx("span",{className:"text-gray-400 text-sm",children:"No comments"})})]},d.id))})]})}),u.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-500",children:e.length===0?"No status change requests found":"No requests match your search criteria"})]})]})})};var _m="Switch",[sq,Fq]=In(_m),[iq,oq]=sq(_m),e3=_.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:a,defaultChecked:s,required:i,disabled:o,value:l="on",onCheckedChange:u,form:f,...d}=e,[m,h]=_.useState(null),v=Qe(t,x=>h(x)),p=_.useRef(!1),g=m?f||!!m.closest("form"):!0,[y,w]=Xa({prop:a,defaultProp:s??!1,onChange:u,caller:_m});return c.jsxs(iq,{scope:r,checked:y,disabled:o,children:[c.jsx(je.button,{type:"button",role:"switch","aria-checked":y,"aria-required":i,"data-state":a3(y),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:v,onClick:Te(e.onClick,x=>{w(S=>!S),g&&(p.current=x.isPropagationStopped(),p.current||x.stopPropagation())})}),g&&c.jsx(n3,{control:m,bubbles:!p.current,name:n,value:l,checked:y,required:i,disabled:o,form:f,style:{transform:"translateX(-100%)"}})]})});e3.displayName=_m;var t3="SwitchThumb",r3=_.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,a=oq(t3,r);return c.jsx(je.span,{"data-state":a3(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t})});r3.displayName=t3;var lq="SwitchBubbleInput",n3=_.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...a},s)=>{const i=_.useRef(null),o=Qe(i,s),l=V1(r),u=P1(t);return _.useEffect(()=>{const f=i.current;if(!f)return;const d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==r&&h){const v=new Event("click",{bubbles:n});h.call(f,r),f.dispatchEvent(v)}},[l,r,n]),c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});n3.displayName=lq;function a3(e){return e?"checked":"unchecked"}var s3=e3,cq=r3;const Rc=_.forwardRef(({className:e,...t},r)=>c.jsx(s3,{className:Ae("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:c.jsx(cq,{className:Ae("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Rc.displayName=s3.displayName;const uq=()=>{const[e,t]=_.useState({requireApprovalForPaid:!0,requireApprovalForOtherStatuses:!1,allowedApprovers:"admins_only",autoRejectAfterDays:7,requireApprovalComments:!1,emailNotifications:!1,approvalNotificationTemplate:"Your status change request for application {application_id} has been approved.",rejectionNotificationTemplate:"Your status change request for application {application_id} has been rejected. Reason: {comments}"}),[r,n]=_.useState(!1),a=async()=>{n(!0);try{await new Promise(i=>setTimeout(i,1e3)),Se.success("Workflow settings saved successfully")}catch(i){console.error("Error saving workflow settings:",i),Se.error("Failed to save workflow settings")}finally{n(!1)}},s=(i,o)=>{t(l=>({...l,[i]:o}))};return c.jsx("div",{className:"space-y-6",children:c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsxs(gt,{className:"flex items-center gap-2",children:[c.jsx(pu,{className:"h-5 w-5"}),"Approval Workflow Configuration"]})}),c.jsxs(Je,{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Approval Requirements"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Ke,{htmlFor:"require-paid-approval",children:'Require approval for "Paid" status'}),c.jsx("p",{className:"text-sm text-gray-600",children:'When enabled, changing status to "Paid" requires admin approval'})]}),c.jsx(Rc,{id:"require-paid-approval",checked:e.requireApprovalForPaid,onCheckedChange:i=>s("requireApprovalForPaid",i)})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Ke,{htmlFor:"require-other-approval",children:"Require approval for other status changes"}),c.jsx("p",{className:"text-sm text-gray-600",children:"When enabled, all status changes require admin approval"})]}),c.jsx(Rc,{id:"require-other-approval",checked:e.requireApprovalForOtherStatuses,onCheckedChange:i=>s("requireApprovalForOtherStatuses",i)})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Ke,{htmlFor:"require-comments",children:"Require comments for approval/rejection"}),c.jsx("p",{className:"text-sm text-gray-600",children:"When enabled, approvers must provide comments"})]}),c.jsx(Rc,{id:"require-comments",checked:e.requireApprovalComments,onCheckedChange:i=>s("requireApprovalComments",i)})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Approver Configuration"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"allowed-approvers",children:"Who can approve requests?"}),c.jsxs(jn,{value:e.allowedApprovers,onValueChange:i=>s("allowedApprovers",i),children:[c.jsx(mn,{children:c.jsx(Dn,{})}),c.jsxs(pn,{children:[c.jsx(bt,{value:"admins_only",children:"Admins Only"}),c.jsx(bt,{value:"admins_and_managers",children:"Admins and Managers"})]})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"auto-reject-days",children:"Auto-reject requests after (days)"}),c.jsxs(jn,{value:e.autoRejectAfterDays.toString(),onValueChange:i=>s("autoRejectAfterDays",parseInt(i)),children:[c.jsx(mn,{children:c.jsx(Dn,{})}),c.jsxs(pn,{children:[c.jsx(bt,{value:"3",children:"3 days"}),c.jsx(bt,{value:"7",children:"7 days"}),c.jsx(bt,{value:"14",children:"14 days"}),c.jsx(bt,{value:"30",children:"30 days"}),c.jsx(bt,{value:"0",children:"Never auto-reject"})]})]})]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Notification Settings"}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(Ke,{htmlFor:"email-notifications",children:"Send email notifications"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Send emails when requests are approved or rejected"})]}),c.jsx(Rc,{id:"email-notifications",checked:e.emailNotifications,onCheckedChange:i=>s("emailNotifications",i)})]}),e.emailNotifications&&c.jsxs("div",{className:"space-y-4 pl-4 border-l-2 border-gray-200",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"approval-template",children:"Approval notification template"}),c.jsx(sh,{id:"approval-template",value:e.approvalNotificationTemplate,onChange:i=>s("approvalNotificationTemplate",i.target.value),placeholder:"Template for approval notifications...",rows:3}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Available variables: ","{application_id}",", ","{requested_status}",", ","{approver_name}"]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(Ke,{htmlFor:"rejection-template",children:"Rejection notification template"}),c.jsx(sh,{id:"rejection-template",value:e.rejectionNotificationTemplate,onChange:i=>s("rejectionNotificationTemplate",i.target.value),placeholder:"Template for rejection notifications...",rows:3}),c.jsxs("p",{className:"text-xs text-gray-500",children:["Available variables: ","{application_id}",", ","{requested_status}",", ","{approver_name}",", ","{comments}"]})]})]})]}),c.jsx("div",{className:"flex justify-end pt-4 border-t",children:c.jsxs(Ee,{onClick:a,disabled:r,className:"flex items-center gap-2",children:[c.jsx(L0,{className:"h-4 w-4"}),r?"Saving...":"Save Settings"]})})]})]})})},fq=()=>{const{user:e}=Ht(),{isAdmin:t,loading:r}=B1(),n=ef(),a=()=>{Se.success("Applications data updated. Refreshing main dashboard...")},s=()=>{Se.success("Users added successfully!")};return r?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading..."})]})}):!e||!t?c.jsx(c8,{to:"/",replace:!0}):c.jsx("div",{className:"min-h-screen bg-gray-50",children:c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("div",{className:"flex items-center gap-4 mb-4",children:c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>n("/"),className:"flex items-center gap-2",children:[c.jsx(F0,{className:"h-4 w-4"}),"Back to Dashboard"]})}),c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Settings"}),c.jsx("p",{className:"text-gray-600 mt-2",children:"Manage users, data, view request history, and configure workflow settings"})]}),c.jsx(qe,{children:c.jsx(Je,{className:"p-6",children:c.jsxs(tT,{defaultValue:"users",className:"w-full",children:[c.jsxs(wv,{className:"grid w-full grid-cols-4",children:[c.jsxs(us,{value:"users",className:"flex items-center gap-2",children:[c.jsx(gu,{className:"h-4 w-4"}),"User Management"]}),c.jsxs(us,{value:"data",className:"flex items-center gap-2",children:[c.jsx(Uk,{className:"h-4 w-4"}),"Data Management"]}),c.jsxs(us,{value:"history",className:"flex items-center gap-2",children:[c.jsx(Uh,{className:"h-4 w-4"}),"Request History"]}),c.jsxs(us,{value:"settings",className:"flex items-center gap-2",children:[c.jsx(pu,{className:"h-4 w-4"}),"Workflow Settings"]})]}),c.jsx(fs,{value:"users",className:"mt-6",children:c.jsx(H7,{})}),c.jsx(fs,{value:"data",className:"mt-6",children:c.jsx(nq,{onApplicationsAdded:a,onUsersAdded:s})}),c.jsx(fs,{value:"history",className:"mt-6",children:c.jsx(aq,{})}),c.jsx(fs,{value:"settings",className:"mt-6",children:c.jsx(uq,{})})]})})})]})})},i3=()=>{const{user:e}=Ht(),[t,r]=_.useState(!1),n=_.useCallback(async(i,o)=>{if(!e)return null;try{let l=Pe.from("ptp_dates").select("ptp_date").eq("application_id",i).order("created_at",{ascending:!1}).limit(1);if(o){const{start:d,end:m}=hi(o);l=l.gte("demand_date",d).lte("demand_date",m)}const{data:u,error:f}=await l.maybeSingle();return f?(console.error("Error fetching PTP date:",f),null):(u==null?void 0:u.ptp_date)||null}catch(l){return console.error("Error fetching PTP date:",l),null}},[e]),a=_.useCallback(async(i,o)=>{if(!e||i.length===0)return{};try{console.log("🔄 Fetching PTP dates for",i.length,"applications"),console.log("Demand month filter:",o||"All dates");let l=Pe.from("ptp_dates").select("application_id, ptp_date, created_at, demand_date").in("application_id",i).order("application_id",{ascending:!0}).order("created_at",{ascending:!1});if(o){const{start:h,end:v}=hi(o);l=l.gte("demand_date",h).lte("demand_date",v)}const{data:u,error:f}=await l;if(f)return console.error("Error fetching PTP dates:",f),{};const d={},m=new Set;return u==null||u.forEach(h=>{m.has(h.application_id)||(d[h.application_id]=h.ptp_date,m.add(h.application_id))}),console.log("✅ Fetched PTP dates:",Object.keys(d).length,"applications processed"),d}catch(l){return console.error("Error fetching PTP dates:",l),{}}},[e]),s=_.useCallback(async(i,o,l)=>{if(!e||!l)return console.error("PTP Update Failed: User not authenticated or demand date missing"),!1;console.log("=== PTP UPDATE ATTEMPT - USING UPSERT ==="),console.log("Application ID:",i),console.log("Demand Date:",l),console.log("User ID:",e.id),console.log("New PTP Date:",o),console.log("Is clearing date:",o===null||o===""),r(!0);try{if(!i||i.trim()==="")return console.error("PTP Update Failed: Invalid application ID"),!1;if(o&&o.trim()!==""){const h=new Date(o);if(isNaN(h.getTime()))return console.error("PTP Update Failed: Invalid PTP date format:",o),!1}const u=o&&o.trim()!==""?o:null;let f;if(l.match(/^\d{4}-\d{2}$/)){const[h,v]=l.split("-").map(Number);if(v<1||v>12)return console.error("PTP Update Failed: Invalid month in demand date:",l),!1;if(new Date(h,v-1,5).getMonth()!==v-1)return console.error("PTP Update Failed: Invalid date would be created from:",l),!1;f=`${l}-05`}else{const h=new Date(l);if(isNaN(h.getTime()))return console.error("PTP Update Failed: Invalid demand date format:",l),!1;f=l}console.log("Attempting to upsert PTP date record..."),console.log("Final PTP Date value:",u),console.log("EMI Date:",f);const{error:d,data:m}=await Pe.from("ptp_dates").upsert({application_id:i,ptp_date:u,demand_date:f,user_id:e.id},{onConflict:"application_id,demand_date",ignoreDuplicates:!1}).select().single();return d?(console.error("❌ PTP Upsert Error:",d),!1):(console.log("✅ PTP date record upserted:",m),!0)}catch(u){return console.error("PTP Update Failed: Unexpected error:",u),!1}finally{r(!1)}},[e]);return{fetchPtpDate:n,fetchPtpDates:a,updatePtpDate:s,loading:t}},dq=()=>{const{user:e}=Ht(),[t,r]=_.useState(!1),n=_.useCallback(async i=>{if(!e)return null;try{const{data:o,error:l}=await Pe.from("payment_dates").select("paid_date").eq("application_id",i).order("created_at",{ascending:!1}).limit(1).maybeSingle();return l?(console.error("Error fetching payment date:",l),null):(o==null?void 0:o.paid_date)||null}catch(o){return console.error("Error fetching payment date:",o),null}},[e]),a=_.useCallback(async i=>{if(!e||i.length===0)return{};try{const{data:o,error:l}=await Pe.from("payment_dates").select("application_id, paid_date, created_at").in("application_id",i).order("created_at",{ascending:!1});if(l)return console.error("Error fetching payment dates:",l),{};const u={};return o==null||o.forEach(f=>{f.paid_date&&!u[f.application_id]&&(u[f.application_id]=f.paid_date)}),u}catch(o){return console.error("Error fetching payment dates:",o),{}}},[e]),s=_.useCallback(async(i,o)=>{if(!e)return!1;r(!0);try{const{error:l}=await Pe.from("payment_dates").insert({application_id:i,paid_date:o,user_id:e.id});return l?(console.error("Error updating payment date:",l),!1):!0}catch(l){return console.error("Error updating payment date:",l),!1}finally{r(!1)}},[e]);return{fetchPaymentDate:n,fetchPaymentDates:a,updatePaymentDate:s,loading:t}},hq=({page:e=1,pageSize:t=50}={})=>{const{user:r}=Ht(),{fetchFieldStatus:n}=WT(),{fetchPtpDates:a}=i3(),{fetchPaymentDates:s}=dq(),{fetchCommentsByApplications:i}=rT(),[o,l]=_.useState([]),[u,f]=_.useState([]),[d,m]=_.useState(0),[h,v]=_.useState(!0),p=_.useCallback(async x=>{try{const{data:S,error:b}=await Pe.from("contact_calling_status").select("application_id, contact_type, status, created_at").in("application_id",x).order("created_at",{ascending:!1});if(b)return console.error("Error fetching contact statuses:",b),{};const E={};return S==null||S.forEach(k=>{E[k.application_id]||(E[k.application_id]={});const T=k.contact_type.toLowerCase();E[k.application_id][T]||(E[k.application_id][T]=k.status)}),E}catch(S){return console.error("Error in fetchContactStatusesForApps:",S),{}}},[]),g=_.useCallback((x,S,b,E,k,T)=>x.map(N=>{const O=k[N.applicant_id]||{};return{...N,field_status:S[N.applicant_id]||"Unpaid",ptp_date:b[N.applicant_id],paid_date:E[N.applicant_id],applicant_calling_status:O.applicant||"Not Called",co_applicant_calling_status:O.co_applicant||"Not Called",guarantor_calling_status:O.guarantor||"Not Called",reference_calling_status:O.reference||"Not Called",latest_calling_status:O.latest||"No Calls",recent_comments:T[N.applicant_id]||[]}}),[]),y=_.useCallback(async()=>{if(r){v(!0);try{console.log(`Fetching applications page ${e} (${t} per page)`);const{count:x}=await Pe.from("applications").select("*",{count:"exact",head:!0});m(x||0);const[S,b]=await Promise.all([Pe.from("applications").select("*").order("applicant_name",{ascending:!0}),Pe.from("applications").select("*").order("applicant_name",{ascending:!0}).range((e-1)*t,e*t-1)]);if(S.error){console.error("Error fetching all applications:",S.error);return}if(b.error){console.error("Error fetching paginated applications:",b.error);return}const E=S.data,k=b.data,T=(E==null?void 0:E.map(K=>K.applicant_id))||[],[N,O,W,P,G]=await Promise.all([n(T),a(T),s(T),p(T),i(T)]),X=g(k,N,O,W,P,G),V=g(E,N,O,W,P,G);console.log("Enhanced applications with all related data"),l(X),f(V)}catch(x){console.error("Error fetching applications:",x)}finally{v(!1)}}},[r,e,t,n,a,s,p,i,g]);return _.useEffect(()=>{r&&y()},[r,y]),_.useMemo(()=>({applications:o,allApplications:u,totalCount:d,totalPages:Math.ceil(d/t),currentPage:e,loading:h,refetch:y}),[o,u,d,t,e,h,y])},Up=new Map,mq=(e,t)=>{const{fetchFieldStatus:r}=vv(),[n,a]=_.useState([]),[s,i]=_.useState(!1),[o,l]=_.useState(null),u=_.useMemo(()=>`payment-${t||"all"}-${e.length}`,[t,e.length]);return _.useEffect(()=>{const f=async()=>{if(Up.has(u)){console.log("📊 Cache HIT for payment data:",u),a(Up.get(u)),i(!1);return}i(!0),l(null);try{console.log("📊 Cache MISS - Fast-loading payment data for month:",t);let d=Pe.from("collection").select(`
            application_id,
            demand_date,
            applications!inner(
              applicant_id,
              branch_name,
              rm_name,
              collection_rm,
              lms_status
            )
          `);if(t){const x=Tu(t);if(!x||!x.match(/^\d{4}-\d{2}$/))throw new Error(`Invalid month format: ${t}`);const{start:S,end:b}=hi(x);d=d.gte("demand_date",S).lte("demand_date",b)}const{data:m,error:h}=await d;if(h)throw console.error("Error fetching collection data:",h),new Error(`Failed to fetch collection data: ${h.message}`);if(!m||m.length===0){console.log("No collection data found for month:",t),a([]);return}const v=m.map(x=>x.application_id);console.log(`📊 Processing ${v.length} applications for payment analysis`);const p=t?Tu(t):void 0,g=await r(v,p,!1);console.log("🔍 Field status loaded for",Object.keys(g).length,"applications");const y=new Map;m.forEach(x=>{if(!x.applications){console.warn("Missing application data for record:",x.application_id);return}const S=x.applications,b=(S==null?void 0:S.branch_name)||"Unknown Branch",E=(S==null?void 0:S.collection_rm)||(S==null?void 0:S.rm_name)||"Unknown RM";let k=g[x.application_id];k||(k=S.lms_status||"Unpaid",console.log(`🔄 Using fallback status for ${x.application_id}: ${k}`)),y.has(b)||y.set(b,{branch_name:b,total_stats:{rm_name:b,branch_name:b,unpaid:0,partially_paid:0,paid_pending_approval:0,paid:0,others:0,total:0},rm_stats:[]});const T=y.get(b);let N=T.rm_stats.find(O=>O.rm_name===E);switch(N||(N={rm_name:E,branch_name:b,unpaid:0,partially_paid:0,paid_pending_approval:0,paid:0,others:0,total:0},T.rm_stats.push(N)),N.total++,T.total_stats.total++,k){case"Unpaid":N.unpaid++,T.total_stats.unpaid++;break;case"Partially Paid":N.partially_paid++,T.total_stats.partially_paid++;break;case"Paid (Pending Approval)":N.paid_pending_approval++,T.total_stats.paid_pending_approval++;break;case"Paid":N.paid++,T.total_stats.paid++;break;case"Cash Collected from Customer":case"Customer Deposited to Bank":default:N.others++,T.total_stats.others++;break}});const w=Array.from(y.values()).map(x=>({...x,rm_stats:x.rm_stats.sort((S,b)=>b.total-S.total)})).sort((x,S)=>S.total_stats.total-x.total_stats.total);console.log("📈 Payment data processing complete. Final status distribution:"),w.forEach(x=>{console.log(`Branch ${x.branch_name}:`,{unpaid:x.total_stats.unpaid,partially_paid:x.total_stats.partially_paid,paid_pending_approval:x.total_stats.paid_pending_approval,paid:x.total_stats.paid,others:x.total_stats.others,total:x.total_stats.total})}),Up.set(u,w),console.log("📊 Payment data cached with key:",u),a(w)}catch(d){console.error("Error in fetchPaymentData:",d),l(d),a([])}finally{i(!1)}};e&&e.length>0?f():(console.log("No applications provided to useBranchPaymentData"),a([]))},[t,r,e]),{data:n,loading:s,error:o}},lr=({value:e,onClick:t,className:r,colorClass:n})=>c.jsx(mt,{className:Ae("text-center cursor-pointer hover:bg-muted/50 transition-colors",n,r),onClick:t,children:e}),pq=({applications:e,onDrillDown:t})=>{const[r,n]=_.useState("Jul-25"),[a,s]=_.useState(new Set),{data:i,loading:o,error:l}=mq(e,r),u=h=>{const v=new Set(a);v.has(h)?v.delete(h):v.add(h),s(v)},f=["Jun-25","Jul-25"],d=(h,v,p)=>{t({branch_name:h,rm_name:v,status_type:p,selectedEmiMonth:r})},m=i.reduce((h,v)=>({unpaid:h.unpaid+v.total_stats.unpaid,partially_paid:h.partially_paid+v.total_stats.partially_paid,paid_pending_approval:h.paid_pending_approval+v.total_stats.paid_pending_approval,paid:h.paid+v.total_stats.paid,others:h.others+v.total_stats.others,total:h.total+v.total_stats.total}),{unpaid:0,partially_paid:0,paid_pending_approval:0,paid:0,others:0,total:0});return o?c.jsxs(qe,{children:[c.jsxs(pt,{children:[c.jsx(gt,{children:"Branch Payment Status Analysis"}),c.jsx(Yi,{children:"Payment status breakdown by branch and collection RM"})]}),c.jsx(Je,{children:c.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-100 border-t-blue-600"}),c.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-transparent border-t-blue-300 animate-ping"})]}),c.jsxs("div",{className:"mt-4 text-center",children:[c.jsx("p",{className:"text-base font-medium text-gray-700 animate-pulse",children:"Loading payment data..."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Analyzing branch performance metrics"})]}),c.jsx("div",{className:"mt-4 w-48 bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse",style:{width:"70%"}})})]})})]}):l?c.jsxs(qe,{children:[c.jsxs(pt,{children:[c.jsx(gt,{children:"Branch Payment Status Analysis"}),c.jsx(Yi,{children:"Payment status breakdown by branch and collection RM"})]}),c.jsx(Je,{children:c.jsxs("div",{className:"text-center py-8 text-red-600",children:[c.jsx("p",{className:"text-lg font-medium",children:"Error loading payment data"}),c.jsx("p",{className:"text-sm",children:l.message})]})})]}):c.jsxs(qe,{children:[c.jsx(pt,{children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx(gt,{children:"Branch Payment Status Analysis"}),c.jsxs(Yi,{children:["Payment status breakdown by branch and collection RM for ",r]})]}),c.jsx("div",{className:"flex gap-4 items-center",children:c.jsxs(jn,{value:r,onValueChange:n,children:[c.jsx(mn,{className:"w-48",children:c.jsx(Dn,{placeholder:"Select EMI Month"})}),c.jsx(pn,{children:f.map(h=>c.jsx(bt,{value:h,children:h},h))})]})})]})}),c.jsx(Je,{children:i.length===0?c.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No payment data available for the selected month"}):c.jsx("div",{className:"rounded-md border",children:c.jsxs(Yl,{children:[c.jsx(uf,{children:c.jsxs(ma,{children:[c.jsx(ft,{className:"font-medium w-8"}),c.jsx(ft,{className:"font-medium w-48",children:"Branch / RM"}),c.jsx(ft,{className:"font-medium text-center w-20",children:"Unpaid"}),c.jsx(ft,{className:"font-medium text-center w-24",children:"Partially Paid"}),c.jsx(ft,{className:"font-medium text-center w-20",children:"Paid (Pending)"}),c.jsx(ft,{className:"font-medium text-center w-16",children:"Paid"}),c.jsx(ft,{className:"font-medium text-center w-20",children:"Others"}),c.jsx(ft,{className:"font-medium text-center w-16",children:"Total"})]})}),c.jsxs(Xl,{children:[i.map(h=>c.jsxs(ge.Fragment,{children:[c.jsxs(ma,{className:"bg-muted/30 font-medium",children:[c.jsx(mt,{children:c.jsx(Ee,{variant:"ghost",size:"sm",onClick:()=>u(h.branch_name),className:"h-6 w-6 p-0",children:a.has(h.branch_name)?c.jsx(wo,{className:"h-4 w-4"}):c.jsx(Lh,{className:"h-4 w-4"})})}),c.jsx(mt,{className:"font-bold text-sm",children:h.branch_name}),c.jsx(lr,{value:h.total_stats.unpaid,onClick:()=>d(h.branch_name,void 0,"unpaid"),className:"text-red-600 font-medium"}),c.jsx(lr,{value:h.total_stats.partially_paid,onClick:()=>d(h.branch_name,void 0,"partially_paid"),className:"text-orange-600 font-medium"}),c.jsx(lr,{value:h.total_stats.paid_pending_approval,onClick:()=>d(h.branch_name,void 0,"paid_pending_approval"),className:"text-yellow-600 font-medium"}),c.jsx(lr,{value:h.total_stats.paid,onClick:()=>d(h.branch_name,void 0,"paid"),className:"text-green-600 font-medium"}),c.jsx(lr,{value:h.total_stats.others,onClick:()=>d(h.branch_name,void 0,"others"),className:"text-gray-600 font-medium"}),c.jsx(lr,{value:h.total_stats.total,onClick:()=>d(h.branch_name,void 0,"total"),className:"text-blue-600 font-bold"})]}),a.has(h.branch_name)&&h.rm_stats.map(v=>c.jsxs(ma,{children:[c.jsx(mt,{}),c.jsx(mt,{className:"text-sm text-muted-foreground",children:c.jsxs("div",{className:"flex items-center pl-4",children:[c.jsx("span",{className:"mr-2 text-gray-400",children:"├─"}),c.jsx("span",{className:"font-medium",children:v.rm_name})]})}),c.jsx(lr,{value:v.unpaid,onClick:()=>d(h.branch_name,v.rm_name,"unpaid"),className:"text-red-600"}),c.jsx(lr,{value:v.partially_paid,onClick:()=>d(h.branch_name,v.rm_name,"partially_paid"),className:"text-orange-600"}),c.jsx(lr,{value:v.paid_pending_approval,onClick:()=>d(h.branch_name,v.rm_name,"paid_pending_approval"),className:"text-yellow-600"}),c.jsx(lr,{value:v.paid,onClick:()=>d(h.branch_name,v.rm_name,"paid"),className:"text-green-600"}),c.jsx(lr,{value:v.others,onClick:()=>d(h.branch_name,v.rm_name,"others"),className:"text-gray-600"}),c.jsx(lr,{value:v.total,onClick:()=>d(h.branch_name,v.rm_name,"total"),className:"text-blue-600 font-medium"})]},`${h.branch_name}-${v.rm_name}`))]},h.branch_name)),i.length>0&&c.jsxs(ma,{className:"bg-primary/10 font-bold",children:[c.jsx(mt,{}),c.jsx(mt,{className:"font-bold text-sm",children:"Grand Total"}),c.jsx(lr,{value:m.unpaid,onClick:()=>d("",void 0,"unpaid"),className:"text-red-600 font-bold"}),c.jsx(lr,{value:m.partially_paid,onClick:()=>d("",void 0,"partially_paid"),className:"text-orange-600 font-bold"}),c.jsx(lr,{value:m.paid_pending_approval,onClick:()=>d("",void 0,"paid_pending_approval"),className:"text-yellow-600 font-bold"}),c.jsx(lr,{value:m.paid,onClick:()=>d("",void 0,"paid"),className:"text-green-600 font-bold"}),c.jsx(lr,{value:m.others,onClick:()=>d("",void 0,"others"),className:"text-gray-600 font-bold"}),c.jsx(lr,{value:m.total,onClick:()=>d("",void 0,"total"),className:"text-blue-600 font-bold"})]})]})]})})})]})},gq=()=>{const e=_.useCallback((r,n="applications-report")=>{const a=Yt.book_new(),s=r.applications.map(u=>({"Applicant ID":u.applicant_id,"Branch Name":u.branch_name,"RM Name":u.rm_name,"Dealer Name":u.dealer_name,"Applicant Name":u.applicant_name,"Applicant Mobile Number":u.applicant_mobile||"","Applicant Current Address":u.applicant_address||"","House Ownership":u.house_ownership||"","Co-Applicant Name":u.co_applicant_name||"","Coapplicant Mobile Number":u.co_applicant_mobile||"","Coapplicant Current Address":u.co_applicant_address||"","Guarantor Name":u.guarantor_name||"","Guarantor Mobile Number":u.guarantor_mobile||"","Guarantor Current Address":u.guarantor_address||"","Reference Name":u.reference_name||"","Reference Mobile Number":u.reference_mobile||"","Reference Address":u.reference_address||"","FI Submission Location":u.fi_location||"","Demand Date":u.demand_date||"",Repayment:u.repayment||"","Principle Due":u.principle_due||0,"Interest Due":u.interest_due||0,EMI:u.emi_amount,"Last Month Bounce":u.last_month_bounce||0,"Lender Name":u.lender_name,Status:u.field_status||"Unpaid","Team Lead":u.team_lead})),i=Yt.json_to_sheet(s),o=[{wch:20},{wch:20},{wch:20},{wch:25},{wch:25},{wch:15},{wch:30},{wch:15},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:25},{wch:15},{wch:30},{wch:20},{wch:12},{wch:15},{wch:12},{wch:12},{wch:12},{wch:15},{wch:25},{wch:12},{wch:20}];i["!cols"]=o,Yt.book_append_sheet(a,i,"Applications");const l=vt(new Date,"yyyy-MM-dd-HHmm");Il(a,`${n}-${l}.xlsx`)},[]),t=_.useCallback((r,n="applications-report")=>{const a=r.applications.map(l=>({"Applicant ID":l.applicant_id,"Branch Name":l.branch_name,"RM Name":l.rm_name,"Dealer Name":l.dealer_name,"Applicant Name":l.applicant_name,"Applicant Mobile Number":l.applicant_mobile||"","Applicant Current Address":l.applicant_address||"","House Ownership":l.house_ownership||"","Co-Applicant Name":l.co_applicant_name||"","Coapplicant Mobile Number":l.co_applicant_mobile||"","Coapplicant Current Address":l.co_applicant_address||"","Guarantor Name":l.guarantor_name||"","Guarantor Mobile Number":l.guarantor_mobile||"","Guarantor Current Address":l.guarantor_address||"","Reference Name":l.reference_name||"","Reference Mobile Number":l.reference_mobile||"","Reference Address":l.reference_address||"","FI Submission Location":l.fi_location||"","Demand Date":l.demand_date||"",Repayment:l.repayment||"","Principle Due":l.principle_due||0,"Interest Due":l.interest_due||0,EMI:l.emi_amount,"Last Month Bounce":l.last_month_bounce||0,"Lender Name":l.lender_name,Status:l.field_status||"Unpaid","Team Lead":l.team_lead})),s=Yt.json_to_sheet(a),i=Yt.book_new();Yt.book_append_sheet(i,s,"Applications");const o=vt(new Date,"yyyy-MM-dd-HHmm");Il(i,`${n}-${o}.csv`)},[]);return{exportToExcel:e,exportToCSV:t}},vq=({filter:e})=>(()=>{if(!e)return"";let r=`Applications in ${e.branch_name}`;switch(e.rm_name&&(r+=` (RM: ${e.rm_name})`),e.status_type){case"unpaid":return`${r} with Unpaid status`;case"partially_paid":return`${r} with Partially Paid status`;case"paid_pending_approval":return`${r} with Paid (Pending Approval) status`;case"paid":return`${r} with Paid status`;case"others":return`${r} with Other statuses`;case"overdue":return`${r} with Overdue PTPs`;case"today":return`${r} with Today's PTPs`;case"tomorrow":return`${r} with Tomorrow's PTPs`;case"future":return`${r} with Future PTPs`;case"no_ptp_set":return`${r} with No PTP set`;default:return r}})(),yq=({applicationsCount:e,filter:t,applications:r})=>{const{exportToExcel:n}=gq(),a=()=>{n({applications:r},"analytics-drill-down-report")};return c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-start gap-8",children:[c.jsx("div",{className:"flex-1 min-w-0",children:c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Application Details"})}),c.jsx("div",{className:"flex-shrink-0",children:c.jsxs(Ee,{variant:"outline",size:"sm",onClick:a,className:"flex items-center gap-2",children:[c.jsx(Ss,{className:"h-3 w-3"}),"Export"]})})]}),c.jsx("p",{className:"text-lg",children:c.jsx(vq,{filter:t})}),c.jsxs("div",{className:"flex items-center gap-6 text-gray-600",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(y1,{className:"h-5 w-5"}),c.jsxs("span",{className:"font-medium text-lg",children:[e," applications"]})]}),(t==null?void 0:t.branch_name)&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Wk,{className:"h-5 w-5"}),c.jsx("span",{className:"text-lg",children:t.branch_name})]}),(t==null?void 0:t.rm_name)&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(gu,{className:"h-5 w-5"}),c.jsx("span",{className:"text-lg",children:t.rm_name})]})]})]})},o3=_.memo(({applications:e,onRowClick:t,selectedApplicationId:r,selectedEmiMonth:n,preloadedStatusData:a,preloadedBatchData:s})=>{const{data:i,loading:o,error:l,fetchAllData:u,clearData:f}=yv(n),[d,m]=_.useState(!0),h=e.map(w=>w.applicant_id),v=h.join(","),p=_.useCallback(async()=>{if(s){console.log("📊 Using preloaded batch data instead of fetching");return}if(h.length===0){f();return}console.log("=== LOADING OPTIMIZED BATCH DATA ==="),console.log("Applications:",h.length),console.log("Selected EMI Month:",n);try{await u(h,{selectedEmiMonth:n,priority:d?"high":"medium"}),console.log("✅ Optimized batch data loading complete")}catch(w){console.error("❌ Error loading optimized batch data:",w)}finally{m(!1)}},[v,n,u,f,d,s]);_.useEffect(()=>{if(s)return;f();const w=setTimeout(()=>{p()},10);return()=>clearTimeout(w)},[p,s]);const g=s||i,y=s?!1:o;return console.log("=== OPTIMIZED TABLE RENDER ==="),console.log("Applications count:",e.length),console.log("Using preloaded data:",!!s),console.log("Is loading:",y),console.log("Has error:",!!l),console.log("Effective batch data keys:",{statuses:Object.keys(g.statuses||{}).length,ptpDates:Object.keys(g.ptpDates||{}).length,contactStatuses:Object.keys(g.contactStatuses||{}).length,comments:Object.keys(g.comments||{}).length}),c.jsxs("div",{className:"rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(Yl,{children:[c.jsx(OE,{}),c.jsx(Xl,{children:e.map(w=>{var x,S,b,E;return c.jsx(gv,{application:w,selectedApplicationId:r,onRowClick:t,selectedEmiMonth:n,batchedStatus:(a==null?void 0:a[w.applicant_id])||((x=g.statuses)==null?void 0:x[w.applicant_id])||"Unpaid",batchedPtpDate:((S=g.ptpDates)==null?void 0:S[w.applicant_id])||null,batchedContactStatus:(b=g.contactStatuses)==null?void 0:b[w.applicant_id],batchedComments:((E=g.comments)==null?void 0:E[w.applicant_id])||[],isLoading:y},w.id)})})]})}),l&&!s&&c.jsxs("div",{className:"text-center py-8 text-red-600 bg-red-50",children:[c.jsx("p",{className:"text-lg font-medium",children:"Error loading data"}),c.jsx("p",{className:"text-sm",children:l.message}),c.jsx("button",{onClick:p,className:"mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]}),e.length===0&&!y&&!l&&c.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[c.jsx("p",{className:"text-lg font-medium text-gray-500",children:"No applications found"}),c.jsx("p",{className:"text-sm text-gray-400",children:"Try adjusting your filters"})]}),y&&e.length===0&&c.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-lg font-medium text-gray-500",children:"Loading applications..."})]})]})});o3.displayName="OptimizedApplicationsTable";const xq=({applications:e,onApplicationSelect:t,selectedEmiMonth:r,statusData:n,batchData:a})=>e.length===0?c.jsx("div",{className:"flex items-center justify-center h-full text-center space-y-4",children:c.jsxs("div",{children:[c.jsx(y1,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),c.jsx("h3",{className:"text-xl font-medium text-gray-900",children:"No applications found"}),c.jsx("p",{className:"text-gray-500",children:"No applications match the selected criteria."})]})}):(console.log("ApplicationDetailsContent - Batch data passed:",!!a,a?{statuses:Object.keys(a.statuses||{}).length,comments:Object.keys(a.comments||{}).length,ptpDates:Object.keys(a.ptpDates||{}).length,contactStatuses:Object.keys(a.contactStatuses||{}).length}:"No batch data"),c.jsx("div",{className:"h-full overflow-auto",children:c.jsx(o3,{applications:e,onRowClick:t,selectedEmiMonth:r,preloadedStatusData:n,preloadedBatchData:a})})),wq=({isOpen:e,onClose:t,applications:r,filter:n,loading:a=!1,statusData:s,batchData:i})=>{const[o,l]=_.useState(null),u=m=>{l(m)},f=()=>{l(null)},d=m=>{l(m)};return console.log("Modal applications count:",r.length),console.log("Filter:",n),console.log("Modal batch data available:",!!i,i?{statuses:Object.keys(i.statuses||{}).length,comments:Object.keys(i.comments||{}).length,ptpDates:Object.keys(i.ptpDates||{}).length,contactStatuses:Object.keys(i.contactStatuses||{}).length}:"No batch data"),c.jsxs(c.Fragment,{children:[c.jsx(So,{open:e&&!o,onOpenChange:t,children:c.jsxs(_i,{className:"max-w-7xl h-[90vh] flex flex-col p-0",children:[c.jsx(Si,{className:"border-b pb-4 px-6 pt-6",children:c.jsx(yq,{applicationsCount:r.length,filter:n,applications:r})}),c.jsx("div",{className:"flex-1 overflow-hidden px-6 pb-6",children:a?c.jsx("div",{className:"flex items-center justify-center h-full",children:c.jsxs("div",{className:"text-center space-y-4",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Loading applications..."})]})}):c.jsx(xq,{applications:r,onApplicationSelect:u,selectedEmiMonth:(n==null?void 0:n.selectedEmiMonth)||null,statusData:s,batchData:i})})]})}),o&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:f}),c.jsx("div",{className:"fixed inset-y-0 right-0 w-full sm:w-96 lg:w-[500px] z-50",children:c.jsx(zT,{application:o,onClose:f,onSave:d,onDataChanged:()=>{console.log("Application data changed")},selectedEmiMonth:(n==null?void 0:n.selectedEmiMonth)||null})})]})]})},_q=()=>{const e=ef(),{allApplications:t,loading:r}=hq(),{fetchFieldStatus:n}=vv(),{fetchPtpDates:a}=i3(),s=yv(),[i,o]=_.useState(null),[l,u]=_.useState(!1),[f,d]=_.useState([]),[m,h]=_.useState({}),[v,p]=_.useState(null),[g,y]=_.useState(!1);console.log("Analytics - Applications loaded:",(t==null?void 0:t.length)||0),console.log("Analytics - Loading state:",r);const w=async b=>{console.log("Analytics - Drill down filter:",b),o(b),y(!0),u(!0);try{const E=await S(b);if(d(E),E.length>0){console.log("📊 Fetching complete batch data for",E.length,"applications");const k=E.map(N=>N.applicant_id),T=await s.fetchAllData(k,{selectedEmiMonth:b.selectedEmiMonth,priority:"high"});p(T),console.log("✅ Batch data loaded for modal:",{statuses:Object.keys(T.statuses).length,comments:Object.keys(T.comments).length,ptpDates:Object.keys(T.ptpDates).length,contactStatuses:Object.keys(T.contactStatuses).length})}else p(null)}catch(E){console.error("Error filtering applications:",E),d([]),p(null)}finally{y(!1)}},x=()=>{u(!1),o(null),d([]),p(null)},S=async b=>{if(!t)return console.log("No applications available"),[];console.log("Filtering applications with filter:",b),console.log("Total applications:",t.length);try{let E=[],k={},T={};if(b.selectedEmiMonth&&b.selectedEmiMonth!=="All"){const P=Tu(b.selectedEmiMonth),{start:G,end:X}=hi(P);console.log("Fetching collection records for date range:",{start:G,end:X});const{data:V,error:K}=await Pe.from("collection").select(`
            application_id,
            applications!inner(*)
          `).gte("demand_date",G).lte("demand_date",X);if(K)return console.error("Error fetching collection data:",K),[];if(!V||V.length===0)return console.log("No collection data found for month:",b.selectedEmiMonth),[];E=V.map(H=>H.applications).filter(H=>H!=null);const Y=V.map(H=>H.application_id);k=await n(Y,P,!1),T=await a(Y,P),console.log("Month-specific filtering - Applications with collection records:",E.length),console.log("Status map loaded:",Object.keys(k).length),console.log("PTP dates map loaded:",Object.keys(T).length)}else{E=t;const P=t.map(G=>G.applicant_id);k=await n(P,void 0,!0),T=await a(P),console.log("All months filtering - Total applications:",E.length)}const O=E.map(P=>({...P,ptp_date:T[P.applicant_id]||P.ptp_date||null,field_status:k[P.applicant_id]||P.lms_status||"Unpaid"})).filter(P=>{if(b.ptp_criteria==="date_specific"&&b.ptp_date){if(!P.ptp_date)return!1;try{if(vt(new Date(P.ptp_date),"yyyy-MM-dd")!==b.ptp_date)return!1}catch{return!1}switch(b.status_type){case"paid":return P.field_status==="Paid";case"overdue":return P.ptp_date&&new Date(P.ptp_date)<new Date&&P.field_status!=="Paid";case"total":return!0;default:return!1}}if(b.branch_name&&P.branch_name!==b.branch_name||b.rm_name&&(P.collection_rm||P.rm_name||"Unknown RM")!==b.rm_name)return!1;const G=P.field_status;if(b.ptp_criteria){if(G==="Paid")return!1;const X=oo(new Date);switch(b.ptp_criteria){case"overdue":if(!P.ptp_date)return!1;try{const V=new Date(P.ptp_date);return Q1(V,X)}catch{return!1}case"today":if(!P.ptp_date)return!1;try{const V=new Date(P.ptp_date);return lI(V)}catch{return!1}case"tomorrow":if(!P.ptp_date)return!1;try{const V=new Date(P.ptp_date);return _w(V)}catch{return!1}case"future":if(!P.ptp_date)return!1;try{const V=new Date(P.ptp_date);return rh(V,X)&&!_w(V)}catch{return!1}case"no_ptp_set":return!P.ptp_date;case"total":return!0;default:break}}switch(b.status_type){case"unpaid":return G==="Unpaid";case"partially_paid":return G==="Partially Paid";case"paid_pending_approval":return G==="Paid (Pending Approval)";case"paid":return G==="Paid";case"others":return["Cash Collected from Customer","Customer Deposited to Bank"].includes(G||"")||!["Unpaid","Partially Paid","Paid (Pending Approval)","Paid"].includes(G||"");case"total":return!0;default:return!1}});console.log("Filtered applications count:",O.length),console.log("Sample filtered applications:",O.slice(0,3).map(P=>({applicant_id:P.applicant_id,ptp_date:P.ptp_date,field_status:P.field_status,branch_name:P.branch_name})));const W=O.reduce((P,G)=>(P[G.applicant_id]=G.field_status,P),{});return h(W),O}catch(E){return console.error("Error filtering applications:",E),[]}};return r?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:c.jsxs("div",{className:"text-center space-y-4",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),c.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Loading analytics..."})]})}):!t||t.length===0?c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:c.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[c.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>e("/"),className:"flex items-center gap-2 hover:bg-white/80 transition-colors",children:[c.jsx(F0,{className:"h-4 w-4"}),"Back to Dashboard"]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Analytics Dashboard"}),c.jsx("p",{className:"text-gray-600",children:"No applications data available"})]})]}),c.jsx(qe,{className:"bg-white/95 backdrop-blur-sm shadow-xl border-0 p-8",children:c.jsx("div",{className:"text-center py-8 text-muted-foreground",children:c.jsx("p",{className:"text-lg",children:"No applications data found. Please check your data connection."})})})]})}):c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-blue-50",children:c.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[c.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[c.jsxs(Ee,{variant:"outline",size:"sm",onClick:()=>e("/"),className:"flex items-center gap-2 hover:bg-white/80 transition-colors",children:[c.jsx(F0,{className:"h-4 w-4"}),"Back to Dashboard"]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Analytics Dashboard"}),c.jsxs("p",{className:"text-gray-600",children:["Comprehensive insights into payment collections for ",t.length," applications"]})]})]}),c.jsx("div",{className:"relative",children:c.jsx(qe,{className:"bg-white/95 backdrop-blur-sm shadow-xl border-0 p-8",children:c.jsx(pq,{applications:t,onDrillDown:w})})}),c.jsx(wq,{isOpen:l,onClose:x,applications:f,filter:i,loading:g,statusData:m,batchData:v})]})})},Sq=()=>{const e=qh();return _.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),c.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),c.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},kq=new yR({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:"always",retry:2,retryDelay:e=>Math.min(1e3*2**e,3e4)},mutations:{retry:1}}}),bq=()=>c.jsx(wR,{client:kq,children:c.jsxs(XD,{children:[c.jsx(DP,{}),c.jsx(uj,{}),c.jsx(m8,{children:c.jsx(p8,{children:c.jsxs(f8,{children:[c.jsx(Cc,{path:"/",element:c.jsx(W7,{})}),c.jsx(Cc,{path:"/admin-settings",element:c.jsx(fq,{})}),c.jsx(Cc,{path:"/analytics",element:c.jsx(_q,{})}),c.jsx(Cc,{path:"*",element:c.jsx(Sq,{})})]})})})]})});"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered successfully: ",e)}).catch(e=>{console.warn("SW registration failed (this is non-critical): ",e)})});ok(document.getElementById("root")).render(c.jsx(_.StrictMode,{children:c.jsx(bq,{})}));export{Mr as A};
//# sourceMappingURL=index-CZD0uKTh.js.map
